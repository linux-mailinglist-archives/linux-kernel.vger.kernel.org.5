Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id AC6CA775430
	for <lists+linux-kernel@lfdr.de>; Wed,  9 Aug 2023 09:33:02 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S230097AbjHIHdB (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Wed, 9 Aug 2023 03:33:01 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:32956 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S230076AbjHIHc7 (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Wed, 9 Aug 2023 03:32:59 -0400
Received: from rtits2.realtek.com.tw (rtits2.realtek.com [211.75.126.72])
        by lindbergh.monkeyblade.net (Postfix) with ESMTP id 1C99F183;
        Wed,  9 Aug 2023 00:32:54 -0700 (PDT)
Authenticated-By: 
X-SpamFilter-By: ArmorX SpamTrap 5.77 with qID 3797W5dG4018489, This message is accepted by code: ctloc85258
Received: from mail.realtek.com (rtexh36506.realtek.com.tw[172.21.6.27])
        by rtits2.realtek.com.tw (8.15.2/2.81/5.90) with ESMTPS id 3797W5dG4018489
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=FAIL);
        Wed, 9 Aug 2023 15:32:05 +0800
Received: from RTEXMBS03.realtek.com.tw (172.21.6.96) by
 RTEXH36506.realtek.com.tw (172.21.6.27) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2507.17; Wed, 9 Aug 2023 15:31:29 +0800
Received: from RTEXMBS04.realtek.com.tw (172.21.6.97) by
 RTEXMBS03.realtek.com.tw (172.21.6.96) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2375.7; Wed, 9 Aug 2023 15:31:28 +0800
Received: from RTEXMBS04.realtek.com.tw ([fe80::e138:e7f1:4709:ff4d]) by
 RTEXMBS04.realtek.com.tw ([fe80::e138:e7f1:4709:ff4d%5]) with mapi id
 15.01.2375.007; Wed, 9 Aug 2023 15:31:28 +0800
From:   Justin Lai <justinlai0215@realtek.com>
To:     Heiner Kallweit <hkallweit1@gmail.com>,
        "kuba@kernel.org" <kuba@kernel.org>
CC:     "davem@davemloft.net" <davem@davemloft.net>,
        "edumazet@google.com" <edumazet@google.com>,
        "pabeni@redhat.com" <pabeni@redhat.com>,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
        "netdev@vger.kernel.org" <netdev@vger.kernel.org>
Subject: RE: [PATCH] net/ethernet/realtek: Add Realtek automotive PCIe driver
Thread-Topic: [PATCH] net/ethernet/realtek: Add Realtek automotive PCIe driver
Thread-Index: AQHZxeQMA/4O5CExTkOPXZ48NozVXK/aDAKAgAeJu7A=
Date:   Wed, 9 Aug 2023 07:31:27 +0000
Message-ID: <ee8815345f35400db5fc89fe44de9de2@realtek.com>
References: <20230803082513.6523-1-justinlai0215@realtek.com>
 <f4ba8384-7155-0396-e89f-e8f8c5b25f19@gmail.com>
In-Reply-To: <f4ba8384-7155-0396-e89f-e8f8c5b25f19@gmail.com>
Accept-Language: zh-TW, en-US
Content-Language: zh-TW
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [172.21.210.185]
x-kse-serverinfo: RTEXMBS03.realtek.com.tw, 9
x-kse-antispam-interceptor-info: fallback
x-kse-antivirus-interceptor-info: fallback
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-KSE-AntiSpam-Interceptor-Info: fallback
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,LOTS_OF_MONEY,
        RCVD_IN_MSPIKE_H2,SPF_HELO_NONE,SPF_PASS,URIBL_BLOCKED autolearn=ham
        autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

PiBPbiAwMy4wOC4yMDIzIDEwOjI1LCBqdXN0aW5sYWkwMjE1IHdyb3RlOg0KPiA+IFRoaXMgcGF0
Y2ggaXMgdG8gYWRkIHRoZSBldGhlcm5ldCBkZXZpY2UgZHJpdmVyIGZvciB0aGUgUENJZSBpbnRl
cmZhY2Ugb2YNCj4gUmVhbHRlayBBdXRvbW90aXZlIEV0aGVybmV0IFN3aXRjaCwNCj4gPiBhcHBs
aWNhYmxlIHRvIFJUTDkwNTQsIFJUTDkwNjgsIFJUTDkwNzIsIFJUTDkwNzUsIFJUTDkwNjgsIFJU
TDkwNzEuDQo+ID4NCj4gLSBBIHJlYWwgYXV0aG9yJ3MgbmFtZSB3b3VsZCBiZSBuaWNlLg0KPiAt
IEEgbGluayB0byB0aGUgY2hpcCBkYXRhIHNoZWV0cyB3b3VsZCBiZSBoZWxwZnVsLg0KPiAtIFJl
YWQgdGhlIG5ldGRldiBjb2RlIHJ1bGVzLg0KPiAgIC0gVGhlIG5ldC1uZXh0IHBhdGNoIGFubm90
YXRpb24gaXMgbWlzc2luZy4NCj4gICAtIFJldmVyc2UgY2hyaXN0bWFzIHRyZWUNCj4gICAtIC4u
DQo+IC0gTm90IGFkZGluZyBhIE1BSU5UQUlORVJTIGVudHJ5Pw0KPiANCj4gSW4gZ2VuZXJhbCB0
aGUgY29kZSBxdWFsaXR5IGRvZXNuJ3QgbWVldCBtYWlubGluZSByZXF1aXJlbWVudHMsIGUuZy4g
dGhlcmUncw0KPiBhIGxvdCBvZiB1bm5lY2Vzc2FyeSBjYXN0aW5nLg0KPiANCj4gQW5kIG5vIFBI
WSBoYW5kbGluZyBhdCBhbGwgaW4gdGhlIGRyaXZlcj8NCg0KVGhhbmsgeW91IGZvciB5b3VyIHF1
ZXN0aW9uLCBpdCBpcyBhbiBpbnRlcmZhY2Ugb2YgZXRoZXJuZXQgc3dpdGNoIHdpdGhvdXQgcGh5
IG1vZGVsLg0KDQo+ID4gU2lnbmVkLW9mZi1ieToganVzdGlubGFpMDIxNSA8anVzdGlubGFpMDIx
NUByZWFsdGVrLmNvbT4NCj4gPiAtLS0NCj4gPiAgZHJpdmVycy9uZXQvZXRoZXJuZXQvcmVhbHRl
ay9LY29uZmlnICAgICAgICAgIHwgICAxNyArDQo+ID4gIGRyaXZlcnMvbmV0L2V0aGVybmV0L3Jl
YWx0ZWsvTWFrZWZpbGUgICAgICAgICB8ICAgIDEgKw0KPiA+ICBkcml2ZXJzL25ldC9ldGhlcm5l
dC9yZWFsdGVrL3J0YXNlL01ha2VmaWxlICAgfCAgIDEwICsNCj4gPiAgZHJpdmVycy9uZXQvZXRo
ZXJuZXQvcmVhbHRlay9ydGFzZS9ydGFzZS5oICAgIHwgIDY1NCArKysNCj4gPiAgLi4uL25ldC9l
dGhlcm5ldC9yZWFsdGVrL3J0YXNlL3J0YXNlX21haW4uYyAgIHwgNDc5NyArKysrKysrKysrKysr
KysrKw0KPiA+ICAuLi4vbmV0L2V0aGVybmV0L3JlYWx0ZWsvcnRhc2UvcnRhc2Vfc3Jpb3YuYyAg
fCAgMzI4ICsrDQo+ID4gIC4uLi9uZXQvZXRoZXJuZXQvcmVhbHRlay9ydGFzZS9ydGFzZV9zcmlv
di5oICB8ICAgMzAgKw0KPiA+ICA3IGZpbGVzIGNoYW5nZWQsIDU4MzcgaW5zZXJ0aW9ucygrKQ0K
PiA+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvZXRoZXJuZXQvcmVhbHRlay9ydGFz
ZS9NYWtlZmlsZQ0KPiA+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9uZXQvZXRoZXJuZXQv
cmVhbHRlay9ydGFzZS9ydGFzZS5oDQo+ID4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL25l
dC9ldGhlcm5ldC9yZWFsdGVrL3J0YXNlL3J0YXNlX21haW4uYw0KPiA+ICBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9uZXQvZXRoZXJuZXQvcmVhbHRlay9ydGFzZS9ydGFzZV9zcmlvdi5jDQo+
ID4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL25ldC9ldGhlcm5ldC9yZWFsdGVrL3J0YXNl
L3J0YXNlX3NyaW92LmgNCj4gPg0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5l
dC9yZWFsdGVrL0tjb25maWcNCj4gYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9yZWFsdGVrL0tjb25m
aWcNCj4gPiBpbmRleCA5M2Q5ZGY1NWIzNjEuLjAyNTBkMWMzODc0YiAxMDA2NDQNCj4gPiAtLS0g
YS9kcml2ZXJzL25ldC9ldGhlcm5ldC9yZWFsdGVrL0tjb25maWcNCj4gPiArKysgYi9kcml2ZXJz
L25ldC9ldGhlcm5ldC9yZWFsdGVrL0tjb25maWcNCj4gPiBAQCAtMTEzLDQgKzExMywyMSBAQCBj
b25maWcgUjgxNjkNCj4gPiAgICAgICAgIFRvIGNvbXBpbGUgdGhpcyBkcml2ZXIgYXMgYSBtb2R1
bGUsIGNob29zZSBNIGhlcmU6IHRoZSBtb2R1bGUNCj4gPiAgICAgICAgIHdpbGwgYmUgY2FsbGVk
IHI4MTY5LiAgVGhpcyBpcyByZWNvbW1lbmRlZC4NCj4gPg0KPiA+ICtjb25maWcgUlRBU0UNCj4g
PiArICAgICB0cmlzdGF0ZSAiUmVhbHRlayBBdXRvbW90aXZlIFN3aXRjaA0KPiA5MDU0LzkwNjgv
OTA3Mi85MDc1LzkwNjgvOTA3MSBQQ0llIEludGVyZmFjZSBzdXBwb3J0Ig0KPiA+ICsgICAgIGRl
cGVuZHMgb24gUENJDQo+ID4gKyAgICAgc2VsZWN0IENSQzMyDQo+ID4gKyAgICAgaGVscA0KPiA+
ICsgICAgICAgU2F5IFkgaGVyZSBpZiB5b3UgaGF2ZSBhIFJlYWx0ZWsgRXRoZXJuZXQgYWRhcHRl
ciBiZWxvbmdpbmcgdG8NCj4gPiArICAgICAgIHRoZSBmb2xsb3dpbmcgZmFtaWxpZXM6DQo+ID4g
KyAgICAgICBSVEw5MDU0IDVHQml0IEV0aGVybmV0DQo+ID4gKyAgICAgICBSVEw5MDY4IDVHQml0
IEV0aGVybmV0DQo+ID4gKyAgICAgICBSVEw5MDcyIDVHQml0IEV0aGVybmV0DQo+ID4gKyAgICAg
ICBSVEw5MDc1IDVHQml0IEV0aGVybmV0DQo+ID4gKyAgICAgICBSVEw5MDY4IDVHQml0IEV0aGVy
bmV0DQo+ID4gKyAgICAgICBSVEw5MDcxIDVHQml0IEV0aGVybmV0DQo+ID4gKw0KPiA+ICsgICAg
ICAgVG8gY29tcGlsZSB0aGlzIGRyaXZlciBhcyBhIG1vZHVsZSwgY2hvb3NlIE0gaGVyZTogdGhl
IG1vZHVsZQ0KPiA+ICsgICAgICAgd2lsbCBiZSBjYWxsZWQgcnRhc2UuICBUaGlzIGlzIHJlY29t
bWVuZGVkLg0KPiA+ICsNCj4gPiAgZW5kaWYgIyBORVRfVkVORE9SX1JFQUxURUsNCj4gPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvcmVhbHRlay9NYWtlZmlsZQ0KPiBiL2RyaXZl
cnMvbmV0L2V0aGVybmV0L3JlYWx0ZWsvTWFrZWZpbGUNCj4gPiBpbmRleCAyZTFkNzhiMTA2YjAu
LjBjMWMxNmY2M2U5YSAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9yZWFs
dGVrL01ha2VmaWxlDQo+ID4gKysrIGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvcmVhbHRlay9NYWtl
ZmlsZQ0KPiA+IEBAIC04LDMgKzgsNCBAQCBvYmotJChDT05GSUdfODEzOVRPTykgKz0gODEzOXRv
by5vDQo+ID4gIG9iai0kKENPTkZJR19BVFApICs9IGF0cC5vDQo+ID4gIHI4MTY5LW9ianMgKz0g
cjgxNjlfbWFpbi5vIHI4MTY5X2Zpcm13YXJlLm8gcjgxNjlfcGh5X2NvbmZpZy5vDQo+ID4gIG9i
ai0kKENPTkZJR19SODE2OSkgKz0gcjgxNjkubw0KPiA+ICtvYmotJChDT05GSUdfUlRBU0UpICs9
IHJ0YXNlLw0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9yZWFsdGVrL3J0
YXNlL01ha2VmaWxlDQo+IGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvcmVhbHRlay9ydGFzZS9NYWtl
ZmlsZQ0KPiA+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0DQo+ID4gaW5kZXggMDAwMDAwMDAwMDAwLi42
MWZlMmY5ZTAzNDQNCj4gPiAtLS0gL2Rldi9udWxsDQo+ID4gKysrIGIvZHJpdmVycy9uZXQvZXRo
ZXJuZXQvcmVhbHRlay9ydGFzZS9NYWtlZmlsZQ0KPiA+IEBAIC0wLDAgKzEsMTAgQEANCj4gPiAr
IyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KPiA+ICsjIENvcHlyaWdodChjKSAy
MDIzIFJlYWx0ZWsgU2VtaWNvbmR1Y3RvciBDb3JwLiBBbGwgcmlnaHRzIHJlc2VydmVkLg0KPiA+
ICsNCj4gPiArIw0KPiA+ICsjIE1ha2VmaWxlIGZvciB0aGUgUmVhbHRlayBQQ0llIGRyaXZlcg0K
PiA+ICsjDQo+ID4gKw0KPiA+ICtvYmotJChDT05GSUdfUlRBU0UpICs9IHJ0YXNlLm8NCj4gPiAr
DQo+ID4gK3J0YXNlLW9ianMgOj0gcnRhc2VfbWFpbi5vIHJ0YXNlX3NyaW92Lm8NCj4gPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvcmVhbHRlay9ydGFzZS9ydGFzZS5oDQo+IGIv
ZHJpdmVycy9uZXQvZXRoZXJuZXQvcmVhbHRlay9ydGFzZS9ydGFzZS5oDQo+ID4gbmV3IGZpbGUg
bW9kZSAxMDA2NDQNCj4gPiBpbmRleCAwMDAwMDAwMDAwMDAuLjc2NjE5MzkxNDM3Mw0KPiA+IC0t
LSAvZGV2L251bGwNCj4gPiArKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9yZWFsdGVrL3J0YXNl
L3J0YXNlLmgNCj4gPiBAQCAtMCwwICsxLDY1NCBAQA0KPiA+ICsvKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMCAqLw0KPiA+ICsvKg0KPiA+ICsgKiAgcnRhc2UgaXMgdGhlIExpbnV4
IGRldmljZSBkcml2ZXIgcmVsZWFzZWQgZm9yIFJlYWx0ZWsgQXV0b21vdGl2ZSBTd2l0Y2gNCj4g
PiArICogIGNvbnRyb2xsZXJzIHdpdGggUENJLUV4cHJlc3MgaW50ZXJmYWNlLg0KPiA+ICsgKg0K
PiA+ICsgKiAgQ29weXJpZ2h0KGMpIDIwMjMgUmVhbHRlayBTZW1pY29uZHVjdG9yIENvcnAuIEFs
bCByaWdodHMgcmVzZXJ2ZWQuDQo+ID4gKyAqDQo+ID4gKyAqICBBdXRob3I6DQo+ID4gKyAqICBS
ZWFsdGVrIEFSRCBzb2Z0d2FyZSB0ZWFtDQo+ID4gKyAqICBOby4gMiwgSW5ub3ZhdGlvbiBSb2Fk
IElJLCBIc2luY2h1IFNjaWVuY2UgUGFyaywgSHNpbmNodSAzMDAsIFRhaXdhbg0KPiA+ICsgKg0K
PiA+ICsgKi8NCj4gPiArDQo+ID4NCj4gKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KPiAqKioqKioqKioqKioqKioqDQo+ID4g
KyAqICBUaGlzIHByb2R1Y3QgaXMgY292ZXJlZCBieSBvbmUgb3IgbW9yZSBvZiB0aGUgZm9sbG93
aW5nIHBhdGVudHM6DQo+ID4gKyAqICBVUzYsNTcwLDg4NCwgVVM2LDExNSw3NzYsIGFuZCBVUzYs
MzI3LDYyNS4NCj4gPiArDQo+ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioNCj4gKioqKioqKioqKioqKiovDQo+ID4gKw0KPiA+
ICsjaWZuZGVmIFJUQVNFX0hfDQo+ID4gKyNkZWZpbmUgUlRBU0VfSF8NCj4gPiArDQo+ID4gKyNp
bmNsdWRlIDxsaW51eC92ZXJzaW9uLmg+DQo+ID4gKyNpbmNsdWRlIDxsaW51eC9ldGh0b29sLmg+
DQo+ID4gKw0KPiA+ICsjZGVmaW5lIFJUTF9BTExPQ19TS0JfSU5UUihuYXBpLCBsZW5ndGgpIG5h
cGlfYWxsb2Nfc2tiKCYobmFwaSksIGxlbmd0aCkNCj4gPiArDQo+IFdoYXQncyB0aGUgYmVuZWZp
dCBvZiB0aGlzPw0KPiANCj4gPiArI2RlZmluZSBORVRJRl9GX0FMTF9DU1VNIE5FVElGX0ZfQ1NV
TV9NQVNLDQo+ID4gKw0KPiBEaXRvDQo+IA0KPiA+ICsjZGVmaW5lIEVOQUJMRV9SVEFTRV9QUk9D
RlMNCj4gPiArDQo+IFVzZSBzdGFuZGFyZCBrZXJuZWwgbWVhbnMgaW5zdGVhZCBvZiBhZGRpbmcg
cHJvcHJpZXRhcnkgcHJvY3NmcyBzdHVmZi4NCj4gDQo+ID4gKyNkZWZpbmUgTkVUSUZfRl9IV19W
TEFOX1JYIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1JYDQo+ID4gKyNkZWZpbmUgTkVUSUZfRl9IV19W
TEFOX1RYIE5FVElGX0ZfSFdfVkxBTl9DVEFHX1RYDQo+ID4gKw0KPiA+ICsjZGVmaW5lIENPTkZJ
R19TUklPViAxDQo+ID4gKw0KPiBXaHkgbm90IGFsd2F5cyBlbmFibGUgaXQ/DQo+IA0KPiA+ICsj
aWZuZGVmIE5FVElGX0ZfUlhBTEwNCj4gPiArI2RlZmluZSBORVRJRl9GX1JYQUxMIDB1DQo+ID4g
KyNlbmRpZg0KPiA+ICsNCj4gQWxsIHRoaXMgc3R1ZmYgc2VlbXMgdG8gY29tZSBmcm9tIGEgdmVu
ZG9yIGRyaXZlciB0aGF0IGhhcyB0byBzdXBwb3J0DQo+IG11bHRpcGxlIGtlcm5lbCB2ZXJzaW9u
cy4gVGhpIHNjYW4gYmUgc2ltcGxpZmllZCBub3cuDQo+IA0KPiA+ICsjaWZuZGVmIE5FVElGX0Zf
UlhGQ1MNCj4gPiArI2RlZmluZSBORVRJRl9GX1JYRkNTIDB1DQo+ID4gKyNlbmRpZg0KPiA+ICsN
Cj4gPiArI2lmbmRlZiBTRVRfTkVUREVWX0RFVg0KPiA+ICsjZGVmaW5lIFNFVF9ORVRERVZfREVW
KG5ldCwgcGRldikNCj4gPiArI2VuZGlmDQo+ID4gKw0KPiA+ICsjaWZuZGVmIFNFVF9NT0RVTEVf
T1dORVINCj4gPiArI2RlZmluZSBTRVRfTU9EVUxFX09XTkVSKGRldikNCj4gPiArI2VuZGlmDQo+
ID4gKw0KPiA+ICsjaWZuZGVmIFNBX1NISVJRDQo+ID4gKyNkZWZpbmUgU0FfU0hJUlEgSVJRRl9T
SEFSRUQNCj4gPiArI2VuZGlmDQo+ID4gKw0KPiA+ICsjaWZuZGVmIE5FVElGX0ZfR1NPDQo+ID4g
KyNkZWZpbmUgZ3NvX3NpemUgdHNvX3NpemUNCj4gPiArI2RlZmluZSBnc29fc2VncyB0c29fc2Vn
cw0KPiA+ICsjZW5kaWYNCj4gPiArDQo+ID4gKyNpZm5kZWYgZG1hX21hcHBpbmdfZXJyb3INCj4g
PiArI2RlZmluZSBkbWFfbWFwcGluZ19lcnJvcihhLCBiKSAwDQo+ID4gKyNlbmRpZg0KPiA+ICsN
Cj4gPiArI2lmbmRlZiBuZXRpZl9lcnINCj4gPiArI2RlZmluZSBuZXRpZl9lcnIoYSwgYiwgYywg
ZCkNCj4gPiArI2VuZGlmDQo+ID4gKw0KPiA+ICsjaWZuZGVmIEZBTFNFDQo+ID4gKyNkZWZpbmUg
RkFMU0UgMA0KPiA+ICsjZW5kaWYNCj4gPiArDQo+ID4gKyNpZm5kZWYgVFJVRQ0KPiA+ICsjZGVm
aW5lIFRSVUUgMQ0KPiA+ICsjZW5kaWYNCj4gPiArDQo+ID4gKyNpZm5kZWYgZmFsc2UNCj4gPiAr
I2RlZmluZSBmYWxzZSAwDQo+ID4gKyNlbmRpZg0KPiA+ICsNCj4gPiArI2lmbmRlZiB0cnVlDQo+
ID4gKyNkZWZpbmUgdHJ1ZSAxDQo+ID4gKyNlbmRpZg0KPiA+ICsNCj4gPiArLyogdGhlIGxvdyAz
MiBiaXQgYWRkcmVzcyBvZiByZWNlaXZlIGJ1ZmZlciBtdXN0IGJlIDgtYnl0ZSBhbGlnbm1lbnQu
ICovDQo+ID4gKyNkZWZpbmUgUlRLX1JYX0FMSUdOICg4dSkNCj4gPiArDQo+ID4gKyNkZWZpbmUg
TkFQSV9TVUZGSVggICAiLU5BUEkiDQo+ID4gKyNkZWZpbmUgUlRBU0VfVkVSU0lPTiAiMS4wMDIu
MDYiIE5BUElfU1VGRklYUmVtb3ZlIHRoaXMNCj4gDQo+ID4gKyNkZWZpbmUgTU9EVUxFTkFNRSAg
ICAicnRhc2UiDQo+ID4gKyNkZWZpbmUgUEZYICAgICAgICAgICBNT0RVTEVOQU1FICI6ICINCj4g
PiArDQo+ID4gKyNkZWZpbmUgR1BMX0NMQUlNIFwNCj4gPiArICAgICAicnRhc2UgIENvcHlyaWdo
dCAoQykgMjAyMSAgUmVhbHRlayBBUkQgc29mdHdhcmUgdGVhbVxuXA0KPiA+ICsgICAgIFRoaXMg
cHJvZ3JhbSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFk7XG5cDQo+ID4gKyAgICAg
Zm9yIGRldGFpbHMsIHBsZWFzZSBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+Llxu
XA0KPiA+ICsgICAgIFRoaXMgaXMgZnJlZSBzb2Z0d2FyZSwgYW5kIHlvdSBhcmUgd2VsY29tZSB0
byByZWRpc3RyaWJ1dGUgaXQgdW5kZXINCj4gY2VydGFpbiBjb25kaXRpb25zOyBcbiBcDQo+ID4g
KyAgICAgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi5cbiINCj4gPiArDQo+ID4g
KyNpZmRlZiBSVEFTRV9ERUJVRw0KPiA+ICsjZGVmaW5lIGFzc2VydChleHByKQ0KPiBcDQo+ID4g
KyAgICAgZG8NCj4gew0KPiAgICAgICAgICAgICAgICAgICAgICAgICBcDQo+ID4gKyAgICAgICAg
ICAgICBpZiAoIShleHByKSkNCj4gew0KPiAgICAgICBcDQo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgIHByX2luZm8oIkFzc2VydGlvbiBmYWlsZWQhICVzLCVzLCVzLGxpbmU9JWRcbiIsDQo+ICNl
eHByLCBfX0ZJTEVfXywgX19mdW5jX18sIFwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBfX0xJTkVfXyk7DQo+IFwNCj4gPiArICAgICAgICAgICAgIH0NCj4gXA0KPiA+ICsgICAg
IH0gd2hpbGUgKDApDQo+ID4gKyNkZWZpbmUgZHByaW50ayhmbXQsIGFyZ3MuLi4pIHByX2luZm8o
UEZYIGZtdCwgIyNhcmdzKQ0KPiA+ICsjZWxzZQ0KPiA+ICsjZGVmaW5lIGFzc2VydChleHByKQ0K
PiA+ICsjZGVmaW5lIGRwcmludGsoZm10LCBhcmdzLi4uKQ0KPiA+ICsjZW5kaWYgLyogUlRBU0Vf
REVCVUcgKi8NCj4gPiArDQo+ID4gKyNkZWZpbmUgUlRBU0VfTVNHX0RFRkFVTFQgKE5FVElGX01T
R19EUlYgfCBORVRJRl9NU0dfUFJPQkUgfA0KPiBORVRJRl9NU0dfSUZVUCB8IE5FVElGX01TR19J
RkRPV04pDQo+ID4gKw0KPiA+ICsjZGVmaW5lIFRYX0JVRkZTX0FWQUlMKHJpbmcpICgocmluZykt
PmRpcnR5X2lkeCArIE5VTV9ERVNDIC0NCj4gKHJpbmcpLT5jdXJfaWR4IC0gMSkNCj4gPiArDQo+
ID4gKy8qIE1BQyBhZGRyZXNzIGxlbmd0aCAqLw0KPiA+ICsjaWZuZGVmIE1BQ19BRERSX0xFTg0K
PiA+ICsjZGVmaW5lIE1BQ19BRERSX0xFTiA2dQ0KPiA+ICsjZW5kaWYNCj4gPiArDQo+ID4gKyNp
Zm5kZWYgTkVUSUZfRl9UU082DQo+ID4gKyNkZWZpbmUgTkVUSUZfRl9UU082IDB1DQo+ID4gKyNl
bmRpZg0KPiA+ICsNCj4gPiArI2RlZmluZSBSWF9ETUFfQlVSU1RfMjU2ICAgICAgIDR1DQo+ID4g
KyNkZWZpbmUgVFhfRE1BX0JVUlNUX1VOTElNSVRFRCA3dQ0KPiA+ICsjZGVmaW5lIEpVTUJPX0ZS
QU1FXzFLICAgICAgICAgKEVUSF9EQVRBX0xFTikNCj4gPiArI2RlZmluZSBKVU1CT19GUkFNRV85
SyAgICAgICAgICgoOSAqIDEwMjQpIC0gRVRIX0hMRU4gLQ0KPiBWTEFOX0hMRU4gLSBFVEhfRkNT
X0xFTikNCj4gPiArDQo+ID4gKy8qIDMgbWVhbnMgSW50ZXJGcmFtZUdhcCA9IHRoZSBzaG9ydGVz
dCBvbmUgKi8NCj4gPiArI2RlZmluZSBJTlRFUkZSQU1FR0FQIDB4MDN1DQo+ID4gKw0KPiA+ICsj
ZGVmaW5lIFJUQVNFX1JFR1NfU0laRSAgICAgKDI1NnUpDQo+ID4gKyNkZWZpbmUgUlRBU0VfUENJ
X1JFR1NfU0laRSAoMHgxMDApDQo+ID4gKyNkZWZpbmUgUlRBU0VfTkFQSV9XRUlHSFQgICAoNjQp
DQo+ID4gKw0KPiA+ICsjZGVmaW5lIFJUQVNFX1RYX1RJTUVPVVQgKDYgKiBIWikNCj4gPiArDQo+
ID4gKyNkZWZpbmUgVFhfRFVQTElDQVRFX0RJUlRZSURYX0NPVU5UIDN1DQo+ID4gKy8qIFNldCB0
aW1lb3V0IHRvIDFzICgweDc3MzU5NDAgPSAxcyAvIDhucykgKi8NCj4gPiArI2RlZmluZSBUSU1F
T1VUX1NFVF9USU1FIDB4NzczNTk0MHUNCj4gPiArDQo+ID4gKyNkZWZpbmUgVkxBTl9GSUxURVJf
RU5UUllfTlVNIDMydQ0KPiA+ICsvKiBOdW1iZXIgb2YgVHggcXVldWVzICovDQo+ID4gKyNkZWZp
bmUgTlVNX1RYX1FVRVVFIDh1DQo+ID4gKy8qIE51bWJlciBvZiBSeCBxdWV1ZXMgKi8NCj4gPiAr
I2RlZmluZSBOVU1fUlhfUVVFVUUgNHUNCj4gPiArLyogTnVtYmVyIG9mIFR4IGRlc2NyaXB0b3Ig
cmVnaXN0ZXJzICovDQo+ID4gKyNkZWZpbmUgTlVNX1RYX0RFU0MgMTAyNHUNCj4gPiArDQo+ID4g
Ky8qIGRlZmF1bHQgdHggaW50ZXJydXB0IG1pdGlnYXRpb24sIG51bSA9IDY0LCB0aW1lID0gMTMx
LjA3MnVzICovDQo+ID4gKyNkZWZpbmUgVFhfSU5UX01JVElHQVRJT04gMHgzNDQ4dQ0KPiA+ICsv
KiBkZWZhdWx0IHJ4IGludGVycnVwdCBtaXRpZ2F0aW9uLCBudW0gPSA2NCwgdGltZSA9IDEzMS4w
NzJ1cyAqLw0KPiA+ICsjZGVmaW5lIFJYX0lOVF9NSVRJR0FUSU9OIDB4MzQ0OHUNCj4gPiArDQo+
ID4gKyNkZWZpbmUgTlVNX01TSVggNHUNCj4gPiArDQo+ID4gKy8qIDB4MDVGMyA9IDE1MjJieWUg
KyAxICovDQo+ID4gKyNkZWZpbmUgUlhfQlVGX1NJWkUgMHgwNUYzdQ0KPiA+ICsNCj4gPiArLyog
d3JpdGUvcmVhZCBNTUlPIHJlZ2lzdGVyICovDQo+ID4gKyNkZWZpbmUgUlRMX1c4KHJlZywgdmFs
OCkgICB3cml0ZWIoKHZhbDgpLCBpb2FkZHIgKyAocmVnKSkNCj4gPiArI2RlZmluZSBSVExfVzE2
KHJlZywgdmFsMTYpIHdyaXRldygodmFsMTYpLCBpb2FkZHIgKyAocmVnKSkNCj4gPiArI2RlZmlu
ZSBSVExfVzMyKHJlZywgdmFsMzIpIHdyaXRlbCgodmFsMzIpLCBpb2FkZHIgKyAocmVnKSkNCj4g
PiArI2RlZmluZSBSVExfUjgocmVnKSAgICAgICAgIHJlYWRiKGlvYWRkciArIChyZWcpKQ0KPiA+
ICsjZGVmaW5lIFJUTF9SMTYocmVnKSAgICAgICAgcmVhZHcoaW9hZGRyICsgKHJlZykpDQo+ID4g
KyNkZWZpbmUgUlRMX1IzMihyZWcpICAgICAgICByZWFkbChpb2FkZHIgKyAocmVnKSkNCj4gPiAr
DQo+ID4gKyNpZm5kZWYgRE1BXzY0QklUX01BU0sNCj4gPiArI2RlZmluZSBETUFfNjRCSVRfTUFT
SyAweEZGRkZGRkZGRkZGRkZGRkZ1TEwNCj4gPiArI2VuZGlmDQo+ID4gKw0KPiA+ICsjaWZuZGVm
IERNQV8zMkJJVF9NQVNLDQo+ID4gKyNkZWZpbmUgRE1BXzMyQklUX01BU0sgMHgwMDAwMDAwMEZG
RkZGRkZGdUxMDQo+ID4gKyNlbmRpZg0KPiA+ICsNCj4gPg0KPiArLyoqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqDQo+ICoqKioqKioq
KioqKioqKi8NCj4gPiArI2RlZmluZSBSVExfTkVUSUZfUlhfU0NIRURVTEVfUFJFUChkZXYsIG5h
cGkpDQo+IG5hcGlfc2NoZWR1bGVfcHJlcChuYXBpKQ0KPiA+ICsjZGVmaW5lIF9fUlRMX05FVElG
X1JYX1NDSEVEVUxFKGRldiwgbmFwaSkgICAgX19uYXBpX3NjaGVkdWxlKG5hcGkpDQo+ID4gKw0K
PiA+DQo+ICsvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioNCj4gKioqKioqKioqKioqKioqLw0KPiA+ICsjaWZuZGVmIG1vZHVsZV9w
YXJhbQ0KPiA+ICsjZGVmaW5lIG1vZHVsZV9wYXJhbSh2LCB0LCBwKSBNT0RVTEVfUEFSTSh2LCAi
aSIpDQo+ID4gKyNlbmRpZg0KPiA+ICsNCj4gPiArI2lmbmRlZiBQQ0lfREVWSUNFDQo+ID4gKyNk
ZWZpbmUgUENJX0RFVklDRSh2ZW5kLCBkZXYpIFwNCj4gPiArICAgICAudmVuZG9yID0gKHZlbmQp
LCAuZGV2aWNlID0gKGRldiksIC5zdWJ2ZW5kb3IgPQ0KPiBQQ0lfQU5ZX0lELCAuc3ViZGV2aWNl
ID0gUENJX0FOWV9JRA0KPiA+ICsjZW5kaWYNCj4gPiArDQo+ID4NCj4gKy8qKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KPiAqKioq
KioqKioqKioqKiovDQo+ID4gKy8qIFJUQVNFX3JlZ2lzdGVycyAqLw0KPiA+ICsjZGVmaW5lIE1B
QzAgICAgICAgICAgICAgICAgMHgwMDAwdQ0KPiA+ICsjZGVmaW5lIE1BQzQgICAgICAgICAgICAg
ICAgMHgwMDA0dQ0KPiA+ICsjZGVmaW5lIE1BUjAgICAgICAgICAgICAgICAgMHgwMDA4dQ0KPiA+
ICsjZGVmaW5lIE1BUjEgICAgICAgICAgICAgICAgMHgwMDBDdQ0KPiA+ICsjZGVmaW5lIERUQ0NS
MCAgICAgICAgICAgICAgMHgwMDEwdQ0KPiA+ICsjZGVmaW5lIERUQ0NSNCAgICAgICAgICAgICAg
MHgwMDE0dQ0KPiA+ICsjZGVmaW5lIEZDUiAgICAgICAgICAgICAgICAgMHgwMDE4dQ0KPiA+ICsj
ZGVmaW5lIExCS19DVFJMICAgICAgICAgICAgMHgwMDFBdQ0KPiA+ICsjZGVmaW5lIFRYX0RFU0Nf
U1RBUlRfQUREUjAgMHgwMDIwdQ0KPiA+ICsjZGVmaW5lIFRYX0RFU0NfU1RBUlRfQUREUjQgMHgw
MDI0dQ0KPiA+ICsjZGVmaW5lIFRYX0RFU0NfQ09NTUFORCAgICAgMHgwMDI4dQ0KPiA+ICsjZGVm
aW5lIENISVBfQ01EICAgICAgICAgICAgMHgwMDM3dQ0KPiA+ICsjZGVmaW5lIElNUjAgICAgICAg
ICAgICAgICAgMHgwMDM4dQ0KPiA+ICsjZGVmaW5lIElTUjAgICAgICAgICAgICAgICAgMHgwMDND
dQ0KPiA+ICsjZGVmaW5lIElNUjEgICAgICAgICAgICAgICAgMHgwODAwdQ0KPiA+ICsjZGVmaW5l
IElTUjEgICAgICAgICAgICAgICAgMHgwODAydQ0KPiA+ICsjZGVmaW5lIFRYX0NPTkZJR18wICAg
ICAgICAgMHgwMDQwdQ0KPiA+ICsjZGVmaW5lIFJYX0NPTkZJR18wICAgICAgICAgMHgwMDQ0dQ0K
PiA+ICsjZGVmaW5lIFJYX0NPTkZJR18xICAgICAgICAgMHgwMDQ2dQ0KPiA+ICsjZGVmaW5lIEVF
TSAgICAgICAgICAgICAgICAgMHgwMDUwdQ0KPiA+ICsjZGVmaW5lIFRERk5SICAgICAgICAgICAg
ICAgMHgwMDU3dQ0KPiA+ICsjZGVmaW5lIFRQUE9MTCAgICAgICAgICAgICAgMHgwMDkwdQ0KPiA+
ICsjZGVmaW5lIFBEUiAgICAgICAgICAgICAgICAgMHgwMEIwdQ0KPiA+ICsjZGVmaW5lIEZJRk9S
ICAgICAgICAgICAgICAgMHgwMEQzdQ0KPiA+ICsjZGVmaW5lIFBDUFIgICAgICAgICAgICAgICAg
MHgwMEQ4dQ0KPiA+ICsjZGVmaW5lIFJNUyAgICAgICAgICAgICAgICAgMHgwMERBdQ0KPiA+ICsj
ZGVmaW5lIENQTFVTX0NNRCAgICAgICAgICAgMHgwMERBdQ0KPiA+ICsjZGVmaW5lIFEwX1JYX0RF
U0NfQUREUjAgICAgMHgwMEU0dQ0KPiA+ICsjZGVmaW5lIFEwX1JYX0RFU0NfQUREUjQgICAgMHgw
MEU4dQ0KPiA+ICsjZGVmaW5lIFExX1JYX0RFU0NfQUREUjAgICAgMHg0MDAwdQ0KPiA+ICsjZGVm
aW5lIFExX1JYX0RFU0NfQUREUjQgICAgMHg0MDA0dQ0KPiA+ICsjZGVmaW5lIE1UUFMgICAgICAg
ICAgICAgICAgMHgwMEVDdQ0KPiA+ICsjZGVmaW5lIE1JU0MgICAgICAgICAgICAgICAgMHgwMEYy
dQ0KPiA+ICsjZGVmaW5lIFRDVFIwICAgICAgICAgICAgICAgMHgwMDQ4dQ0KPiA+ICsjZGVmaW5l
IFRJTUVPVVQwX0FERFIgICAgICAgMHgwMDU4dQ0KPiA+ICsNCj4gPiArI2RlZmluZSBURlVOX0NU
UkwgICAweDA0MDB1DQo+ID4gKyNkZWZpbmUgVFhfQ09ORklHXzEgMHgyMDNFdQ0KPiA+ICsjZGVm
aW5lIFRPS1NFTCAgICAgIDB4MjA0NnUNCj4gPiArI2RlZmluZSBUWFFDUkRUXzAgICAweDI1MDB1
DQo+ID4gKyNkZWZpbmUgUkZJRk9ORlVMTCAgMHg0NDA2dQ0KPiA+ICsjZGVmaW5lIFZRQ1RSTCAg
ICAgIDB4NDgwMHUNCj4gPiArI2RlZmluZSBJTlRfTUlUSV9UWCAweDBBMDB1DQo+ID4gKyNkZWZp
bmUgSU5UX01JVElfUlggMHgwQTgwdQ0KPiA+ICsNCj4gPiArI2RlZmluZSBWRk1TR0RBVEFfMCAw
eDcxMDB1DQo+ID4gKyNkZWZpbmUgVkZNU0dEQVRBXzIgMHg3MTA0dQ0KPiA+ICsjZGVmaW5lIFBG
TVNHSUNSUkVRIDB4NzE0MHUNCj4gPiArI2RlZmluZSBQRk1TR0lNUiAgICAweDcxNDh1DQo+ID4g
KyNkZWZpbmUgUEZNU0dWRjEgICAgMHg3MjAwdQ0KPiA+ICsNCj4gPiArI2RlZmluZSBWRl9NQUNf
MCAweDcyOTR1DQo+ID4gKyNkZWZpbmUgVkZfTUFDXzIgMHg3Mjk2dQ0KPiA+ICsjZGVmaW5lIFZG
X01BQ180IDB4NzI5OHUNCj4gPiArDQo+ID4gKyNkZWZpbmUgUlhfUENQX1RBQkxFICAgICAweDcy
RDR1DQo+ID4gKyNkZWZpbmUgVkxBTl9FTlRSWV9NRU1fMCAweDcyMzR1DQo+ID4gKyNkZWZpbmUg
VkxBTl9FTlRSWV8wICAgICAweEFDODB1DQo+ID4gKw0KPiA+ICsvKiBSVEFTRV9yZWdpc3Rlcl9j
b250ZW50ICovDQo+ID4gKy8qIEludGVycnVwdFN0YXR1c0JpdHMgMCAqLw0KPiA+ICsjZGVmaW5l
IFRPSzcgICAgIEJJVCgzMCkNCj4gPiArI2RlZmluZSBUT0s2ICAgICBCSVQoMjgpDQo+ID4gKyNk
ZWZpbmUgVE9LNSAgICAgQklUKDI2KQ0KPiA+ICsjZGVmaW5lIFRPSzQgICAgIEJJVCgyNCkNCj4g
PiArI2RlZmluZSBNQlggICAgICBCSVQoMTYpDQo+ID4gKyNkZWZpbmUgVElNRU9VVDAgQklUKDE0
KQ0KPiA+ICsjZGVmaW5lIEZPVlcgICAgIEJJVCg2KQ0KPiA+ICsjZGVmaW5lIFJEVSAgICAgIEJJ
VCg0KQ0KPiA+ICsjZGVmaW5lIFRPSyAgICAgIEJJVCgyKQ0KPiA+ICsjZGVmaW5lIFJPSyAgICAg
IEJJVCgwKQ0KPiA+ICsNCj4gPiArLyogSW50ZXJydXB0U3RhdHVzQml0cyAxfjMgKi8NCj4gPiAr
I2RlZmluZSBRX1RPSyBCSVQoNCkNCj4gPiArI2RlZmluZSBRX1JEVSBCSVQoMSkNCj4gPiArI2Rl
ZmluZSBRX1JPSyBCSVQoMCkNCj4gPiArDQo+ID4gKy8qIENoaXBDbWRSZWdCaXRzICovDQo+ID4g
KyNkZWZpbmUgU1RPUF9SRVEgICAgICBCSVQoNykNCj4gPiArI2RlZmluZSBTVE9QX1JFUV9ET05F
IEJJVCg2KQ0KPiA+ICsjZGVmaW5lIFJFICAgICAgICAgICAgQklUKDMpDQo+ID4gKyNkZWZpbmUg
VEUgICAgICAgICAgICBCSVQoMikNCj4gPiArDQo+ID4gKy8qIENmZzkzNDZCaXRzICovDQo+ID4g
KyNkZWZpbmUgRUVNX1VubG9jayAweEMwdQ0KPiA+ICsNCj4gPiArLyogUmVjZWl2ZSBDb25maWd1
cmF0aW9uIDAgKi8NCj4gPiArI2RlZmluZSBSWF9TSU5HTEVfRkVUQ0ggIEJJVCgxNCkNCj4gPiAr
I2RlZmluZSBSWF9TSU5HTEVfVEFHICAgIEJJVCgxMykNCj4gPiArI2RlZmluZSBSWF9NWF9ETUFf
TUFTSyAgIDB4Nw0KPiA+ICsjZGVmaW5lIFJYX01YX0RNQV9TSElGVCAgOHUNCj4gPiArI2RlZmlu
ZSBBQ1BUX0ZMT1cgICAgICAgIEJJVCg3KQ0KPiA+ICsjZGVmaW5lIEFDQ0VQVF9FUlIgICAgICAg
QklUKDUpDQo+ID4gKyNkZWZpbmUgQUNDRVBUX1JVTlQgICAgICBCSVQoNCkNCj4gPiArI2RlZmlu
ZSBBQ0NFUFRfQlJPQURDQVNUIEJJVCgzKQ0KPiA+ICsjZGVmaW5lIEFDQ0VQVF9NVUxUSUNBU1Qg
QklUKDIpDQo+ID4gKyNkZWZpbmUgQUNDRVBUX01ZUEhZUyAgICBCSVQoMSkNCj4gPiArI2RlZmlu
ZSBBQ0NFUFRfQUxMUEhZUyAgIEJJVCgwKQ0KPiA+ICsjZGVmaW5lIEFDQ0VQVF9NQVNLDQo+IFwN
Cj4gPiArICAgICAoQUNQVF9GTE9XIHwgQUNDRVBUX0VSUiB8IEFDQ0VQVF9SVU5UIHwgQUNDRVBU
X0JST0FEQ0FTVA0KPiB8IEFDQ0VQVF9NVUxUSUNBU1QgXA0KPiA+ICsgICAgICB8IEFDQ0VQVF9N
WVBIWVMgfCBBQ0NFUFRfQUxMUEhZUykNCj4gPiArDQo+ID4gKy8qIFJlY2VpdmUgQ29uZmlndXJh
dGlvbiAxICovDQo+ID4gKyNkZWZpbmUgUlhfTUFYX0ZFVENIX0RFU0NfTUFTSyAgMHgxRg0KPiA+
ICsjZGVmaW5lIFJYX01BWF9GRVRDSF9ERVNDX1NISUZUIDExdQ0KPiA+ICsjZGVmaW5lIFJYX05F
V19ERVNDX0ZPUk1BVF9FTiAgIEJJVCg4KQ0KPiA+ICsjZGVmaW5lIE9VVEVSX1ZMQU5fREVUQUdf
RU4gICAgIEJJVCg3KQ0KPiA+ICsjZGVmaW5lIElOTkVSX1ZMQU5fREVUQUdfRU4gICAgIEJJVCg2
KQ0KPiA+ICsjZGVmaW5lIFBDSUVfTkVXX0ZMT1cgICAgICAgICAgIEJJVCgyKQ0KPiA+ICsjZGVm
aW5lIFBDSUVfUkVMT0FEX0VuICAgICAgICAgIEJJVCgwKQ0KPiA+ICsNCj4gPiArLyogVHhDb25m
aWdCaXRzICovDQo+ID4gKyNkZWZpbmUgVFhfSU5URVJfRlJBTUVfR0FQX01BU0sgIDB4M3UNCj4g
PiArI2RlZmluZSBUWF9JTlRFUl9GUkFNRV9HQVBfU0hJRlQgMjR1DQo+ID4gKyNkZWZpbmUgVFhf
RE1BX01BU0sgICAgICAgICAgICAgIDB4N3UNCj4gPiArLyogRE1BIGJ1cnN0IHZhbHVlICgwLTcp
IGlzIHNoaWZ0IHRoaXMgbWFueSBiaXRzICovDQo+ID4gKyNkZWZpbmUgVFhfRE1BX1NISUZUIDh1
DQo+ID4gKw0KPiA+ICsvKiBURnVuQ3RybCAqLw0KPiA+ICsjZGVmaW5lIFRYX05FV19ERVNDX0ZP
Uk1BVF9FTiBCSVQoMCkNCj4gPiArDQo+ID4gKy8qIFR4RGVzY0NvbW1hbmQgKi8NCj4gPiArI2Rl
ZmluZSBUWF9ERVNDX0NNRF9DUyBCSVQoMTUpDQo+ID4gKyNkZWZpbmUgVFhfREVTQ19DTURfV0Ug
QklUKDE0KQ0KPiA+ICsNCj4gPiArLyogQ1BsdXNDbWQgKi8NCj4gPiArI2RlZmluZSBGT1JDRV9S
WEZMT1dfRU4gQklUKDExKQ0KPiA+ICsjZGVmaW5lIEZPUkNFX1RYRkxPV19FTiBCSVQoMTApDQo+
ID4gKyNkZWZpbmUgUlhfQ0hLU1VNICAgICAgIEJJVCg1KQ0KPiA+ICsNCj4gPiArLyogTUlTQyAq
Lw0KPiA+ICsjZGVmaW5lIFJYX0RWX0dBVEVfRU4gQklUKDMpDQo+ID4gKw0KPiA+ICsvKiBSZXNl
dENvdW50ZXJDb21tYW5kICovDQo+ID4gKyNkZWZpbmUgQ09VTlRFUl9SRVNFVCBCSVQoMCkNCj4g
PiArLyogRHVtcENvdW50ZXJDb21tYW5kICovDQo+ID4gKyNkZWZpbmUgQ09VTlRFUl9EVU1QIEJJ
VCgzKQ0KPiA+ICsNCj4gPiArLyogT0NQIGFjY2VzcyAqLw0KPiA+ICsjZGVmaW5lIE9DUFJfV1JJ
VEUgICAgICAgICAgMHg4MDAwMDAwMHUNCj4gPiArI2RlZmluZSBPQ1BSX0FERFJfUkVHX1NISUZU
IDE2dQ0KPiA+ICsNCj4gPiArLyogTUNVIENvbW1hbmQgKi8NCj4gPiArI2RlZmluZSBUWF9GSUZP
X0VNUFRZIEJJVCg1KQ0KPiA+ICsjZGVmaW5lIFJYX0ZJRk9fRU1QVFkgQklUKDQpDQo+ID4gKw0K
PiA+ICsvKiBGdW5jdGlvbiBDb250cm9sIFJlZ2lzdGVyICovDQo+ID4gKyNkZWZpbmUgRkNSX1RY
X0xPT1BCQUNLX0VOIEJJVCg5KQ0KPiA+ICsjZGVmaW5lIEZDUl9URSAgICAgICAgICAgICBCSVQo
OCkNCj4gPiArI2RlZmluZSBGQ1JfUlhRX01BU0sgICAgICAgMHgzdQ0KPiA+ICsjZGVmaW5lIEZD
Ul9SWFFfU0hJRlQgICAgICA0dQ0KPiA+ICsjZGVmaW5lIEZDUl9NQVJfRU4gICAgICAgICBCSVQo
MykNCj4gPiArI2RlZmluZSBGQ1JfQkFSX0VOICAgICAgICAgQklUKDIpDQo+ID4gKyNkZWZpbmUg
RkNSX1ZMQU5fRlRSX0VOICAgIEJJVCgxKQ0KPiA+ICsjZGVmaW5lIEZDUl9SRSAgICAgICAgICAg
ICBCSVQoMCkNCj4gPiArDQo+ID4gKy8qIExvb3BiYWNrIENvbnRyb2wgKi8NCj4gPiArI2RlZmlu
ZSBMQktfQVRMRCBCSVQoMSkNCj4gPiArI2RlZmluZSBMQktfQ0xSICBCSVQoMCkNCj4gPiArDQo+
ID4gKy8qIFBDUCBSZWdpc3RlciAqLw0KPiA+ICsjZGVmaW5lIFBDUFJfVkxBTl9GVFJfRU4gQklU
KDYpDQo+ID4gKw0KPiA+ICsvKlJUQVNFX3JlZ2lzdGVyX2NvbnRlbnQgRU5EICovDQo+ID4gKw0K
PiA+ICsvKiBfRGVzY1N0YXR1c0JpdCAqLw0KPiA+ICsjZGVmaW5lIERFU0NfT1dOIEJJVCgzMSkg
LyogRGVzY3JpcHRvciBpcyBvd25lZCBieSBOSUMgKi8NCj4gPiArI2RlZmluZSBSSU5HX0VORCBC
SVQoMzApIC8qIEVuZCBvZiBkZXNjcmlwdG9yIHJpbmcgKi8NCj4gPiArDQo+ID4gKy8qIFR4IHBy
aXZhdGUgKi8NCj4gPiArLyotLS0tLS0gb2Zmc2V0IDAgb2YgdHggZGVzY3JpcHRvciAtLS0tLS0q
Lw0KPiA+ICsjZGVmaW5lIFRYX0ZJUlNUX0ZSQUcgQklUKDI5KSAvKiBUeCBGaXJzdCBzZWdtZW50
IG9mIGEgcGFja2V0ICovDQo+ID4gKyNkZWZpbmUgVFhfTEFTVF9GUkFHICBCSVQoMjgpIC8qIFR4
IEZpbmFsIHNlZ21lbnQgb2YgYSBwYWNrZXQgKi8NCj4gPiArI2RlZmluZSBHSUFOVF9TRU5EX1Y0
IEJJVCgyNikgLyogVENQIEdpYW50IFNlbmQgT2ZmbG9hZCBWNCAoR1NPdjQpICovDQo+ID4gKyNk
ZWZpbmUgR0lBTlRfU0VORF9WNiBCSVQoMjUpIC8qIFRDUCBHaWFudCBTZW5kIE9mZmxvYWQgVjYg
KEdTT3Y2KSAqLw0KPiA+ICsjZGVmaW5lIFRYX1ZMQU5fVEFHICAgQklUKDE3KSAvKiBBZGQgVkxB
TiB0YWcgKi8NCj4gPiArDQo+ID4gKy8qLS0tLS0tIG9mZnNldCA0IG9mIHR4IGRlc2NyaXB0b3Ig
LS0tLS0tKi8NCj4gPiArI2RlZmluZSBUWF9VRFBDU19DIEJJVCgzMSkgLyogQ2FsY3VsYXRlIFVE
UC9JUCBjaGVja3N1bSAqLw0KPiA+ICsjZGVmaW5lIFRYX1RDUENTX0MgQklUKDMwKSAvKiBDYWxj
dWxhdGUgVENQL0lQIGNoZWNrc3VtICovDQo+ID4gKyNkZWZpbmUgVFhfSVBDU19DICBCSVQoMjkp
IC8qIENhbGN1bGF0ZSBJUCBjaGVja3N1bSAqLw0KPiA+ICsjZGVmaW5lIFRYX0lQVjZGX0MgQklU
KDI4KSAvKiBJbmRpY2F0ZSBpdCBpcyBhbiBJUHY2IHBhY2tldCAqLw0KPiA+ICsNCj4gPiArLyog
UnggcHJpdmF0ZSAqLw0KPiA+ICsvKi0tLS0tLSBvZmZzZXQgMjggb2YgcnggZGVzY3JpcHRvciAt
LS0tLS0qLw0KPiA+ICsjZGVmaW5lIFJYX0ZJUlNUX0ZSQUcgQklUKDI1KSAvKiBSeCBGaXJzdCBz
ZWdtZW50IG9mIGEgcGFja2V0ICovDQo+ID4gKyNkZWZpbmUgUlhfTEFTVF9GUkFHICBCSVQoMjQp
IC8qIFJ4IEZpbmFsIHNlZ21lbnQgb2YgYSBwYWNrZXQgKi8NCj4gPiArI2RlZmluZSBSWF9SRVMg
ICAgICAgIEJJVCgyMCkNCj4gPiArI2RlZmluZSBSWF9SVU5UICAgICAgIEJJVCgxOSkNCj4gPiAr
I2RlZmluZSBSWF9SV1QgICAgICAgIEJJVCgxOCkNCj4gPiArI2RlZmluZSBSWF9DUkMgICAgICAg
IEJJVCgxNikNCj4gPiArDQo+ID4gKyNkZWZpbmUgUlhfVjZGICAgICAgICAgICBCSVQoMzEpDQo+
ID4gKyNkZWZpbmUgUlhfVjRGICAgICAgICAgICBCSVQoMzApDQo+ID4gKyNkZWZpbmUgUlhfVURQ
VCAgICAgICAgICBCSVQoMjkpDQo+ID4gKyNkZWZpbmUgUlhfVENQVCAgICAgICAgICBCSVQoMjgp
DQo+ID4gKyNkZWZpbmUgUlhfSVBGICAgICAgICAgICBCSVQoMjYpIC8qIElQIGNoZWNrc3VtIGZh
aWxlZCAqLw0KPiA+ICsjZGVmaW5lIFJYX1VEUEYgICAgICAgICAgQklUKDI1KSAvKiBVRFAvSVAg
Y2hlY2tzdW0gZmFpbGVkICovDQo+ID4gKyNkZWZpbmUgUlhfVENQRiAgICAgICAgICBCSVQoMjQp
IC8qIFRDUC9JUCBjaGVja3N1bSBmYWlsZWQgKi8NCj4gPiArI2RlZmluZSBSWF9MQktfRklGT19G
VUxMIEJJVCgxNykgLyogTG9vcGJhY2sgRklGTyBGdWxsICovDQo+ID4gKyNkZWZpbmUgUlhfVkxB
Tl9UQUcgICAgICBCSVQoMTYpIC8qIFZMQU4gdGFnIGF2YWlsYWJsZSAqLw0KPiA+ICsvKiBfRGVz
Y1N0YXR1c0JpdCBFTkQgKi8NCj4gPiArDQo+ID4gKy8qIHN3X2ZsYWdfY29udGVudCAqLw0KPiA+
ICsjZGVmaW5lIFNXRl9TUklPVl9FTkFCTEVEIEJJVCgwKQ0KPiA+ICsjZGVmaW5lIFNXRl9NU0lf
RU5BQkxFRCAgIEJJVCgxKQ0KPiA+ICsjZGVmaW5lIFNXRl9NU0lYX0VOQUJMRUQgIEJJVCgyKQ0K
PiA+ICsNCj4gPiArI2RlZmluZSBSU1ZEX01BU0sgMHgzRkZGQzAwMHUNCj4gPiArDQo+ID4gK3R5
cGVkZWYgc3RydWN0IHsNCj4gPiArICAgICB1MzIgb3B0czE7DQo+IE1vc3QgbGlrZWx5IHRoaXMg
c2hvdWxkIGJlIF9fbGUzMi4NCj4gU2ltaWxhciBmb3IgdGhlIG90aGVyIGRlc2NyaXB0b3IgZmll
bGRzLg0KPiANCj4gPiArICAgICB1MzIgb3B0czI7DQo+ID4gKyAgICAgdTY0IGFkZHI7DQo+ID4g
KyAgICAgdTMyIG9wdHMzOw0KPiA+ICsgICAgIHUzMiByZXNlcnZlZDE7DQo+ID4gKyAgICAgdTMy
IHJlc2VydmVkMjsNCj4gPiArICAgICB1MzIgcmVzZXJ2ZWQzOw0KPiA+ICt9IHR4X2Rlc2M7DQo+
ID4gKw0KPiA+ICt0eXBlZGVmIHVuaW9uIHsNCj4gPiArICAgICBzdHJ1Y3Qgew0KPiA+ICsgICAg
ICAgICAgICAgdTY0IGhlYWRlcl9idWZfYWRkcjsNCj4gPiArICAgICAgICAgICAgIHUzMiByZXNl
cnZlZDE7DQo+ID4gKyAgICAgICAgICAgICB1MzIgb3B0c19oZWFkZXJfbGVuOw0KPiA+ICsgICAg
ICAgICAgICAgdTY0IGFkZHI7DQo+ID4gKyAgICAgICAgICAgICB1MzIgcmVzZXJ2ZWQyOw0KPiA+
ICsgICAgICAgICAgICAgdTMyIG9wdHMxOw0KPiA+ICsgICAgIH0gZGVzY19jbWQ7DQo+ID4gKw0K
PiA+ICsgICAgIHN0cnVjdCB7DQo+ID4gKyAgICAgICAgICAgICB1MzIgcmVzZXJ2ZWQxOw0KPiA+
ICsgICAgICAgICAgICAgdTMyIHJlc2VydmVkMjsNCj4gPiArICAgICAgICAgICAgIHUzMiByc3M7
DQo+ID4gKyAgICAgICAgICAgICB1MzIgb3B0czQ7DQo+ID4gKyAgICAgICAgICAgICB1MzIgcmVz
ZXJ2ZWQzOw0KPiA+ICsgICAgICAgICAgICAgdTMyIG9wdHMzOw0KPiA+ICsgICAgICAgICAgICAg
dTMyIG9wdHMyOw0KPiA+ICsgICAgICAgICAgICAgdTMyIG9wdHMxOw0KPiA+ICsgICAgIH0gZGVz
Y19zdGF0dXM7DQo+ID4gKw0KPiA+ICsgICAgIHN0cnVjdCB7DQo+ID4gKyAgICAgICAgICAgICB1
MzIgcmVzZXJ2ZWQxOw0KPiA+ICsgICAgICAgICAgICAgdTMyIHJlc2VydmVkMjsNCj4gPiArICAg
ICAgICAgICAgIHUzMiByZXNlcnZlZDM7DQo+ID4gKyAgICAgICAgICAgICB1MzIgcmVzZXJ2ZWQ0
Ow0KPiA+ICsgICAgICAgICAgICAgdTMyIHRpbWVfc3RhbXBfMF8zMTsNCj4gPiArICAgICAgICAg
ICAgIHUzMiB0aW1lX3N0YW1wXzMyXzYzOw0KPiA+ICsgICAgICAgICAgICAgdTMyIHRpbWVfc3Rh
bXBfNjRfNzk7DQo+ID4gKyAgICAgICAgICAgICB1MzIgb3B0czE7DQo+ID4gKyAgICAgfSBkZXNj
X3B0cDsNCj4gPiArDQo+ID4gKyAgICAgc3RydWN0IHsNCj4gPiArICAgICAgICAgICAgIHUzMiBy
c3ZkMTsNCj4gPiArICAgICAgICAgICAgIHUzMiByc3ZkMjsNCj4gPiArICAgICAgICAgICAgIHUz
MiByc3ZkMzsNCj4gPiArICAgICAgICAgICAgIHUzMiByc3ZkNDsNCj4gPiArICAgICAgICAgICAg
IHUzMiByc3ZkNTsNCj4gPiArICAgICAgICAgICAgIHUzMiByc3ZkNjsNCj4gPiArICAgICAgICAg
ICAgIHUzMiBvcHRzMjsNCj4gPiArICAgICAgICAgICAgIHUzMiBvcHRzMTsNCj4gPiArICAgICB9
IGRlc2NfcnNjOw0KPiA+ICt9IHJ4X2Rlc2M7DQo+ID4gKw0KPiA+ICsjZGVmaW5lIENNRF9EQkdf
UkVBRCAgICAgICAgMXUNCj4gPiArI2RlZmluZSBDTURfREJHX1dSSVRFICAgICAgIDJ1DQo+ID4g
KyNkZWZpbmUgQ01EX1JFR19SRUFEMTYgICAgICAzdQ0KPiA+ICsjZGVmaW5lIENNRF9SRUdfV1JJ
VEUxNiAgICAgNHUNCj4gPiArI2RlZmluZSBDTURfUkVHX1JFQUQzMiAgICAgIDV1DQo+ID4gKyNk
ZWZpbmUgQ01EX1JFR19XUklURTMyICAgICA2dQ0KPiA+ICsjZGVmaW5lIENNRF9HRVRfUlhRT1Mg
ICAgICAgN3UNCj4gPiArI2RlZmluZSBDTURfU0VUX1JYUU9TICAgICAgIDh1DQo+ID4gKyNkZWZp
bmUgQ01EX0dFVF9USU1TSUcgICAgICA5dQ0KPiA+ICsjZGVmaW5lIENNRF9TRVRfVElNU0lHICAg
ICAgMTB1DQo+ID4gKyNkZWZpbmUgU0lPX1BSSVZfUlRLX1JFRyAgICAoU0lPQ0RFVlBSSVZBVEUg
KyA2KQ0KPiA+ICsjZGVmaW5lIFNJT19QUklWX1JUS19SWFFPUyAgKFNJT0NERVZQUklWQVRFICsg
NykNCj4gPiArI2RlZmluZSBTSU9fVElNRU9VVF9TSUdfU0VUIChTSU9DREVWUFJJVkFURSArIDgp
DQo+ID4gKyNkZWZpbmUgU0lPX1BSSVZfUlRLX1BUTSAgICAoU0lPQ0RFVlBSSVZBVEUgKyA5KQ0K
PiA+ICsjZGVmaW5lIFNJT19QUklWX1JUS19JTkZPICAgKFNJT0NERVZQUklWQVRFICsgMTApDQo+
ID4gKyNkZWZpbmUgVElNRU9VVF9JTklUICAgICAgICAwDQo+ID4gKyNkZWZpbmUgVElNRU9VVF9F
UlJPUiAgICAgICA5OQ0KPiA+ICsjZGVmaW5lIERXT1JEX01PRCAgICAgICAgICAgMTYNCj4gPiAr
DQo+ID4gK3N0cnVjdCBydGFzZV9wdG1fY21kX3Qgew0KPiA+ICsgICAgIC8qIGRpc2FibGU6MCwg
ZW5hYmxlOjEgKi8NCj4gPiArICAgICB1OCBlbmFibGU7DQo+ID4gKyAgICAgdTggdHlwZTsNCj4g
PiArICAgICB1OCBiaXRzOw0KPiA+ICsgICAgIHUzMiByZWdfYWRkcjsNCj4gPiArICAgICB1MzIg
cHRtX2FkZHI7DQo+ID4gKyAgICAgdTMyIHJlZ192YWx1ZTsNCj4gPiArICAgICB1NjQgcHRwX3Nl
Y29uZDsNCj4gPiArICAgICB1MzIgcHRwX25hbm9fc2Vjb25kOw0KPiA+ICsgICAgIHU2NCBwdG1f
dGltZTsNCj4gPiArfTsNCj4gPiArDQo+ID4gK3N0cnVjdCByZWdfcncgew0KPiA+ICsgICAgIHUx
NiBjbWQ7DQo+ID4gKyAgICAgdTE2IGFkZHI7DQo+ID4gKyAgICAgdTMyIHZhbDsNCj4gPiArfTsN
Cj4gPiArDQo+ID4gK3N0cnVjdCBydGtfcW9zIHsNCj4gPiArICAgICB1MTYgY21kOw0KPiA+ICsg
ICAgIHU4IHBjcDsNCj4gPiArICAgICB1OCB0YzsNCj4gPiArfTsNCj4gPiArDQo+ID4gK3N0cnVj
dCBydGtfdGltZW91dF9zaWcgew0KPiA+ICsgICAgIHUxNiBjbWQ7DQo+ID4gKyAgICAgdTE2IHN0
YXRlOw0KPiA+ICt9Ow0KPiA+ICsNCj4gPiArI2lmZGVmIENPTkZJR19TUklPVg0KPiA+ICtzdHJ1
Y3QgdmZfaW5mbyB7DQo+ID4gKyAgICAgc3RydWN0IHBjaV9kZXYgKnZmX3BjaV9kZXY7DQo+ID4g
KyAgICAgdTggc3RhdHVzOw0KPiA+ICsgICAgIHU4IHZmX21hY1tFVEhfQUxFTl07DQo+ID4gKyAg
ICAgdTMyIG1jX2ZpbHRlclsyXTsNCj4gPiArfTsNCj4gPiArI2VuZGlmDQo+ID4gKw0KPiA+ICsj
ZGVmaW5lIE5VTV9ERVNDICAgICAgICAgICAgICAgIDEwMjR1DQo+ID4gKyNkZWZpbmUgUlRBU0Vf
VFhfUklOR19ERVNDX1NJWkUgKE5VTV9ERVNDICogc2l6ZW9mKHR4X2Rlc2MpKQ0KPiA+ICsjZGVm
aW5lIFJUQVNFX1JYX1JJTkdfREVTQ19TSVpFIChOVU1fREVTQyAqIHNpemVvZihyeF9kZXNjKSkN
Cj4gPiArI2RlZmluZSBWTEFOX0VOVFJZX0NBUkVCSVQgICAgICAweEYwMDAwMDAwdQ0KPiA+ICsN
Cj4gPiArLyogdHhxb3MgaGFyZHdhcmUgZGVmaW5pdGlvbnMgKi8NCj4gPiArI2RlZmluZSBSVEFT
RV8xVF9DTE9DSyAgICAgICAgICAgIDY0dQ0KPiA+ICsjZGVmaW5lIFJUQVNFXzFUX1BPV0VSICAg
ICAgICAgICAgMTAwMDAwMDB1DQo+ID4gKyNkZWZpbmUgUlRBU0VfSURMRVNMT1BFX0lOVF9TSElG
VCAyNXUNCj4gPiArDQo+ID4gK3N0cnVjdCBydGFzZV9pbnRfdmVjdG9yIHsNCj4gPiArICAgICBz
dHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHA7DQo+ID4gKyAgICAgdW5zaWduZWQgaW50IGlycTsNCj4g
PiArICAgICB1OCBzdGF0dXM7DQo+ID4gKyAgICAgdTggbmFtZVsyMF07DQo+ID4gKyAgICAgdTE2
IGluZGV4Ow0KPiA+ICsgICAgIHUxNiBpbXJfYWRkcjsNCj4gPiArICAgICB1MTYgaXNyX2FkZHI7
DQo+ID4gKyAgICAgdTMyIGltcjsNCj4gPiArICAgICBzdHJ1Y3QgbGlzdF9oZWFkIHJpbmdfbGlz
dDsNCj4gPiArICAgICBzdHJ1Y3QgbmFwaV9zdHJ1Y3QgbmFwaTsNCj4gPiArICAgICBpbnQgd2Vp
Z2h0Ow0KPiA+ICsgICAgIGludCAoKnBvbGwpKHN0cnVjdCBuYXBpX3N0cnVjdCAqbmFwaSwgaW50
IGJ1ZGdldCk7DQo+ID4gK307DQo+ID4gKw0KPiA+ICtzdHJ1Y3QgcnRhc2VfcmluZyB7DQo+ID4g
KyAgICAgc3RydWN0IHJ0YXNlX2ludF92ZWN0b3IgKml2ZWM7DQo+ID4gKyAgICAgdm9pZCAqZGVz
YzsNCj4gPiArICAgICBkbWFfYWRkcl90IHBoeV9hZGRyOw0KPiA+ICsgICAgIHUzMiBjdXJfaWR4
Ow0KPiA+ICsgICAgIHUzMiBkaXJ0eV9pZHg7DQo+ID4gKyAgICAgdTMyIHByaXZfZGlydHlfaWR4
Ow0KPiA+ICsgICAgIHU4IGR1cGxpY2F0ZV9kaXJ0eV9jb3VudDsNCj4gPiArICAgICB1MTYgaW5k
ZXg7DQo+ID4gKw0KPiA+ICsgICAgIHN0cnVjdCBza19idWZmICpza2J1ZmZbTlVNX0RFU0NdOw0K
PiA+ICsgICAgIHVuaW9uIHsNCj4gPiArICAgICAgICAgICAgIHUzMiBsZW5bTlVNX0RFU0NdOw0K
PiA+ICsgICAgICAgICAgICAgZG1hX2FkZHJfdCBkYXRhX3BoeV9hZGRyW05VTV9ERVNDXTsNCj4g
PiArICAgICB9IG1pczsNCj4gPiArDQo+ID4gKyAgICAgc3RydWN0IGxpc3RfaGVhZCByaW5nX2Vu
dHJ5Ow0KPiA+ICsgICAgIHMzMiAoKnJpbmdfaGFuZGxlcikoc3RydWN0IHJ0YXNlX3JpbmcgKnJp
bmcsIHMzMiBidWRnZXQpOw0KPiA+ICt9Ow0KPiA+ICsNCj4gPiArc3RydWN0IHJ0YXNlX3R4cW9z
IHsNCj4gPiArICAgICBzMzIgaGljcmVkaXQ7DQo+ID4gKyAgICAgczMyIGxvY3JlZGl0Ow0KPiA+
ICsgICAgIHMzMiBpZGxlc2xvcGU7DQo+ID4gKyAgICAgczMyIHNlbmRzbG9wZTsNCj4gPiArfTsN
Cj4gPiArDQo+ID4gK3N0cnVjdCBydGFzZV9wcml2YXRlIHsNCj4gPiArICAgICB2b2lkIF9faW9t
ZW0gKm1taW9fYWRkcjsgLyogbWVtb3J5IG1hcCBwaHlzaWNhbCBhZGRyZXNzICovDQo+ID4gKw0K
PiA+ICsjaWZkZWYgUkRCR19NU0lYDQo+ID4gKyAgICAgdTggX19pb21lbSAqbXNpeF9hZGRyOw0K
PiA+ICsjZW5kaWYNCj4gPiArDQo+ID4gKyAgICAgdTMyIHN3X2ZsYWc7DQo+ID4gKyAgICAgc3Ry
dWN0IHdvcmtfc3RydWN0IG1zZ193b3JrOw0KPiA+ICsgICAgIHN0cnVjdCB3b3JrX3N0cnVjdCB3
YXRjaGRvZ193b3JrOw0KPiA+ICsgICAgIHUzMiBtY19maWx0ZXJbMl07DQo+ID4gKw0KPiA+ICsg
ICAgIHN0cnVjdCBwY2lfZGV2ICpwZGV2OyAvKiBJbmRleCBvZiBQQ0kgZGV2aWNlICovDQo+ID4g
KyAgICAgc3RydWN0IG5ldF9kZXZpY2UgKmRldjsNCj4gPiArICAgICBzcGlubG9ja190IGxvY2s7
ICAgICAgLyogc3BpbiBsb2NrIGZsYWcgKi8NCj4gPiArICAgICB1MzIgbXNnX2VuYWJsZTsNCj4g
PiArICAgICB1MTYgbWF4X2p1bWJvX2ZyYW1lX3NpemU7DQo+ID4gKyAgICAgdTggbWNmZzsNCj4g
PiArICAgICB1MzIgcnhfYnVmX3N6Ow0KPiA+ICsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2Vfcmlu
ZyB0eF9yaW5nW05VTV9UWF9RVUVVRV07DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX3R4cW9zIHR4
X3Fvc1tOVU1fVFhfUVVFVUVdOw0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9yaW5nIHJ4X3Jpbmdb
TlVNX1JYX1FVRVVFXTsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfY291bnRlcnMgKnRhbGx5X3Zh
ZGRyOw0KPiA+ICsgICAgIGRtYV9hZGRyX3QgdGFsbHlfcGFkZHI7DQo+ID4gKw0KPiA+ICsgICAg
IHUzMiB2bGFuX2ZpbHRlcl9jdHJsOw0KPiA+ICsgICAgIHUxNiB2bGFuX2ZpbHRlcl92aWRbVkxB
Tl9GSUxURVJfRU5UUllfTlVNXTsNCj4gPiArDQo+ID4gKyAgICAgc3RydWN0IGRlbGF5ZWRfd29y
ayB0YXNrOw0KPiA+ICsgICAgIHU4IGh3X2ljX3Zlcl91bmtub3duOw0KPiA+ICsgICAgIHU4IHJh
bmRvbV9tYWM7DQo+ID4gKyAgICAgdTggb3JnX21hY19hZGRyW01BQ19BRERSX0xFTl07DQo+ID4g
Kw0KPiA+ICsjaWZkZWYgRU5BQkxFX1JUQVNFX1BST0NGUw0KPiA+ICsgICAgIC8qIFByb2NmcyBz
dXBwb3J0ICovDQo+ID4gKyAgICAgc3RydWN0IHByb2NfZGlyX2VudHJ5ICpwcm9jX2RpcjsNCj4g
PiArI2VuZGlmDQo+ID4gKyNpZmRlZiBDT05GSUdfU1JJT1YNCj4gPiArICAgICBzdHJ1Y3QgdmZf
aW5mbyAqdmZfaW5mbzsNCj4gPiArICAgICB1MTYgbnVtX3ZmczsNCj4gPiArICAgICB1MTYgdG90
YWxfdmZzOw0KPiA+ICsjZW5kaWYNCj4gPiArICAgICBzdHJ1Y3QgbXNpeF9lbnRyeSBtc2l4X2Vu
dHJ5W05VTV9NU0lYXTsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfaW50X3ZlY3RvciBpbnRfdmVj
dG9yW05VTV9NU0lYXTsNCj4gPiArDQo+ID4gKyAgICAgdTE2IHR4X3F1ZXVlX2N0cmw7DQo+ID4g
KyAgICAgdTE2IGZ1bmNfdHhfcXVldWVfbnVtOw0KPiA+ICsgICAgIHUxNiBmdW5jX3J4X3F1ZXVl
X251bTsNCj4gPiArICAgICB1MTYgaW50X251bXM7DQo+ID4gKyAgICAgdTE2IHR4X2ludF9taXQ7
DQo+ID4gKyAgICAgdTE2IHJ4X2ludF9taXQ7DQo+ID4gKw0KPiA+ICsgICAgIC8qIHRpbWVvdXQg
c3RhdGUgKi8NCj4gPiArICAgICB1MTYgdGltZW91dF9zdGF0ZTsNCj4gPiArDQo+ID4gKyAgICAg
LyogcHRtICovDQo+ID4gKyAgICAgdTggcHRtX3N1cHBvcnQ7DQo+ID4gK307DQo+ID4gKw0KPiA+
ICsvKiBtY2ZnICovDQo+ID4gKyNkZWZpbmUgQ0ZHX01FVEhPRF8xICAgICAgICgwdSkNCj4gPiAr
I2RlZmluZSBDRkdfTUVUSE9EX0RFRkFVTFQgKDF1KQ0KPiA+ICsNCj4gPiArI2RlZmluZSBMU09f
NjRLIDY0MDAwDQo+ID4gKw0KPiA+ICsjZGVmaW5lIE5JQ19NSU5fUEhZU19CVUZfQ09VTlQgICAg
ICAoMikNCj4gPiArI2RlZmluZSBOSUNfTUFYX1BIWVNfQlVGX0NPVU5UX0xTTzIgKDE2ICogNCkN
Cj4gPiArDQo+ID4gKyNkZWZpbmUgR1RUQ1BIT19TSElGVCAxOA0KPiA+ICsNCj4gPiArI2RlZmlu
ZSBUQ1BIT19TSElGVCAxOHUNCj4gPiArI2RlZmluZSBUQ1BIT19NQVggICAweDNGRnUNCj4gPiAr
DQo+ID4gKyNkZWZpbmUgTVNTX01BWCAweDA3RkZ1IC8qIE1TUyB2YWx1ZSAqLw0KPiA+ICsNCj4g
PiArdm9pZCBydGFzZV9od19yZXNldChjb25zdCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KTsNCj4g
PiArdm9pZCBydGFzZV90eF9jbGVhcihzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHApOw0KPiA+ICt2
b2lkIHJ0YXNlX3J4X2NsZWFyKHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCk7DQo+ID4gK3MzMiBy
dGFzZV9pbml0X3JpbmcoY29uc3Qgc3RydWN0IG5ldF9kZXZpY2UgKmRldik7DQo+ID4gK3ZvaWQg
cnRhc2VfaHdfc3RhcnQoY29uc3Qgc3RydWN0IG5ldF9kZXZpY2UgKmRldik7DQo+ID4gK3ZvaWQg
cnRhc2VfaHdfc2V0X3J4X3BhY2tldF9maWx0ZXIoc3RydWN0IG5ldF9kZXZpY2UgKmRldik7DQo+
ID4gK3ZvaWQgcnRhc2VfZnVuY19lbmFibGUoY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRw
KTsNCj4gPiArdm9pZCBydGFzZV9mdW5jX2Rpc2FibGUoY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZh
dGUgKnRwKTsNCj4gPiArDQo+ID4gKyNlbmRpZiAvKiBSVEFTRV9IXyAqLw0KPiA+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9yZWFsdGVrL3J0YXNlL3J0YXNlX21haW4uYw0KPiBi
L2RyaXZlcnMvbmV0L2V0aGVybmV0L3JlYWx0ZWsvcnRhc2UvcnRhc2VfbWFpbi5jDQo+ID4gbmV3
IGZpbGUgbW9kZSAxMDA2NDQNCj4gPiBpbmRleCAwMDAwMDAwMDAwMDAuLjk2NzQ0YmQ3ZjZhYw0K
PiA+IC0tLSAvZGV2L251bGwNCj4gPiArKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9yZWFsdGVr
L3J0YXNlL3J0YXNlX21haW4uYw0KPiA+IEBAIC0wLDAgKzEsNDc5NyBAQA0KPiA+ICsvLyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KPiA+ICsvKg0KPiA+ICsgKiAgcnRhc2UgaXMg
dGhlIExpbnV4IGRldmljZSBkcml2ZXIgcmVsZWFzZWQgZm9yIFJlYWx0ZWsgQXV0b21vdGl2ZSBT
d2l0Y2gNCj4gPiArICogIGNvbnRyb2xsZXJzIHdpdGggUENJLUV4cHJlc3MgaW50ZXJmYWNlLg0K
PiA+ICsgKg0KPiA+ICsgKiAgQ29weXJpZ2h0KGMpIDIwMjMgUmVhbHRlayBTZW1pY29uZHVjdG9y
IENvcnAuIEFsbCByaWdodHMgcmVzZXJ2ZWQuDQo+ID4gKyAqDQo+ID4gKyAqICBBdXRob3I6DQo+
ID4gKyAqICBSZWFsdGVrIEFSRCBzb2Z0d2FyZSB0ZWFtDQo+ID4gKyAqICBOby4gMiwgSW5ub3Zh
dGlvbiBSb2FkIElJLCBIc2luY2h1IFNjaWVuY2UgUGFyaywgSHNpbmNodSAzMDAsIFRhaXdhbg0K
PiA+ICsgKg0KPiA+ICsgKi8NCj4gPiArDQo+ID4NCj4gKy8qKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KPiAqKioqKioqKioqKioq
KioqDQo+ID4gKyAqICBUaGlzIHByb2R1Y3QgaXMgY292ZXJlZCBieSBvbmUgb3IgbW9yZSBvZiB0
aGUgZm9sbG93aW5nIHBhdGVudHM6DQo+ID4gKyAqICBVUzYsNTcwLDg4NCwgVVM2LDExNSw3NzYs
IGFuZCBVUzYsMzI3LDYyNS4NCj4gPiArDQo+ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCj4gKioqKioqKioqKioqKiovDQo+
ID4gKw0KPiA+ICsjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+DQo+ID4gKyNpbmNsdWRlIDxsaW51
eC92ZXJzaW9uLmg+DQo+ID4gKyNpbmNsdWRlIDxsaW51eC9jZGV2Lmg+DQo+ID4gKyNpbmNsdWRl
IDxsaW51eC9wY2kuaD4NCj4gPiArI2luY2x1ZGUgPGxpbnV4L25ldGRldmljZS5oPg0KPiA+ICsj
aW5jbHVkZSA8bGludXgvZXRoZXJkZXZpY2UuaD4NCj4gPiArI2luY2x1ZGUgPGxpbnV4L2RlbGF5
Lmg+DQo+ID4gKyNpbmNsdWRlIDxsaW51eC9pZl92bGFuLmg+DQo+ID4gKyNpbmNsdWRlIDxsaW51
eC9jcmMzMi5oPg0KPiA+ICsjaW5jbHVkZSA8bGludXgvaW50ZXJydXB0Lmg+DQo+ID4gKyNpbmNs
dWRlIDxsaW51eC9pbi5oPg0KPiA+ICsjaW5jbHVkZSA8bGludXgvaXAuaD4NCj4gPiArI2luY2x1
ZGUgPGxpbnV4L2lwdjYuaD4NCj4gPiArI2luY2x1ZGUgPGxpbnV4L3RjcC5oPg0KPiA+ICsjaW5j
bHVkZSA8bGludXgvaW5pdC5oPg0KPiA+ICsjaW5jbHVkZSA8bGludXgvcnRuZXRsaW5rLmg+DQo+
ID4gKyNpbmNsdWRlIDxsaW51eC9wcmVmZXRjaC5oPg0KPiA+ICsjaW5jbHVkZSA8bGludXgvZG1h
LW1hcHBpbmcuaD4NCj4gPiArI2luY2x1ZGUgPGxpbnV4L21vZHVsZXBhcmFtLmg+DQo+ID4gKyNp
bmNsdWRlIDxsaW51eC9tZGlvLmg+DQo+ID4gKyNpbmNsdWRlIDxuZXQvaXA2X2NoZWNrc3VtLmg+
DQo+ID4gKyNpbmNsdWRlIDxuZXQvcGt0X2Nscy5oPg0KPiA+ICsNCj4gPiArI2luY2x1ZGUgPGxp
bnV4L2lvLmg+DQo+ID4gKyNpbmNsdWRlIDxhc20vaXJxLmg+DQo+ID4gKw0KPiA+ICsjaW5jbHVk
ZSAicnRhc2UuaCINCj4gPiArI2lmZGVmIENPTkZJR19TUklPVg0KPiA+ICsjaW5jbHVkZSAicnRh
c2Vfc3Jpb3YuaCINCj4gPiArI2VuZGlmDQo+ID4gKw0KPiA+ICsjaWZkZWYgRU5BQkxFX1JUQVNF
X1BST0NGUw0KPiA+ICsjaW5jbHVkZSA8bGludXgvcHJvY19mcy5oPg0KPiA+ICsjaW5jbHVkZSA8
bGludXgvc2VxX2ZpbGUuaD4NCj4gPiArI2VuZGlmDQo+ID4gKw0KPiA+ICsvKiBNYXhpbXVtIG51
bWJlciBvZiBtdWx0aWNhc3QgYWRkcmVzc2VzIHRvIGZpbHRlciAodnMuIFJ4LWFsbC1tdWx0aWNh
c3QpLg0KPiA+ICsgKiBUaGUgUlRMIGNoaXBzIHVzZSBhIDY0IGVsZW1lbnQgaGFzaCB0YWJsZSBi
YXNlZCBvbiB0aGUgRXRoZXJuZXQgQ1JDLg0KPiA+ICsgKi8NCj4gPiArc3RhdGljIHN0cnVjdCB3
b3JrcXVldWVfc3RydWN0ICp3b3JrX3F1ZXVlOw0KPiA+ICsNCj4gPiArI2RlZmluZSBfUihOQU1F
LCBNQUMsIEpVTV9GUkFNRV9TWikNCj4gXA0KPiA+ICsNCj4gew0KPiAgIFwNCj4gPiArICAgICAg
ICAgICAgIC5uYW1lID0gTkFNRSwgLm1jZmcgPSBNQUMsIC5qdW1ib19mcmFtZV9zeiA9DQo+IEpV
TV9GUkFNRV9TWiBcDQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArc3RhdGljIGNvbnN0IHN0cnVj
dCB7DQo+ID4gKyAgICAgY29uc3QgY2hhciAqbmFtZTsNCj4gPiArICAgICB1OCBtY2ZnOw0KPiA+
ICsgICAgIHUxNiBqdW1ib19mcmFtZV9zejsNCj4gPiArfSBydGxfY2hpcF9pbmZvW10gPSB7X1Io
IlJUTDkwNzIiLCBDRkdfTUVUSE9EXzEsIEpVTUJPX0ZSQU1FXzlLKSwNCj4gPiArDQo+ID4gKyAg
ICAgICAgICAgICAgICAgIF9SKCJVbmtub3duIiwgQ0ZHX01FVEhPRF9ERUZBVUxULA0KPiBKVU1C
T19GUkFNRV8xSyl9Ow0KPiA+ICsjdW5kZWYgX1INCj4gPiArDQo+ID4gK3N0YXRpYyBzdHJ1Y3Qg
cGNpX2RldmljZV9pZCBydGFzZV9wY2lfdGJsW10gPSB7DQo+ID4gKyAgICAgew0KPiA+ICsgICAg
ICAgICAgICAgUENJX0RFVklDRShQQ0lfVkVORE9SX0lEX1JFQUxURUssIDB4OTA2QSksDQo+ID4g
KyAgICAgfSwNCj4gPiArICAgICB7DQo+ID4gKyAgICAgICAgICAgICAwLA0KPiA+ICsgICAgIH0s
DQo+ID4gK307DQo+ID4gKw0KPiA+ICtNT0RVTEVfREVWSUNFX1RBQkxFKHBjaSwgcnRhc2VfcGNp
X3RibCk7DQo+ID4gK01PRFVMRV9BVVRIT1IoIlJlYWx0ZWsgQVJEIFNvZnR3YXJlIFRlYW0iKTsN
Cj4gPiArTU9EVUxFX0RFU0NSSVBUSU9OKCJSZWFsdGVrIEF1dG9tb3RpdmUgU3dpdGNoIEV0aGVy
bmV0IGFuZCBOZXR3b3JrDQo+IFBDSWUgRHJpdmVyIik7DQo+ID4gK01PRFVMRV9MSUNFTlNFKCJH
UEwiKTsNCj4gPiArTU9EVUxFX1ZFUlNJT04oUlRBU0VfVkVSU0lPTik7DQo+ID4gKw0KPiA+ICtz
dGF0aWMgc3RydWN0IHsNCj4gPiArICAgICB1MzIgbXNnX2VuYWJsZTsNCj4gPiArfSBkZWJ1ZyA9
IHstMX07DQo+ID4gKw0KPiA+DQo+ICsvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCj4gKioqKioqKioqKioqKioqKg0KPiA+ICsg
KiBNb2R1bGUgUGFyYW1ldGVycw0KPiA+ICsNCj4gKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KPiAqKioqKioqKioqKioqKi8N
Cj4gDQo+IE1vZHVsZSBwYXJhbWV0ZXJzIGFyZSBkaXNjb3VyYWdlZC4gVXNlIGV0aHRvb2wgb3Bz
IGFzIGZhciBhcyBwb3NzaWJsZS4NCj4gDQo+ID4gK3N0YXRpYyB1bnNpZ25lZCBpbnQgdHhxX2N0
cmwgPSAxOw0KPiA+ICtzdGF0aWMgdW5zaWduZWQgaW50IGZ1bmNfdHhxX251bSA9IDE7DQo+ID4g
K3N0YXRpYyB1bnNpZ25lZCBpbnQgZnVuY19yeHFfbnVtID0gMTsNCj4gPiArc3RhdGljIHVuc2ln
bmVkIGludCBpbnRlcnJ1cHRfbnVtID0gMTsNCj4gPiArc3RhdGljIGludCByeF9jb3B5YnJlYWs7
DQo+ID4gKw0KPiA+ICttb2R1bGVfcGFyYW0odHhxX2N0cmwsIHVpbnQsIDApOw0KPiA+ICtNT0RV
TEVfUEFSTV9ERVNDKHR4cV9jdHJsLCAiVGhlIG1heGltdW0gbnVtYmVyIG9mIFRYIHF1ZXVlcyBm
b3INCj4gUEYgYW5kIFZGcy4iKTsNCj4gPiArDQo+ID4gK21vZHVsZV9wYXJhbShmdW5jX3R4cV9u
dW0sIHVpbnQsIDApOw0KPiA+ICtNT0RVTEVfUEFSTV9ERVNDKGZ1bmNfdHhxX251bSwgIlRYIHF1
ZXVlIG51bWJlciBmb3IgdGhpcw0KPiBmdW5jdGlvbi4iKTsNCj4gPiArDQo+ID4gK21vZHVsZV9w
YXJhbShmdW5jX3J4cV9udW0sIHVpbnQsIDApOw0KPiA+ICtNT0RVTEVfUEFSTV9ERVNDKGZ1bmNf
cnhxX251bSwgIlJYIHF1ZXVlIG51bWJlciBmb3IgdGhpcw0KPiBmdW5jdGlvbi4iKTsNCj4gPiAr
DQo+ID4gK21vZHVsZV9wYXJhbShpbnRlcnJ1cHRfbnVtLCB1aW50LCAwKTsNCj4gPiArTU9EVUxF
X1BBUk1fREVTQyhpbnRlcnJ1cHRfbnVtLCAiSW50ZXJydXB0IFZlY3RvciBudW1iZXIgZm9yIHRo
aXMNCj4gZnVuY3Rpb24uIik7DQo+ID4gKw0KPiA+ICttb2R1bGVfcGFyYW0ocnhfY29weWJyZWFr
LCBpbnQsIDApOw0KPiA+ICtNT0RVTEVfUEFSTV9ERVNDKHJ4X2NvcHlicmVhaywgIkNvcHkgYnJl
YWtwb2ludCBmb3INCj4gY29weS1vbmx5LXRpbnktZnJhbWVzIik7DQo+ID4gKw0KPiA+DQo+ICsv
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioNCj4gKioqKioqKioqKioqKioqKg0KPiA+ICsgKiBGdW5jdGlvbiBQcm90b3R5cGUNCj4g
PiArDQo+ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioNCj4gKioqKioqKioqKioqKiovDQo+IA0KPiBObyBmb3J3YXJkIGRlY2xh
cmF0aW9ucyBwbGVhc2UuDQo+IA0KPiA+ICtzdGF0aWMgaW50IHJ0YXNlX29wZW4oc3RydWN0IG5l
dF9kZXZpY2UgKmRldik7DQo+ID4gK3N0YXRpYyBuZXRkZXZfdHhfdCBydGFzZV9zdGFydF94bWl0
KHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlDQo+ICpkZXYpOw0KPiA+ICtz
dGF0aWMgdm9pZCBydGFzZV9zZXRfcnhfbW9kZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KTsNCj4g
PiArc3RhdGljIGludCBydGFzZV9zZXRfbWFjX2FkZHJlc3Moc3RydWN0IG5ldF9kZXZpY2UgKmRl
diwgdm9pZCAqcCk7DQo+ID4gK3N0YXRpYyBpbnQgcnRhc2VfY2hhbmdlX210dShzdHJ1Y3QgbmV0
X2RldmljZSAqZGV2LCBpbnQgbmV3X210dSk7DQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX3R4X3Rp
bWVvdXQoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHR4cXVldWUpOw0KPiA+
ICtzdGF0aWMgdm9pZCBydGFzZV9nZXRfc3RhdHM2NChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBz
dHJ1Y3QgcnRubF9saW5rX3N0YXRzNjQNCj4gKnN0YXRzKTsNCj4gPiArc3RhdGljIGludCBydGFz
ZV92bGFuX3J4X2FkZF92aWQoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgX19iZTE2IHByb3RvY29s
LA0KPiB1MTYgdmlkKTsNCj4gPiArc3RhdGljIGludCBydGFzZV92bGFuX3J4X2tpbGxfdmlkKHN0
cnVjdCBuZXRfZGV2aWNlICpkZXYsIF9fYmUxNiBwcm90b2NvbCwNCj4gdTE2IHZpZCk7DQo+ID4g
K3N0YXRpYyBpbnQgcnRhc2Vfc2V0dXBfdGMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgZW51bSB0
Y19zZXR1cF90eXBlIHR5cGUsDQo+IHZvaWQgKnR5cGVfZGF0YSk7DQo+ID4gKw0KPiA+ICtzdGF0
aWMgaXJxcmV0dXJuX3QgcnRhc2VfaW50ZXJydXB0KGludCBpcnEsIHZvaWQgKmRldl9pbnN0YW5j
ZSk7DQo+ID4gK3N0YXRpYyBpcnFyZXR1cm5fdCBydGFzZV9xX2ludGVycnVwdChpbnQgaXJxLCB2
b2lkICpkZXZfaW5zdGFuY2UpOw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9od19jb25maWcoc3Ry
dWN0IG5ldF9kZXZpY2UgKmRldik7DQo+ID4gK3N0YXRpYyBpbnQgcnRhc2VfY2xvc2Uoc3RydWN0
IG5ldF9kZXZpY2UgKmRldik7DQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX2Rvd24oc3RydWN0IG5l
dF9kZXZpY2UgKmRldik7DQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX2luaXRfbmV0ZGV2X29wcyhz
dHJ1Y3QgbmV0X2RldmljZSAqZGV2KTsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfcmFyX3NldChj
b25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAsIGNvbnN0IHVpbnQ4X3QNCj4gKmFkZHIpOw0K
PiA+ICtzdGF0aWMgdm9pZCBydGFzZV9kZXNjX2FkZHJfZmlsbChjb25zdCBzdHJ1Y3QgcnRhc2Vf
cHJpdmF0ZSAqdHApOw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV90eF9kZXNjX2luaXQoc3RydWN0
IHJ0YXNlX3ByaXZhdGUgKnRwLCB1MTYgaWR4KTsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2Vfcnhf
ZGVzY19pbml0KHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCwgdTE2IGlkeCk7DQo+ID4gK3N0YXRp
YyB2b2lkIHJ0YXNlX3NldF9tYXIoY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKTsNCj4g
PiArc3RhdGljIHMzMiB0eF9oYW5kbGVyKHN0cnVjdCBydGFzZV9yaW5nICpyaW5nLCBzMzIgYnVk
Z2V0KTsNCj4gPiArc3RhdGljIHMzMiByeF9oYW5kbGVyKHN0cnVjdCBydGFzZV9yaW5nICpyaW5n
LCBzMzIgYnVkZ2V0KTsNCj4gPiArc3RhdGljIHMzMiBydGFzZV9yeHFvcyhjb25zdCBzdHJ1Y3Qg
aWZyZXEgKmlmciwgY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKTsNCj4gPiArc3RhdGlj
IGludCBydGFzZV9wb2xsKHN0cnVjdCBuYXBpX3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdldCk7DQo+
ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX3N3X3Jlc2V0KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpOw0K
PiA+ICtzdGF0aWMgdm9pZCBydGFzZV9kdW1wX3RhbGx5X2NvdW50ZXIoY29uc3Qgc3RydWN0IHJ0
YXNlX3ByaXZhdGUgKnRwLA0KPiBkbWFfYWRkcl90IHBhZGRyKTsNCj4gPiArc3RhdGljIHMzMiBy
dGFzZV9wdG0oY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2
YXRlICp0cCk7DQo+ID4gK3N0YXRpYyBzMzIgcnRhc2VfcHRtX2Z1bmN0aW9uKGNvbnN0IHN0cnVj
dCBpZnJlcSAqaWZyLCBjb25zdCBzdHJ1Y3QNCj4gcnRhc2VfcHJpdmF0ZSAqdHApOw0KPiA+ICtz
dGF0aWMgczMyIHJ0YXNlX3B0bV9nZXRfY2xvY2soY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNv
bnN0IHN0cnVjdA0KPiBydGFzZV9wcml2YXRlICp0cCk7DQo+ID4gK3N0YXRpYyBzMzIgcnRhc2Vf
cHRtX3N3Y19zZXQoY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0cnVjdA0KPiBydGFz
ZV9wcml2YXRlICp0cCk7DQo+ID4gK3N0YXRpYyBzMzIgcnRhc2VfcHRtX3N3Y19nZXQoY29uc3Qg
c3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0cnVjdA0KPiBydGFzZV9wcml2YXRlICp0cCk7DQo+
ID4gK3N0YXRpYyBzMzIgcnRhc2VfcHRtX3JlZ19nZXQoY29uc3Qgc3RydWN0IGlmcmVxICppZnIs
IGNvbnN0IHN0cnVjdA0KPiBydGFzZV9wcml2YXRlICp0cCk7DQo+ID4gK3N0YXRpYyBzMzIgcnRh
c2VfcHRtX3JlZ19zZXQoY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0cnVjdA0KPiBy
dGFzZV9wcml2YXRlICp0cCk7DQo+ID4gK3N0YXRpYyBzMzIgcnRhc2VfcHRtX2F1dG9fdXBkYXRl
KGNvbnN0IHN0cnVjdCBpZnJlcSAqaWZyLCBjb25zdCBzdHJ1Y3QNCj4gcnRhc2VfcHJpdmF0ZSAq
dHApOw0KPiA+ICtzdGF0aWMgdm9pZCBkdW1wX3R4X2Rlc2MoY29uc3Qgc3RydWN0IHJ0YXNlX3Jp
bmcgKnJpbmcpOw0KPiA+ICtzdGF0aWMgczMyIHJ0YXNlX2RlYnVnX21zZyhjb25zdCBzdHJ1Y3Qg
aWZyZXEgKmlmciwgY29uc3Qgc3RydWN0DQo+IHJ0YXNlX3ByaXZhdGUgKnRwKTsNCj4gPiArc3Rh
dGljIHZvaWQgbWFjX29jcF93cml0ZShjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAsIHUx
NiByZWdfYWRkciwgdTE2DQo+IHZhbHVlKTsNCj4gPiArc3RhdGljIHUxNiBtYWNfb2NwX3JlYWQo
Y29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwLCB1MTYgcmVnX2FkZHIpOw0KPiA+ICtzdGF0
aWMgczMyIHJlZ19mdW4oY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0cnVjdCBydGFz
ZV9wcml2YXRlICp0cCk7DQo+ID4gK3N0YXRpYyBzMzIgdGltZW91dF9zaWcoY29uc3Qgc3RydWN0
IGlmcmVxICppZnIsIHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCk7DQo+ID4gKw0KPiA+DQo+ICsv
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioNCj4gKioqKioqKioqKioqKioqKg0KPiA+ICsgKiBGdW5jdGlvbg0KPiA+ICsNCj4gKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKg0KPiAqKioqKioqKioqKioqKi8NCj4gPiArI2lmbmRlZiBTRVRfRVRIVE9PTF9PUFMNCj4g
PiArI2RlZmluZSBTRVRfRVRIVE9PTF9PUFMobmV0ZGV2LCBvcHMpICgobmV0ZGV2KS0+ZXRodG9v
bF9vcHMgPSAob3BzKSkNCj4gPiArI2VuZGlmIC8qIFNFVF9FVEhUT09MX09QUyAqLw0KPiA+ICsN
Cj4gPiArc3RydWN0IHJ0YXNlX2NvdW50ZXJzIHsNCj4gPiArICAgICB1NjQgdHhfcGFja2V0czsN
Cj4gQWxzbyBoZXJlIG1vc3QgbGlrZWx5IHRoaXMgc2hvdWxkIGJlIF9fbGU2NC4NCj4gDQo+ID4g
KyAgICAgdTY0IHJ4X3BhY2tldHM7DQo+ID4gKyAgICAgdTY0IHR4X2Vycm9yczsNCj4gPiArICAg
ICB1MzIgcnhfZXJyb3JzOw0KPiA+ICsgICAgIHUxNiByeF9taXNzZWQ7DQo+ID4gKyAgICAgdTE2
IGFsaWduX2Vycm9yczsNCj4gPiArICAgICB1MzIgdHhfb25lX2NvbGxpc2lvbjsNCj4gPiArICAg
ICB1MzIgdHhfbXVsdGlfY29sbGlzaW9uOw0KPiA+ICsgICAgIHU2NCByeF91bmljYXN0Ow0KPiA+
ICsgICAgIHU2NCByeF9icm9hZGNhc3Q7DQo+ID4gKyAgICAgdTMyIHJ4X211bHRpY2FzdDsNCj4g
PiArICAgICB1MTYgdHhfYWJvcnRlZDsNCj4gPiArICAgICB1MTYgdHhfdW5kZXJ1bjsNCj4gPiAr
fTsNCj4gPiArDQo+ID4gKyNpZmRlZiBFTkFCTEVfUlRBU0VfUFJPQ0ZTDQo+ID4NCj4gKy8qKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
Kg0KPiAqKioqKioqKioqKioqKioqDQo+ID4gKyAqIFBST0NGUyBTVFVGRg0KPiA+ICsNCj4gKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKg0KPiAqKioqKioqKioqKioqKi8NCj4gPiArc3RhdGljIHN0cnVjdCBwcm9jX2Rpcl9lbnRy
eSAqcnRhc2VfcHJvYzsNCj4gPiArc3RhdGljIHMzMiBwcm9jX2luaXRfbnVtOw0KPiA+ICsNCj4g
PiArc3RhdGljIHZvaWQgcnRhc2VfZHVtcF90YWxseV9jb3VudGVyKGNvbnN0IHN0cnVjdCBydGFz
ZV9wcml2YXRlICp0cCwNCj4gZG1hX2FkZHJfdCBwYWRkcikNCj4gPiArew0KPiA+ICsgICAgIHZv
aWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAgICB1MzIgY21kOw0K
PiA+ICsgICAgIHUzMiB3YWl0X2NudDsNCj4gPiArDQo+ID4gKyAgICAgUlRMX1czMihEVENDUjQs
ICh1MzIpKHBhZGRyID4+IDMyKSk7DQo+ID4gKyAgICAgY21kID0gKHUzMikocGFkZHIgJiBETUFf
QklUX01BU0soMzIpKTsNCj4gPiArICAgICBSVExfVzMyKERUQ0NSMCwgY21kKTsNCj4gPiArICAg
ICBSVExfVzMyKERUQ0NSMCwgKHUzMikoY21kIHwgQ09VTlRFUl9EVU1QKSk7DQo+ID4gKw0KPiA+
ICsgICAgIHdhaXRfY250ID0gMDsNCj4gPiArICAgICB3aGlsZSAoKFJUTF9SMzIoRFRDQ1IwKSAm
IENPVU5URVJfRFVNUCkgIT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgIHVzbGVlcF9yYW5nZSgx
MCwgMjApOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIHdhaXRfY250Kys7DQo+ID4gKyAgICAg
ICAgICAgICBpZiAod2FpdF9jbnQgPiAyMHUpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJy
ZWFrOw0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBwcm9jX2dl
dF90YWxseV9jb3VudGVyKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqdikNCj4gPiArew0KPiA+
ICsgICAgIGNvbnN0IHN0cnVjdCBuZXRfZGV2aWNlICpkZXYgPSBtLT5wcml2YXRlOw0KPiA+ICsg
ICAgIHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAg
ICAgY29uc3Qgc3RydWN0IHJ0YXNlX2NvdW50ZXJzICpjb3VudGVycyA9IE5VTEw7DQo+ID4gKyAg
ICAgZG1hX2FkZHJfdCBwYWRkcjsNCj4gPiArICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOw0KPiA+
ICsNCj4gPiArICAgICAodm9pZCl2Ow0KPiA+ICsgICAgIHNlcV9wdXRzKG0sICJcbkR1bXAgVGFs
bHkgQ291bnRlclxuIik7DQo+ID4gKw0KPiA+ICsgICAgIGNvdW50ZXJzID0gdHAtPnRhbGx5X3Zh
ZGRyOw0KPiA+ICsgICAgIHBhZGRyID0gdHAtPnRhbGx5X3BhZGRyOw0KPiA+ICsgICAgIGlmICgh
Y291bnRlcnMpIHsNCj4gPiArICAgICAgICAgICAgIHNlcV9wdXRzKG0sICJcbkR1bXAgVGFsbHkg
Q291bnRlciBGYWlsXG4iKTsNCj4gPiArICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAg
IH0NCj4gPiArDQo+ID4gKyAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJnRwLT5sb2NrLCBmbGFncyk7
DQo+ID4gKyAgICAgcnRhc2VfZHVtcF90YWxseV9jb3VudGVyKHRwLCBwYWRkcik7DQo+ID4gKyAg
ICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiArDQo+ID4g
KyAgICAgc2VxX3B1dHMobSwgIlN0YXRpc3RpY3NcdFZhbHVlXG4tLS0tLS0tLS0tXHQtLS0tLVxu
Iik7DQo+ID4gKyAgICAgc2VxX3ByaW50ZihtLCAidHhfcGFja2V0c1x0JWxsZFxuIiwNCj4gbGU2
NF90b19jcHUoY291bnRlcnMtPnR4X3BhY2tldHMpKTsNCj4gPiArICAgICBzZXFfcHJpbnRmKG0s
ICJyeF9wYWNrZXRzXHQlbGxkXG4iLA0KPiBsZTY0X3RvX2NwdShjb3VudGVycy0+cnhfcGFja2V0
cykpOw0KPiA+ICsgICAgIHNlcV9wcmludGYobSwgInR4X2Vycm9yc1x0JWxsZFxuIiwgbGU2NF90
b19jcHUoY291bnRlcnMtPnR4X2Vycm9ycykpOw0KPiA+ICsgICAgIHNlcV9wcmludGYobSwgInJ4
X21pc3NlZFx0JWxsZFxuIiwNCj4gbGU2NF90b19jcHUoY291bnRlcnMtPnJ4X21pc3NlZCkpOw0K
PiA+ICsgICAgIHNlcV9wcmludGYobSwgImFsaWduX2Vycm9yc1x0JWxsZFxuIiwNCj4gbGU2NF90
b19jcHUoY291bnRlcnMtPmFsaWduX2Vycm9ycykpOw0KPiA+ICsgICAgIHNlcV9wcmludGYobSwg
InR4X29uZV9jb2xsaXNpb25cdCVsbGRcbiIsDQo+IGxlNjRfdG9fY3B1KGNvdW50ZXJzLT50eF9v
bmVfY29sbGlzaW9uKSk7DQo+ID4gKyAgICAgc2VxX3ByaW50ZihtLCAidHhfbXVsdGlfY29sbGlz
aW9uXHQlbGxkXG4iLA0KPiBsZTY0X3RvX2NwdShjb3VudGVycy0+dHhfbXVsdGlfY29sbGlzaW9u
KSk7DQo+ID4gKyAgICAgc2VxX3ByaW50ZihtLCAicnhfdW5pY2FzdFx0JWxsZFxuIiwNCj4gbGU2
NF90b19jcHUoY291bnRlcnMtPnJ4X3VuaWNhc3QpKTsNCj4gPiArICAgICBzZXFfcHJpbnRmKG0s
ICJyeF9icm9hZGNhc3RcdCVsbGRcbiIsDQo+IGxlNjRfdG9fY3B1KGNvdW50ZXJzLT5yeF9icm9h
ZGNhc3QpKTsNCj4gPiArICAgICBzZXFfcHJpbnRmKG0sICJyeF9tdWx0aWNhc3RcdCVsbGRcbiIs
DQo+IGxlNjRfdG9fY3B1KGNvdW50ZXJzLT5yeF9tdWx0aWNhc3QpKTsNCj4gPiArICAgICBzZXFf
cHJpbnRmKG0sICJ0eF9hYm9ydGVkXHQlbGxkXG4iLA0KPiBsZTY0X3RvX2NwdShjb3VudGVycy0+
dHhfYWJvcnRlZCkpOw0KPiA+ICsgICAgIHNlcV9wcmludGYobSwgInR4X3VuZGVydW5cdCVsbGRc
biIsDQo+IGxlNjRfdG9fY3B1KGNvdW50ZXJzLT50eF91bmRlcnVuKSk7DQo+ID4gKw0KPiA+ICsg
ICAgIHNlcV9wdXRjKG0sICdcbicpOw0KPiA+ICsNCj4gPiArb3V0Og0KPiA+ICsgICAgIHJldHVy
biAwOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IHByb2NfZ2V0X3BjaV9yZWdpc3Rl
cnMoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICp2KQ0KPiA+ICt7DQo+ID4gKyAgICAgY29uc3Qg
c3RydWN0IG5ldF9kZXZpY2UgKmRldiA9IG0tPnByaXZhdGU7DQo+ID4gKyAgICAgczMyIG4gPSAw
Ow0KPiA+ICsgICAgIHMzMiBtYXhfcmVnX3NpemUgPSBSVEFTRV9QQ0lfUkVHU19TSVpFOw0KPiA+
ICsgICAgIHUzMiBkd29yZF9yZDsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAg
PSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7DQo+ID4g
Kw0KPiA+ICsgICAgICh2b2lkKXY7DQo+ID4gKyAgICAgc2VxX3B1dHMobSwgIlxuRHVtcCBQQ0kg
UmVnaXN0ZXJzXG4iKTsNCj4gPiArICAgICBzZXFfcHV0cyhtLCAiXG5PZmZzZXRcdFZhbHVlXG4t
LS0tLS1cdC0tLS0tXG4gIik7DQo+ID4gKw0KPiA+ICsgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZ0
cC0+bG9jaywgZmxhZ3MpOw0KPiA+ICsNCj4gPiArICAgICB3aGlsZSAobiA8IG1heF9yZWdfc2l6
ZSkgew0KPiA+ICsgICAgICAgICAgICAgaWYgKChuICUgRFdPUkRfTU9EKSA9PSAwKQ0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICBzZXFfcHJpbnRmKG0sICJcbjB4JTAzeDpcdCIsIG4pOw0KPiA+
ICsNCj4gPiArICAgICAgICAgICAgIHBjaV9yZWFkX2NvbmZpZ19kd29yZCh0cC0+cGRldiwgbiwg
JmR3b3JkX3JkKTsNCj4gPiArICAgICAgICAgICAgIHNlcV9wcmludGYobSwgIiUwOHggIiwgZHdv
cmRfcmQpOw0KPiA+ICsgICAgICAgICAgICAgbiArPSA0Ow0KPiA+ICsgICAgIH0NCj4gPiArDQo+
ID4gKyAgICAgbiA9IDB4MTEwOw0KPiA+ICsgICAgIHBjaV9yZWFkX2NvbmZpZ19kd29yZCh0cC0+
cGRldiwgbiwgJmR3b3JkX3JkKTsNCj4gPiArICAgICBzZXFfcHJpbnRmKG0sICJcbjB4JTAzeDpc
dCUwOHggIiwgbiwgZHdvcmRfcmQpOw0KPiA+ICsgICAgIG4gPSAweDcwQzsNCj4gPiArICAgICBw
Y2lfcmVhZF9jb25maWdfZHdvcmQodHAtPnBkZXYsIG4sICZkd29yZF9yZCk7DQo+ID4gKyAgICAg
c2VxX3ByaW50ZihtLCAiXG4weCUwM3g6XHQlMDh4ICIsIG4sIGR3b3JkX3JkKTsNCj4gPiArDQo+
ID4gKyAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiAr
DQo+ID4gKyAgICAgc2VxX3B1dGMobSwgJ1xuJyk7DQo+ID4gKyAgICAgcmV0dXJuIDA7DQo+ID4g
K30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX3Byb2NfbW9kdWxlX2luaXQodm9pZCkN
Cj4gPiArew0KPiA+ICsgICAgIC8qIGNyZWF0ZSAvcHJvYy9uZXQvcnRhc2UgKi8NCj4gPiArICAg
ICBydGFzZV9wcm9jID0gcHJvY19ta2RpcihNT0RVTEVOQU1FLCBpbml0X25ldC5wcm9jX25ldCk7
DQo+ID4gKw0KPiA+ICsgICAgIGlmICghcnRhc2VfcHJvYykNCj4gPiArICAgICAgICAgICAgIGRw
cmludGsoImNhbm5vdCBjcmVhdGUgJXMgcHJvYyBlbnRyeVxuIiwgTU9EVUxFTkFNRSk7DQo+ID4g
K30NCj4gPiArDQo+ID4gKy8qIHNlcV9maWxlIHdyYXBwZXJzIGZvciBwcm9jZmlsZSBzaG93IHJv
dXRpbmVzLg0KPiA+ICsgKi8NCj4gPiArc3RhdGljIGludCBydGFzZV9wcm9jX29wZW4oc3RydWN0
IGlub2RlICpwX2lub2RlLCBzdHJ1Y3QgZmlsZSAqcF9maWxlKQ0KPiA+ICt7DQo+ID4gKyAgICAg
c3RydWN0IG5ldF9kZXZpY2UgKmRldiA9IHByb2NfZ2V0X3BhcmVudF9kYXRhKHBfaW5vZGUpOw0K
PiA+ICsgICAgIGludCAoKnNob3cpKHN0cnVjdCBzZXFfZmlsZSAqc2VxLCB2b2lkICp2KSA9IHBk
ZV9kYXRhKHBfaW5vZGUpOw0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gc2luZ2xlX29wZW4ocF9m
aWxlLCBzaG93LCBkZXYpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgY29uc3Qgc3RydWN0
IHByb2Nfb3BzIHJ0YXNlX3Byb2NfZm9wcyA9IHsNCj4gPiArICAgICAucHJvY19vcGVuID0gcnRh
c2VfcHJvY19vcGVuLA0KPiA+ICsgICAgIC5wcm9jX3JlYWQgPSBzZXFfcmVhZCwNCj4gPiArICAg
ICAucHJvY19sc2VlayA9IHNlcV9sc2VlaywNCj4gPiArICAgICAucHJvY19yZWxlYXNlID0gc2lu
Z2xlX3JlbGVhc2UsDQo+ID4gK307DQo+ID4gKw0KPiA+ICsvKiBUYWJsZSBvZiBwcm9jIGZpbGVz
IHdlIG5lZWQgdG8gY3JlYXRlLg0KPiA+ICsgKi8NCj4gPiArc3RydWN0IHJ0YXNlX3Byb2NfZmls
ZSB7DQo+ID4gKyAgICAgY2hhciBuYW1lWzEyXTsNCj4gPiArICAgICBpbnQgKCpzaG93KShzdHJ1
Y3Qgc2VxX2ZpbGUgKnNlcSwgdm9pZCAqdik7DQo+ID4gK307DQo+ID4gKw0KPiA+ICtzdGF0aWMg
Y29uc3Qgc3RydWN0IHJ0YXNlX3Byb2NfZmlsZSBydGFzZV9wcm9jX2ZpbGVzW10gPSB7DQo+ID4g
KyAgICAgeyJ0YWxseSIsICZwcm9jX2dldF90YWxseV9jb3VudGVyfSwgeyJwY2lfcmVncyIsDQo+
ICZwcm9jX2dldF9wY2lfcmVnaXN0ZXJzfSwgeyIifX07DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9p
ZCBydGFzZV9wcm9jX2luaXQoc3RydWN0IG5ldF9kZXZpY2UgKmRldikNCj4gPiArew0KPiA+ICsg
ICAgIHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAg
ICAgY29uc3Qgc3RydWN0IHJ0YXNlX3Byb2NfZmlsZSAqZjsNCj4gPiArICAgICBzdHJ1Y3QgcHJv
Y19kaXJfZW50cnkgKmRpciA9IE5VTEw7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChydGFzZV9wcm9j
ICYmICF0cC0+cHJvY19kaXIpIHsNCj4gPiArICAgICAgICAgICAgIGRpciA9IHByb2NfbWtkaXJf
ZGF0YShkZXYtPm5hbWUsIDAsIHJ0YXNlX3Byb2MsIGRldik7DQo+ID4gKyAgICAgICAgICAgICBp
ZiAoIWRpcikgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfaW5mbyhkZXYsICJV
bmFibGUgdG8gaW5pdGlhbGl6ZQ0KPiAvcHJvYy9uZXQvJXMvJXNcbiIsIE1PRFVMRU5BTUUsDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldi0+bmFtZSk7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsN
Cj4gPiArICAgICAgICAgICAgIHRwLT5wcm9jX2RpciA9IGRpcjsNCj4gPiArICAgICAgICAgICAg
IHByb2NfaW5pdF9udW0rKzsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBmb3IgKGYgPSBydGFz
ZV9wcm9jX2ZpbGVzOyBmLT5uYW1lWzBdICE9ICdcMCc7IGYrKykgew0KPiA+ICsgICAgICAgICAg
ICAgICAgICAgICBpZiAocHJvY19jcmVhdGVfZGF0YShmLT5uYW1lLCBTX0lGUkVHIHwNCj4gU19J
UlVHTywgZGlyLCAmcnRhc2VfcHJvY19mb3BzLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBmLT5zaG93KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgPT0gTlVMTCkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9p
bmZvKGRldiwgIlVuYWJsZSB0byBpbml0aWFsaXplDQo+IC9wcm9jL25ldC8lcy8lcy8lc1xuIiwN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNT0RVTEVOQU1F
LA0KPiBkZXYtPm5hbWUsIGYtPm5hbWUpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAgICAgICAgICAgICAgICAgICB9DQo+ID4gKyAgICAgICAg
ICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArb3V0Og0KPiA+ICsgICAgIHJldHVybjsN
Cj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfcHJvY19yZW1vdmUoY29uc3Qg
c3RydWN0IG5ldF9kZXZpY2UgKmRldikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9w
cml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKw0KPiA+ICsgICAgIGlmICh0cC0+
cHJvY19kaXIpIHsNCj4gPiArICAgICAgICAgICAgIHJlbW92ZV9wcm9jX3N1YnRyZWUoZGV2LT5u
YW1lLCBydGFzZV9wcm9jKTsNCj4gPiArICAgICAgICAgICAgIHByb2NfaW5pdF9udW0tLTsNCj4g
PiArICAgICAgICAgICAgIHRwLT5wcm9jX2RpciA9IE5VTEw7DQo+ID4gKyAgICAgfQ0KPiA+ICt9
DQo+ID4gKw0KPiA+ICsjZW5kaWYgLyogRU5BQkxFX1JUQVNFX1BST0NGUyAqLw0KPiA+ICsNCj4g
PiArc3RhdGljIHZvaWQgbWFjX29jcF93cml0ZShjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAq
dHAsIHUxNiByZWdfYWRkciwgdTE2DQo+IHZhbHVlKQ0KPiA+ICt7DQo+ID4gKyAgICAgdm9pZCBf
X2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHUzMiBkYXRhMzI7DQo+
ID4gKw0KPiA+ICsgICAgIFdBUk5fT05fT05DRShyZWdfYWRkciAlIDJ1KTsNCj4gPiArDQo+ID4g
KyAgICAgZGF0YTMyID0gKCh1MzIpcmVnX2FkZHIgLyAydSk7DQo+ID4gKyAgICAgZGF0YTMyIDw8
PSBPQ1BSX0FERFJfUkVHX1NISUZUOw0KPiA+ICsgICAgIGRhdGEzMiArPSB2YWx1ZTsNCj4gPiAr
ICAgICBkYXRhMzIgfD0gT0NQUl9XUklURTsNCj4gPiArDQo+ID4gKyAgICAgUlRMX1czMihQRFIs
IGRhdGEzMik7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB1MTYgbWFjX29jcF9yZWFkKGNv
bnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCwgdTE2IHJlZ19hZGRyKQ0KPiA+ICt7DQo+ID4g
KyAgICAgdm9pZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHUz
MiBkYXRhMzI7DQo+ID4gKyAgICAgdTE2IGRhdGExNiA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIFdB
Uk5fT05fT05DRShyZWdfYWRkciAlIDJ1KTsNCj4gPiArDQo+ID4gKyAgICAgZGF0YTMyID0gKCh1
MzIpcmVnX2FkZHIgLyAydSk7DQo+ID4gKyAgICAgZGF0YTMyIDw8PSBPQ1BSX0FERFJfUkVHX1NI
SUZUOw0KPiA+ICsNCj4gPiArICAgICBSVExfVzMyKFBEUiwgZGF0YTMyKTsNCj4gPiArICAgICBk
YXRhMTYgPSAodTE2KVJUTF9SMzIoUERSKTsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIGRhdGEx
NjsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfaW50ZXJydXB0X21pdGln
YXRpb24oY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7DQo+ID4gKyAgICAg
dm9pZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHUzMiBpID0g
MDsNCj4gPiArDQo+ID4gKyAgICAgLyogdHggaW50ZXJydXB0IG1pdGlnYXRpb24gKi8NCj4gPiAr
ICAgICBmb3IgKGkgPSAwdTsgaSA8IHRwLT5mdW5jX3R4X3F1ZXVlX251bTsgaSsrKQ0KPiA+ICsg
ICAgICAgICAgICAgUlRMX1cxNigoSU5UX01JVElfVFggKyAoaSAqIDJ1KSksIHRwLT50eF9pbnRf
bWl0KTsNCj4gPiArDQo+ID4gKyAgICAgLyogcnggaW50ZXJydXB0IG1pdGlnYXRpb24gKi8NCj4g
PiArICAgICBmb3IgKGkgPSAwdTsgaSA8IHRwLT5mdW5jX3J4X3F1ZXVlX251bTsgaSsrKQ0KPiA+
ICsgICAgICAgICAgICAgUlRMX1cxNigoSU5UX01JVElfUlggKyAoaSAqIDJ1KSksIHRwLT5yeF9p
bnRfbWl0KTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGlubGluZSB2b2lkIHJ0YXNlX2Vu
YWJsZV9od19pbnRlcnJ1cHQoY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7
DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IHJ0YXNlX2ludF92ZWN0b3IgKml2ZWMgPSAmdHAtPmlu
dF92ZWN0b3JbMF07DQo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19h
ZGRyOw0KPiA+ICsgICAgIHUzMiBpID0gMDsNCj4gPiArDQo+ID4gKyAgICAgUlRMX1czMihpdmVj
LT5pbXJfYWRkciwgaXZlYy0+aW1yKTsNCj4gPiArDQo+ID4gKyAgICAgZm9yIChpID0gMTsgaSA8
IHRwLT5pbnRfbnVtczsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICBpdmVjID0gJnRwLT5pbnRf
dmVjdG9yW2ldOw0KPiA+ICsgICAgICAgICAgICAgUlRMX1cxNihpdmVjLT5pbXJfYWRkciwgKHUx
NilpdmVjLT5pbXIpOw0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZv
aWQgcnRhc2VfaXJxX21hc2tfYW5kX2Fjayhjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAp
DQo+ID4gK3sNCj4gPiArICAgICBjb25zdCBzdHJ1Y3QgcnRhc2VfaW50X3ZlY3RvciAqaXZlYyA9
ICZ0cC0+aW50X3ZlY3RvclswXTsNCj4gPiArICAgICB2b2lkIF9faW9tZW0gKmlvYWRkciA9IHRw
LT5tbWlvX2FkZHI7DQo+ID4gKyAgICAgdTggaSA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIFJUTF9X
MzIoaXZlYy0+aW1yX2FkZHIsIDApOw0KPiA+ICsgICAgIFJUTF9XMzIoaXZlYy0+aXNyX2FkZHIs
IFJUTF9SMzIoaXZlYy0+aXNyX2FkZHIpKTsNCj4gPiArDQo+ID4gKyAgICAgZm9yIChpID0gMTsg
aSA8IHRwLT5pbnRfbnVtczsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICBpdmVjID0gJnRwLT5p
bnRfdmVjdG9yW2ldOw0KPiA+ICsgICAgICAgICAgICAgUlRMX1cxNihpdmVjLT5pbXJfYWRkciwg
MCk7DQo+ID4gKyAgICAgICAgICAgICBSVExfVzE2KGl2ZWMtPmlzcl9hZGRyLCBSVExfUjE2KGl2
ZWMtPmlzcl9hZGRyKSk7DQo+ID4gKyAgICAgfQ0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMg
dm9pZCBydGFzZV9uaWNfcmVzZXQoY29uc3Qgc3RydWN0IG5ldF9kZXZpY2UgKmRldikNCj4gPiAr
ew0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2
KGRldik7DQo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0K
PiA+ICsgICAgIHUxNiBpID0gMDsNCj4gPiArICAgICB1MTYgcnhfY29uZmlnOw0KPiA+ICsNCj4g
PiArICAgICByeF9jb25maWcgPSBSVExfUjE2KFJYX0NPTkZJR18wKTsNCj4gPiArICAgICBSVExf
VzE2KFJYX0NPTkZJR18wLCAodTE2KShyeF9jb25maWcgJiB+QUNDRVBUX01BU0spKTsNCj4gPiAr
DQo+ID4gKyAgICAgLyogcnhkdl9nYXRlZF9lbiAtIG1hc2sgcnhkdiBpbiBQSFlJTyAqLw0KPiA+
ICsgICAgIFJUTF9XOChNSVNDLCAodTgpKFJUTF9SOChNSVNDKSB8IFJYX0RWX0dBVEVfRU4pKTsN
Cj4gPiArICAgICAvKiBzdG9wIGFueSBUTFAgcmVxdWVzdCBmcm9tIFBDSWUgKi8NCj4gPiArICAg
ICBSVExfVzgoQ0hJUF9DTUQsICh1OCkoUlRMX1I4KENISVBfQ01EKSB8IFNUT1BfUkVRKSk7DQo+
ID4gKyAgICAgbWRlbGF5KDIpOw0KPiA+ICsNCj4gPiArICAgICAvKiB3YWl0IFRMUCByZXF1ZXN0
IGRvbmUgKi8NCj4gPiArICAgICBmb3IgKGkgPSAwdTsgaSA8IDE1MDB1OyBpKyspIHsNCj4gPiAr
ICAgICAgICAgICAgIGlmICgoUlRMX1I4KENISVBfQ01EKSAmIFNUT1BfUkVRX0RPTkUpICE9IDB1
KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiArDQo+ID4gKyAgICAgICAg
ICAgICB1c2xlZXBfcmFuZ2UoMTAwLCAxMTApOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAg
ICAgLyogd2FpdCBGSUZPIGVtcHR5ICovDQo+ID4gKyAgICAgZm9yIChpID0gMHU7IGkgPCAxMDAw
dTsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICBpZiAoKFJUTF9SOChGSUZPUikgJiAoVFhfRklG
T19FTVBUWSB8IFJYX0ZJRk9fRU1QVFkpKQ0KPiA+ICsgICAgICAgICAgICAgICAgID09IChUWF9G
SUZPX0VNUFRZIHwgUlhfRklGT19FTVBUWSkpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJy
ZWFrOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIHVzbGVlcF9yYW5nZSgxMDAsIDExMCk7DQo+
ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBSVExfVzgoQ0hJUF9DTUQsICh1OCkoUlRMX1I4
KENISVBfQ01EKSAmIH4oVEUgfCBSRSkpKTsNCj4gPiArDQo+ID4gKyAgICAgUlRMX1c4KENISVBf
Q01ELCAodTgpKFJUTF9SOChDSElQX0NNRCkgJiB+U1RPUF9SRVEpKTsNCj4gPiArDQo+ID4gKyAg
ICAgUlRMX1cxNihSWF9DT05GSUdfMCwgcnhfY29uZmlnKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiAr
c3RhdGljIHZvaWQgcnRhc2VfbmljX2VuYWJsZShjb25zdCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2
KQ0KPiA+ICt7DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0
ZGV2X3ByaXYoZGV2KTsNCj4gPiArICAgICB2b2lkIF9faW9tZW0gKmlvYWRkciA9IHRwLT5tbWlv
X2FkZHI7DQo+ID4gKyAgICAgdTE2IHJjciA9IFJUTF9SMTYoUlhfQ09ORklHXzEpOw0KPiA+ICsN
Cj4gPiArICAgICAvKiBQQ0llIFBMQSByZWxvYWQgKi8NCj4gPiArICAgICBSVExfVzE2KFJYX0NP
TkZJR18xLCAodTE2KShyY3IgJiB+UENJRV9SRUxPQURfRW4pKTsNCj4gPiArICAgICBSVExfVzE2
KFJYX0NPTkZJR18xLCAodTE2KShyY3IgfCBQQ0lFX1JFTE9BRF9FbikpOw0KPiA+ICsNCj4gPiAr
ICAgICAvKiBTZXQgUENJZSBURSAmIFJFICovDQo+ID4gKyAgICAgUlRMX1c4KENISVBfQ01ELCAo
dTgpKFJUTF9SOChDSElQX0NNRCkgfCAoVEUgfCBSRSkpKTsNCj4gPiArDQo+ID4gKyAgICAgLyog
Q2xlYXIgcnhkdl9nYXRlZF9lbiAqLw0KPiA+ICsgICAgIFJUTF9XOChNSVNDLCAodTgpKFJUTF9S
OChNSVNDKSAmIH5SWF9EVl9HQVRFX0VOKSk7DQo+ID4gK30NCj4gPiArDQo+ID4gK3ZvaWQgcnRh
c2VfZnVuY19lbmFibGUoY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7DQo+
ID4gKyAgICAgdTE2IGkgPSAwdTsNCj4gPiArICAgICB1MTYgY3IgPSAwdTsNCj4gPiArICAgICB2
b2lkIF9faW9tZW0gKmlvYWRkciA9IHRwLT5tbWlvX2FkZHI7DQo+ID4gKw0KPiA+ICsgICAgIC8q
IFBvbGxpbmcgZnVuY3Rpb24gVEUgJiBSRSAqLw0KPiA+ICsgICAgIGZvciAoaSA9IDB1OyBpIDwg
MTUwMHU7IGkrKykgew0KPiA+ICsgICAgICAgICAgICAgaWYgKChSVExfUjE2KEZDUikgJiAoRkNS
X1RFIHwgRkNSX1JFKSkgPT0gMHUpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0K
PiA+ICsNCj4gPiArICAgICAgICAgICAgIHVzbGVlcF9yYW5nZSgxMDAsIDExMCk7DQo+ID4gKyAg
ICAgfQ0KPiA+ICsNCj4gPiArICAgICAvKiBTZXQgZnVuY3Rpb24gVEUgJiBSRSAqLw0KPiA+ICsg
ICAgIGNyID0gUlRMX1IxNihGQ1IpOw0KPiA+ICsgICAgIGNyIHw9ICh1MTYpKEZDUl9URSB8IEZD
Ul9SRSk7DQo+ID4gKyAgICAgUlRMX1cxNihGQ1IsIGNyKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiAr
dm9pZCBydGFzZV9mdW5jX2Rpc2FibGUoY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0K
PiA+ICt7DQo+ID4gKyAgICAgdTE2IGkgPSAwOw0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9h
ZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArDQo+ID4gKyAgICAgLyogQ2xlYXIgZnVuY3Rpb24g
VEUgJiBSRSAqLw0KPiA+ICsgICAgIFJUTF9XMTYoRkNSLCAodTE2KShSVExfUjE2KEZDUikgJiB+
KEZDUl9URSB8IEZDUl9SRSkpKTsNCj4gPiArDQo+ID4gKyAgICAgLyogUG9sbGluZyBmdW5jdGlv
biBURSAmIFJFICovDQo+ID4gKyAgICAgZm9yIChpID0gMHU7IGkgPCAxNTAwdTsgaSsrKSB7DQo+
ID4gKyAgICAgICAgICAgICBpZiAoKFJUTF9SMTYoRkNSKSAmIChGQ1JfVEUgfCBGQ1JfUkUpKSA9
PSAwdSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4gKw0KPiA+ICsgICAg
ICAgICAgICAgdXNsZWVwX3JhbmdlKDEwMCwgMTEwKTsNCj4gPiArICAgICB9DQo+ID4gK30NCj4g
PiArDQo+ID4gK3ZvaWQgcnRhc2VfaHdfcmVzZXQoY29uc3Qgc3RydWN0IG5ldF9kZXZpY2UgKmRl
dikNCj4gPiArew0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5l
dGRldl9wcml2KGRldik7DQo+ID4gKw0KPiA+ICsgICAgIC8qIGRpc2FibGUgJiBjbGVhciBpbnRl
cnJ1cHRzICovDQo+ID4gKyAgICAgcnRhc2VfaXJxX21hc2tfYW5kX2Fjayh0cCk7DQo+ID4gKw0K
PiA+ICsgICAgIC8qIG5pYyByZXNldCAqLw0KPiA+ICsgICAgIHJ0YXNlX25pY19yZXNldChkZXYp
Ow0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9lbmFibGVfRUVNX3dyaXRl
KGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCkNCj4gPiArew0KPiA+ICsgICAgIHZvaWQg
X19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArDQo+ID4gKyAgICAgUlRMX1c4
KEVFTSwgKFJUTF9SOChFRU0pIHwgRUVNX1VubG9jaykpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtz
dGF0aWMgdm9pZCBydGFzZV9kaXNhYmxlX0VFTV93cml0ZShjb25zdCBzdHJ1Y3QgcnRhc2VfcHJp
dmF0ZSAqdHApDQo+ID4gK3sNCj4gPiArICAgICB2b2lkIF9faW9tZW0gKmlvYWRkciA9IHRwLT5t
bWlvX2FkZHI7DQo+ID4gKw0KPiA+ICsgICAgIFJUTF9XOChFRU0sIChSVExfUjgoRUVNKSAmICh1
OCkofkVFTV9VbmxvY2spKSk7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbmxpbmUgdTMy
IHJ0YXNlX3R4X3ZsYW5fdGFnKGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCwgY29uc3QN
Cj4gc3RydWN0IHNrX2J1ZmYgKnNrYikNCj4gPiArew0KPiA+ICsgICAgIHUzMiB0YWc7DQo+ID4g
Kw0KPiA+ICsgICAgICh2b2lkKXRwOw0KPiA+ICsNCj4gPiArICAgICB0YWcgPSAoc2tiX3ZsYW5f
dGFnX3ByZXNlbnQoc2tiKSAhPSAwdSkgPyAodTMyKShUWF9WTEFOX1RBRyB8DQo+IHN3YWIxNihz
a2Jfdmxhbl90YWdfZ2V0KHNrYikpKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICA6IDB4MDB1Ow0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gdGFnOw0K
PiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgczMyIHJ0YXNlX3J4X3ZsYW5fc2tiKHJ4X2Rlc2Mg
KmRlc2MsIHN0cnVjdCBza19idWZmICpza2IpDQo+ID4gK3sNCj4gPiArICAgICB1MzIgb3B0czIg
PSBsZTMyX3RvX2NwdShkZXNjLT5kZXNjX3N0YXR1cy5vcHRzMik7DQo+ID4gKyAgICAgczMyIHJl
dCA9IC0xOw0KPiA+ICsNCj4gPiArI2lmZGVmIFJUQVNFX0RFQlVHDQo+ID4gKyAgICAgaWYgKG9w
dHMyICYgUlhfTEJLX0ZJRk9fRlVMTCkNCj4gPiArICAgICAgICAgICAgIHByX2FsZXJ0KCJQRiBy
ZWNlaXZlIGxvb3BiYWNrIGZpZm8gZnVsbC4uLiIpOw0KPiA+ICsNCj4gPiArI2VuZGlmDQo+ID4g
Kw0KPiA+ICsgICAgIGlmICgob3B0czIgJiBSWF9WTEFOX1RBRykgIT0gMHUpDQo+ID4gKyAgICAg
ICAgICAgICBfX3ZsYW5faHdhY2NlbF9wdXRfdGFnKHNrYiwgaHRvbnMoRVRIX1BfODAyMVEpLA0K
PiBzd2FiMTYob3B0czIgJiAweEZGRkZ1KSk7DQo+ID4gKw0KPiA+ICsgICAgIGRlc2MtPmRlc2Nf
c3RhdHVzLm9wdHMyID0gMDsNCj4gPiArICAgICByZXR1cm4gcmV0Ow0KPiA+ICt9DQo+ID4gKw0K
PiA+ICtzdGF0aWMgbmV0ZGV2X2ZlYXR1cmVzX3QgcnRhc2VfZml4X2ZlYXR1cmVzKHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYsDQo+IG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzKQ0KPiA+ICt7DQo+
ID4gKyAgICAgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0ZGV2X3ByaXYoZGV2KTsNCj4g
PiArICAgICBuZXRkZXZfZmVhdHVyZXNfdCBmZWF0dXJlc19maXggPSBmZWF0dXJlczsNCj4gPiAr
ICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOw0KPiA+ICsNCj4gPiArICAgICBzcGluX2xvY2tfaXJx
c2F2ZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiArICAgICBpZiAoZGV2LT5tdHUgPiBNU1NfTUFY
KQ0KPiA+ICsgICAgICAgICAgICAgZmVhdHVyZXNfZml4ICY9IH5ORVRJRl9GX0FMTF9UU087DQo+
ID4gKw0KPiA+ICsgICAgIGlmIChkZXYtPm10dSA+ICh1MzIpRVRIX0RBVEFfTEVOKSB7DQo+ID4g
KyAgICAgICAgICAgICBmZWF0dXJlc19maXggJj0gfk5FVElGX0ZfQUxMX1RTTzsNCj4gPiArICAg
ICAgICAgICAgIGZlYXR1cmVzX2ZpeCAmPSB+TkVUSUZfRl9BTExfQ1NVTTsNCj4gPiArICAgICB9
DQo+ID4gKyAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4g
PiArDQo+ID4gKyAgICAgcmV0dXJuIGZlYXR1cmVzX2ZpeDsNCj4gPiArfQ0KPiA+ICsNCj4gPiAr
c3RhdGljIHMzMiBydGFzZV9od19zZXRfZmVhdHVyZXMoY29uc3Qgc3RydWN0IG5ldF9kZXZpY2Ug
KmRldiwNCj4gbmV0ZGV2X2ZlYXR1cmVzX3QgZmVhdHVyZXMpDQo+ID4gK3sNCj4gPiArICAgICBj
b25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsg
ICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAgICB1MTYg
cnhfY29uZmlnOw0KPiA+ICsNCj4gPiArICAgICByeF9jb25maWcgPSBSVExfUjE2KFJYX0NPTkZJ
R18wKTsNCj4gPiArICAgICBpZiAoKGZlYXR1cmVzICYgTkVUSUZfRl9SWEFMTCkgIT0gMHUpDQo+
ID4gKyAgICAgICAgICAgICByeF9jb25maWcgfD0gKHUxNikoQUNDRVBUX0VSUiB8IEFDQ0VQVF9S
VU5UKTsNCj4gPiArICAgICBlbHNlDQo+ID4gKyAgICAgICAgICAgICByeF9jb25maWcgJj0gKHUx
NikofihBQ0NFUFRfRVJSIHwgQUNDRVBUX1JVTlQpKTsNCj4gPiArDQo+ID4gKyAgICAgUlRMX1cx
NihSWF9DT05GSUdfMCwgcnhfY29uZmlnKTsNCj4gPiArDQo+ID4gKyAgICAgcnhfY29uZmlnID0g
UlRMX1IxNihSWF9DT05GSUdfMSk7DQo+ID4gKyAgICAgaWYgKChkZXYtPmZlYXR1cmVzICYgTkVU
SUZfRl9IV19WTEFOX1JYKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIHJ4X2NvbmZpZyB8PSAo
dTE2KShJTk5FUl9WTEFOX0RFVEFHX0VOIHwNCj4gT1VURVJfVkxBTl9ERVRBR19FTik7DQo+ID4g
KyAgICAgZWxzZQ0KPiA+ICsgICAgICAgICAgICAgcnhfY29uZmlnICY9ICh1MTYpKH4oSU5ORVJf
VkxBTl9ERVRBR19FTiB8DQo+IE9VVEVSX1ZMQU5fREVUQUdfRU4pKTsNCj4gPiArDQo+ID4gKyAg
ICAgUlRMX1cxNihSWF9DT05GSUdfMSwgcnhfY29uZmlnKTsNCj4gPiArDQo+ID4gKyAgICAgaWYg
KChmZWF0dXJlcyAmIE5FVElGX0ZfUlhDU1VNKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIFJU
TF9XMTYoQ1BMVVNfQ01ELCAodTE2KShSVExfUjE2KENQTFVTX0NNRCkgfA0KPiBSWF9DSEtTVU0p
KTsNCj4gPiArICAgICBlbHNlDQo+ID4gKyAgICAgICAgICAgICBSVExfVzE2KENQTFVTX0NNRCwg
KHUxNikoUlRMX1IxNihDUExVU19DTUQpICYNCj4gflJYX0NIS1NVTSkpOw0KPiA+ICsNCj4gPiAr
ICAgICByZXR1cm4gMDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBydGFzZV9zZXRf
ZmVhdHVyZXMoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgbmV0ZGV2X2ZlYXR1cmVzX3QNCj4gZmVh
dHVyZXMpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRk
ZXZfcHJpdihkZXYpOw0KPiA+ICsgICAgIG5ldGRldl9mZWF0dXJlc190IGZlYXR1cmVzX3NldCA9
IGZlYXR1cmVzOw0KPiA+ICsgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7DQo+ID4gKw0KPiA+ICsg
ICAgIGZlYXR1cmVzX3NldCAmPSBORVRJRl9GX1JYQUxMIHwgTkVUSUZfRl9SWENTVU0gfA0KPiBO
RVRJRl9GX0hXX1ZMQU5fUlg7DQo+ID4gKw0KPiA+ICsgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZ0
cC0+bG9jaywgZmxhZ3MpOw0KPiA+ICsgICAgIGlmICgoZmVhdHVyZXNfc2V0IF4gZGV2LT5mZWF0
dXJlcykgIT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgIGlmIChydGFzZV9od19zZXRfZmVhdHVy
ZXMoZGV2LCBmZWF0dXJlc19zZXQpICE9IDApDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIG5l
dGRldl9hbGVydChkZXYsICJ1bmFibGUgdG8gc2V0IGh3IGZlYXR1cmVcbiIpOw0KPiA+ICsgICAg
IH0NCj4gPiArICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ0cC0+bG9jaywgZmxhZ3MpOw0K
PiA+ICsNCj4gPiArICAgICByZXR1cm4gMDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGNv
bnN0IGNoYXIgcnRhc2VfZ3N0cmluZ3NbXVtFVEhfR1NUUklOR19MRU5dID0gew0KPiA+ICsgICAg
ICJ0eF9wYWNrZXRzIiwgICAicnhfcGFja2V0cyIsICAgICAgICAgICAidHhfZXJyb3JzIiwNCj4g
InJ4X2Vycm9ycyIsICJyeF9taXNzZWQiLA0KPiA+ICsgICAgICJhbGlnbl9lcnJvcnMiLCAidHhf
c2luZ2xlX2NvbGxpc2lvbnMiLCAidHhfbXVsdGlfY29sbGlzaW9ucyIsICJ1bmljYXN0IiwNCj4g
ImJyb2FkY2FzdCIsDQo+ID4gKyAgICAgIm11bHRpY2FzdCIsICAgICJ0eF9hYm9ydGVkIiwgICAg
ICAgICAgICJ0eF91bmRlcnJ1biIsDQo+ID4gK307DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBy
dGFzZV9nZXRfbWFjX3ZlcnNpb24oc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwLCBjb25zdCB2b2lk
DQo+IF9faW9tZW0gKmlvYWRkcikNCj4gPiArew0KPiA+ICsgICAgIHUzMiByZWdfdmFsLCBod192
ZXI7DQo+ID4gKw0KPiA+ICsgICAgIHJlZ192YWwgPSBSVExfUjMyKFRYX0NPTkZJR18wKTsNCj4g
PiArICAgICBod192ZXIgPSByZWdfdmFsICYgMHg3QzgwMDAwMHU7DQo+ID4gKw0KPiA+ICsgICAg
IHN3aXRjaCAoaHdfdmVyKSB7DQo+ID4gKyAgICAgY2FzZSAweDAwODAwMDAwOg0KPiA+ICsgICAg
ICAgICAgICAgdHAtPm1jZmcgPSBDRkdfTUVUSE9EXzE7DQo+ID4gKyAgICAgICAgICAgICBicmVh
azsNCj4gPiArICAgICBjYXNlIDB4MDQwMDAwMDA6DQo+ID4gKyAgICAgY2FzZSAweDA0ODAwMDAw
Og0KPiA+ICsgICAgICAgICAgICAgdHAtPm1jZmcgPSBDRkdfTUVUSE9EXzE7DQo+ID4gKyAgICAg
ICAgICAgICB0cC0+cHRtX3N1cHBvcnQgPSAxOw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+
ID4gKw0KPiA+ICsgICAgIGRlZmF1bHQ6DQo+ID4gKyAgICAgICAgICAgICBuZXRkZXZfaW5mbyh0
cC0+ZGV2LCAidW5rbm93biBjaGlwIHZlcnNpb24gKCV4KVxuIiwNCj4gaHdfdmVyKTsNCj4gPiAr
ICAgICAgICAgICAgIHRwLT5tY2ZnID0gQ0ZHX01FVEhPRF9ERUZBVUxUOw0KPiA+ICsgICAgICAg
ICAgICAgdHAtPmh3X2ljX3Zlcl91bmtub3duID0gVFJVRTsNCj4gPiArICAgICAgICAgICAgIGJy
ZWFrOw0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2Vf
cHJpbnRfbWFjX3ZlcnNpb24oY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7
DQo+ID4gKyAgICAgczE2IGk7DQo+ID4gKyAgICAgYm9vbCBmbGFnID0gZmFsc2U7DQo+ID4gKw0K
PiA+ICsgICAgIGZvciAoaSA9IChzMTYpKEFSUkFZX1NJWkUocnRsX2NoaXBfaW5mbykgLSAxdSk7
IGkgPj0gMDsgaS0tKSB7DQo+ID4gKyAgICAgICAgICAgICBpZiAodHAtPm1jZmcgPT0gcnRsX2No
aXBfaW5mb1tpXS5tY2ZnKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGRwcmludGsoIlJl
YWx0ZWsgUENJZSBGYW1pbHkgQ29udHJvbGxlciBtY2ZnID0NCj4gJTA0ZFxuIiwNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBydGxfY2hpcF9pbmZvW2ldLm1jZmcpOw0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICBmbGFnID0gdHJ1ZTsNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgYnJlYWs7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiAr
ICAgICBpZiAoIWZsYWcpDQo+ID4gKyAgICAgICAgICAgICBkcHJpbnRrKCJtYWNfdmVyc2lvbiA9
PSBVbmtub3duXG4iKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfdGFs
bHlfY291bnRlcl9hZGRyX2ZpbGwoY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+
ICt7DQo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+
ICsNCj4gPiArICAgICBpZiAodHAtPnRhbGx5X3BhZGRyICE9IDB1KSB7DQo+ID4gKyAgICAgICAg
ICAgICBSVExfVzMyKERUQ0NSNCwgKHUzMikodHAtPnRhbGx5X3BhZGRyID4+IDMyKSk7DQo+ID4g
KyAgICAgICAgICAgICBSVExfVzMyKERUQ0NSMCwgKHUzMikodHAtPnRhbGx5X3BhZGRyICYNCj4g
KERNQV9CSVRfTUFTSygzMikpKSk7DQo+ID4gKyAgICAgfQ0KPiA+ICt9DQo+ID4gKw0KPiA+ICtz
dGF0aWMgdm9pZCBydGFzZV90YWxseV9jb3VudGVyX2NsZWFyKGNvbnN0IHN0cnVjdCBydGFzZV9w
cml2YXRlICp0cCkNCj4gPiArew0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAt
Pm1taW9fYWRkcjsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHRwLT50YWxseV9wYWRkciAhPSAwdSkg
ew0KPiA+ICsgICAgICAgICAgICAgUlRMX1czMihEVENDUjQsICh1MzIpKHRwLT50YWxseV9wYWRk
ciA+PiAzMikpOw0KPiA+ICsgICAgICAgICAgICAgUlRMX1czMihEVENDUjAsICh1MzIpKCh0cC0+
dGFsbHlfcGFkZHIgJg0KPiAoRE1BX0JJVF9NQVNLKDMyKSkpIHwgQ09VTlRFUl9SRVNFVCkpOw0K
PiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArI2lmZGVmIENPTkZJR19ORVRfUE9MTF9D
T05UUk9MTEVSDQo+ID4gKw0KPiA+ICsvKiBQb2xsaW5nICdpbnRlcnJ1cHQnIC0gdXNlZCBieSB0
aGluZ3MgbGlrZSBuZXRjb25zb2xlIHRvIHNlbmQgc2ticw0KPiA+ICsgKiB3aXRob3V0IGhhdmlu
ZyB0byByZS1lbmFibGUgaW50ZXJydXB0cy4gSXQncyBub3QgY2FsbGVkIHdoaWxlDQo+ID4gKyAq
IHRoZSBpbnRlcnJ1cHQgcm91dGluZSBpcyBleGVjdXRpbmcuDQo+ID4gKyAqLw0KPiA+ICtzdGF0
aWMgdm9pZCBydGFzZV9uZXRwb2xsKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpDQo+ID4gK3sNCj4g
PiArICAgICBjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihkZXYp
Ow0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gdHAtPnBkZXY7DQo+ID4g
Kw0KPiA+ICsgICAgIGRpc2FibGVfaXJxKHBkZXYtPmlycSk7DQo+ID4gKyAgICAgcnRhc2VfaW50
ZXJydXB0KChzMzIpcGRldi0+aXJxLCBkZXYpOw0KPiA+ICsgICAgIGVuYWJsZV9pcnEocGRldi0+
aXJxKTsNCj4gPiArfQ0KPiA+ICsjZW5kaWYNCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNl
X21ieF9zZXRfdmZtYyhjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAsIHU4IHZmbikNCj4g
PiArew0KPiA+ICsgICAgIGNvbnN0IHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRk
cjsNCj4gPiArDQo+ID4gKyAgICAgdHAtPnZmX2luZm9bdmZuXS5tY19maWx0ZXJbMF0gPSBSVExf
UjMyKFZGTVNHREFUQV8wICsgKCh1MzIpdmZuICoNCj4gOHUpKTsNCj4gPiArICAgICB0cC0+dmZf
aW5mb1t2Zm5dLm1jX2ZpbHRlclsxXSA9IFJUTF9SMzIoVkZNU0dEQVRBXzIgKyAoKHUzMil2Zm4g
Kg0KPiA4dSkpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9tc2dfd29y
ayhzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspDQo+ID4gK3sNCj4gPiArICAgICBzdGF0aWMgdm9p
ZCAoKmNvbnN0IHJ0YXNlX21ieF9mdW5jW10pKGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0
cCwNCj4gdTggdmZuKSA9IHsNCj4gPiArICAgICAgICAgICAgIHJ0YXNlX21ieF9zZXRfdmZtYywN
Cj4gPiArICAgICB9Ow0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9
IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QNCj4gcnRhc2VfcHJpdmF0ZSwgbXNnX3dvcmspOw0K
PiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAg
ICB1OCBzdGF0dXMgPSAwOw0KPiA+ICsNCj4gPiArICAgICBzdGF0dXMgPSBSVExfUjgoUEZNU0dJ
Q1JSRVEpOw0KPiA+ICsgICAgIGlmIChzdGF0dXMgIT0gMHUpIHsNCj4gPiArICAgICAgICAgICAg
IHUxNiBpID0gMHU7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgZm9yIChpID0gMHU7IGkgPCB0
cC0+bnVtX3ZmczsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGlmICgoc3RhdHVz
ICYgQklUKGkpKSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0
YXNlX21ieF9mdW5jWzBdKHRwLCBpKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBSVExfVzgoUEZNU0dWRjEgKyAoaSAqIDR1KSwNCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKHU4KShSVExfUjgoUEZNU0dWRjEgKw0KPiAoKHUzMilpICogNHUpKSB8
IEJJVCgxKSkpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICB9DQo+ID4gKyAgICAgICAgICAg
ICB9DQo+ID4gKyAgICAgICAgICAgICBydGFzZV9zZXRfbWFyKHRwKTsNCj4gPiArICAgICB9DQo+
ID4gKw0KPiA+ICsgICAgIFJUTF9XOChQRk1TR0lDUlJFUSwgc3RhdHVzKTsNCj4gPiArfQ0KPiA+
ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2Vfd2F0Y2hkb2dfd29yayhzdHJ1Y3Qgd29ya19zdHJ1
Y3QgKndvcmspDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBj
b250YWluZXJfb2Yod29yaywgc3RydWN0IHJ0YXNlX3ByaXZhdGUsDQo+IHdhdGNoZG9nX3dvcmsp
Ow0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiAr
ICAgICBzdHJ1Y3QgcnRhc2VfcmluZyAqcmluZyA9ICZ0cC0+dHhfcmluZ1swXTsNCj4gPiArDQo+
ID4gKyAgICAgLyogQ2hlY2sgaWYgdGhlcmUgaXMgYSBwYWNrZXQgdG8gdHJhbnNtaXQuICovDQo+
ID4gKyAgICAgaWYgKHJpbmctPmN1cl9pZHggIT0gcmluZy0+ZGlydHlfaWR4KSB7DQo+ID4gKyAg
ICAgICAgICAgICAvKiBEZXRlcm1pbmUgaWYgZGlydHlfaWR4IGhhcyBjaGFuZ2VkLiAqLw0KPiA+
ICsgICAgICAgICAgICAgaWYgKHJpbmctPmRpcnR5X2lkeCA9PSByaW5nLT5wcml2X2RpcnR5X2lk
eCkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAvKiBEZXRlcm1pbmUgd2hldGhlciB0aGUg
VHhmaWZvIGlzIGVtcHR5LiAqLw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBpZiAoKFJUTF9S
OChGSUZPUikgJiBUWF9GSUZPX0VNUFRZKSA9PQ0KPiBUWF9GSUZPX0VNUFRZKSB7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogSWYgaXQgaXMgcmVwZWF0ZWRseSBjaGVja2Vk
IHRoYXQgdGhlDQo+IGRpcnR5X2lkeCBoYXMgbm90IGNoYW5nZWQgMw0KPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAqIHRpbWVzLCB0aGUgc29mdHdhcmUgd2lsbCBiZSByZXNldC4N
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8NCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpZiAocmluZy0+ZHVwbGljYXRlX2RpcnR5X2NvdW50ID49DQo+IFRY
X0RVUExJQ0FURV9ESVJUWUlEWF9DT1VOVCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJ0YXNlX3N3X3Jlc2V0KHRwLT5kZXYpOw0KPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGVsc2UNCj4gPiArDQo+IHJpbmctPmR1cGxpY2F0ZV9kaXJ0eV9jb3Vu
dCsrOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHJpbmctPmR1cGxpY2F0ZV9kaXJ0eV9jb3VudCA9IDA7DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIH0NCj4gPiArICAgICAgICAgICAgIH0gZWxzZSB7DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIHJpbmctPmR1cGxpY2F0ZV9kaXJ0eV9jb3VudCA9IDA7DQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIHJpbmctPnByaXZfZGlydHlfaWR4ID0gcmluZy0+ZGly
dHlfaWR4Ow0KPiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAg
ICAgICAgICAgICByaW5nLT5kdXBsaWNhdGVfZGlydHlfY291bnQgPSAwOw0KPiA+ICsgICAgIH0N
Cj4gPiArDQo+ID4gKyAgICAgLyogcmVzZXQgdGltZXIgKi8NCj4gPiArICAgICBSVExfVzMyKFRD
VFIwLCAweDApOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9pbml0X2lu
dF92ZWN0b3Ioc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7DQo+ID4gKyAgICAgdTE2
IGkgPSAwdTsNCj4gPiArDQo+ID4gKyAgICAgLyogaW50ZXJydXB0IHZlY3RvciAwICovDQo+ID4g
KyAgICAgdHAtPmludF92ZWN0b3JbMF0udHAgPSB0cDsNCj4gPiArICAgICBtZW1zZXQodHAtPmlu
dF92ZWN0b3JbMF0ubmFtZSwgMHgwLCAyMCk7DQo+ID4gKyAgICAgdHAtPmludF92ZWN0b3JbMF0u
aW5kZXggPSAwOw0KPiA+ICsgICAgIHRwLT5pbnRfdmVjdG9yWzBdLmltcl9hZGRyID0gSU1SMDsN
Cj4gPiArICAgICB0cC0+aW50X3ZlY3RvclswXS5pc3JfYWRkciA9IElTUjA7DQo+ID4gKyAgICAg
dHAtPmludF92ZWN0b3JbMF0uaW1yID0gKHUzMikoUk9LIHwgUkRVIHwgVE9LIHwgTUJYIHwgVE9L
NCB8IFRPSzUNCj4gfCBUT0s2IHwgVE9LNyB8IFRJTUVPVVQwKTsNCj4gPiArICAgICBJTklUX0xJ
U1RfSEVBRCgmdHAtPmludF92ZWN0b3JbMF0ucmluZ19saXN0KTsNCj4gPiArICAgICB0cC0+aW50
X3ZlY3RvclswXS53ZWlnaHQgPSBSVEFTRV9OQVBJX1dFSUdIVDsNCj4gPiArICAgICB0cC0+aW50
X3ZlY3RvclswXS5wb2xsID0gcnRhc2VfcG9sbDsNCj4gPiArICAgICBuZXRpZl9uYXBpX2FkZCh0
cC0+ZGV2LCAmdHAtPmludF92ZWN0b3JbMF0ubmFwaSwNCj4gdHAtPmludF92ZWN0b3JbMF0ucG9s
bCwNCj4gPiArICAgICAgICAgICAgICAgICAgICB0cC0+aW50X3ZlY3RvclswXS53ZWlnaHQpOw0K
PiA+ICsgICAgIG5hcGlfZW5hYmxlKCZ0cC0+aW50X3ZlY3RvclswXS5uYXBpKTsNCj4gPiArDQo+
ID4gKyAgICAgLyogaW50ZXJydXB0IHZlY3RvciAxIH4gMyAqLw0KPiA+ICsgICAgIGZvciAoaSA9
IDE7IGkgPCB0cC0+aW50X251bXM7IGkrKykgew0KPiA+ICsgICAgICAgICAgICAgdHAtPmludF92
ZWN0b3JbaV0udHAgPSB0cDsNCj4gPiArICAgICAgICAgICAgIG1lbXNldCh0cC0+aW50X3ZlY3Rv
cltpXS5uYW1lLCAweDAsIDIwKTsNCj4gPiArICAgICAgICAgICAgIHRwLT5pbnRfdmVjdG9yW2ld
LmluZGV4ID0gaTsNCj4gPiArICAgICAgICAgICAgIHRwLT5pbnRfdmVjdG9yW2ldLmltcl9hZGRy
ID0gKElNUjEgKyAoKGkgLSAxdSkgKiA0dSkpOw0KPiA+ICsgICAgICAgICAgICAgdHAtPmludF92
ZWN0b3JbaV0uaXNyX2FkZHIgPSAoSVNSMSArICgoaSAtIDF1KSAqIDR1KSk7DQo+ID4gKyAgICAg
ICAgICAgICB0cC0+aW50X3ZlY3RvcltpXS5pbXIgPSAodTMyKShRX1JPSyB8IFFfUkRVIHwgUV9U
T0spOw0KPiA+ICsgICAgICAgICAgICAgSU5JVF9MSVNUX0hFQUQoJnRwLT5pbnRfdmVjdG9yW2ld
LnJpbmdfbGlzdCk7DQo+ID4gKyAgICAgICAgICAgICB0cC0+aW50X3ZlY3RvcltpXS53ZWlnaHQg
PSBSVEFTRV9OQVBJX1dFSUdIVDsNCj4gPiArICAgICAgICAgICAgIHRwLT5pbnRfdmVjdG9yW2ld
LnBvbGwgPSBydGFzZV9wb2xsOw0KPiA+ICsgICAgICAgICAgICAgbmV0aWZfbmFwaV9hZGQodHAt
PmRldiwgJnRwLT5pbnRfdmVjdG9yW2ldLm5hcGksDQo+IHRwLT5pbnRfdmVjdG9yW2ldLnBvbGws
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cC0+aW50X3ZlY3RvcltpXS53ZWln
aHQpOw0KPiA+ICsgICAgICAgICAgICAgbmFwaV9lbmFibGUoJnRwLT5pbnRfdmVjdG9yW2ldLm5h
cGkpOw0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2Vf
aW5pdF9zb2Z0d2FyZV92YXJpYWJsZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQ0KPiA+ICt7DQo+
ID4gKyAgICAgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0ZGV2X3ByaXYoZGV2KTsNCj4g
PiArDQo+ID4gKyAgICAgc3Bpbl9sb2NrX2luaXQoJnRwLT5sb2NrKTsNCj4gPiArDQo+ID4gKyAg
ICAgLyogYXNzaWduIG1vZHVsZSBwYXJhbWV0ZXJzICovDQo+ID4gKyAgICAgdHAtPnR4X3F1ZXVl
X2N0cmwgPSAodTE2KXR4cV9jdHJsOw0KPiA+ICsgICAgIHRwLT5mdW5jX3R4X3F1ZXVlX251bSA9
ICh1MTYpZnVuY190eHFfbnVtOw0KPiA+ICsgICAgIHRwLT5mdW5jX3J4X3F1ZXVlX251bSA9ICh1
MTYpZnVuY19yeHFfbnVtOw0KPiA+ICsgICAgIHRwLT5pbnRfbnVtcyA9ICh1MTYpaW50ZXJydXB0
X251bTsNCj4gPiArICAgICB0cC0+dHhfaW50X21pdCA9IFRYX0lOVF9NSVRJR0FUSU9OOw0KPiA+
ICsgICAgIHRwLT5yeF9pbnRfbWl0ID0gUlhfSU5UX01JVElHQVRJT047DQo+ID4gKw0KPiA+ICsg
ICAgIHRwLT5zd19mbGFnID0gMDsNCj4gPiArICAgICB0cC0+bnVtX3ZmcyA9IDA7DQo+ID4gKw0K
PiA+ICsgICAgIC8qIGluaXRpYWwgdGltZW91dCBzdGF0ZSAqLw0KPiA+ICsgICAgIHRwLT50aW1l
b3V0X3N0YXRlID0gVElNRU9VVF9JTklUOw0KPiA+ICsNCj4gPiArICAgICAvKiBuZXcsIGludGVy
cnV0cCB2YXJpYWJsZXMgaW5pdCAqLw0KPiA+ICsgICAgIHJ0YXNlX2luaXRfaW50X3ZlY3Rvcih0
cCk7DQo+ID4gKw0KPiA+ICsgICAgIHRwLT5tYXhfanVtYm9fZnJhbWVfc2l6ZSA9DQo+IHJ0bF9j
aGlwX2luZm9bdHAtPm1jZmddLmp1bWJvX2ZyYW1lX3N6Ow0KPiA+ICsgICAgIC8qIE1UVSByYW5n
ZTogNjAgLSBody1zcGVjaWZpYyBtYXggKi8NCj4gPiArICAgICBkZXYtPm1pbl9tdHUgPSBFVEhf
WkxFTjsNCj4gPiArICAgICBkZXYtPm1heF9tdHUgPSB0cC0+bWF4X2p1bWJvX2ZyYW1lX3NpemU7
DQo+ID4gKw0KPiA+ICsgICAgIElOSVRfV09SSygmdHAtPm1zZ193b3JrLCBydGFzZV9tc2dfd29y
ayk7DQo+ID4gKyAgICAgSU5JVF9XT1JLKCZ0cC0+d2F0Y2hkb2dfd29yaywgcnRhc2Vfd2F0Y2hk
b2dfd29yayk7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX2luaXRfaGFy
ZHdhcmUoY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7DQo+ID4gKyAgICAg
dm9pZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHUxNiBpOw0K
PiA+ICsNCj4gPiArICAgICAvKiB2bGFuIGZpbHRlciB0YWJsZSAqLw0KPiA+ICsgICAgIGZvciAo
aSA9IDB1OyBpIDwgVkxBTl9GSUxURVJfRU5UUllfTlVNOyBpKyspDQo+ID4gKyAgICAgICAgICAg
ICBSVExfVzMyKChWTEFOX0VOVFJZXzAgKyAoaSAqIDR1KSksIDApOw0KPiA+ICt9DQo+ID4gKw0K
PiA+ICtzdGF0aWMgdm9pZCBydGFzZV9yZWxlYXNlX2JvYXJkKHN0cnVjdCBwY2lfZGV2ICpwZGV2
LCBzdHJ1Y3QgbmV0X2RldmljZQ0KPiAqZGV2LCB2b2lkIF9faW9tZW0gKmlvYWRkcikNCj4gPiAr
ew0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2
KGRldik7DQo+ID4gKw0KPiA+ICsgICAgIHJ0YXNlX3Jhcl9zZXQodHAsIHRwLT5vcmdfbWFjX2Fk
ZHIpOw0KPiA+ICsgICAgIGlvdW5tYXAoaW9hZGRyKTsNCj4gPiArICAgICBpZiAoKHRwLT5zd19m
bGFnICYgU1dGX01TSVhfRU5BQkxFRCkgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICBwY2lfZGlz
YWJsZV9tc2l4KHBkZXYpOw0KPiA+ICsgICAgIGVsc2UNCj4gPiArICAgICAgICAgICAgIHBjaV9k
aXNhYmxlX21zaShwZGV2KTsNCj4gPiArDQo+ID4gKyAgICAgcGNpX3JlbGVhc2VfcmVnaW9ucyhw
ZGV2KTsNCj4gPiArICAgICBwY2lfZGlzYWJsZV9kZXZpY2UocGRldik7DQo+ID4gKyAgICAgZnJl
ZV9uZXRkZXYoZGV2KTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfaHdf
YWRkcmVzc19zZXQoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgY29uc3QgdTgNCj4gbWFjX2FkZHJb
TUFDX0FERFJfTEVOXSkNCj4gPiArew0KPiA+ICsgICAgIGV0aF9od19hZGRyX3NldChkZXYsIG1h
Y19hZGRyKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHMzMiBydGFzZV9nZXRfbWFjX2Fk
ZHJlc3Moc3RydWN0IG5ldF9kZXZpY2UgKmRldikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBy
dGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAgICAgY29uc3Qgdm9p
ZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHUzMiBpOw0KPiA+
ICsgICAgIHU4IG1hY19hZGRyW01BQ19BRERSX0xFTl07DQo+ID4gKw0KPiA+ICsgICAgIGZvciAo
aSA9IDA7IGkgPCBNQUNfQUREUl9MRU47IGkrKykNCj4gPiArICAgICAgICAgICAgIG1hY19hZGRy
W2ldID0gUlRMX1I4KE1BQzAgKyBpKTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKCFpc192YWxpZF9l
dGhlcl9hZGRyKG1hY19hZGRyKSkgew0KPiA+ICsgICAgICAgICAgICAgbmV0aWZfZXJyKHRwLCBw
cm9iZSwgZGV2LCAiSW52YWxpZCBldGhlciBhZGRyICVwTVxuIiwNCj4gbWFjX2FkZHIpOw0KPiA+
ICsgICAgICAgICAgICAgZXRoX2h3X2FkZHJfcmFuZG9tKGRldik7DQo+ID4gKyAgICAgICAgICAg
ICBldGhlcl9hZGRyX2NvcHkobWFjX2FkZHIsIGRldi0+ZGV2X2FkZHIpOw0KPiA+ICsgICAgICAg
ICAgICAgbmV0aWZfaW5mbyh0cCwgcHJvYmUsIGRldiwgIlJhbmRvbSBldGhlciBhZGRyICVwTVxu
IiwNCj4gbWFjX2FkZHIpOw0KPiA+ICsgICAgICAgICAgICAgdHAtPnJhbmRvbV9tYWMgPSAxOw0K
PiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgcnRhc2VfaHdfYWRkcmVzc19zZXQoZGV2LCBt
YWNfYWRkcik7DQo+ID4gKyAgICAgcnRhc2VfcmFyX3NldCh0cCwgbWFjX2FkZHIpOw0KPiA+ICsN
Cj4gPiArICAgICAvKiBrZWVwIHRoZSBvcmlnaW5hbCBNQUMgYWRkcmVzcyAqLw0KPiA+ICsgICAg
IG1lbWNweSh0cC0+b3JnX21hY19hZGRyLCBkZXYtPmRldl9hZGRyLCBNQUNfQUREUl9MRU4pOw0K
PiA+ICsgICAgIG1lbWNweShkZXYtPnBlcm1fYWRkciwgZGV2LT5kZXZfYWRkciwgZGV2LT5hZGRy
X2xlbik7DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiAwOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICsv
KiBydGFzZV9zZXRfbWFjX2FkZHJlc3MgLSBDaGFuZ2UgdGhlIEV0aGVybmV0IEFkZHJlc3Mgb2Yg
dGhlIE5JQw0KPiA+ICsgKiBAZGV2OiBuZXR3b3JrIGludGVyZmFjZSBkZXZpY2Ugc3RydWN0dXJl
DQo+ID4gKyAqIEBwOiAgIHBvaW50ZXIgdG8gYW4gYWRkcmVzcyBzdHJ1Y3R1cmUNCj4gPiArICoN
Cj4gPiArICogUmV0dXJuIDAgb24gc3VjY2VzcywgbmVnYXRpdmUgb24gZmFpbHVyZQ0KPiA+ICsg
Ki8NCj4gPiArc3RhdGljIGludCBydGFzZV9zZXRfbWFjX2FkZHJlc3Moc3RydWN0IG5ldF9kZXZp
Y2UgKmRldiwgdm9pZCAqcCkNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9wcml2YXRl
ICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IHNvY2thZGRy
ICphZGRyID0gcDsNCj4gPiArICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOw0KPiA+ICsgICAgIHMz
MiByYyA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIGlmICghaXNfdmFsaWRfZXRoZXJfYWRkcigodTgg
KikmYWRkci0+c2FfZGF0YSkpIHsNCj4gPiArICAgICAgICAgICAgIHJjID0gLUVBRERSTk9UQVZB
SUw7DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIHNwaW5fbG9ja19pcnFz
YXZlKCZ0cC0+bG9jaywgZmxhZ3MpOw0KPiA+ICsgICAgICAgICAgICAgcnRhc2VfaHdfYWRkcmVz
c19zZXQoZGV2LCAodTggKikmYWRkci0+c2FfZGF0YSk7DQo+ID4gKyAgICAgICAgICAgICBydGFz
ZV9yYXJfc2V0KHRwLCBkZXYtPmRldl9hZGRyKTsNCj4gPiArICAgICAgICAgICAgIHNwaW5fdW5s
b2NrX2lycXJlc3RvcmUoJnRwLT5sb2NrLCBmbGFncyk7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4g
PiArICAgICByZXR1cm4gcmM7DQo+ID4gK30NCj4gPiArDQo+ID4gKy8qIHJ0YXNlX3Jhcl9zZXQg
LSBQdXRzIGFuIGV0aGVybmV0IGFkZHJlc3MgaW50byBhIHJlY2VpdmUgYWRkcmVzcyByZWdpc3Rl
ci4NCj4gPiArICoNCj4gPiArICogdHAgLSBUaGUgcHJpdmF0ZSBkYXRhIHN0cnVjdHVyZSBmb3Ig
ZHJpdmVyDQo+ID4gKyAqIGFkZHIgLSBBZGRyZXNzIHRvIHB1dCBpbnRvIHJlY2VpdmUgYWRkcmVz
cyByZWdpc3Rlcg0KPiA+ICsgKi8NCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfcmFyX3NldChjb25z
dCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAsIGNvbnN0IHVpbnQ4X3QgKmFkZHIpDQo+ID4gK3sN
Cj4gPiArICAgICB2b2lkIF9faW9tZW0gKmlvYWRkciA9IHRwLT5tbWlvX2FkZHI7DQo+ID4gKyAg
ICAgdTMyIHJhcl9sb3cgPSAwOw0KPiA+ICsgICAgIHUzMiByYXJfaGlnaCA9IDA7DQo+ID4gKw0K
PiA+ICsgICAgIHJhcl9sb3cgPSAoKHVpbnQzMl90KWFkZHJbMF0gfCAoKHVpbnQzMl90KWFkZHJb
MV0gPDwgOCkgfA0KPiAoKHVpbnQzMl90KWFkZHJbMl0gPDwgMTYpDQo+ID4gKyAgICAgICAgICAg
ICAgICB8ICgodWludDMyX3QpYWRkclszXSA8PCAyNCkpOw0KPiA+ICsNCj4gPiArICAgICByYXJf
aGlnaCA9ICgodWludDMyX3QpYWRkcls0XSB8ICgodWludDMyX3QpYWRkcls1XSA8PCA4KSk7DQo+
ID4gKw0KPiA+ICsgICAgIHJ0YXNlX2VuYWJsZV9FRU1fd3JpdGUodHApOw0KPiA+ICsgICAgIFJU
TF9XMzIoTUFDMCwgcmFyX2xvdyk7DQo+ID4gKyAgICAgUlRMX1czMihNQUM0LCByYXJfaGlnaCk7
DQo+ID4gKyAgICAgcnRhc2VfZGlzYWJsZV9FRU1fd3JpdGUodHApOw0KPiA+ICsgICAgIFJUTF9X
MTYoTEJLX0NUUkwsICh1MTYpKExCS19BVExEIHwgTEJLX0NMUikpOw0KPiA+ICt9DQo+ID4gKw0K
PiA+ICtzdGF0aWMgczMyIHJlZ19mdW4oY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0
cnVjdCBydGFzZV9wcml2YXRlICp0cCkNCj4gPiArew0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAq
aW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAgICB2b2lkICp1c2VyYWRkciA9ICh2b2lk
ICopaWZyLT5pZnJfZGF0YTsNCj4gPiArICAgICBzdHJ1Y3QgcmVnX3J3IHJlZzsNCj4gPiArICAg
ICBzMzIgcmMgPSAwOw0KPiA+ICsNCj4gPiArICAgICBpZiAoY29weV9mcm9tX3VzZXIoJnJlZywg
dXNlcmFkZHIsIHNpemVvZihzdHJ1Y3QgcmVnX3J3KSkgIT0gMHUpIHsNCj4gPiArICAgICAgICAg
ICAgIHJjID0gLUVGQVVMVDsNCj4gPiArICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAg
IH0NCj4gPiArDQo+ID4gKyAgICAgLyogZGVidWcgY2hhbm5lbCByZWFkICovDQo+ID4gKyAgICAg
aWYgKHJlZy5jbWQgPT0gQ01EX0RCR19SRUFEKSB7DQo+ID4gKyAgICAgICAgICAgICByZWcudmFs
ID0gbWFjX29jcF9yZWFkKHRwLCByZWcuYWRkcik7DQo+ID4gKyAgICAgICAgICAgICBpZiAoY29w
eV90b191c2VyKHVzZXJhZGRyLCAmcmVnLCBzaXplb2Yoc3RydWN0IHJlZ19ydykpICE9IDB1KQ0K
PiB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJjID0gLUVGQVVMVDsNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAg
ICAgICAgICBuZXRkZXZfaW5mbyh0cC0+ZGV2LCAiXHRyZWFkIHJlZyAweCUwNHggPSAweCUwNHgi
LA0KPiByZWcuYWRkciwgcmVnLnZhbCk7DQo+ID4gKyAgICAgfQ0KPiA+ICsgICAgIC8qIGRlYnVn
IGNoYW5uZWwgd3JpdGUgKi8NCj4gPiArICAgICBlbHNlIGlmIChyZWcuY21kID09IENNRF9EQkdf
V1JJVEUpIHsNCj4gPiArICAgICAgICAgICAgIG1hY19vY3Bfd3JpdGUodHAsIHJlZy5hZGRyLCAo
dTE2KXJlZy52YWwpOw0KPiA+ICsgICAgICAgICAgICAgbmV0ZGV2X2luZm8odHAtPmRldiwgIlx0
d3JpdGUgcmVnIDB4JTA0eCA9IDB4JTA0eCIsDQo+IHJlZy5hZGRyLA0KPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgbWFjX29jcF9yZWFkKHRwLCByZWcuYWRkcikpOw0KPiA+ICsgICAgIH0N
Cj4gPiArICAgICAvKiBtbWlvIHJlYWQxNiAqLw0KPiA+ICsgICAgIGVsc2UgaWYgKHJlZy5jbWQg
PT0gQ01EX1JFR19SRUFEMTYpIHsNCj4gPiArICAgICAgICAgICAgIHJlZy52YWwgPSBSVExfUjE2
KHJlZy5hZGRyKTsNCj4gPiArICAgICAgICAgICAgIGlmIChjb3B5X3RvX3VzZXIodXNlcmFkZHIs
ICZyZWcsIHNpemVvZihzdHJ1Y3QgcmVnX3J3KSkgIT0gMHUpDQo+IHsNCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgcmMgPSAtRUZBVUxUOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBnb3Rv
IG91dDsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArICAgICAgICAgICAgIG5ldGRldl9pbmZv
KHRwLT5kZXYsICJcdHJlYWQgTU1JTyAweCUwNHggPSAweCUwNHgiLA0KPiByZWcuYWRkciwgcmVn
LnZhbCk7DQo+ID4gKyAgICAgfQ0KPiA+ICsgICAgIC8qIG1taW8gd3JpdGUxNiAqLw0KPiA+ICsg
ICAgIGVsc2UgaWYgKHJlZy5jbWQgPT0gQ01EX1JFR19XUklURTE2KSB7DQo+ID4gKyAgICAgICAg
ICAgICBSVExfVzE2KHJlZy5hZGRyLCAodTE2KXJlZy52YWwpOw0KPiA+ICsgICAgICAgICAgICAg
bmV0ZGV2X2luZm8odHAtPmRldiwgIlx0d3JpdGUgTU1JTyAweCUwNHggPSAweCUwNHgiLA0KPiBy
ZWcuYWRkciwgUlRMX1IxNihyZWcuYWRkcikpOw0KPiA+ICsgICAgIH0NCj4gPiArICAgICAvKiBt
bWlvIHJlYWQzMiAqLw0KPiA+ICsgICAgIGVsc2UgaWYgKHJlZy5jbWQgPT0gQ01EX1JFR19SRUFE
MzIpIHsNCj4gPiArICAgICAgICAgICAgIHJlZy52YWwgPSBSVExfUjMyKHJlZy5hZGRyKTsNCj4g
PiArICAgICAgICAgICAgIGlmIChjb3B5X3RvX3VzZXIodXNlcmFkZHIsICZyZWcsIHNpemVvZihz
dHJ1Y3QgcmVnX3J3KSkgIT0gMHUpDQo+IHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgcmMg
PSAtRUZBVUxUOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiArICAg
ICAgICAgICAgIH0NCj4gPiArICAgICAgICAgICAgIG5ldGRldl9pbmZvKHRwLT5kZXYsICJcdHJl
YWQgTU1JTyAweCUwNHggPSAweCUwOHgiLA0KPiByZWcuYWRkciwgcmVnLnZhbCk7DQo+ID4gKyAg
ICAgfQ0KPiA+ICsgICAgIC8qIG1taW8gd3JpdGUzMiAqLw0KPiA+ICsgICAgIGVsc2UgaWYgKHJl
Zy5jbWQgPT0gQ01EX1JFR19XUklURTMyKSB7DQo+ID4gKyAgICAgICAgICAgICBSVExfVzMyKHJl
Zy5hZGRyLCByZWcudmFsKTsNCj4gPiArICAgICAgICAgICAgIG5ldGRldl9pbmZvKHRwLT5kZXYs
ICJcdHdyaXRlIE1NSU8gMHglMDR4ID0gMHglMDh4IiwNCj4gcmVnLmFkZHIsIFJUTF9SMTYocmVn
LmFkZHIpKTsNCj4gPiArICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAgICAgICAgbmV0ZGV2X2lu
Zm8odHAtPmRldiwgInJlZyBjb21tYW5kIGVycm9yLlxuIik7DQo+ID4gKyAgICAgfQ0KPiA+ICsg
ICAgIHByX2luZm8oIlx0XG4iKTsNCj4gPiArDQo+ID4gK291dDoNCj4gPiArICAgICByZXR1cm4g
cmM7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBzMzIgcnRhc2Vfcnhxb3MoY29uc3Qgc3Ry
dWN0IGlmcmVxICppZnIsIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCkNCj4gPiArew0K
PiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAg
ICB2b2lkICp1c2VyYWRkciA9ICh2b2lkICopaWZyLT5pZnJfZGF0YTsNCj4gPiArICAgICBzdHJ1
Y3QgcnRrX3FvcyBxb3NfY29uZmlnOw0KPiA+ICsgICAgIHUxNiBvZmZzZXQgPSAwOw0KPiA+ICsg
ICAgIHUzMiByZWdWID0gMDsNCj4gPiArICAgICBzMzIgcmMgPSAwOw0KPiA+ICsNCj4gPiArICAg
ICBpZiAoY29weV9mcm9tX3VzZXIoJnFvc19jb25maWcsIHVzZXJhZGRyLCBzaXplb2Yoc3RydWN0
IHJ0a19xb3MpKSAhPQ0KPiAwdSkgew0KPiA+ICsgICAgICAgICAgICAgcmMgPSAtRUZBVUxUOw0K
PiA+ICsgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAg
ICBpZiAocW9zX2NvbmZpZy5wY3AgPCA0dSkNCj4gPiArICAgICAgICAgICAgIG9mZnNldCA9ICgo
dTE2KXFvc19jb25maWcucGNwICogM3UpOw0KPiA+ICsgICAgIGVsc2UgaWYgKHFvc19jb25maWcu
cGNwIDwgOHUpDQo+ID4gKyAgICAgICAgICAgICBvZmZzZXQgPSAoKCgodTE2KXFvc19jb25maWcu
cGNwIC0gNHUpICogM3UpICsgMTZ1KTsNCj4gPiArICAgICBlbHNlDQo+ID4gKyAgICAgICAgICAg
ICBvZmZzZXQgPSAyODsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHFvc19jb25maWcuY21kID09IENN
RF9HRVRfUlhRT1MpIHsNCj4gPiArICAgICAgICAgICAgIHJlZ1YgPSBSVExfUjMyKFJYX1BDUF9U
QUJMRSk7DQo+ID4gKyAgICAgICAgICAgICBxb3NfY29uZmlnLnRjID0gKHU4KSgocmVnViA+PiBv
ZmZzZXQpICYgMHg3dSk7DQo+ID4gKyAgICAgICAgICAgICBpZiAoY29weV90b191c2VyKHVzZXJh
ZGRyLCAmcW9zX2NvbmZpZywgc2l6ZW9mKHN0cnVjdA0KPiBydGtfcW9zKSkgIT0gMHUpIHsNCj4g
PiArICAgICAgICAgICAgICAgICAgICAgcmMgPSAtRUZBVUxUOw0KPiA+ICsgICAgICAgICAgICAg
ICAgICAgICBnb3RvIG91dDsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArICAgICB9IGVsc2Ug
aWYgKHFvc19jb25maWcuY21kID09IENNRF9TRVRfUlhRT1MpIHsNCj4gPiArICAgICAgICAgICAg
IHJlZ1YgPSBSVExfUjMyKFJYX1BDUF9UQUJMRSk7DQo+ID4gKyAgICAgICAgICAgICByZWdWICY9
IH4oKHUzMikweDd1IDw8IG9mZnNldCk7DQo+ID4gKyAgICAgICAgICAgICByZWdWIHw9ICgodTMy
KXFvc19jb25maWcudGMgPDwgb2Zmc2V0KTsNCj4gPiArICAgICAgICAgICAgIFJUTF9XMzIoUlhf
UENQX1RBQkxFLCByZWdWKTsNCj4gPiArICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAgICAgICAg
bmV0ZGV2X2luZm8odHAtPmRldiwgInJ4cW9zIGNvbW1hbmQgZXJyb3IuXG4iKTsNCj4gPiArICAg
ICB9DQo+ID4gKyAgICAgcHJfaW5mbygiXHRcbiIpOw0KPiA+ICsNCj4gPiArb3V0Og0KPiA+ICsg
ICAgIHJldHVybiByYzsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHMzMiB0aW1lb3V0X3Np
Zyhjb25zdCBzdHJ1Y3QgaWZyZXEgKmlmciwgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+
ICt7DQo+ID4gKyAgICAgdm9pZCAqdXNlcmFkZHIgPSAodm9pZCAqKWlmci0+aWZyX2RhdGE7DQo+
ID4gKyAgICAgc3RydWN0IHJ0a190aW1lb3V0X3NpZyBydGtfdGltZW91dF9zaWc7DQo+ID4gKyAg
ICAgczMyIHJjID0gMDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKGNvcHlfZnJvbV91c2VyKCZydGtf
dGltZW91dF9zaWcsIHVzZXJhZGRyLCBzaXplb2Yoc3RydWN0DQo+IHJ0a190aW1lb3V0X3NpZykp
ICE9IDB1KSB7DQo+ID4gKyAgICAgICAgICAgICByYyA9IC1FRkFVTFQ7DQo+ID4gKyAgICAgfSBl
bHNlIHsNCj4gPiArICAgICAgICAgICAgIGlmIChydGtfdGltZW91dF9zaWcuY21kID09IENNRF9H
RVRfVElNU0lHKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJ0a190aW1lb3V0X3NpZy5z
dGF0ZSA9IHRwLT50aW1lb3V0X3N0YXRlOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgaWYgKGNvcHlfdG9fdXNlcih1c2VyYWRkciwgJnJ0a190aW1lb3V0X3NpZywNCj4gc2l6ZW9m
KHN0cnVjdCBydGtfdGltZW91dF9zaWcpKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
IT0gMHUpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmMgPSAtRUZBVUxUOw0K
PiA+ICsgICAgICAgICAgICAgfSBlbHNlIGlmIChydGtfdGltZW91dF9zaWcuY21kID09IENNRF9T
RVRfVElNU0lHKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHRwLT50aW1lb3V0X3N0YXRl
ID0gcnRrX3RpbWVvdXRfc2lnLnN0YXRlOw0KPiA+ICsgICAgICAgICAgICAgfSBlbHNlIHsNCj4g
PiArICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2luZm8odHAtPmRldiwgIiVzIGNvbW1hbmQg
ZXJyb3IuXG4iLA0KPiBfX2Z1bmNfXyk7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAg
fQ0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gcmM7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRp
YyBzMzIgcnRhc2VfcHRtKGNvbnN0IHN0cnVjdCBpZnJlcSAqaWZyLCBjb25zdCBzdHJ1Y3QgcnRh
c2VfcHJpdmF0ZSAqdHApDQo+ID4gK3sNCj4gPiArICAgICBjb25zdCB2b2lkICp1c2VyYWRkciA9
ICh2b2lkICopaWZyLT5pZnJfZGF0YTsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHRtX2NtZF90
IGNtZDsNCj4gPiArICAgICBzMzIgcmV0Ow0KPiA+ICsgICAgIHUzMiBzaXplOw0KPiA+ICsNCj4g
PiArICAgICBzdGF0aWMgczMyICgqY29uc3QgcHRtX2NtZF9pbmZvW10pKGNvbnN0IHN0cnVjdCBp
ZnJlcSAqaWZyLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUNCj4gKnRwKSA9IHsNCj4gPiArICAgICAgICAgICAg
IHJ0YXNlX3B0bV9mdW5jdGlvbiwgcnRhc2VfcHRtX2dldF9jbG9jaywNCj4gcnRhc2VfcHRtX3N3
Y19nZXQsICAgICBydGFzZV9wdG1fcmVnX2dldCwNCj4gPiArICAgICAgICAgICAgIHJ0YXNlX3B0
bV9zd2Nfc2V0LCAgcnRhc2VfcHRtX3JlZ19zZXQsDQo+IHJ0YXNlX3B0bV9hdXRvX3VwZGF0ZSwN
Cj4gPiArICAgICB9Ow0KPiA+ICsNCj4gPiArICAgICBpZiAoY29weV9mcm9tX3VzZXIoJmNtZCwg
dXNlcmFkZHIsIHNpemVvZihzdHJ1Y3QNCj4gcnRhc2VfcHRtX2NtZF90KSkgIT0gMHUpIHsNCj4g
PiArICAgICAgICAgICAgIHJldCA9IC1FRkFVTFQ7DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiAr
ICAgICAgICAgICAgIHNpemUgPSAodTMyKUFSUkFZX1NJWkUocHRtX2NtZF9pbmZvKTsNCj4gPiAr
DQo+ID4gKyAgICAgICAgICAgICBpZiAoY21kLnR5cGUgPj0gc2l6ZSkNCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgcmV0ID0gLUVGQVVMVDsNCj4gPiArICAgICAgICAgICAgIGVsc2UNCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgcmV0ID0gcHRtX2NtZF9pbmZvW2NtZC50eXBlXShpZnIsIHRw
KTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4g
PiArDQo+ID4gK3N0YXRpYyBzMzIgcnRhc2VfcHRtX2Z1bmN0aW9uKGNvbnN0IHN0cnVjdCBpZnJl
cSAqaWZyLCBjb25zdCBzdHJ1Y3QNCj4gcnRhc2VfcHJpdmF0ZSAqdHApDQo+ID4gK3sNCj4gPiAr
ICAgICBjb25zdCB2b2lkICp1c2VyYWRkciA9ICh2b2lkICopaWZyLT5pZnJfZGF0YTsNCj4gPiAr
ICAgICBzdHJ1Y3QgcnRhc2VfcHRtX2NtZF90IGNtZDsNCj4gPiArICAgICBzdHJ1Y3QgcGNpX2Rl
diAqcGRldiA9IHRwLT5wZGV2Ow0KPiA+ICsgICAgIHMzMiBwdG1fcG9zID0gMDsNCj4gPiArICAg
ICBzMzIgcmV0ID0gMDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKGNvcHlfZnJvbV91c2VyKCZjbWQs
IHVzZXJhZGRyLCBzaXplb2Yoc3RydWN0DQo+IHJ0YXNlX3B0bV9jbWRfdCkpICE9IDB1KSB7DQo+
ID4gKyAgICAgICAgICAgICByZXQgPSAtRUZBVUxUOw0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4g
KyAgICAgICAgICAgICBwdG1fcG9zID0gKHMzMikocGNpX2ZpbmRfZXh0X2NhcGFiaWxpdHkocGRl
diwNCj4gUENJX0VYVF9DQVBfSURfUFRNKSk7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgaWYg
KHB0bV9wb3MgPT0gMCkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfaW5mbyh0
cC0+ZGV2LCAiY2FuJ3QgZmluZCBwdG0gcG9zaXRpb24uIik7DQo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgIHJldCA9IC1FRkFVTFQ7DQo+ID4gKyAgICAgICAgICAgICB9IGVsc2Ugew0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICBpZiAoY21kLmVuYWJsZSA9PSAxdSkgew0KPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIC8qIHB0bSBlbmFibGUgKi8NCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwY2lfd3JpdGVfY29uZmlnX2J5dGUocGRldiwgcHRtX3BvcyArDQo+
IDgsIDB4MXUpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNtZC5lbmFi
bGUgPT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBwdG0gZGlz
YWJsZSAqLw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBjaV93cml0ZV9jb25m
aWdfYnl0ZShwZGV2LCBwdG1fcG9zICsNCj4gOCwgMHgwdSk7DQo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2
X2luZm8odHAtPmRldiwgIiVzIGNvbW1hbmQNCj4gZXJyb3IuXG4iLCBfX2Z1bmNfXyk7DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIH0NCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArICAgICB9
DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRp
YyBzMzIgcnRhc2VfcHRtX3JlZ19nZXQoY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0
cnVjdA0KPiBydGFzZV9wcml2YXRlICp0cCkNCj4gPiArew0KPiA+ICsgICAgIGNvbnN0IHZvaWQg
X19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAgICB2b2lkICp1c2VyYWRk
ciA9ICh2b2lkICopaWZyLT5pZnJfZGF0YTsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHRtX2Nt
ZF90IGNtZDsNCj4gPiArICAgICBzMzIgcmV0ID0gMDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKGNv
cHlfZnJvbV91c2VyKCZjbWQsIHVzZXJhZGRyLCBzaXplb2Yoc3RydWN0DQo+IHJ0YXNlX3B0bV9j
bWRfdCkpICE9IDB1KSB7DQo+ID4gKyAgICAgICAgICAgICByZXQgPSAtRUZBVUxUOw0KPiA+ICsg
ICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICBjbWQucmVnX3ZhbHVlID0gUlRMX1IxNihj
bWQucmVnX2FkZHIpOw0KPiA+ICsgICAgICAgICAgICAgaWYgKGNvcHlfdG9fdXNlcih1c2VyYWRk
ciwgJmNtZCwgc2l6ZW9mKHN0cnVjdA0KPiBydGFzZV9wdG1fY21kX3QpKSAhPSAwdSkNCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVGQVVMVDsNCj4gPiArICAgICB9DQo+ID4gKw0K
PiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBzMzIgcnRh
c2VfcHRtX3JlZ19zZXQoY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0cnVjdA0KPiBy
dGFzZV9wcml2YXRlICp0cCkNCj4gPiArew0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRy
ID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAgICBjb25zdCB2b2lkICp1c2VyYWRkciA9ICh2b2lk
ICopaWZyLT5pZnJfZGF0YTsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHRtX2NtZF90IGNtZDsN
Cj4gPiArICAgICBzMzIgcmV0ID0gMDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKGNvcHlfZnJvbV91
c2VyKCZjbWQsIHVzZXJhZGRyLCBzaXplb2Yoc3RydWN0DQo+IHJ0YXNlX3B0bV9jbWRfdCkpICE9
IDB1KSB7DQo+ID4gKyAgICAgICAgICAgICByZXQgPSAtRUZBVUxUOw0KPiA+ICsgICAgIH0gZWxz
ZSB7DQo+ID4gKyAgICAgICAgICAgICBpZiAoY21kLmJpdHMgPT0gMTZ1KQ0KPiA+ICsgICAgICAg
ICAgICAgICAgICAgICBSVExfVzE2KGNtZC5yZWdfYWRkciwgKHUxNiljbWQucmVnX3ZhbHVlKTsN
Cj4gPiArICAgICAgICAgICAgIGVsc2UgaWYgKGNtZC5iaXRzID09IDMydSkNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgUlRMX1czMihjbWQucmVnX2FkZHIsIGNtZC5yZWdfdmFsdWUpOw0KPiA+
ICsgICAgICAgICAgICAgZWxzZQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfaW5m
byh0cC0+ZGV2LCAiJXMgY29tbWFuZCBlcnJvci5cbiIsDQo+IF9fZnVuY19fKTsNCj4gPiArICAg
ICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0
YXRpYyBzMzIgcnRhc2VfcHRtX2F1dG9fdXBkYXRlKGNvbnN0IHN0cnVjdCBpZnJlcSAqaWZyLCBj
b25zdCBzdHJ1Y3QNCj4gcnRhc2VfcHJpdmF0ZSAqdHApDQo+ID4gK3sNCj4gPiArICAgICBjb25z
dCB2b2lkICp1c2VyYWRkciA9ICh2b2lkICopaWZyLT5pZnJfZGF0YTsNCj4gPiArICAgICBzdHJ1
Y3QgcGNpX2RldiAqcGRldiA9IHRwLT5wZGV2Ow0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9wdG1f
Y21kX3QgY21kOw0KPiA+ICsgICAgIHMzMiBwdG1fcG9zID0gMDsNCj4gPiArICAgICBzMzIgcmV0
ID0gMDsNCj4gPiArDQo+ID4gKyAgICAgcHRtX3BvcyA9IChzMzIpKHBjaV9maW5kX2V4dF9jYXBh
YmlsaXR5KHBkZXYsDQo+IFBDSV9FWFRfQ0FQX0lEX1BUTSkpOw0KPiA+ICsNCj4gPiArICAgICBp
ZiAoY29weV9mcm9tX3VzZXIoJmNtZCwgdXNlcmFkZHIsIHNpemVvZihzdHJ1Y3QNCj4gcnRhc2Vf
cHRtX2NtZF90KSkgIT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgIHJldCA9IC1FRkFVTFQ7DQo+
ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIGlmIChwdG1fcG9zID09IDApIHsN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X3dhcm4odHAtPmRldiwgImNhbid0IGZp
bmQgcHRtIHBvc2l0aW9uLiIpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICByZXQgPSAtRUZB
VUxUOw0KPiA+ICsgICAgICAgICAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgaWYgKGNtZC5lbmFibGUgPT0gMXUpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcGNpX3dyaXRlX2NvbmZpZ19ieXRlKHBkZXYsIHB0bV9wb3MgKw0KPiAyMCwgMHgxdSk7DQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIGVsc2UNCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBwY2lfd3JpdGVfY29uZmlnX2J5dGUocGRldiwgcHRtX3BvcyArDQo+IDIwLCAweDB1
KTsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHJl
dHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4NCj4gKy8qKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KPiAqKioqKioqKioqKioq
KioqDQo+ID4gKyAqIEV0aHRvb2wgT3BlcmF0aW9ucw0KPiA+ICsNCj4gKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KPiAqKioq
KioqKioqKioqKi8NCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfZ2V0X2RydmluZm8oc3RydWN0IG5l
dF9kZXZpY2UgKmRldiwgc3RydWN0IGV0aHRvb2xfZHJ2aW5mbw0KPiAqZHJ2aW5mbykNCj4gPiAr
ew0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2
KGRldik7DQo+ID4gKw0KPiA+ICsgICAgIHN0cnNjcHkoZHJ2aW5mby0+ZHJpdmVyLCBNT0RVTEVO
QU1FLCAzMik7DQo+ID4gKyAgICAgc3Ryc2NweShkcnZpbmZvLT52ZXJzaW9uLCBSVEFTRV9WRVJT
SU9OLCAzMik7DQo+ID4gKyAgICAgc3Ryc2NweShkcnZpbmZvLT5idXNfaW5mbywgcGNpX25hbWUo
dHAtPnBkZXYpLCAzMik7DQo+ID4gK30NCj4gPiArDQo+ID4gKyN1bmRlZiBldGh0b29sX29wX2dl
dF9saW5rDQo+ID4gKyNkZWZpbmUgZXRodG9vbF9vcF9nZXRfbGluayBfa2NfZXRodG9vbF9vcF9n
ZXRfbGluaw0KPiA+ICtzdGF0aWMgdTMyIF9rY19ldGh0b29sX29wX2dldF9saW5rKHN0cnVjdCBu
ZXRfZGV2aWNlICpkZXYpDQo+ID4gK3sNCj4gPiArICAgICByZXR1cm4gbmV0aWZfY2Fycmllcl9v
ayhkZXYpID8gMXUgOiAwdTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBydGFzZV9n
ZXRfc2V0dGluZ3Moc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgc3RydWN0DQo+IGV0aHRvb2xfbGlu
a19rc2V0dGluZ3MgKmNtZCkNCj4gPiArew0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBydGFzZV9w
cml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAgICAgY29uc3Qgdm9pZCBfX2lv
bWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHUzMiBzdXBwb3J0ZWQgPSAw
Ow0KPiA+ICsgICAgIHUzMiBhZHZlcnRpc2luZyA9IDA7DQo+ID4gKyAgICAgdTMyIHNwZWVkID0g
MDsNCj4gPiArICAgICB1MTYgdmFsdWUgPSAwOw0KPiA+ICsNCj4gPiArICAgICBzdXBwb3J0ZWQg
fD0gKHUzMikoU1VQUE9SVEVEX01JSSB8IFNVUFBPUlRFRF9QYXVzZSk7DQo+ID4gKw0KPiA+ICsg
ICAgIGFkdmVydGlzaW5nIHw9ICh1MzIpQURWRVJUSVNFRF9NSUk7DQo+ID4gKw0KPiA+ICsgICAg
IC8qIHNwZWVkICovDQo+ID4gKyAgICAgc3dpdGNoICh0cC0+cGRldi0+YnVzLT5jdXJfYnVzX3Nw
ZWVkKSB7DQo+ID4gKyAgICAgY2FzZSBQQ0lFX1NQRUVEXzJfNUdUOg0KPiA+ICsgICAgICAgICAg
ICAgc3BlZWQgPSBTUEVFRF8xMDAwOw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAg
ICAgY2FzZSBQQ0lFX1NQRUVEXzVfMEdUOg0KPiA+ICsgICAgICAgICAgICAgc3BlZWQgPSBTUEVF
RF8yNTAwOw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAgICAgY2FzZSBQQ0lFX1NQ
RUVEXzhfMEdUOg0KPiA+ICsgICAgICAgICAgICAgc3BlZWQgPSBTUEVFRF81MDAwOw0KPiA+ICsg
ICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAgICAgZGVmYXVsdDoNCj4gPiArICAgICAgICAgICAg
IC8qIG5vdGhpbmcgdG8gZG8uICovDQo+ID4gKyAgICAgICAgICAgICBicmVhazsNCj4gPiArICAg
ICB9DQo+ID4gKw0KPiA+ICsgICAgIC8qIHBhdXNlICovDQo+ID4gKyAgICAgdmFsdWUgPSBSVExf
UjE2KENQTFVTX0NNRCk7DQo+ID4gKyAgICAgaWYgKCh2YWx1ZSAmIChGT1JDRV9UWEZMT1dfRU4g
fCBGT1JDRV9SWEZMT1dfRU4pKSA9PQ0KPiAoRk9SQ0VfVFhGTE9XX0VOIHwgRk9SQ0VfUlhGTE9X
X0VOKSkNCj4gPiArICAgICAgICAgICAgIGFkdmVydGlzaW5nIHw9ICh1MzIpQURWRVJUSVNFRF9Q
YXVzZTsNCj4gPiArICAgICBlbHNlIGlmICgodmFsdWUgJiBGT1JDRV9UWEZMT1dfRU4pICE9IDB1
KQ0KPiA+ICsgICAgICAgICAgICAgYWR2ZXJ0aXNpbmcgfD0gKHUzMilBRFZFUlRJU0VEX0FzeW1f
UGF1c2U7DQo+ID4gKyAgICAgZWxzZSBpZiAoKHZhbHVlICYgRk9SQ0VfUlhGTE9XX0VOKSAhPSAw
dSkNCj4gPiArICAgICAgICAgICAgIGFkdmVydGlzaW5nIHw9ICh1MzIpKEFEVkVSVElTRURfUGF1
c2UgfA0KPiBBRFZFUlRJU0VEX0FzeW1fUGF1c2UpOw0KPiA+ICsgICAgIGVsc2UNCj4gPiArICAg
ICAgICAgICAgIG5ldGRldl9pbmZvKGRldiwgInBhdXNlIGlzIGRpc2FibGVcbiIpOw0KPiA+ICsN
Cj4gPiArDQo+IGV0aHRvb2xfY29udmVydF9sZWdhY3lfdTMyX3RvX2xpbmtfbW9kZShjbWQtPmxp
bmtfbW9kZXMuc3VwcG9ydGVkLA0KPiBzdXBwb3J0ZWQpOw0KPiA+ICsNCj4gZXRodG9vbF9jb252
ZXJ0X2xlZ2FjeV91MzJfdG9fbGlua19tb2RlKGNtZC0+bGlua19tb2Rlcy5hZHZlcnRpc2luZywN
Cj4gYWR2ZXJ0aXNpbmcpOw0KPiA+ICsgICAgIGNtZC0+YmFzZS5zcGVlZCA9IHNwZWVkOw0KPiA+
ICsgICAgIGNtZC0+YmFzZS5kdXBsZXggPSBEVVBMRVhfRlVMTDsNCj4gPiArICAgICBjbWQtPmJh
c2UucG9ydCA9IFBPUlRfTUlJOw0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gMDsNCj4gPiArfQ0K
PiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfZ2V0X3BhdXNlcGFyYW0oc3RydWN0IG5ldF9k
ZXZpY2UgKmRldiwgc3RydWN0DQo+IGV0aHRvb2xfcGF1c2VwYXJhbSAqcGF1c2UpDQo+ID4gK3sN
Cj4gPiArICAgICBjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihk
ZXYpOw0KPiA+ICsgICAgIGNvbnN0IHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRk
cjsNCj4gPiArICAgICB1MTYgdmFsdWUgPSBSVExfUjE2KENQTFVTX0NNRCk7DQo+ID4gKw0KPiA+
ICsgICAgIGlmICgodmFsdWUgJiAoRk9SQ0VfVFhGTE9XX0VOIHwgRk9SQ0VfUlhGTE9XX0VOKSkg
PT0NCj4gKEZPUkNFX1RYRkxPV19FTiB8IEZPUkNFX1JYRkxPV19FTikpIHsNCj4gPiArICAgICAg
ICAgICAgIHBhdXNlLT5yeF9wYXVzZSA9IDE7DQo+ID4gKyAgICAgICAgICAgICBwYXVzZS0+dHhf
cGF1c2UgPSAxOw0KPiA+ICsgICAgIH0gZWxzZSBpZiAoKHZhbHVlICYgRk9SQ0VfVFhGTE9XX0VO
KSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAgcGF1c2UtPnR4X3BhdXNlID0gMTsNCj4gPiAr
ICAgICB9IGVsc2UgaWYgKCh2YWx1ZSAmIEZPUkNFX1JYRkxPV19FTikgIT0gMHUpIHsNCj4gPiAr
ICAgICAgICAgICAgIHBhdXNlLT5yeF9wYXVzZSA9IDE7DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4g
PiArICAgICAgICAgICAgIC8qIG5vdCBlbmFibGUgcGF1c2UgKi8NCj4gPiArICAgICB9DQo+ID4g
K30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgcnRhc2Vfc2V0X3BhdXNlcGFyYW0oc3RydWN0IG5l
dF9kZXZpY2UgKmRldiwgc3RydWN0DQo+IGV0aHRvb2xfcGF1c2VwYXJhbSAqcGF1c2UpDQo+ID4g
K3sNCj4gPiArICAgICBjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJp
dihkZXYpOw0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsN
Cj4gPiArICAgICB1MTYgdmFsdWUgPSBSVExfUjE2KENQTFVTX0NNRCk7DQo+ID4gKw0KPiA+ICsg
ICAgIHZhbHVlICY9ICh1MTYpKH4oRk9SQ0VfVFhGTE9XX0VOIHwgRk9SQ0VfUlhGTE9XX0VOKSk7
DQo+ID4gKw0KPiA+ICsgICAgIGlmIChwYXVzZS0+dHhfcGF1c2UgPT0gMXUpDQo+ID4gKyAgICAg
ICAgICAgICB2YWx1ZSB8PSAodTE2KUZPUkNFX1RYRkxPV19FTjsNCj4gPiArDQo+ID4gKyAgICAg
aWYgKHBhdXNlLT5yeF9wYXVzZSA9PSAxdSkNCj4gPiArICAgICAgICAgICAgIHZhbHVlIHw9ICh1
MTYpRk9SQ0VfUlhGTE9XX0VOOw0KPiA+ICsNCj4gPiArICAgICBSVExfVzE2KENQTFVTX0NNRCwg
dmFsdWUpOw0KPiA+ICsgICAgIHJldHVybiAwOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMg
dTMyIHJ0YXNlX2dldF9tc2dsZXZlbChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQ0KPiA+ICt7DQo+
ID4gKyAgICAgY29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0ZGV2X3ByaXYoZGV2
KTsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIHRwLT5tc2dfZW5hYmxlOw0KPiA+ICt9DQo+ID4g
Kw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9zZXRfbXNnbGV2ZWwoc3RydWN0IG5ldF9kZXZpY2Ug
KmRldiwgdTMyIHZhbHVlKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX3ByaXZhdGUg
KnRwID0gbmV0ZGV2X3ByaXYoZGV2KTsNCj4gPiArDQo+ID4gKyAgICAgdHAtPm1zZ19lbmFibGUg
PSB2YWx1ZTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfZ2V0X3N0cmlu
Z3Moc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgdTMyIHN0cmluZ3NldCwgdTgNCj4gKmRhdGEpDQo+
ID4gK3sNCj4gPiArICAgICAodm9pZClkZXY7DQo+ID4gKw0KPiA+ICsgICAgIHN3aXRjaCAoc3Ry
aW5nc2V0KSB7DQo+ID4gKyAgICAgY2FzZSBFVEhfU1NfU1RBVFM6DQo+ID4gKyAgICAgICAgICAg
ICBtZW1jcHkoZGF0YSwgKHU4ICopJnJ0YXNlX2dzdHJpbmdzLA0KPiBzaXplb2YocnRhc2VfZ3N0
cmluZ3MpKTsNCj4gPiArICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsgICAgIGRlZmF1bHQ6DQo+
ID4gKyAgICAgICAgICAgICAvKiBub3RoaW5nIHRvIGRvLiAqLw0KPiA+ICsgICAgICAgICAgICAg
YnJlYWs7DQo+ID4gKyAgICAgfQ0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IHJ0YXNl
X2dldF9zc2V0X2NvdW50KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIGludCBzc2V0KQ0KPiA+ICt7
DQo+ID4gKyAgICAgaW50IHJldCA9IDA7DQo+ID4gKw0KPiA+ICsgICAgICh2b2lkKWRldjsNCj4g
PiArDQo+ID4gKyAgICAgc3dpdGNoIChzc2V0KSB7DQo+ID4gKyAgICAgY2FzZSBFVEhfU1NfU1RB
VFM6DQo+ID4gKyAgICAgICAgICAgICByZXQgPSAoaW50KShBUlJBWV9TSVpFKHJ0YXNlX2dzdHJp
bmdzKSk7DQo+ID4gKyAgICAgICAgICAgICBicmVhazsNCj4gPiArICAgICBkZWZhdWx0Og0KPiA+
ICsgICAgICAgICAgICAgcmV0ID0gLUVPUE5PVFNVUFA7DQo+ID4gKyAgICAgICAgICAgICBicmVh
azsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4g
PiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX2dldF9ldGh0b29sX3N0YXRzKHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYsIHN0cnVjdA0KPiBldGh0b29sX3N0YXRzICpzdGF0cywgdTY0ICpkYXRhKQ0K
PiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0ZGV2X3ByaXYo
ZGV2KTsNCj4gPiArICAgICBjb25zdCBzdHJ1Y3QgcnRhc2VfY291bnRlcnMgKmNvdW50ZXJzOw0K
PiA+ICsgICAgIGRtYV9hZGRyX3QgcGFkZHI7DQo+ID4gKyAgICAgdW5zaWduZWQgbG9uZyBmbGFn
czsNCj4gPiArDQo+ID4gKyAgICAgQVNTRVJUX1JUTkwoKTsNCj4gPiArDQo+ID4gKyAgICAgKHZv
aWQpc3RhdHM7DQo+ID4gKyAgICAgY291bnRlcnMgPSB0cC0+dGFsbHlfdmFkZHI7DQo+ID4gKyAg
ICAgcGFkZHIgPSB0cC0+dGFsbHlfcGFkZHI7DQo+ID4gKyAgICAgaWYgKCFjb3VudGVycykNCj4g
PiArICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsNCj4gPiArICAgICBzcGluX2xvY2tfaXJx
c2F2ZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiArICAgICBydGFzZV9kdW1wX3RhbGx5X2NvdW50
ZXIodHAsIHBhZGRyKTsNCj4gPiArICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ0cC0+bG9j
aywgZmxhZ3MpOw0KPiA+ICsNCj4gPiArICAgICBkYXRhWzBdID0gbGU2NF90b19jcHUoY291bnRl
cnMtPnR4X3BhY2tldHMpOw0KPiA+ICsgICAgIGRhdGFbMV0gPSBsZTY0X3RvX2NwdShjb3VudGVy
cy0+cnhfcGFja2V0cyk7DQo+ID4gKyAgICAgZGF0YVsyXSA9IGxlNjRfdG9fY3B1KGNvdW50ZXJz
LT50eF9lcnJvcnMpOw0KPiA+ICsgICAgIGRhdGFbM10gPSBsZTMyX3RvX2NwdShjb3VudGVycy0+
cnhfZXJyb3JzKTsNCj4gPiArICAgICBkYXRhWzRdID0gbGUxNl90b19jcHUoY291bnRlcnMtPnJ4
X21pc3NlZCk7DQo+ID4gKyAgICAgZGF0YVs1XSA9IGxlMTZfdG9fY3B1KGNvdW50ZXJzLT5hbGln
bl9lcnJvcnMpOw0KPiA+ICsgICAgIGRhdGFbNl0gPSBsZTMyX3RvX2NwdShjb3VudGVycy0+dHhf
b25lX2NvbGxpc2lvbik7DQo+ID4gKyAgICAgZGF0YVs3XSA9IGxlMzJfdG9fY3B1KGNvdW50ZXJz
LT50eF9tdWx0aV9jb2xsaXNpb24pOw0KPiA+ICsgICAgIGRhdGFbOF0gPSBsZTY0X3RvX2NwdShj
b3VudGVycy0+cnhfdW5pY2FzdCk7DQo+ID4gKyAgICAgZGF0YVs5XSA9IGxlNjRfdG9fY3B1KGNv
dW50ZXJzLT5yeF9icm9hZGNhc3QpOw0KPiA+ICsgICAgIGRhdGFbMTBdID0gbGUzMl90b19jcHUo
Y291bnRlcnMtPnJ4X211bHRpY2FzdCk7DQo+ID4gKyAgICAgZGF0YVsxMV0gPSBsZTE2X3RvX2Nw
dShjb3VudGVycy0+dHhfYWJvcnRlZCk7DQo+ID4gKyAgICAgZGF0YVsxMl0gPSBsZTE2X3RvX2Nw
dShjb3VudGVycy0+dHhfdW5kZXJ1bik7DQo+ID4gKw0KPiA+ICtvdXQ6DQo+ID4gKyAgICAgcmV0
dXJuOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgY29uc3Qgc3RydWN0IGV0aHRvb2xfb3Bz
IHJ0YXNlX2V0aHRvb2xfb3BzID0gew0KPiA+ICsgICAgIC5nZXRfZHJ2aW5mbyA9IHJ0YXNlX2dl
dF9kcnZpbmZvLA0KPiA+ICsgICAgIC5nZXRfbGluayA9IGV0aHRvb2xfb3BfZ2V0X2xpbmssDQo+
ID4gKyAgICAgLmdldF9saW5rX2tzZXR0aW5ncyA9IHJ0YXNlX2dldF9zZXR0aW5ncywNCj4gPiAr
ICAgICAuZ2V0X3BhdXNlcGFyYW0gPSBydGFzZV9nZXRfcGF1c2VwYXJhbSwNCj4gPiArICAgICAu
c2V0X3BhdXNlcGFyYW0gPSBydGFzZV9zZXRfcGF1c2VwYXJhbSwNCj4gPiArICAgICAuZ2V0X21z
Z2xldmVsID0gcnRhc2VfZ2V0X21zZ2xldmVsLA0KPiA+ICsgICAgIC5zZXRfbXNnbGV2ZWwgPSBy
dGFzZV9zZXRfbXNnbGV2ZWwsDQo+ID4gKyAgICAgLmdldF9zdHJpbmdzID0gcnRhc2VfZ2V0X3N0
cmluZ3MsDQo+ID4gKyAgICAgLmdldF9zc2V0X2NvdW50ID0gcnRhc2VfZ2V0X3NzZXRfY291bnQs
DQo+ID4gKyAgICAgLmdldF9ldGh0b29sX3N0YXRzID0gcnRhc2VfZ2V0X2V0aHRvb2xfc3RhdHMs
DQo+ID4gKyAgICAgLmdldF90c19pbmZvID0gZXRodG9vbF9vcF9nZXRfdHNfaW5mbywNCj4gPiAr
fTsNCj4gPiArDQo+ID4NCj4gKy8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKg0KPiAqKioqKioqKioqKioqKioqDQo+ID4gKyAqIEV0
aHRvb2wgQ29tcGF0aWJpbGl0eQ0KPiA+ICsNCj4gKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KPiAqKioqKioqKioqKioqKi8N
Cj4gPiArI2lmZGVmIEVUSFRPT0xfT1BTX0NPTVBBVA0KPiA+ICtzdGF0aWMgaW50IGV0aHRvb2xf
Z2V0X3NldHRpbmdzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHZvaWQgKnVzZXJhZGRyKQ0KPiA+
ICt7DQo+ID4gKyAgICAgc3RydWN0IGV0aHRvb2xfY21kIGNtZCA9IHtFVEhUT09MX0dTRVR9Ow0K
PiA+ICsgICAgIGludCBlcnI7DQo+ID4gKw0KPiA+ICsgICAgIGlmICghZXRodG9vbF9vcHMtPmdl
dF9zZXR0aW5ncykNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiAr
DQo+ID4gKyAgICAgZXJyID0gZXRodG9vbF9vcHMtPmdldF9zZXR0aW5ncyhkZXYsICZjbWQpOw0K
PiA+ICsgICAgIGlmIChlcnIgPCAwKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIGVycjsNCj4g
PiArDQo+ID4gKyAgICAgaWYgKGNvcHlfdG9fdXNlcih1c2VyYWRkciwgJmNtZCwgc2l6ZW9mKGNt
ZCkpICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7DQo+ID4gKyAgICAg
cmV0dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9zZXRfc2V0
dGluZ3Moc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgdm9pZCAqdXNlcmFkZHIpDQo+ID4gK3sNCj4g
PiArICAgICBzdHJ1Y3QgZXRodG9vbF9jbWQgY21kOw0KPiA+ICsNCj4gPiArICAgICBpZiAoIWV0
aHRvb2xfb3BzLT5zZXRfc2V0dGluZ3MpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVPUE5P
VFNVUFA7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X2Zyb21fdXNlcigmY21kLCB1c2VyYWRk
ciwgc2l6ZW9mKGNtZCkpICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7
DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiBldGh0b29sX29wcy0+c2V0X3NldHRpbmdzKGRldiwg
JmNtZCk7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9nZXRfZHJ2aW5m
byhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB2b2lkICp1c2VyYWRkcikNCj4gPiArew0KPiA+ICsg
ICAgIHN0cnVjdCBldGh0b29sX2RydmluZm8gaW5mbzsNCj4gPiArICAgICBjb25zdCBzdHJ1Y3Qg
ZXRodG9vbF9vcHMgKm9wcyA9IGV0aHRvb2xfb3BzOw0KPiA+ICsNCj4gPiArICAgICBpZiAoIW9w
cy0+Z2V0X2RydmluZm8pDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+
ID4gKw0KPiA+ICsgICAgIG1lbXNldCgmaW5mbywgMCwgc2l6ZW9mKGluZm8pKTsNCj4gPiArICAg
ICBpbmZvLmNtZCA9IEVUSFRPT0xfR0RSVklORk87DQo+ID4gKyAgICAgb3BzLT5nZXRfZHJ2aW5m
byhkZXYsICZpbmZvKTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKG9wcy0+c2VsZl90ZXN0X2NvdW50
KQ0KPiA+ICsgICAgICAgICAgICAgaW5mby50ZXN0aW5mb19sZW4gPSBvcHMtPnNlbGZfdGVzdF9j
b3VudChkZXYpOw0KPiA+ICsgICAgIGlmIChvcHMtPmdldF9zdGF0c19jb3VudCkNCj4gPiArICAg
ICAgICAgICAgIGluZm8ubl9zdGF0cyA9IG9wcy0+Z2V0X3N0YXRzX2NvdW50KGRldik7DQo+ID4g
KyAgICAgaWYgKG9wcy0+Z2V0X3JlZ3NfbGVuKQ0KPiA+ICsgICAgICAgICAgICAgaW5mby5yZWdk
dW1wX2xlbiA9IG9wcy0+Z2V0X3JlZ3NfbGVuKGRldik7DQo+ID4gKyAgICAgaWYgKG9wcy0+Z2V0
X2VlcHJvbV9sZW4pDQo+ID4gKyAgICAgICAgICAgICBpbmZvLmVlZHVtcF9sZW4gPSBvcHMtPmdl
dF9lZXByb21fbGVuKGRldik7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X3RvX3VzZXIodXNl
cmFkZHIsICZpbmZvLCBzaXplb2YoaW5mbykpICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgcmV0
dXJuIC1FRkFVTFQ7DQo+ID4gKyAgICAgcmV0dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0
YXRpYyBpbnQgZXRodG9vbF9nZXRfcmVncyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBjaGFyICp1
c2VyYWRkcikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBldGh0b29sX3JlZ3MgcmVnczsNCj4g
PiArICAgICBjb25zdCBzdHJ1Y3QgZXRodG9vbF9vcHMgKm9wcyA9IGV0aHRvb2xfb3BzOw0KPiA+
ICsgICAgIHZvaWQgKnJlZ2J1ZjsNCj4gPiArICAgICBpbnQgcmVnbGVuLCByZXQ7DQo+ID4gKw0K
PiA+ICsgICAgIGlmICghb3BzLT5nZXRfcmVncyB8fCAhb3BzLT5nZXRfcmVnc19sZW4pDQo+ID4g
KyAgICAgICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChj
b3B5X2Zyb21fdXNlcigmcmVncywgdXNlcmFkZHIsIHNpemVvZihyZWdzKSkgIT0gMHUpDQo+ID4g
KyAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsNCj4gPiArDQo+ID4gKyAgICAgcmVnbGVuID0g
b3BzLT5nZXRfcmVnc19sZW4oZGV2KTsNCj4gPiArICAgICBpZiAocmVncy5sZW4gPiByZWdsZW4p
DQo+ID4gKyAgICAgICAgICAgICByZWdzLmxlbiA9IHJlZ2xlbjsNCj4gPiArDQo+ID4gKyAgICAg
cmVnYnVmID0ga21hbGxvYyhyZWdsZW4sIEdGUF9VU0VSKTsNCj4gPiArICAgICBpZiAoIXJlZ2J1
ZikNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPiA+ICsNCj4gPiArICAgICBv
cHMtPmdldF9yZWdzKGRldiwgJnJlZ3MsIHJlZ2J1Zik7DQo+ID4gKw0KPiA+ICsgICAgIHJldCA9
IC1FRkFVTFQ7DQo+ID4gKyAgICAgaWYgKGNvcHlfdG9fdXNlcih1c2VyYWRkciwgJnJlZ3MsIHNp
emVvZihyZWdzKSkgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiArICAg
ICB1c2VyYWRkciArPSBvZmZzZXRvZihzdHJ1Y3QgZXRodG9vbF9yZWdzLCBkYXRhKTsNCj4gPiAr
ICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRyLCByZWdidWYsIHJlZ2xlbikgIT0gMHUpDQo+
ID4gKyAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiArICAgICByZXQgPSAwOw0KPiA+ICsNCj4g
PiArb3V0Og0KPiA+ICsgICAgIGtmcmVlKHJlZ2J1Zik7DQo+ID4gKyAgICAgcmV0dXJuIHJldDsN
Cj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBldGh0b29sX2dldF93b2woc3RydWN0IG5l
dF9kZXZpY2UgKmRldiwgY2hhciAqdXNlcmFkZHIpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3Qg
ZXRodG9vbF93b2xpbmZvIHdvbCA9IHtFVEhUT09MX0dXT0x9Ow0KPiA+ICsNCj4gPiArICAgICBp
ZiAoIWV0aHRvb2xfb3BzLT5nZXRfd29sKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FT1BO
T1RTVVBQOw0KPiA+ICsNCj4gPiArICAgICBldGh0b29sX29wcy0+Z2V0X3dvbChkZXYsICZ3b2wp
Ow0KPiA+ICsNCj4gPiArICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRyLCAmd29sLCBzaXpl
b2Yod29sKSkgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsNCj4gPiAr
ICAgICByZXR1cm4gMDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBldGh0b29sX3Nl
dF93b2woc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgY2hhciAqdXNlcmFkZHIpDQo+ID4gK3sNCj4g
PiArICAgICBzdHJ1Y3QgZXRodG9vbF93b2xpbmZvIHdvbDsNCj4gPiArDQo+ID4gKyAgICAgaWYg
KCFldGh0b29sX29wcy0+c2V0X3dvbCkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9U
U1VQUDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKGNvcHlfZnJvbV91c2VyKCZ3b2wsIHVzZXJhZGRy
LCBzaXplb2Yod29sKSkgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsN
Cj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIGV0aHRvb2xfb3BzLT5zZXRfd29sKGRldiwgJndvbCk7
DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9nZXRfbXNnbGV2ZWwoc3Ry
dWN0IG5ldF9kZXZpY2UgKmRldiwgY2hhciAqdXNlcmFkZHIpDQo+ID4gK3sNCj4gPiArICAgICBz
dHJ1Y3QgZXRodG9vbF92YWx1ZSBlZGF0YSA9IHtFVEhUT09MX0dNU0dMVkx9Ow0KPiA+ICsNCj4g
PiArICAgICBpZiAoIWV0aHRvb2xfb3BzLT5nZXRfbXNnbGV2ZWwpDQo+ID4gKyAgICAgICAgICAg
ICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ID4gKw0KPiA+ICsgICAgIGVkYXRhLmRhdGEgPSBldGh0
b29sX29wcy0+Z2V0X21zZ2xldmVsKGRldik7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X3Rv
X3VzZXIodXNlcmFkZHIsICZlZGF0YSwgc2l6ZW9mKGVkYXRhKSkgIT0gMHUpDQo+ID4gKyAgICAg
ICAgICAgICByZXR1cm4gLUVGQVVMVDsNCj4gPiArICAgICByZXR1cm4gMDsNCj4gPiArfQ0KPiA+
ICsNCj4gPiArc3RhdGljIGludCBldGh0b29sX3NldF9tc2dsZXZlbChzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2LCBjaGFyICp1c2VyYWRkcikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBldGh0b29s
X3ZhbHVlIGVkYXRhOw0KPiA+ICsNCj4gPiArICAgICBpZiAoIWV0aHRvb2xfb3BzLT5zZXRfbXNn
bGV2ZWwpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ID4gKw0KPiA+
ICsgICAgIGlmIChjb3B5X2Zyb21fdXNlcigmZWRhdGEsIHVzZXJhZGRyLCBzaXplb2YoZWRhdGEp
KSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRUZBVUxUOw0KPiA+ICsNCj4gPiAr
ICAgICBldGh0b29sX29wcy0+c2V0X21zZ2xldmVsKGRldiwgZWRhdGEuZGF0YSk7DQo+ID4gKyAg
ICAgcmV0dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9ud2F5
X3Jlc2V0KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpDQo+ID4gK3sNCj4gPiArICAgICBpZiAoIWV0
aHRvb2xfb3BzLT5ud2F5X3Jlc2V0KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RT
VVBQOw0KPiA+ICsNCj4gDQo+IFRoaXMgaXMgY2hlY2tlZCBieSB0aGUgY29yZSBhbHJlYWR5LiBT
YW1lIGFwcGxpZXMgdG8gb3RoZXIgZXRodG9vbCBvcHMgYXMgd2VsbC4NCj4gDQo+ID4gKyAgICAg
cmV0dXJuIGV0aHRvb2xfb3BzLT5ud2F5X3Jlc2V0KGRldik7DQo+ID4gK30NCj4gPiArDQo+ID4g
K3N0YXRpYyBpbnQgZXRodG9vbF9nZXRfbGluayhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB2b2lk
ICp1c2VyYWRkcikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBldGh0b29sX3ZhbHVlIGVkYXRh
ID0ge0VUSFRPT0xfR0xJTkt9Ow0KPiA+ICsNCj4gPiArICAgICBpZiAoIWV0aHRvb2xfb3BzLT5n
ZXRfbGluaykNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiArDQo+
ID4gKyAgICAgZWRhdGEuZGF0YSA9IGV0aHRvb2xfb3BzLT5nZXRfbGluayhkZXYpOw0KPiA+ICsN
Cj4gPiArICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRyLCAmZWRhdGEsIHNpemVvZihlZGF0
YSkpICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7DQo+ID4gKyAgICAg
cmV0dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9nZXRfZWVw
cm9tKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHZvaWQgKnVzZXJhZGRyKQ0KPiA+ICt7DQo+ID4g
KyAgICAgc3RydWN0IGV0aHRvb2xfZWVwcm9tIGVlcHJvbTsNCj4gPiArICAgICBjb25zdCBzdHJ1
Y3QgZXRodG9vbF9vcHMgKm9wcyA9IGV0aHRvb2xfb3BzOw0KPiA+ICsgICAgIHU4ICpkYXRhOw0K
PiA+ICsgICAgIGludCByZXQ7DQo+ID4gKw0KPiA+ICsgICAgIGlmICghb3BzLT5nZXRfZWVwcm9t
IHx8ICFvcHMtPmdldF9lZXByb21fbGVuKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FT1BO
T1RTVVBQOw0KPiA+ICsNCj4gPiArICAgICBpZiAoY29weV9mcm9tX3VzZXIoJmVlcHJvbSwgdXNl
cmFkZHIsIHNpemVvZihlZXByb20pKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAt
RUZBVUxUOw0KPiA+ICsNCj4gPiArICAgICAvKiBDaGVjayBmb3Igd3JhcCBhbmQgemVybyAqLw0K
PiA+ICsgICAgIGlmIChlZXByb20ub2Zmc2V0ICsgZWVwcm9tLmxlbiA8PSBlZXByb20ub2Zmc2V0
KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ID4gKw0KPiA+ICsgICAgIC8q
IENoZWNrIGZvciBleGNlZWRpbmcgdG90YWwgZWVwcm9tIGxlbiAqLw0KPiA+ICsgICAgIGlmIChl
ZXByb20ub2Zmc2V0ICsgZWVwcm9tLmxlbiA+IG9wcy0+Z2V0X2VlcHJvbV9sZW4oZGV2KSkNCj4g
PiArICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiA+ICsNCj4gPiArICAgICBkYXRhID0g
a21hbGxvYyhlZXByb20ubGVuLCBHRlBfVVNFUik7DQo+ID4gKyAgICAgaWYgKCFkYXRhKQ0KPiA+
ICsgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07DQo+ID4gKw0KPiA+ICsgICAgIHJldCA9IC1F
RkFVTFQ7DQo+ID4gKyAgICAgaWYgKGNvcHlfZnJvbV91c2VyKGRhdGEsIHVzZXJhZGRyICsgc2l6
ZW9mKGVlcHJvbSksIGVlcHJvbS5sZW4pICE9DQo+IDB1KQ0KPiA+ICsgICAgICAgICAgICAgZ290
byBvdXQ7DQo+ID4gKw0KPiA+ICsgICAgIHJldCA9IG9wcy0+Z2V0X2VlcHJvbShkZXYsICZlZXBy
b20sIGRhdGEpOw0KPiA+ICsgICAgIGlmIChyZXQpDQo+ID4gKyAgICAgICAgICAgICBnb3RvIG91
dDsNCj4gPiArDQo+ID4gKyAgICAgcmV0ID0gLUVGQVVMVDsNCj4gPiArICAgICBpZiAoY29weV90
b191c2VyKHVzZXJhZGRyLCAmZWVwcm9tLCBzaXplb2YoZWVwcm9tKSkgIT0gMHUpDQo+ID4gKyAg
ICAgICAgICAgICBnb3RvIG91dDsNCj4gPiArICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRy
ICsgc2l6ZW9mKGVlcHJvbSksIGRhdGEsIGVlcHJvbS5sZW4pICE9IDB1KQ0KPiA+ICsgICAgICAg
ICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAgcmV0ID0gMDsNCj4gPiArDQo+ID4gK291dDoNCj4g
PiArICAgICBrZnJlZShkYXRhKTsNCj4gPiArICAgICByZXR1cm4gcmV0Ow0KPiA+ICt9DQo+ID4g
Kw0KPiA+ICtzdGF0aWMgaW50IGV0aHRvb2xfc2V0X2VlcHJvbShzdHJ1Y3QgbmV0X2RldmljZSAq
ZGV2LCB2b2lkICp1c2VyYWRkcikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBldGh0b29sX2Vl
cHJvbSBlZXByb207DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IGV0aHRvb2xfb3BzICpvcHMgPSBl
dGh0b29sX29wczsNCj4gPiArICAgICB1OCAqZGF0YTsNCj4gPiArICAgICBpbnQgcmV0Ow0KPiA+
ICsNCj4gPiArICAgICBpZiAoIW9wcy0+c2V0X2VlcHJvbSB8fCAhb3BzLT5nZXRfZWVwcm9tX2xl
bikNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiArDQo+ID4gKyAg
ICAgaWYgKGNvcHlfZnJvbV91c2VyKCZlZXByb20sIHVzZXJhZGRyLCBzaXplb2YoZWVwcm9tKSkg
IT0gMHUpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsNCj4gPiArDQo+ID4gKyAg
ICAgLyogQ2hlY2sgZm9yIHdyYXAgYW5kIHplcm8gKi8NCj4gPiArICAgICBpZiAoZWVwcm9tLm9m
ZnNldCArIGVlcHJvbS5sZW4gPD0gZWVwcm9tLm9mZnNldCkNCj4gPiArICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOw0KPiA+ICsNCj4gPiArICAgICAvKiBDaGVjayBmb3IgZXhjZWVkaW5nIHRv
dGFsIGVlcHJvbSBsZW4gKi8NCj4gPiArICAgICBpZiAoZWVwcm9tLm9mZnNldCArIGVlcHJvbS5s
ZW4gPiBvcHMtPmdldF9lZXByb21fbGVuKGRldikpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4g
LUVJTlZBTDsNCj4gPiArDQo+ID4gKyAgICAgZGF0YSA9IGttYWxsb2MoZWVwcm9tLmxlbiwgR0ZQ
X1VTRVIpOw0KPiA+ICsgICAgIGlmICghZGF0YSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAt
RU5PTUVNOw0KPiA+ICsNCj4gPiArICAgICByZXQgPSAtRUZBVUxUOw0KPiA+ICsgICAgIGlmIChj
b3B5X2Zyb21fdXNlcihkYXRhLCB1c2VyYWRkciArIHNpemVvZihlZXByb20pLCBlZXByb20ubGVu
KSAhPQ0KPiAwdSkNCj4gPiArICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsNCj4gPiArICAg
ICByZXQgPSBvcHMtPnNldF9lZXByb20oZGV2LCAmZWVwcm9tLCBkYXRhKTsNCj4gPiArICAgICBp
ZiAocmV0KQ0KPiA+ICsgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gKw0KPiA+ICsgICAgIGlm
IChjb3B5X3RvX3VzZXIodXNlcmFkZHIgKyBzaXplb2YoZWVwcm9tKSwgZGF0YSwgZWVwcm9tLmxl
bikgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICByZXQgPSAtRUZBVUxUOw0KPiA+ICsNCj4gPiAr
b3V0Og0KPiA+ICsgICAgIGtmcmVlKGRhdGEpOw0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4g
K30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9nZXRfY29hbGVzY2Uoc3RydWN0IG5l
dF9kZXZpY2UgKmRldiwgdm9pZCAqdXNlcmFkZHIpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3Qg
ZXRodG9vbF9jb2FsZXNjZSBjb2FsZXNjZSA9IHtFVEhUT09MX0dDT0FMRVNDRX07DQo+ID4gKw0K
PiA+ICsgICAgIGlmICghZXRodG9vbF9vcHMtPmdldF9jb2FsZXNjZSkNCj4gPiArICAgICAgICAg
ICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiArDQo+ID4gKyAgICAgZXRodG9vbF9vcHMtPmdl
dF9jb2FsZXNjZShkZXYsICZjb2FsZXNjZSk7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X3Rv
X3VzZXIodXNlcmFkZHIsICZjb2FsZXNjZSwgc2l6ZW9mKGNvYWxlc2NlKSkgIT0gMHUpDQo+ID4g
KyAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsNCj4gPiArICAgICByZXR1cm4gMDsNCj4gPiAr
fQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBldGh0b29sX3NldF9jb2FsZXNjZShzdHJ1Y3QgbmV0
X2RldmljZSAqZGV2LCB2b2lkICp1c2VyYWRkcikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBl
dGh0b29sX2NvYWxlc2NlIGNvYWxlc2NlOw0KPiA+ICsNCj4gPiArICAgICBpZiAoIWV0aHRvb2xf
b3BzLT5nZXRfY29hbGVzY2UpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7
DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X2Zyb21fdXNlcigmY29hbGVzY2UsIHVzZXJhZGRy
LCBzaXplb2YoY29hbGVzY2UpKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRUZB
VUxUOw0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gZXRodG9vbF9vcHMtPnNldF9jb2FsZXNjZShk
ZXYsICZjb2FsZXNjZSk7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9n
ZXRfcmluZ3BhcmFtKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHZvaWQgKnVzZXJhZGRyKQ0KPiA+
ICt7DQo+ID4gKyAgICAgc3RydWN0IGV0aHRvb2xfcmluZ3BhcmFtIHJpbmdwYXJhbSA9IHtFVEhU
T09MX0dSSU5HUEFSQU19Ow0KPiA+ICsNCj4gPiArICAgICBpZiAoIWV0aHRvb2xfb3BzLT5nZXRf
cmluZ3BhcmFtKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOw0KPiA+ICsN
Cj4gPiArICAgICBldGh0b29sX29wcy0+Z2V0X3JpbmdwYXJhbShkZXYsICZyaW5ncGFyYW0pOw0K
PiA+ICsNCj4gPiArICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRyLCAmcmluZ3BhcmFtLCBz
aXplb2YocmluZ3BhcmFtKSkgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVGQVVM
VDsNCj4gPiArICAgICByZXR1cm4gMDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBl
dGh0b29sX3NldF9yaW5ncGFyYW0oc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgdm9pZCAqdXNlcmFk
ZHIpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgZXRodG9vbF9yaW5ncGFyYW0gcmluZ3BhcmFt
Ow0KPiA+ICsNCj4gPiArICAgICBpZiAoIWV0aHRvb2xfb3BzLT5nZXRfcmluZ3BhcmFtKQ0KPiA+
ICsgICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOw0KPiA+ICsNCj4gPiArICAgICBpZiAo
Y29weV9mcm9tX3VzZXIoJnJpbmdwYXJhbSwgdXNlcmFkZHIsIHNpemVvZihyaW5ncGFyYW0pKSAh
PSAwdSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRUZBVUxUOw0KPiA+ICsNCj4gPiArICAg
ICByZXR1cm4gZXRodG9vbF9vcHMtPnNldF9yaW5ncGFyYW0oZGV2LCAmcmluZ3BhcmFtKTsNCj4g
PiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBldGh0b29sX2dldF9wYXVzZXBhcmFtKHN0cnVj
dCBuZXRfZGV2aWNlICpkZXYsIHZvaWQgKnVzZXJhZGRyKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3Ry
dWN0IGV0aHRvb2xfcGF1c2VwYXJhbSBwYXVzZXBhcmFtID0NCj4ge0VUSFRPT0xfR1BBVVNFUEFS
QU19Ow0KPiA+ICsNCj4gPiArICAgICBpZiAoIWV0aHRvb2xfb3BzLT5nZXRfcGF1c2VwYXJhbSkN
Cj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiArDQo+ID4gKyAgICAg
ZXRodG9vbF9vcHMtPmdldF9wYXVzZXBhcmFtKGRldiwgJnBhdXNlcGFyYW0pOw0KPiA+ICsNCj4g
PiArICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRyLCAmcGF1c2VwYXJhbSwgc2l6ZW9mKHBh
dXNlcGFyYW0pKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRUZBVUxUOw0KPiA+
ICsgICAgIHJldHVybiAwOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IGV0aHRvb2xf
c2V0X3BhdXNlcGFyYW0oc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgdm9pZCAqdXNlcmFkZHIpDQo+
ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgZXRodG9vbF9wYXVzZXBhcmFtIHBhdXNlcGFyYW07DQo+
ID4gKw0KPiA+ICsgICAgIGlmICghZXRodG9vbF9vcHMtPmdldF9wYXVzZXBhcmFtKQ0KPiA+ICsg
ICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOw0KPiA+ICsNCj4gPiArICAgICBpZiAoY29w
eV9mcm9tX3VzZXIoJnBhdXNlcGFyYW0sIHVzZXJhZGRyLCBzaXplb2YocGF1c2VwYXJhbSkpICE9
DQo+IDB1KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7DQo+ID4gKw0KPiA+ICsg
ICAgIHJldHVybiBldGh0b29sX29wcy0+c2V0X3BhdXNlcGFyYW0oZGV2LCAmcGF1c2VwYXJhbSk7
DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9nZXRfcnhfY3N1bShzdHJ1
Y3QgbmV0X2RldmljZSAqZGV2LCBjaGFyICp1c2VyYWRkcikNCj4gPiArew0KPiA+ICsgICAgIHN0
cnVjdCBldGh0b29sX3ZhbHVlIGVkYXRhID0ge0VUSFRPT0xfR1JYQ1NVTX07DQo+ID4gKw0KPiA+
ICsgICAgIGlmICghZXRodG9vbF9vcHMtPmdldF9yeF9jc3VtKQ0KPiA+ICsgICAgICAgICAgICAg
cmV0dXJuIC1FT1BOT1RTVVBQOw0KPiA+ICsNCj4gPiArICAgICBlZGF0YS5kYXRhID0gZXRodG9v
bF9vcHMtPmdldF9yeF9jc3VtKGRldik7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X3RvX3Vz
ZXIodXNlcmFkZHIsICZlZGF0YSwgc2l6ZW9mKGVkYXRhKSkgIT0gMHUpDQo+ID4gKyAgICAgICAg
ICAgICByZXR1cm4gLUVGQVVMVDsNCj4gPiArICAgICByZXR1cm4gMDsNCj4gPiArfQ0KPiA+ICsN
Cj4gPiArc3RhdGljIGludCBldGh0b29sX3NldF9yeF9jc3VtKHN0cnVjdCBuZXRfZGV2aWNlICpk
ZXYsIGNoYXIgKnVzZXJhZGRyKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGV0aHRvb2xfdmFs
dWUgZWRhdGE7DQo+ID4gKw0KPiA+ICsgICAgIGlmICghZXRodG9vbF9vcHMtPnNldF9yeF9jc3Vt
KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOw0KPiA+ICsNCj4gPiArICAg
ICBpZiAoY29weV9mcm9tX3VzZXIoJmVkYXRhLCB1c2VyYWRkciwgc2l6ZW9mKGVkYXRhKSkgIT0g
MHUpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsNCj4gPiArDQo+ID4gKyAgICAg
ZXRodG9vbF9vcHMtPnNldF9yeF9jc3VtKGRldiwgZWRhdGEuZGF0YSk7DQo+ID4gKyAgICAgcmV0
dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9nZXRfdHhfY3N1
bShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBjaGFyICp1c2VyYWRkcikNCj4gPiArew0KPiA+ICsg
ICAgIHN0cnVjdCBldGh0b29sX3ZhbHVlIGVkYXRhID0ge0VUSFRPT0xfR1RYQ1NVTX07DQo+ID4g
Kw0KPiA+ICsgICAgIGlmICghZXRodG9vbF9vcHMtPmdldF90eF9jc3VtKQ0KPiA+ICsgICAgICAg
ICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOw0KPiA+ICsNCj4gPiArICAgICBlZGF0YS5kYXRhID0g
ZXRodG9vbF9vcHMtPmdldF90eF9jc3VtKGRldik7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5
X3RvX3VzZXIodXNlcmFkZHIsICZlZGF0YSwgc2l6ZW9mKGVkYXRhKSkgIT0gMHUpDQo+ID4gKyAg
ICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsNCj4gPiArICAgICByZXR1cm4gMDsNCj4gPiArfQ0K
PiA+ICsNCj4gPiArc3RhdGljIGludCBldGh0b29sX3NldF90eF9jc3VtKHN0cnVjdCBuZXRfZGV2
aWNlICpkZXYsIGNoYXIgKnVzZXJhZGRyKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGV0aHRv
b2xfdmFsdWUgZWRhdGE7DQo+ID4gKw0KPiA+ICsgICAgIGlmICghZXRodG9vbF9vcHMtPnNldF90
eF9jc3VtKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQOw0KPiA+ICsNCj4g
PiArICAgICBpZiAoY29weV9mcm9tX3VzZXIoJmVkYXRhLCB1c2VyYWRkciwgc2l6ZW9mKGVkYXRh
KSkgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsNCj4gPiArDQo+ID4g
KyAgICAgcmV0dXJuIGV0aHRvb2xfb3BzLT5zZXRfdHhfY3N1bShkZXYsIGVkYXRhLmRhdGEpOw0K
PiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IGV0aHRvb2xfZ2V0X3NnKHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYsIGNoYXIgKnVzZXJhZGRyKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGV0
aHRvb2xfdmFsdWUgZWRhdGEgPSB7RVRIVE9PTF9HU0d9Ow0KPiA+ICsNCj4gPiArICAgICBpZiAo
IWV0aHRvb2xfb3BzLT5nZXRfc2cpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVPUE5PVFNV
UFA7DQo+ID4gKw0KPiA+ICsgICAgIGVkYXRhLmRhdGEgPSBldGh0b29sX29wcy0+Z2V0X3NnKGRl
dik7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X3RvX3VzZXIodXNlcmFkZHIsICZlZGF0YSwg
c2l6ZW9mKGVkYXRhKSkgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVGQVVMVDsN
Cj4gPiArICAgICByZXR1cm4gMDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBldGh0
b29sX3NldF9zZyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBjaGFyICp1c2VyYWRkcikNCj4gPiAr
ew0KPiA+ICsgICAgIHN0cnVjdCBldGh0b29sX3ZhbHVlIGVkYXRhOw0KPiA+ICsNCj4gPiArICAg
ICBpZiAoIWV0aHRvb2xfb3BzLT5zZXRfc2cpDQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVP
UE5PVFNVUFA7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X2Zyb21fdXNlcigmZWRhdGEsIHVz
ZXJhZGRyLCBzaXplb2YoZWRhdGEpKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAt
RUZBVUxUOw0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gZXRodG9vbF9vcHMtPnNldF9zZyhkZXYs
IGVkYXRhLmRhdGEpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IGV0aHRvb2xfZ2V0
X3RzbyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBjaGFyICp1c2VyYWRkcikNCj4gPiArew0KPiA+
ICsgICAgIHN0cnVjdCBldGh0b29sX3ZhbHVlIGVkYXRhID0ge0VUSFRPT0xfR1RTT307DQo+ID4g
Kw0KPiA+ICsgICAgIGlmICghZXRodG9vbF9vcHMtPmdldF90c28pDQo+ID4gKyAgICAgICAgICAg
ICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ID4gKw0KPiA+ICsgICAgIGVkYXRhLmRhdGEgPSBldGh0
b29sX29wcy0+Z2V0X3RzbyhkZXYpOw0KPiA+ICsNCj4gPiArICAgICBpZiAoY29weV90b191c2Vy
KHVzZXJhZGRyLCAmZWRhdGEsIHNpemVvZihlZGF0YSkpICE9IDB1KQ0KPiA+ICsgICAgICAgICAg
ICAgcmV0dXJuIC1FRkFVTFQ7DQo+ID4gKyAgICAgcmV0dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+
ID4gK3N0YXRpYyBpbnQgZXRodG9vbF9zZXRfdHNvKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIGNo
YXIgKnVzZXJhZGRyKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGV0aHRvb2xfdmFsdWUgZWRh
dGE7DQo+ID4gKw0KPiA+ICsgICAgIGlmICghZXRodG9vbF9vcHMtPnNldF90c28pDQo+ID4gKyAg
ICAgICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5
X2Zyb21fdXNlcigmZWRhdGEsIHVzZXJhZGRyLCBzaXplb2YoZWRhdGEpKSAhPSAwdSkNCj4gPiAr
ICAgICAgICAgICAgIHJldHVybiAtRUZBVUxUOw0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gZXRo
dG9vbF9vcHMtPnNldF90c28oZGV2LCBlZGF0YS5kYXRhKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiAr
c3RhdGljIGludCBldGh0b29sX3NlbGZfdGVzdChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBjaGFy
ICp1c2VyYWRkcikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBldGh0b29sX3Rlc3QgdGVzdDsN
Cj4gPiArICAgICBjb25zdCBzdHJ1Y3QgZXRodG9vbF9vcHMgKm9wcyA9IGV0aHRvb2xfb3BzOw0K
PiA+ICsgICAgIHU2NCAqZGF0YTsNCj4gPiArICAgICBpbnQgcmV0Ow0KPiA+ICsNCj4gPiArICAg
ICBpZiAoIW9wcy0+c2VsZl90ZXN0IHx8ICFvcHMtPnNlbGZfdGVzdF9jb3VudCkNCj4gPiArICAg
ICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKGNvcHlf
ZnJvbV91c2VyKCZ0ZXN0LCB1c2VyYWRkciwgc2l6ZW9mKHRlc3QpKSAhPSAwdSkNCj4gPiArICAg
ICAgICAgICAgIHJldHVybiAtRUZBVUxUOw0KPiA+ICsNCj4gPiArICAgICB0ZXN0LmxlbiA9IG9w
cy0+c2VsZl90ZXN0X2NvdW50KGRldik7DQo+ID4gKyAgICAgZGF0YSA9IGttYWxsb2ModGVzdC5s
ZW4gKiBzaXplb2YodTY0KSwgR0ZQX1VTRVIpOw0KPiA+ICsgICAgIGlmICghZGF0YSkNCj4gPiAr
ICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPiA+ICsNCj4gPiArICAgICBvcHMtPnNlbGZf
dGVzdChkZXYsICZ0ZXN0LCBkYXRhKTsNCj4gPiArDQo+ID4gKyAgICAgcmV0ID0gLUVGQVVMVDsN
Cj4gPiArICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRyLCAmdGVzdCwgc2l6ZW9mKHRlc3Qp
KSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAgIHVzZXJhZGRy
ICs9IHNpemVvZih0ZXN0KTsNCj4gPiArICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRyLCBk
YXRhLCB0ZXN0LmxlbiAqIHNpemVvZih1NjQpKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIGdv
dG8gb3V0Ow0KPiA+ICsgICAgIHJldCA9IDA7DQo+ID4gKw0KPiA+ICtvdXQ6DQo+ID4gKyAgICAg
a2ZyZWUoZGF0YSk7DQo+ID4gKyAgICAgcmV0dXJuIHJldDsNCj4gPiArfQ0KPiA+ICsNCj4gPiAr
c3RhdGljIGludCBldGh0b29sX2dldF9zdHJpbmdzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHZv
aWQgKnVzZXJhZGRyKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGV0aHRvb2xfZ3N0cmluZ3Mg
Z3N0cmluZ3M7DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IGV0aHRvb2xfb3BzICpvcHMgPSBldGh0
b29sX29wczsNCj4gPiArICAgICB1OCAqZGF0YTsNCj4gPiArICAgICBpbnQgcmV0Ow0KPiA+ICsN
Cj4gPiArICAgICBpZiAoIW9wcy0+Z2V0X3N0cmluZ3MpDQo+ID4gKyAgICAgICAgICAgICByZXR1
cm4gLUVPUE5PVFNVUFA7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X2Zyb21fdXNlcigmZ3N0
cmluZ3MsIHVzZXJhZGRyLCBzaXplb2YoZ3N0cmluZ3MpKSAhPSAwdSkNCj4gPiArICAgICAgICAg
ICAgIHJldHVybiAtRUZBVUxUOw0KPiA+ICsNCj4gPiArICAgICBzd2l0Y2ggKGdzdHJpbmdzLnN0
cmluZ19zZXQpIHsNCj4gPiArICAgICBjYXNlIEVUSF9TU19URVNUOg0KPiA+ICsgICAgICAgICAg
ICAgaWYgKCFvcHMtPnNlbGZfdGVzdF9jb3VudCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAg
cmV0dXJuIC1FT1BOT1RTVVBQOw0KPiA+ICsgICAgICAgICAgICAgZ3N0cmluZ3MubGVuID0gb3Bz
LT5zZWxmX3Rlc3RfY291bnQoZGV2KTsNCj4gPiArICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsg
ICAgIGNhc2UgRVRIX1NTX1NUQVRTOg0KPiA+ICsgICAgICAgICAgICAgaWYgKCFvcHMtPmdldF9z
dGF0c19jb3VudCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FT1BOT1RTVVBQ
Ow0KPiA+ICsgICAgICAgICAgICAgZ3N0cmluZ3MubGVuID0gb3BzLT5nZXRfc3RhdHNfY291bnQo
ZGV2KTsNCj4gPiArICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsgICAgIGRlZmF1bHQ6DQo+ID4g
KyAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsg
ICAgIGRhdGEgPSBrbWFsbG9jKGdzdHJpbmdzLmxlbiAqIEVUSF9HU1RSSU5HX0xFTiwgR0ZQX1VT
RVIpOw0KPiA+ICsgICAgIGlmICghZGF0YSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU5P
TUVNOw0KPiA+ICsNCj4gPiArICAgICBvcHMtPmdldF9zdHJpbmdzKGRldiwgZ3N0cmluZ3Muc3Ry
aW5nX3NldCwgZGF0YSk7DQo+ID4gKw0KPiA+ICsgICAgIHJldCA9IC1FRkFVTFQ7DQo+ID4gKyAg
ICAgaWYgKGNvcHlfdG9fdXNlcih1c2VyYWRkciwgJmdzdHJpbmdzLCBzaXplb2YoZ3N0cmluZ3Mp
KSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAgIHVzZXJhZGRy
ICs9IHNpemVvZihnc3RyaW5ncyk7DQo+ID4gKyAgICAgaWYgKGNvcHlfdG9fdXNlcih1c2VyYWRk
ciwgZGF0YSwgZ3N0cmluZ3MubGVuICogRVRIX0dTVFJJTkdfTEVOKSAhPQ0KPiAwdSkNCj4gPiAr
ICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAgIHJldCA9IDA7DQo+ID4gKw0KPiA+ICtv
dXQ6DQo+ID4gKyAgICAga2ZyZWUoZGF0YSk7DQo+ID4gKyAgICAgcmV0dXJuIHJldDsNCj4gPiAr
fQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBldGh0b29sX3BoeXNfaWQoc3RydWN0IG5ldF9kZXZp
Y2UgKmRldiwgdm9pZCAqdXNlcmFkZHIpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgZXRodG9v
bF92YWx1ZSBpZDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKCFldGh0b29sX29wcy0+cGh5c19pZCkN
Cj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiArDQo+ID4gKyAgICAg
aWYgKGNvcHlfZnJvbV91c2VyKCZpZCwgdXNlcmFkZHIsIHNpemVvZihpZCkpICE9IDB1KQ0KPiA+
ICsgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiBl
dGh0b29sX29wcy0+cGh5c19pZChkZXYsIGlkLmRhdGEpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtz
dGF0aWMgaW50IGV0aHRvb2xfZ2V0X3N0YXRzKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIHZvaWQg
KnVzZXJhZGRyKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IGV0aHRvb2xfc3RhdHMgc3RhdHM7
DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IGV0aHRvb2xfb3BzICpvcHMgPSBldGh0b29sX29wczsN
Cj4gPiArICAgICB1NjQgKmRhdGE7DQo+ID4gKyAgICAgaW50IHJldDsNCj4gPiArDQo+ID4gKyAg
ICAgaWYgKCFvcHMtPmdldF9ldGh0b29sX3N0YXRzIHx8ICFvcHMtPmdldF9zdGF0c19jb3VudCkN
Cj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU9QTk9UU1VQUDsNCj4gPiArDQo+ID4gKyAgICAg
aWYgKGNvcHlfZnJvbV91c2VyKCZzdGF0cywgdXNlcmFkZHIsIHNpemVvZihzdGF0cykpICE9IDB1
KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7DQo+ID4gKw0KPiA+ICsgICAgIHN0
YXRzLm5fc3RhdHMgPSBvcHMtPmdldF9zdGF0c19jb3VudChkZXYpOw0KPiA+ICsgICAgIGRhdGEg
PSBrbWFsbG9jKHN0YXRzLm5fc3RhdHMgKiBzaXplb2YodTY0KSwgR0ZQX1VTRVIpOw0KPiA+ICsg
ICAgIGlmICghZGF0YSkNCj4gPiArICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPiA+ICsN
Cj4gPiArICAgICBvcHMtPmdldF9ldGh0b29sX3N0YXRzKGRldiwgJnN0YXRzLCBkYXRhKTsNCj4g
PiArDQo+ID4gKyAgICAgcmV0ID0gLUVGQVVMVDsNCj4gPiArICAgICBpZiAoY29weV90b191c2Vy
KHVzZXJhZGRyLCAmc3RhdHMsIHNpemVvZihzdGF0cykpICE9IDB1KQ0KPiA+ICsgICAgICAgICAg
ICAgZ290byBvdXQ7DQo+ID4gKyAgICAgdXNlcmFkZHIgKz0gc2l6ZW9mKHN0YXRzKTsNCj4gPiAr
ICAgICBpZiAoY29weV90b191c2VyKHVzZXJhZGRyLCBkYXRhLCBzdGF0cy5uX3N0YXRzICogc2l6
ZW9mKHU2NCkpICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAg
cmV0ID0gMDsNCj4gPiArDQo+ID4gK291dDoNCj4gPiArICAgICBrZnJlZShkYXRhKTsNCj4gPiAr
ICAgICByZXR1cm4gcmV0Ow0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IGV0aHRvb2xf
aW9jdGwoc3RydWN0IGlmcmVxICppZnIpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgbmV0X2Rl
dmljZSAqZGV2ID0gX19kZXZfZ2V0X2J5X25hbWUoaWZyLT5pZnJfbmFtZSk7DQo+ID4gKyAgICAg
dm9pZCAqdXNlcmFkZHIgPSAodm9pZCAqKWlmci0+aWZyX2RhdGE7DQo+ID4gKyAgICAgdTMyIGV0
aGNtZDsNCj4gPiArDQo+ID4gKyAgICAgLyogWFhYOiBUaGlzIGNhbiBiZSBwdXNoZWQgZG93biBp
bnRvIHRoZSBldGh0b29sXyogaGFuZGxlcnMgdGhhdA0KPiA+ICsgICAgICAqIG5lZWQgaXQuICBL
ZWVwIGV4aXN0aW5nIGJlaGF2aW9yIGZvciB0aGUgbW9tZW50Lg0KPiA+ICsgICAgICAqLw0KPiA+
ICsgICAgIGlmICghY2FwYWJsZShDQVBfTkVUX0FETUlOKSkNCj4gPiArICAgICAgICAgICAgIHJl
dHVybiAtRVBFUk07DQo+ID4gKw0KPiA+ICsgICAgIGlmICghZGV2IHx8ICFuZXRpZl9kZXZpY2Vf
cHJlc2VudChkZXYpKQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FTk9ERVY7DQo+ID4gKw0K
PiA+ICsgICAgIGlmIChjb3B5X2Zyb21fdXNlcigmZXRoY21kLCB1c2VyYWRkciwgc2l6ZW9mKGV0
aGNtZCkpICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIC1FRkFVTFQ7DQo+ID4gKw0K
PiA+ICsgICAgIHN3aXRjaCAoZXRoY21kKSB7DQo+ID4gKyAgICAgY2FzZSBFVEhUT09MX0dTRVQ6
DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXRodG9vbF9nZXRfc2V0dGluZ3MoZGV2LCB1c2Vy
YWRkcik7DQo+ID4gKyAgICAgY2FzZSBFVEhUT09MX1NTRVQ6DQo+ID4gKyAgICAgICAgICAgICBy
ZXR1cm4gZXRodG9vbF9zZXRfc2V0dGluZ3MoZGV2LCB1c2VyYWRkcik7DQo+ID4gKyAgICAgY2Fz
ZSBFVEhUT09MX0dEUlZJTkZPOg0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIGV0aHRvb2xfZ2V0
X2RydmluZm8oZGV2LCB1c2VyYWRkcik7DQo+ID4gKyAgICAgY2FzZSBFVEhUT09MX0dSRUdTOg0K
PiA+ICsgICAgICAgICAgICAgcmV0dXJuIGV0aHRvb2xfZ2V0X3JlZ3MoZGV2LCB1c2VyYWRkcik7
DQo+ID4gKyAgICAgY2FzZSBFVEhUT09MX0dXT0w6DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4g
ZXRodG9vbF9nZXRfd29sKGRldiwgdXNlcmFkZHIpOw0KPiA+ICsgICAgIGNhc2UgRVRIVE9PTF9T
V09MOg0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIGV0aHRvb2xfc2V0X3dvbChkZXYsIHVzZXJh
ZGRyKTsNCj4gPiArICAgICBjYXNlIEVUSFRPT0xfR01TR0xWTDoNCj4gPiArICAgICAgICAgICAg
IHJldHVybiBldGh0b29sX2dldF9tc2dsZXZlbChkZXYsIHVzZXJhZGRyKTsNCj4gPiArICAgICBj
YXNlIEVUSFRPT0xfU01TR0xWTDoNCj4gPiArICAgICAgICAgICAgIHJldHVybiBldGh0b29sX3Nl
dF9tc2dsZXZlbChkZXYsIHVzZXJhZGRyKTsNCj4gPiArICAgICBjYXNlIEVUSFRPT0xfTldBWV9S
U1Q6DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXRodG9vbF9ud2F5X3Jlc2V0KGRldik7DQo+
ID4gKyAgICAgY2FzZSBFVEhUT09MX0dMSU5LOg0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIGV0
aHRvb2xfZ2V0X2xpbmsoZGV2LCB1c2VyYWRkcik7DQo+ID4gKyAgICAgY2FzZSBFVEhUT09MX0dF
RVBST006DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXRodG9vbF9nZXRfZWVwcm9tKGRldiwg
dXNlcmFkZHIpOw0KPiA+ICsgICAgIGNhc2UgRVRIVE9PTF9TRUVQUk9NOg0KPiA+ICsgICAgICAg
ICAgICAgcmV0dXJuIGV0aHRvb2xfc2V0X2VlcHJvbShkZXYsIHVzZXJhZGRyKTsNCj4gPiArICAg
ICBjYXNlIEVUSFRPT0xfR0NPQUxFU0NFOg0KPiA+ICsgICAgICAgICAgICAgcmV0dXJuIGV0aHRv
b2xfZ2V0X2NvYWxlc2NlKGRldiwgdXNlcmFkZHIpOw0KPiA+ICsgICAgIGNhc2UgRVRIVE9PTF9T
Q09BTEVTQ0U6DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXRodG9vbF9zZXRfY29hbGVzY2Uo
ZGV2LCB1c2VyYWRkcik7DQo+ID4gKyAgICAgY2FzZSBFVEhUT09MX0dSSU5HUEFSQU06DQo+ID4g
KyAgICAgICAgICAgICByZXR1cm4gZXRodG9vbF9nZXRfcmluZ3BhcmFtKGRldiwgdXNlcmFkZHIp
Ow0KPiA+ICsgICAgIGNhc2UgRVRIVE9PTF9TUklOR1BBUkFNOg0KPiA+ICsgICAgICAgICAgICAg
cmV0dXJuIGV0aHRvb2xfc2V0X3JpbmdwYXJhbShkZXYsIHVzZXJhZGRyKTsNCj4gPiArICAgICBj
YXNlIEVUSFRPT0xfR1BBVVNFUEFSQU06DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXRodG9v
bF9nZXRfcGF1c2VwYXJhbShkZXYsIHVzZXJhZGRyKTsNCj4gPiArICAgICBjYXNlIEVUSFRPT0xf
U1BBVVNFUEFSQU06DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXRodG9vbF9zZXRfcGF1c2Vw
YXJhbShkZXYsIHVzZXJhZGRyKTsNCj4gPiArICAgICBjYXNlIEVUSFRPT0xfR1JYQ1NVTToNCj4g
PiArICAgICAgICAgICAgIHJldHVybiBldGh0b29sX2dldF9yeF9jc3VtKGRldiwgdXNlcmFkZHIp
Ow0KPiA+ICsgICAgIGNhc2UgRVRIVE9PTF9TUlhDU1VNOg0KPiA+ICsgICAgICAgICAgICAgcmV0
dXJuIGV0aHRvb2xfc2V0X3J4X2NzdW0oZGV2LCB1c2VyYWRkcik7DQo+ID4gKyAgICAgY2FzZSBF
VEhUT09MX0dUWENTVU06DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXRodG9vbF9nZXRfdHhf
Y3N1bShkZXYsIHVzZXJhZGRyKTsNCj4gPiArICAgICBjYXNlIEVUSFRPT0xfU1RYQ1NVTToNCj4g
PiArICAgICAgICAgICAgIHJldHVybiBldGh0b29sX3NldF90eF9jc3VtKGRldiwgdXNlcmFkZHIp
Ow0KPiA+ICsgICAgIGNhc2UgRVRIVE9PTF9HU0c6DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4g
ZXRodG9vbF9nZXRfc2coZGV2LCB1c2VyYWRkcik7DQo+ID4gKyAgICAgY2FzZSBFVEhUT09MX1NT
RzoNCj4gPiArICAgICAgICAgICAgIHJldHVybiBldGh0b29sX3NldF9zZyhkZXYsIHVzZXJhZGRy
KTsNCj4gPiArICAgICBjYXNlIEVUSFRPT0xfR1RTTzoNCj4gPiArICAgICAgICAgICAgIHJldHVy
biBldGh0b29sX2dldF90c28oZGV2LCB1c2VyYWRkcik7DQo+ID4gKyAgICAgY2FzZSBFVEhUT09M
X1NUU086DQo+ID4gKyAgICAgICAgICAgICByZXR1cm4gZXRodG9vbF9zZXRfdHNvKGRldiwgdXNl
cmFkZHIpOw0KPiA+ICsgICAgIGNhc2UgRVRIVE9PTF9URVNUOg0KPiA+ICsgICAgICAgICAgICAg
cmV0dXJuIGV0aHRvb2xfc2VsZl90ZXN0KGRldiwgdXNlcmFkZHIpOw0KPiA+ICsgICAgIGNhc2Ug
RVRIVE9PTF9HU1RSSU5HUzoNCj4gPiArICAgICAgICAgICAgIHJldHVybiBldGh0b29sX2dldF9z
dHJpbmdzKGRldiwgdXNlcmFkZHIpOw0KPiA+ICsgICAgIGNhc2UgRVRIVE9PTF9QSFlTX0lEOg0K
PiA+ICsgICAgICAgICAgICAgcmV0dXJuIGV0aHRvb2xfcGh5c19pZChkZXYsIHVzZXJhZGRyKTsN
Cj4gPiArICAgICBjYXNlIEVUSFRPT0xfR1NUQVRTOg0KPiA+ICsgICAgICAgICAgICAgcmV0dXJu
IGV0aHRvb2xfZ2V0X3N0YXRzKGRldiwgdXNlcmFkZHIpOw0KPiA+ICsgICAgIGRlZmF1bHQ6DQo+
ID4gKyAgICAgICAgICAgICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ID4gKyAgICAgfQ0KPiA+ICsN
Cj4gPiArICAgICByZXR1cm4gLUVPUE5PVFNVUFA7DQo+ID4gK30NCj4gPiArI2VuZGlmIC8qIEVU
SFRPT0xfT1BTX0NPTVBBVCAqLw0KPiA+ICsNCj4gPiArc3RhdGljIGludCBydGFzZV9zaW9jZGV2
cHJpdmF0ZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1Y3QgaWZyZXEgKmlmciwgdm9pZA0K
PiBfX3VzZXIgKmRhdGEsDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGNt
ZCkNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9w
cml2KGRldik7DQo+ID4gKyAgICAgaW50IHJldCA9IDA7DQo+ID4gKw0KPiA+ICsgICAgICh2b2lk
KWRhdGE7DQo+ID4gKw0KPiA+ICsgICAgIGlmICgodHAtPnB0bV9zdXBwb3J0ID09IDB1KSAmJiAo
Y21kID09IFNJT19QUklWX1JUS19QVE0pKSB7DQo+ID4gKyAgICAgICAgICAgICByZXQgPSAtRU9Q
Tk9UU1VQUDsNCj4gPiArICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAgIH0NCj4gPiAr
DQo+ID4gKyAgICAgc3dpdGNoIChjbWQpIHsNCj4gPiArICAgICBjYXNlIFNJT19QUklWX1JUS19S
RUc6DQo+ID4gKyAgICAgICAgICAgICByZXQgPSByZWdfZnVuKGlmciwgdHApOw0KPiA+ICsgICAg
ICAgICAgICAgYnJlYWs7DQo+ID4gKyAgICAgY2FzZSBTSU9fUFJJVl9SVEtfUlhRT1M6DQo+ID4g
KyAgICAgICAgICAgICByZXQgPSBydGFzZV9yeHFvcyhpZnIsIHRwKTsNCj4gPiArICAgICAgICAg
ICAgIGJyZWFrOw0KPiA+ICsgICAgIGNhc2UgU0lPX1RJTUVPVVRfU0lHX1NFVDoNCj4gPiArICAg
ICAgICAgICAgIHJldCA9IHRpbWVvdXRfc2lnKGlmciwgdHApOw0KPiA+ICsgICAgICAgICAgICAg
YnJlYWs7DQo+ID4gKyAgICAgY2FzZSBTSU9fUFJJVl9SVEtfUFRNOg0KPiA+ICsgICAgICAgICAg
ICAgcmV0ID0gcnRhc2VfcHRtKGlmciwgdHApOw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+
ID4gKyAgICAgY2FzZSBTSU9fUFJJVl9SVEtfSU5GTzoNCj4gPiArICAgICAgICAgICAgIHJldCA9
IHJ0YXNlX2RlYnVnX21zZyhpZnIsIHRwKTsNCj4gPiArICAgICAgICAgICAgIGJyZWFrOw0KPiA+
ICsNCj4gPiArICAgICBkZWZhdWx0Og0KPiA+ICsgICAgICAgICAgICAgcmV0ID0gLUVPUE5PVFNV
UFA7DQo+ID4gKyAgICAgICAgICAgICBicmVhazsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICtv
dXQ6DQo+ID4gKyAgICAgcmV0dXJuIHJldDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGlu
dCBydGFzZV9kb19pb2N0bChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1Y3QgaWZyZXEgKmlm
ciwgaW50IGNtZCkNCj4gPiArew0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRl
ICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAgICAgaW50IHJldCA9IDA7DQo+ID4gKw0K
PiA+ICsgICAgICh2b2lkKWlmcjsNCj4gPiArDQo+ID4gKyAgICAgaWYgKCh0cC0+cHRtX3N1cHBv
cnQgPT0gMHUpICYmIChjbWQgPT0gU0lPX1BSSVZfUlRLX1BUTSkpIHsNCj4gPiArICAgICAgICAg
ICAgIHJldCA9IC1FT1BOT1RTVVBQOw0KPiA+ICsgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4g
KyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBzd2l0Y2ggKGNtZCkgew0KPiA+ICsjaWZkZWYgRVRI
VE9PTF9PUFNfQ09NUEFUDQo+ID4gKyAgICAgY2FzZSBTSU9DRVRIVE9PTDoNCj4gPiArICAgICAg
ICAgICAgIHJldCA9IGV0aHRvb2xfaW9jdGwoaWZyKTsNCj4gPiArICAgICAgICAgICAgIGJyZWFr
Ow0KPiA+ICsjZW5kaWYNCj4gPiArDQo+ID4gKyAgICAgZGVmYXVsdDoNCj4gPiArICAgICAgICAg
ICAgIHJldCA9IC1FT1BOT1RTVVBQOw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAg
ICAgfQ0KPiA+ICsNCj4gPiArb3V0Og0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4g
PiArDQo+ID4gK3N0YXRpYyBzMzIgcnRhc2VfYWxsb2NfbXNpeChzdHJ1Y3QgcGNpX2RldiAqcGRl
diwgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7DQo+ID4gKyAgICAgdTE2IGkgPSAw
Ow0KPiA+ICsgICAgIHMzMiByYyA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIG1lbXNldCh0cC0+bXNp
eF9lbnRyeSwgMHgwLCBOVU1fTVNJWCAqIHNpemVvZihzdHJ1Y3QNCj4gbXNpeF9lbnRyeSkpOw0K
PiA+ICsgICAgIGZvciAoaSA9IDB1OyBpIDwgTlVNX01TSVg7IGkrKykNCj4gPiArICAgICAgICAg
ICAgIHRwLT5tc2l4X2VudHJ5W2ldLmVudHJ5ID0gKHUxNilpOw0KPiA+ICsNCj4gPiArICAgICBy
YyA9IHBjaV9lbmFibGVfbXNpeF9yYW5nZShwZGV2LCB0cC0+bXNpeF9lbnRyeSwgKHMzMil0cC0+
aW50X251bXMsDQo+IChzMzIpdHAtPmludF9udW1zKTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKCh1
MTYpcmMgPT0gdHAtPmludF9udW1zKSB7DQo+ID4gKyAgICAgICAgICAgICBmb3IgKGkgPSAwdTsg
aSA8IHRwLT5pbnRfbnVtczsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHRwLT5p
bnRfdmVjdG9yW2ldLmlycSA9ICh1MzIpKHBjaV9pcnFfdmVjdG9yKHBkZXYsDQo+ICh1MzIpaSkp
Ow0KPiA+ICsgICAgICAgICAgICAgICAgICAgICB0cC0+aW50X3ZlY3RvcltpXS5zdGF0dXMgPSAx
Ow0KPiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgcmV0
dXJuIHJjOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgczMyIHJ0YXNlX2FsbG9jX2ludGVy
cnVwdChzdHJ1Y3QgcGNpX2RldiAqcGRldiwgc3RydWN0IHJ0YXNlX3ByaXZhdGUNCj4gKnRwKQ0K
PiANCj4gQnkgdXNpbmcgcGNpX2FsbG9jX2lycV92ZWN0b3JzKCkgYSBsb3QgaWYgdGhpcyBzdHVm
ZiBoZXJlIHNob3VsZG4ndCBiZSBuZWVkZWQuDQo+IA0KPiA+ICt7DQo+ID4gKyAgICAgczMyIHJj
ID0gMDsNCj4gPiArDQo+ID4gKyAgICAgcmMgPSBydGFzZV9hbGxvY19tc2l4KHBkZXYsIHRwKTsN
Cj4gPiArICAgICBpZiAoKHUxNilyYyAhPSB0cC0+aW50X251bXMpIHsNCj4gPiArICAgICAgICAg
ICAgIHJjID0gcGNpX2VuYWJsZV9tc2kocGRldik7DQo+ID4gKyAgICAgICAgICAgICBpZiAocmMg
IT0gMCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgZGV2X2VycigmcGRldi0+ZGV2LCAidW5h
YmxlIHRvIGFsbG9jDQo+IGludGVycnVwdC4oTVNJKVxuIik7DQo+ID4gKyAgICAgICAgICAgICBl
bHNlDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHRwLT5zd19mbGFnIHw9ICh1MzIpU1dGX01T
SV9FTkFCTEVEOw0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICB0cC0+c3df
ZmxhZyB8PSAodTMyKVNXRl9NU0lYX0VOQUJMRUQ7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiAr
ICAgICByZXR1cm4gcmM7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX3Jl
c2V0X2ludGVycnVwdChzdHJ1Y3QgcGNpX2RldiAqcGRldiwgY29uc3Qgc3RydWN0DQo+IHJ0YXNl
X3ByaXZhdGUgKnRwKQ0KPiA+ICt7DQo+ID4gKyAgICAgaWYgKCh0cC0+c3dfZmxhZyAmIFNXRl9N
U0lYX0VOQUJMRUQpICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgcGNpX2Rpc2FibGVfbXNpeChw
ZGV2KTsNCj4gPiArICAgICBlbHNlIGlmICgodHAtPnN3X2ZsYWcgJiBTV0ZfTVNJX0VOQUJMRUQp
ICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgcGNpX2Rpc2FibGVfbXNpKHBkZXYpOw0KPiA+ICsg
ICAgIGVsc2UNCj4gPiArICAgICAgICAgICAgIG5ldGRldl9pbmZvKHRwLT5kZXYsICJpbnRlcnJ1
cHQgaXMgbmV2ZXIgZW5hYmxlZFxuIik7DQo+ID4gK30NCj4gPiArDQo+ID4gKy8qIHJ0YXNlX2lu
aXRfYm9hcmQgLQ0KPiA+ICsgKiBAcGRldjogUENJIGRldmljZSBzdHJ1Y3QNCj4gPiArICogQGRl
dl9vdXQ6DQo+ID4gKyAqIEBpb2FkZHJfb3V0Og0KPiA+ICsgKg0KPiA+ICsgKiBSZXR1cm4gMCBv
biBzdWNjZXNzLCBuZWdhdGl2ZSBvbiBmYWlsdXJlDQo+ID4gKyAqLw0KPiA+ICtzdGF0aWMgaW50
IHJ0YXNlX2luaXRfYm9hcmQoc3RydWN0IHBjaV9kZXYgKnBkZXYsIHN0cnVjdCBuZXRfZGV2aWNl
DQo+ICoqZGV2X291dCwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgX19pb21l
bSAqKmlvYWRkcl9vdXQpDQo+ID4gK3sNCj4gPiArICAgICB2b2lkIF9faW9tZW0gKmlvYWRkcjsN
Cj4gPiArICAgICBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2Ow0KPiA+ICsgICAgIHN0cnVjdCBydGFz
ZV9wcml2YXRlICp0cDsNCj4gPiArICAgICBpbnQgcmMgPSAtRU5PTUVNOw0KPiA+ICsNCj4gPiAr
ICAgICBhc3NlcnQoaW9hZGRyX291dCk7DQo+ID4gKw0KPiA+ICsgICAgIC8qIGRldiB6ZXJvZWQg
aW4gYWxsb2NfZXRoZXJkZXYgKi8NCj4gPiArICAgICBkZXYgPSBhbGxvY19ldGhlcmRldl9tcSgo
czMyKShzaXplb2Yoc3RydWN0IHJ0YXNlX3ByaXZhdGUpKSwNCj4gZnVuY190eHFfbnVtKTsNCj4g
PiArICAgICBpZiAoIWRldikgew0KPiA+ICsgICAgICAgICAgICAgaWYgKG5ldGlmX21zZ19kcnYo
JmRlYnVnKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgZGV2X2VycigmcGRldi0+
ZGV2LCAidW5hYmxlIHRvIGFsbG9jIG5ldw0KPiBldGhlcm5ldFxuIik7DQo+ID4gKw0KPiA+ICsg
ICAgICAgICAgICAgZ290byBlcnJfb3V0Ow0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAg
U0VUX01PRFVMRV9PV05FUihkZXYpOw0KPiA+ICsgICAgIFNFVF9ORVRERVZfREVWKGRldiwgJnBk
ZXYtPmRldik7DQo+ID4gKyAgICAgdHAgPSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsgICAgIHRw
LT5kZXYgPSBkZXY7DQo+ID4gKyAgICAgdHAtPm1zZ19lbmFibGUgPSBuZXRpZl9tc2dfaW5pdCgo
czMyKWRlYnVnLm1zZ19lbmFibGUsDQo+IChzMzIpUlRBU0VfTVNHX0RFRkFVTFQpOw0KPiA+ICsN
Cj4gPiArICAgICAvKiBlbmFibGUgZGV2aWNlIChpbmNsLiBQQ0kgUE0gd2FrZXVwIGFuZCBob3Rw
bHVnIHNldHVwKSAqLw0KPiA+ICsgICAgIHJjID0gcGNpX2VuYWJsZV9kZXZpY2UocGRldik7DQo+
ID4gKyAgICAgaWYgKHJjIDwgMCkgew0KPiA+ICsgICAgICAgICAgICAgaWYgKG5ldGlmX21zZ19w
cm9iZSh0cCkgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGRldl9lcnIoJnBkZXYt
PmRldiwgImVuYWJsZSBmYWlsdXJlXG4iKTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBnb3Rv
IGVycl9vdXRfZnJlZV9kZXY7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICAvKiBtYWtl
IHN1cmUgUENJIGJhc2UgYWRkciAxIGlzIE1NSU8gKi8NCj4gPiArICAgICBpZiAoKHBjaV9yZXNv
dXJjZV9mbGFncyhwZGV2LCAyKSAmICh1NjQpSU9SRVNPVVJDRV9NRU0pID09IDB1KSB7DQo+ID4g
KyAgICAgICAgICAgICBpZiAobmV0aWZfbXNnX3Byb2JlKHRwKSAhPSAwdSkNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgZGV2X2VycigmcGRldi0+ZGV2LCAicmVnaW9uICMxIG5vdCBhbiBNTUlP
DQo+IHJlc291cmNlLCBhYm9ydGluZ1xuIik7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgcmMg
PSAtRU5PREVWOw0KPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfb3V0X2Rpc2FibGU7DQo+ID4g
KyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICAvKiBjaGVjayBmb3Igd2VpcmQvYnJva2VuIFBDSSBy
ZWdpb24gcmVwb3J0aW5nICovDQo+ID4gKyAgICAgaWYgKHBjaV9yZXNvdXJjZV9sZW4ocGRldiwg
MikgPCBSVEFTRV9SRUdTX1NJWkUpIHsNCj4gPiArICAgICAgICAgICAgIGlmIChuZXRpZl9tc2df
cHJvYmUodHApICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBkZXZfZXJyKCZwZGV2
LT5kZXYsICJJbnZhbGlkIFBDSSByZWdpb24gc2l6ZShzKSwNCj4gYWJvcnRpbmdcbiIpOw0KPiA+
ICsNCj4gPiArICAgICAgICAgICAgIHJjID0gLUVOT0RFVjsNCj4gPiArICAgICAgICAgICAgIGdv
dG8gZXJyX291dF9kaXNhYmxlOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgcmMgPSBw
Y2lfcmVxdWVzdF9yZWdpb25zKHBkZXYsIE1PRFVMRU5BTUUpOw0KPiA+ICsgICAgIGlmIChyYyA8
IDApIHsNCj4gPiArICAgICAgICAgICAgIGlmIChuZXRpZl9tc2dfcHJvYmUodHApICE9IDB1KQ0K
PiA+ICsgICAgICAgICAgICAgICAgICAgICBkZXZfZXJyKCZwZGV2LT5kZXYsICJjb3VsZCBub3Qg
cmVxdWVzdA0KPiByZWdpb25zLlxuIik7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgZ290byBl
cnJfb3V0X2Rpc2FibGU7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBpZiAoZG1hX3Nl
dF9tYXNrX2FuZF9jb2hlcmVudCgmcGRldi0+ZGV2LCBETUFfQklUX01BU0soNjQpKQ0KPiA9PSAw
KQ0KPiA+ICsgICAgICAgICAgICAgZGV2LT5mZWF0dXJlcyB8PSBORVRJRl9GX0hJR0hETUE7DQo+
ID4gKyAgICAgZWxzZSBpZiAoZG1hX3NldF9tYXNrX2FuZF9jb2hlcmVudCgmcGRldi0+ZGV2LA0K
PiBETUFfQklUX01BU0soMzIpKSAhPSAwKQ0KPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfb3V0
X2ZyZWVfcmVzOw0KPiA+ICsgICAgIGVsc2UNCj4gPiArICAgICAgICAgICAgIHByX2luZm8oIkRN
QV9CSVRfTUFTSzogMzJcbiIpOw0KPiA+ICsNCj4gPiArICAgICBwY2lfc2V0X21hc3RlcihwZGV2
KTsNCj4gPiArDQo+ID4gKyAgICAgLyogaW9yZW1hcCBNTUlPIHJlZ2lvbiAqLw0KPiA+ICsgICAg
IGlvYWRkciA9IGlvcmVtYXAocGNpX3Jlc291cmNlX3N0YXJ0KHBkZXYsIDIpLCBwY2lfcmVzb3Vy
Y2VfbGVuKHBkZXYsDQo+IDIpKTsNCj4gPiArICAgICBpZiAoIWlvYWRkcikgew0KPiA+ICsgICAg
ICAgICAgICAgaWYgKG5ldGlmX21zZ19wcm9iZSh0cCkgIT0gMHUpDQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgIGRldl9lcnIoJnBkZXYtPmRldiwgImNhbm5vdCByZW1hcCBNTUlPLA0KPiBhYm9y
dGluZ1xuIik7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgcmMgPSAtRUlPOw0KPiA+ICsgICAg
ICAgICAgICAgZ290byBlcnJfb3V0X2ZyZWVfcmVzOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4g
KyAgICAgLyogSWRlbnRpZnkgY2hpcCBhdHRhY2hlZCB0byBib2FyZCAqLw0KPiA+ICsgICAgIHJ0
YXNlX2dldF9tYWNfdmVyc2lvbih0cCwgaW9hZGRyKTsNCj4gPiArICAgICBydGFzZV9wcmludF9t
YWNfdmVyc2lvbih0cCk7DQo+ID4gKw0KPiA+ICsgICAgICppb2FkZHJfb3V0ID0gaW9hZGRyOw0K
PiA+ICsgICAgICpkZXZfb3V0ID0gZGV2Ow0KPiA+ICsgICAgIGdvdG8gb3V0Ow0KPiA+ICsNCj4g
PiArZXJyX291dF9mcmVlX3JlczoNCj4gPiArICAgICBwY2lfcmVsZWFzZV9yZWdpb25zKHBkZXYp
Ow0KPiA+ICsNCj4gPiArZXJyX291dF9kaXNhYmxlOg0KPiA+ICsgICAgIHBjaV9kaXNhYmxlX2Rl
dmljZShwZGV2KTsNCj4gPiArDQo+ID4gK2Vycl9vdXRfZnJlZV9kZXY6DQo+ID4gKyAgICAgZnJl
ZV9uZXRkZXYoZGV2KTsNCj4gPiArDQo+ID4gK2Vycl9vdXQ6DQo+ID4gKyAgICAgKmlvYWRkcl9v
dXQgPSBOVUxMOw0KPiA+ICsgICAgICpkZXZfb3V0ID0gTlVMTDsNCj4gPiArDQo+ID4gK291dDoN
Cj4gPiArICAgICByZXR1cm4gcmM7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgbmV0X2RldmljZV9vcHMgcnRhc2VfbmV0ZGV2X29wcyA9IHsNCj4gPiArICAgICAubmRv
X29wZW4gPSBydGFzZV9vcGVuLA0KPiA+ICsgICAgIC5uZG9fc3RvcCA9IHJ0YXNlX2Nsb3NlLA0K
PiA+ICsgICAgIC5uZG9fc3RhcnRfeG1pdCA9IHJ0YXNlX3N0YXJ0X3htaXQsDQo+ID4gKyAgICAg
Lm5kb19zZXRfcnhfbW9kZSA9IHJ0YXNlX3NldF9yeF9tb2RlLA0KPiA+ICsgICAgIC5uZG9fc2V0
X21hY19hZGRyZXNzID0gcnRhc2Vfc2V0X21hY19hZGRyZXNzLA0KPiA+ICsgICAgIC5uZG9fc2lv
Y2RldnByaXZhdGUgPSBydGFzZV9zaW9jZGV2cHJpdmF0ZSwNCj4gPiArICAgICAubmRvX2V0aF9p
b2N0bCA9IHJ0YXNlX2RvX2lvY3RsLA0KPiA+ICsgICAgIC5uZG9fY2hhbmdlX210dSA9IHJ0YXNl
X2NoYW5nZV9tdHUsDQo+ID4gKyAgICAgLm5kb190eF90aW1lb3V0ID0gcnRhc2VfdHhfdGltZW91
dCwNCj4gPiArICAgICAubmRvX2dldF9zdGF0czY0ID0gcnRhc2VfZ2V0X3N0YXRzNjQsDQo+ID4g
KyAgICAgLm5kb192bGFuX3J4X2FkZF92aWQgPSBydGFzZV92bGFuX3J4X2FkZF92aWQsDQo+ID4g
KyAgICAgLm5kb192bGFuX3J4X2tpbGxfdmlkID0gcnRhc2Vfdmxhbl9yeF9raWxsX3ZpZCwNCj4g
PiArI2lmZGVmIENPTkZJR19ORVRfUE9MTF9DT05UUk9MTEVSDQo+ID4gKyAgICAgLm5kb19wb2xs
X2NvbnRyb2xsZXIgPSBydGFzZV9uZXRwb2xsLA0KPiA+ICsjZW5kaWYNCj4gPiArI2lmZGVmIElG
TEFfVkZfTUFYDQo+ID4gKyAgICAgLm5kb19zZXRfdmZfbWFjID0gcnRhc2Vfc2V0X3ZmX21hYywN
Cj4gPiArICAgICAubmRvX2dldF92Zl9jb25maWcgPSBydGFzZV9nZXRfdmZfY29uZmlnLA0KPiA+
ICsjZW5kaWYgLyogSUZMQV9WRl9NQVggKi8NCj4gPiArICAgICAubmRvX3NldHVwX3RjID0gcnRh
c2Vfc2V0dXBfdGMsDQo+ID4gKyAgICAgLm5kb19maXhfZmVhdHVyZXMgPSBydGFzZV9maXhfZmVh
dHVyZXMsDQo+ID4gKyAgICAgLm5kb19zZXRfZmVhdHVyZXMgPSBydGFzZV9zZXRfZmVhdHVyZXMs
DQo+ID4gK307DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9pbml0X25ldGRldl9vcHMo
c3RydWN0IG5ldF9kZXZpY2UgKmRldikNCj4gPiArew0KPiA+ICsgICAgIGRldi0+bmV0ZGV2X29w
cyA9ICZydGFzZV9uZXRkZXZfb3BzOw0KPiA+ICsNCj4gPiArICAgICBTRVRfRVRIVE9PTF9PUFMo
ZGV2LCAmcnRhc2VfZXRodG9vbF9vcHMpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICsvKiBydGFzZV9p
bml0X29uZSAtIFBDSSBEZXZpY2UgSW5pdGlhbGl6YXRpb24NCj4gPiArICogQHBkZXY6IFBDSSBk
ZXZpY2Ugc3RydWN0DQo+ID4gKyAqIEBlbnQ6IGVudHJ5IGluIHJ0bHh4eF9wY2lfdGJsDQo+ID4g
KyAqDQo+ID4gKyAqIFJldHVybiAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIG9uIGZhaWx1cmUNCj4g
PiArICovDQo+ID4gK3N0YXRpYyBpbnQgcnRhc2VfaW5pdF9vbmUoc3RydWN0IHBjaV9kZXYgKnBk
ZXYsIGNvbnN0IHN0cnVjdCBwY2lfZGV2aWNlX2lkDQo+ICplbnQpDQo+ID4gK3sNCj4gPiArICAg
ICBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2ID0gTlVMTDsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2Vf
cHJpdmF0ZSAqdHA7DQo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICppb2FkZHIgPSBOVUxMOw0KPiA+
ICsgICAgIGludCByYzsNCj4gPiArDQo+ID4gKyAgICAgKHZvaWQpZW50Ow0KPiBEb24ndCBkbyB0
aGlzLg0KPiANCj4gPiArICAgICBhc3NlcnQocGRldik7DQo+ID4gKyAgICAgYXNzZXJ0KGVudCk7
DQo+ID4gKw0KPiA+ICsgICAgIGlmICgocGRldi0+aXNfcGh5c2ZuID09IDB1KSAmJiAocGRldi0+
aXNfdmlydGZuICE9IDB1KSkgew0KPiA+ICsgICAgICAgICAgICAgcHJfaW5mbygiJXMgVGhpcyBt
b2R1bGUgZG9lcyBub3Qgc3VwcG9ydCBhIHZpcnR1YWwNCj4gZnVuY3Rpb24uIiwgTU9EVUxFTkFN
RSk7DQo+ID4gKyAgICAgICAgICAgICByYyA9IC1FSU5WQUw7DQo+ID4gKyAgICAgICAgICAgICBn
b3RvIG91dDsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGlmIChuZXRpZl9tc2dfZHJ2
KCZkZWJ1ZykgIT0gMHUpDQo+ID4gKyAgICAgICAgICAgICBwcl9pbmZvKCIlcyBBdXRvbW90aXZl
IFN3aXRjaCBFdGhlcm5ldCBkcml2ZXIgJXMNCj4gbG9hZGVkXG4iLCBNT0RVTEVOQU1FLA0KPiA+
ICsgICAgICAgICAgICAgICAgICAgICBSVEFTRV9WRVJTSU9OKTsNCj4gPiArDQo+ID4gKyAgICAg
cmMgPSBydGFzZV9pbml0X2JvYXJkKHBkZXYsICZkZXYsICZpb2FkZHIpOw0KPiA+ICsgICAgIGlm
IChyYyAhPSAwKQ0KPiA+ICsgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gKw0KPiA+ICsgICAg
IHRwID0gbmV0ZGV2X3ByaXYoZGV2KTsNCj4gPiArICAgICBhc3NlcnQoaW9hZGRyKTsNCj4gPiAr
ICAgICB0cC0+bW1pb19hZGRyID0gaW9hZGRyOw0KPiA+ICsgICAgIHRwLT5wZGV2ID0gcGRldjsN
Cj4gPiArICAgICBkZXYtPnRzdGF0cyA9IGRldm1fbmV0ZGV2X2FsbG9jX3BjcHVfc3RhdHMoJnBk
ZXYtPmRldiwgc3RydWN0DQo+IHBjcHVfc3dfbmV0c3RhdHMpOw0KPiA+ICsgICAgIGlmICghZGV2
LT50c3RhdHMpDQo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9vdXRfMTsNCj4gPiArDQo+ID4g
KyAgICAgcnRhc2VfaW5pdF9zb2Z0d2FyZV92YXJpYWJsZShkZXYpOw0KPiA+ICsgICAgIHJ0YXNl
X2luaXRfaGFyZHdhcmUodHApOw0KPiA+ICsNCj4gPiArICAgICByYyA9IHJ0YXNlX2FsbG9jX2lu
dGVycnVwdChwZGV2LCB0cCk7DQo+ID4gKyAgICAgaWYgKHJjIDwgMCkNCj4gPiArICAgICAgICAg
ICAgIHByX2VycigidW5hYmxlIHRvIGFsbG9jIE1TSVgvTVNJXG4iKTsNCj4gPiArDQo+ID4gKyAg
ICAgcnRhc2VfaW5pdF9uZXRkZXZfb3BzKGRldik7DQo+ID4gKw0KPiA+ICsgICAgIGRldi0+d2F0
Y2hkb2dfdGltZW8gPSBSVEFTRV9UWF9USU1FT1VUOw0KPiA+ICsgICAgIGRldi0+aXJxID0gKHMz
MilwZGV2LT5pcnE7DQo+ID4gKyAgICAgZGV2LT5iYXNlX2FkZHIgPSAodW5zaWduZWQgbG9uZylp
b2FkZHI7DQo+ID4gKw0KPiA+ICsgICAgIGRldi0+ZmVhdHVyZXMgfD0gTkVUSUZfRl9IV19WTEFO
X1RYIHwgTkVUSUZfRl9IV19WTEFOX1JYOw0KPiA+ICsjaWZkZWYgUlRMX0hXX1ZMQU5fRklMVEVS
DQo+ID4gKyAgICAgZGV2LT5mZWF0dXJlcyB8PSBORVRJRl9GX0hXX1ZMQU5fQ1RBR19GSUxURVI7
DQo+ID4gKyNlbmRpZg0KPiA+ICsNCj4gPiArICAgICBpZiAodHAtPm1jZmcgIT0gQ0ZHX01FVEhP
RF9ERUZBVUxUKSB7DQo+ID4gKyAgICAgICAgICAgICBkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0Zf
SVBfQ1NVTTsNCj4gPiArICAgICAgICAgICAgIGRldi0+ZmVhdHVyZXMgfD0gTkVUSUZfRl9SWENT
VU0gfCBORVRJRl9GX1NHIHwNCj4gTkVUSUZfRl9UU087DQo+ID4gKyAgICAgICAgICAgICBkZXYt
Pmh3X2ZlYXR1cmVzID0gTkVUSUZfRl9TRyB8IE5FVElGX0ZfSVBfQ1NVTSB8DQo+IE5FVElGX0Zf
VFNPIHwgTkVUSUZfRl9SWENTVU0NCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB8IE5FVElGX0ZfSFdfVkxBTl9UWCB8DQo+IE5FVElGX0ZfSFdfVkxBTl9SWDsNCj4gPiArICAg
ICAgICAgICAgIGRldi0+dmxhbl9mZWF0dXJlcyA9IE5FVElGX0ZfU0cgfCBORVRJRl9GX0lQX0NT
VU0gfA0KPiBORVRJRl9GX1RTTyB8IE5FVElGX0ZfSElHSERNQTsNCj4gPiArICAgICAgICAgICAg
IGRldi0+cHJpdl9mbGFncyB8PSBJRkZfTElWRV9BRERSX0NIQU5HRTsNCj4gPiArICAgICAgICAg
ICAgIGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9SWEFMTDsNCj4gPiArICAgICAgICAgICAg
IGRldi0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9SWEZDUzsNCj4gPiArICAgICAgICAgICAgIGRl
di0+aHdfZmVhdHVyZXMgfD0gTkVUSUZfRl9JUFY2X0NTVU0gfCBORVRJRl9GX1RTTzY7DQo+ID4g
KyAgICAgICAgICAgICBkZXYtPmZlYXR1cmVzIHw9IE5FVElGX0ZfSVBWNl9DU1VNIHwgTkVUSUZf
Rl9UU082Ow0KPiA+ICsgICAgICAgICAgICAgbmV0aWZfc2V0X3Rzb19tYXhfc2l6ZShkZXYsIExT
T182NEspOw0KPiA+ICsgICAgICAgICAgICAgbmV0aWZfc2V0X3Rzb19tYXhfc2VncyhkZXYsDQo+
IE5JQ19NQVhfUEhZU19CVUZfQ09VTlRfTFNPMik7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiAr
ICAgICBpZiAocnRhc2VfZ2V0X21hY19hZGRyZXNzKGRldikgIT0gMCkNCj4gPiArICAgICAgICAg
ICAgIHByX2FsZXJ0KCJ1bmFibGUgdG8gZ2V0IG1hYyBhZGRyZXNzXG4iKTsNCj4gPiArDQo+ID4g
KyAgICAgdHAtPnRhbGx5X3ZhZGRyID0gZG1hX2FsbG9jX2NvaGVyZW50KCZwZGV2LT5kZXYsDQo+
IHNpemVvZigqdHAtPnRhbGx5X3ZhZGRyKSwgJnRwLT50YWxseV9wYWRkciwNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0ZQX0tFUk5FTCk7DQo+ID4gKyAg
ICAgaWYgKCF0cC0+dGFsbHlfdmFkZHIpIHsNCj4gPiArICAgICAgICAgICAgIHJjID0gLUVOT01F
TTsNCj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX291dDsNCj4gPiArICAgICB9DQo+ID4gKw0K
PiA+ICsgICAgIHJ0YXNlX3RhbGx5X2NvdW50ZXJfY2xlYXIodHApOw0KPiA+ICsNCj4gPiArICAg
ICBwY2lfc2V0X2RydmRhdGEocGRldiwgZGV2KTsNCj4gPiArDQo+ID4gKyAgICAgcmMgPSByZWdp
c3Rlcl9uZXRkZXYoZGV2KTsNCj4gPiArICAgICBpZiAocmMgIT0gMCkNCj4gPiArICAgICAgICAg
ICAgIGdvdG8gZXJyX291dDsNCj4gPiArDQo+ID4gKyAgICAgcHJfaW5mbygiJXM6IFRoaXMgcHJv
ZHVjdCBpcyBjb3ZlcmVkIGJ5IG9uZSBvciBtb3JlIG9mIHRoZSBmb2xsb3dpbmcNCj4gcGF0ZW50
czogVVM2LDU3MCw4ODQsIFVTNiwxMTUsNzc2LCBhbmQgVVM2LDMyNyw2MjUuXG4iLA0KPiA+ICsg
ICAgICAgICAgICAgTU9EVUxFTkFNRSk7DQo+ID4gKw0KPiA+ICsgICAgIG5ldGlmX2NhcnJpZXJf
b2ZmKGRldik7DQo+ID4gKw0KPiA+ICsgICAgIHByX2luZm8oIiVzIiwgR1BMX0NMQUlNKTsNCj4g
PiArICAgICBnb3RvIG91dDsNCj4gPiArDQo+ID4gK2Vycl9vdXQ6DQo+ID4gKyAgICAgaWYgKHRw
LT50YWxseV92YWRkcikgew0KPiA+ICsgICAgICAgICAgICAgZG1hX2ZyZWVfY29oZXJlbnQoJnBk
ZXYtPmRldiwgc2l6ZW9mKCp0cC0+dGFsbHlfdmFkZHIpLA0KPiB0cC0+dGFsbHlfdmFkZHIsDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cC0+dGFsbHlfcGFkZHIpOw0KPiA+
ICsNCj4gPiArICAgICAgICAgICAgIHRwLT50YWxseV92YWRkciA9IE5VTEw7DQo+ID4gKyAgICAg
fQ0KPiA+ICsNCj4gPiArZXJyX291dF8xOg0KPiA+ICsgICAgIHJ0YXNlX3JlbGVhc2VfYm9hcmQo
cGRldiwgZGV2LCBpb2FkZHIpOw0KPiA+ICsNCj4gPiArb3V0Og0KPiA+ICsgICAgIHJldHVybiBy
YzsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfcmVtb3ZlX29uZShzdHJ1
Y3QgcGNpX2RldiAqcGRldikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBuZXRfZGV2aWNlICpk
ZXYgPSBwY2lfZ2V0X2RydmRhdGEocGRldik7DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX3ByaXZh
dGUgKnRwID0gbmV0ZGV2X3ByaXYoZGV2KTsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfaW50X3Zl
Y3RvciAqaXZlYzsNCj4gPiArICAgICB1MzIgaSA9IDB1Ow0KPiA+ICsNCj4gPiArICAgICBhc3Nl
cnQoZGV2KTsNCj4gPiArICAgICBhc3NlcnQodHApOw0KPiA+ICsNCj4gPiArICAgICBmb3IgKGkg
PSAwdTsgaSA8IHRwLT5pbnRfbnVtczsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICBpdmVjID0g
JnRwLT5pbnRfdmVjdG9yW2ldOw0KPiA+ICsgICAgICAgICAgICAgbmV0aWZfbmFwaV9kZWwoJml2
ZWMtPm5hcGkpOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyNpZmRlZiBDT05GSUdfU1JJT1YN
Cj4gPiArICAgICBpZiAodHAtPm51bV92ZnMgIT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgIGlm
IChydGFzZV9kaXNhYmxlX3NyaW92KHRwKSAhPSAwKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAg
ICBwcl9hbGVydCgidW5hYmxlIHRvIGRpc2FibGUgc3Jpb3ZcbiIpOw0KPiA+ICsgICAgIH0NCj4g
PiArI2VuZGlmDQo+ID4gKw0KPiA+ICsgICAgIHVucmVnaXN0ZXJfbmV0ZGV2KGRldik7DQo+ID4g
KyAgICAgcnRhc2VfcmVzZXRfaW50ZXJydXB0KHBkZXYsIHRwKTsNCj4gPiArI2lmZGVmIEVOQUJM
RV9SVEFTRV9QUk9DRlMNCj4gPiArICAgICBydGFzZV9wcm9jX3JlbW92ZShkZXYpOw0KPiA+ICsj
ZW5kaWYNCj4gPiArICAgICBpZiAodHAtPnRhbGx5X3ZhZGRyKSB7DQo+ID4gKyAgICAgICAgICAg
ICBkbWFfZnJlZV9jb2hlcmVudCgmcGRldi0+ZGV2LCBzaXplb2YoKnRwLT50YWxseV92YWRkciks
DQo+IHRwLT50YWxseV92YWRkciwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHRwLT50YWxseV9wYWRkcik7DQo+ID4gKyAgICAgICAgICAgICB0cC0+dGFsbHlfdmFkZHIgPSBO
VUxMOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgcnRhc2VfcmVsZWFzZV9ib2FyZChw
ZGV2LCBkZXYsIHRwLT5tbWlvX2FkZHIpOw0KPiA+ICsgICAgIHBjaV9zZXRfZHJ2ZGF0YShwZGV2
LCBOVUxMKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2Vfc2V0X3J4YnVm
c2l6ZShzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAsIGNvbnN0IHN0cnVjdA0KPiBuZXRfZGV2aWNl
ICpkZXYpDQo+ID4gK3sNCj4gPiArICAgICB1MzIgbXR1ID0gZGV2LT5tdHU7DQo+ID4gKw0KPiA+
ICsgICAgIHRwLT5yeF9idWZfc3ogPSAobXR1ID4gKHUzMilFVEhfREFUQV9MRU4pID8gKG10dSAr
DQo+ICh1MzIpRVRIX0hMRU4gKyA4dSArIDF1KSA6IFJYX0JVRl9TSVpFOw0KPiA+ICt9DQo+ID4g
Kw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9mcmVlX2Rlc2Moc3RydWN0IHJ0YXNlX3ByaXZhdGUg
KnRwKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IHBjaV9kZXYgKnBkZXYgPSB0cC0+cGRldjsN
Cj4gPiArICAgICB1MzIgaSA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIGZvciAoaSA9IDB1OyBpIDwg
dHAtPmZ1bmNfdHhfcXVldWVfbnVtOyBpKyspIHsNCj4gPiArICAgICAgICAgICAgIGlmICh0cC0+
dHhfcmluZ1tpXS5kZXNjKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGRtYV9mcmVlX2Nv
aGVyZW50KCZwZGV2LT5kZXYsDQo+IFJUQVNFX1RYX1JJTkdfREVTQ19TSVpFLCB0cC0+dHhfcmlu
Z1tpXS5kZXNjLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0
cC0+dHhfcmluZ1tpXS5waHlfYWRkcik7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHRwLT50
eF9yaW5nW2ldLmRlc2MgPSBOVUxMOw0KPiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsgICAgIH0N
Cj4gPiArDQo+ID4gKyAgICAgZm9yIChpID0gMHU7IGkgPCB0cC0+ZnVuY19yeF9xdWV1ZV9udW07
IGkrKykgew0KPiA+ICsgICAgICAgICAgICAgaWYgKHRwLT5yeF9yaW5nW2ldLmRlc2MpIHsNCj4g
PiArICAgICAgICAgICAgICAgICAgICAgZG1hX2ZyZWVfY29oZXJlbnQoJnBkZXYtPmRldiwNCj4g
UlRBU0VfUlhfUklOR19ERVNDX1NJWkUsIHRwLT5yeF9yaW5nW2ldLmRlc2MsDQo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRwLT5yeF9yaW5nW2ldLnBoeV9hZGRy
KTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgdHAtPnJ4X3JpbmdbaV0uZGVzYyA9IE5VTEw7
DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+ICt9DQo+ID4gKw0KPiA+ICtz
dGF0aWMgczMyIHJ0YXNlX2FsbG9jX2Rlc2Moc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+
ICt7DQo+ID4gKyAgICAgc3RydWN0IHBjaV9kZXYgKnBkZXYgPSB0cC0+cGRldjsNCj4gPiArICAg
ICB1MzIgaSA9IDA7DQo+ID4gKyAgICAgczMyIHJldHZhbCA9IDA7DQo+ID4gKw0KPiA+ICsgICAg
IC8qIGFsbG9jYXRlIHR4IGRlc2NyaXB0b3IgcmluZ3MgKi8NCj4gPiArICAgICBmb3IgKGkgPSAw
dTsgaSA8IHRwLT5mdW5jX3R4X3F1ZXVlX251bTsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICB0
cC0+dHhfcmluZ1tpXS5kZXNjID0gZG1hX2FsbG9jX2NvaGVyZW50KCZwZGV2LT5kZXYsDQo+IFJU
QVNFX1RYX1JJTkdfREVTQ19TSVpFLA0KPiA+ICsNCj4gJnRwLT50eF9yaW5nW2ldLnBoeV9hZGRy
LCBHRlBfS0VSTkVMKTsNCj4gPiArICAgICAgICAgICAgIGlmICghdHAtPnR4X3JpbmdbaV0uZGVz
Yykgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICByZXR2YWwgPSAtRU5PTUVNOw0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArICAg
ICB9DQo+ID4gKw0KPiA+ICsgICAgIGlmIChyZXR2YWwgPT0gMCkgew0KPiA+ICsgICAgICAgICAg
ICAgLyogYWxsb2NhdGUgcnggZGVzY3JpcHRvciByaW5ncyAqLw0KPiA+ICsgICAgICAgICAgICAg
Zm9yIChpID0gMHU7IGkgPCB0cC0+ZnVuY19yeF9xdWV1ZV9udW07IGkrKykgew0KPiA+ICsgICAg
ICAgICAgICAgICAgICAgICB0cC0+cnhfcmluZ1tpXS5kZXNjID0NCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBkbWFfYWxsb2NfY29oZXJlbnQoJnBkZXYtPmRldiwNCj4gUlRBU0Vf
UlhfUklOR19ERVNDX1NJWkUsDQo+ID4gKw0KPiAmdHAtPnJ4X3JpbmdbaV0ucGh5X2FkZHIsIEdG
UF9LRVJORUwpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBpZiAoIXRwLT5yeF9yaW5nW2ld
LmRlc2MpIHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR2YWwgPSAtRU5P
TUVNOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsgICAg
ICAgICAgICAgICAgICAgICB9DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+
ICsNCj4gPiArICAgICByZXR1cm4gcmV0dmFsOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMg
aW50IHJ0YXNlX29wZW4oc3RydWN0IG5ldF9kZXZpY2UgKmRldikNCj4gPiArew0KPiA+ICsgICAg
IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAgICAg
Y29uc3Qgc3RydWN0IHBjaV9kZXYgKnBkZXYgPSB0cC0+cGRldjsNCj4gPiArICAgICBzdHJ1Y3Qg
cnRhc2VfaW50X3ZlY3RvciAqaXZlYyA9ICZ0cC0+aW50X3ZlY3RvclswXTsNCj4gPiArICAgICBp
bnQgcmV0dmFsOw0KPiA+ICsgICAgIHUxNiBpOw0KPiA+ICsNCj4gPiArI2lmZGVmIEVOQUJMRV9S
VEFTRV9QUk9DRlMNCj4gPiArICAgICBydGFzZV9wcm9jX2luaXQoZGV2KTsNCj4gPiArI2VuZGlm
DQo+ID4gKyAgICAgcnRhc2Vfc2V0X3J4YnVmc2l6ZSh0cCwgZGV2KTsNCj4gPiArDQo+ID4gKyAg
ICAgcmV0dmFsID0gcnRhc2VfYWxsb2NfZGVzYyh0cCk7DQo+ID4gKyAgICAgaWYgKHJldHZhbCA8
IDApDQo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX2FsbF9hbGxvY2F0ZWRfbWVtOw0K
PiA+ICsNCj4gPiArICAgICByZXR2YWwgPSBydGFzZV9pbml0X3JpbmcoZGV2KTsNCj4gPiArICAg
ICBpZiAocmV0dmFsIDwgMCkNCj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfYWxsX2Fs
bG9jYXRlZF9tZW07DQo+ID4gKw0KPiA+ICsgICAgIGlmIChuZXRpZl9tc2dfcHJvYmUodHApICE9
IDB1KSB7DQo+ID4gKyAgICAgICAgICAgICBuZXRkZXZfaW5mbyhkZXYsICIlczogMHglbHgsDQo+
ICUyLjJ4OiUyLjJ4OiUyLjJ4OiUyLjJ4OiUyLjJ4OiUyLjJ4LCBJUlEgJWRcbiIsDQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICBkZXYtPm5hbWUsIGRldi0+YmFzZV9hZGRyLA0KPiBkZXYt
PmRldl9hZGRyWzBdLCBkZXYtPmRldl9hZGRyWzFdLA0KPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgZGV2LT5kZXZfYWRkclsyXSwgZGV2LT5kZXZfYWRkclszXSwNCj4gZGV2LT5kZXZfYWRk
cls0XSwgZGV2LT5kZXZfYWRkcls1XSwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIGRl
di0+aXJxKTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIElOSVRfREVMQVlFRF9XT1JL
KCZ0cC0+dGFzaywgTlVMTCk7DQo+ID4gKw0KPiA+ICsgICAgIHJ0YXNlX2h3X2NvbmZpZyhkZXYp
Ow0KPiA+ICsNCj4gPiArICAgICBpZiAoKHRwLT5zd19mbGFnICYgU1dGX01TSVhfRU5BQkxFRCkg
IT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgIHJldHZhbCA9IHJlcXVlc3RfaXJxKGl2ZWMtPmly
cSwgcnRhc2VfaW50ZXJydXB0LCAwLA0KPiBkZXYtPm5hbWUsIGRldik7DQo+ID4gKw0KPiA+ICsg
ICAgICAgICAgICAgLyogcmVxdWVzdCBvdGhlciBpbnRlcnJ1cHRzIHRvIGhhbmRsZSBtdWx0aXF1
ZXVlICovDQo+ID4gKyAgICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgdHAtPmludF9udW1zOyBp
KyspIHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgaWYgKHJldHZhbCA9PSAwKSB7DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXZlYyA9ICZ0cC0+aW50X3ZlY3RvcltpXTsN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXZlYy0+c3RhdHVzID09IDF1
KSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJpbnRmKChj
aGFyICopJml2ZWMtPm5hbWUsDQo+ICIlc19pbnQlaSIsIGRldi0+bmFtZSwgaSk7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR2YWwgPSByZXF1ZXN0X2lycShp
dmVjLT5pcnEsDQo+IHJ0YXNlX3FfaW50ZXJydXB0LCAwLA0KPiA+ICsNCj4gKGNoYXIgKikmaXZl
Yy0+bmFtZSwgaXZlYyk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KPiA+
ICsgICAgICAgICAgICAgICAgICAgICB9DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAg
fSBlbHNlIGlmICgodHAtPnN3X2ZsYWcgJiBTV0ZfTVNJX0VOQUJMRUQpICE9IDB1KSB7DQo+ID4g
KyAgICAgICAgICAgICByZXR2YWwgPSByZXF1ZXN0X2lycShwZGV2LT5pcnEsIHJ0YXNlX2ludGVy
cnVwdCwgMCwNCj4gZGV2LT5uYW1lLCBkZXYpOw0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAg
ICAgICAgICAgICByZXR2YWwgPSByZXF1ZXN0X2lycShwZGV2LT5pcnEsIHJ0YXNlX2ludGVycnVw
dCwgU0FfU0hJUlEsDQo+IGRldi0+bmFtZSwgZGV2KTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+
ICsgICAgIGlmIChyZXR2YWwgIT0gMCkgew0KPiA+ICsgICAgICAgICAgICAgbmV0ZGV2X2Vycihk
ZXYsICIlczogY2FuJ3QgcmVxdWVzdCBNU0lYIGludGVycnVwdC4gRXJyb3I6DQo+ICVkIiwgZGV2
LT5uYW1lLCByZXR2YWwpOw0KPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9hbGxfYWxs
b2NhdGVkX21lbTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIC8qIGFsd2F5cyBsaW5r
LCBzbyBzdGFydCB0byB0cmFuc21pdCAmIHJlY2VpdmUgKi8NCj4gPiArICAgICBpZiAoKHRwLT5z
d19mbGFnICYgU1dGX1NSSU9WX0VOQUJMRUQpICE9IDB1KSB7DQo+ID4gKyAgICAgICAgICAgICBy
dGFzZV9mdW5jX2VuYWJsZSh0cCk7DQo+ID4gKyAgICAgICAgICAgICBydGFzZV9lbmFibGVfaHdf
aW50ZXJydXB0KHRwKTsNCj4gPiArICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAgICAgICAgcnRh
c2VfaHdfc3RhcnQoZGV2KTsNCj4gPiArICAgICB9DQo+ID4gKyAgICAgbmV0aWZfY2Fycmllcl9v
bihkZXYpOw0KPiA+ICsgICAgIG5ldGlmX3dha2VfcXVldWUoZGV2KTsNCj4gPiArICAgICBpZiAo
bmV0aWZfbXNnX2lmdXAodHApICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgbmV0ZGV2X2luZm8o
ZGV2LCBQRlggIiVzOiBsaW5rIHVwXG4iLCBkZXYtPm5hbWUpOw0KPiA+ICsNCj4gPiArICAgICBn
b3RvIG91dDsNCj4gPiArDQo+ID4gK2Vycl9mcmVlX2FsbF9hbGxvY2F0ZWRfbWVtOg0KPiA+ICsg
ICAgIHJ0YXNlX2ZyZWVfZGVzYyh0cCk7DQo+ID4gKw0KPiA+ICtvdXQ6DQo+ID4gKyAgICAgcmV0
dXJuIHJldHZhbDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2Vfc2V0X21h
cihjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHApDQo+ID4gK3sNCj4gPiArICAgICB2b2lk
IF9faW9tZW0gKmlvYWRkciA9IHRwLT5tbWlvX2FkZHI7DQo+ID4gKyAgICAgdTMyIG1jX2ZpbHRl
clsyXTsNCj4gPiArDQo+ID4gKyAgICAgbWNfZmlsdGVyWzBdID0gdHAtPm1jX2ZpbHRlclswXTsN
Cj4gPiArICAgICBtY19maWx0ZXJbMV0gPSB0cC0+bWNfZmlsdGVyWzFdOw0KPiA+ICsNCj4gPiAr
ICAgICBpZiAoKHRwLT5zd19mbGFnICYgU1dGX1NSSU9WX0VOQUJMRUQpICE9IDB1KSB7DQo+ID4g
KyAgICAgICAgICAgICB1OCBpID0gMHU7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgZm9yIChp
ID0gMHU7IGkgPCB0cC0+bnVtX3ZmczsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
IG1jX2ZpbHRlclswXSB8PSB0cC0+dmZfaW5mb1tpXS5tY19maWx0ZXJbMF07DQo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgIG1jX2ZpbHRlclsxXSB8PSB0cC0+dmZfaW5mb1tpXS5tY19maWx0ZXJb
MV07DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBS
VExfVzMyKE1BUjAsIG1jX2ZpbHRlclswXSk7DQo+ID4gKyAgICAgUlRMX1czMihNQVIxLCBtY19m
aWx0ZXJbMV0pOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICt2b2lkIHJ0YXNlX2h3X3NldF9yeF9wYWNr
ZXRfZmlsdGVyKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1
Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsgICAgIHZvaWQg
X19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAgICBzdGF0aWMgY29uc3Qg
czMyIG11bHRpY2FzdF9maWx0ZXJfbGltaXQgPSAzMjsNCj4gPiArICAgICB1MzIgbWNfZmlsdGVy
WzJdOyAvKiBNdWx0aWNhc3QgaGFzaCBmaWx0ZXIgKi8NCj4gPiArICAgICB1MTYgcnhfbW9kZSA9
ICh1MTYpKFJUTF9SMTYoUlhfQ09ORklHXzApICYgfkFDQ0VQVF9NQVNLKTsNCj4gPiArDQo+ID4g
KyAgICAgaWYgKChkZXYtPmZsYWdzICYgSUZGX1BST01JU0MpICE9IDB1KSB7DQo+ID4gKyAgICAg
ICAgICAgICAvKiBVbmNvbmRpdGlvbmFsbHkgbG9nIG5ldCB0YXBzLiAqLw0KPiA+ICsgICAgICAg
ICAgICAgaWYgKG5ldGlmX21zZ19saW5rKHRwKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgbmV0ZGV2X25vdGljZShkZXYsICIlczogUHJvbWlzY3VvdXMgbW9kZQ0KPiBlbmFibGVk
LlxuIiwgZGV2LT5uYW1lKTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICByeF9tb2RlIHw9DQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICh1MTYpKEFDQ0VQVF9CUk9BRENBU1QgfA0KPiBBQ0NF
UFRfTVVMVElDQVNUIHwgQUNDRVBUX01ZUEhZUyB8IEFDQ0VQVF9BTExQSFlTKTsNCj4gPiArICAg
ICAgICAgICAgIG1jX2ZpbHRlclswXSA9IDB4RkZGRkZGRkZ1Ow0KPiA+ICsgICAgICAgICAgICAg
bWNfZmlsdGVyWzFdID0gMHhGRkZGRkZGRnU7DQo+ID4gKyAgICAgfSBlbHNlIGlmICgobmV0ZGV2
X21jX2NvdW50KGRldikgPiBtdWx0aWNhc3RfZmlsdGVyX2xpbWl0KQ0KPiA+ICsgICAgICAgICAg
ICAgICAgfHwgKChkZXYtPmZsYWdzICYgSUZGX0FMTE1VTFRJKSAhPSAwdSkpIHsNCj4gPiArICAg
ICAgICAgICAgIC8qIFRvbyBtYW55IHRvIGZpbHRlciBwZXJmZWN0bHkgLS0gYWNjZXB0IGFsbCBt
dWx0aWNhc3RzLiAqLw0KPiA+ICsgICAgICAgICAgICAgcnhfbW9kZSB8PSAodTE2KShBQ0NFUFRf
QlJPQURDQVNUIHwNCj4gQUNDRVBUX01VTFRJQ0FTVCB8IEFDQ0VQVF9NWVBIWVMpOw0KPiA+ICsg
ICAgICAgICAgICAgbWNfZmlsdGVyWzBdID0gMHhGRkZGRkZGRnU7DQo+ID4gKyAgICAgICAgICAg
ICBtY19maWx0ZXJbMV0gPSAweEZGRkZGRkZGdTsNCj4gPiArICAgICB9IGVsc2Ugew0KPiA+ICsg
ICAgICAgICAgICAgY29uc3Qgc3RydWN0IG5ldGRldl9od19hZGRyICpoYTsNCj4gPiArDQo+ID4g
KyAgICAgICAgICAgICByeF9tb2RlIHw9ICh1MTYpKEFDQ0VQVF9CUk9BRENBU1QgfA0KPiBBQ0NF
UFRfTVlQSFlTKTsNCj4gPiArICAgICAgICAgICAgIG1jX2ZpbHRlclswXSA9IDB1Ow0KPiA+ICsg
ICAgICAgICAgICAgbWNfZmlsdGVyWzFdID0gMHU7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAg
LyogY2xhbmctZm9ybWF0IG9mZiAqLw0KPiA+ICsgICAgICAgICAgICAgbmV0ZGV2X2Zvcl9lYWNo
X21jX2FkZHIoaGEsIGRldikgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICB1MzIgYml0X25y
ID0gKGV0aGVyX2NyYyhFVEhfQUxFTiwgaGEtPmFkZHIpID4+DQo+IDI2KTsNCj4gPiArDQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIG1jX2ZpbHRlcltiaXRfbnIgPj4gNV0gfD0gKCh1MzIpMXUg
PDwgKGJpdF9uciAmDQo+IDMxdSkpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICByeF9tb2Rl
IHw9ICh1MTYpQUNDRVBUX01VTFRJQ0FTVDsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArICAg
ICAgICAgICAgIC8qIGNsYW5nLWZvcm1hdCBvbiAqLw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4g
KyAgICAgaWYgKChkZXYtPmZlYXR1cmVzICYgTkVUSUZfRl9SWEFMTCkgIT0gMHUpDQo+ID4gKyAg
ICAgICAgICAgICByeF9tb2RlIHw9ICh1MTYpKEFDQ0VQVF9FUlIgfCBBQ0NFUFRfUlVOVCk7DQo+
ID4gKw0KPiA+ICsgICAgIHRwLT5tY19maWx0ZXJbMF0gPSBzd2FiMzIobWNfZmlsdGVyWzFdKTsN
Cj4gPiArICAgICB0cC0+bWNfZmlsdGVyWzFdID0gc3dhYjMyKG1jX2ZpbHRlclswXSk7DQo+ID4g
Kw0KPiA+ICsgICAgIHJ0YXNlX3NldF9tYXIodHApOw0KPiA+ICsgICAgIFJUTF9XMTYoUlhfQ09O
RklHXzAsIHJ4X21vZGUpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9z
ZXRfcnhfbW9kZShzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQ0KPiA+ICt7DQo+ID4gKyAgICAgc3Ry
dWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0ZGV2X3ByaXYoZGV2KTsNCj4gPiArICAgICB1bnNp
Z25lZCBsb25nIGZsYWdzOw0KPiA+ICsNCj4gPiArICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmdHAt
PmxvY2ssIGZsYWdzKTsNCj4gPiArDQo+ID4gKyAgICAgcnRhc2VfaHdfc2V0X3J4X3BhY2tldF9m
aWx0ZXIoZGV2KTsNCj4gPiArDQo+ID4gKyAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdHAt
PmxvY2ssIGZsYWdzKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2VfaHdf
Y29uZmlnKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpDQo+ID4gK3sNCj4gPiArICAgICBjb25zdCBz
dHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsgICAgIHZv
aWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAgICB1MzIgcmVnX2Rh
dGEgPSAwOw0KPiA+ICsNCj4gPiArICAgICBpZiAoKHRwLT5zd19mbGFnICYgU1dGX1NSSU9WX0VO
QUJMRUQpID09IDB1KQ0KPiA+ICsgICAgICAgICAgICAgcnRhc2VfaHdfcmVzZXQoZGV2KTsNCj4g
PiArDQo+ID4gKyAgICAgLyogU2V0IFJ4IERNQSBidXJzdCAqLw0KPiA+ICsgICAgIHJlZ19kYXRh
ID0gUlRMX1IxNihSWF9DT05GSUdfMCk7DQo+ID4gKyAgICAgcmVnX2RhdGEgJj0gKHUzMikofihS
WF9TSU5HTEVfVEFHIHwgUlhfU0lOR0xFX0ZFVENIKSk7DQo+ID4gKyAgICAgcmVnX2RhdGEgJj0g
figodTMyKVJYX01YX0RNQV9NQVNLIDw8IFJYX01YX0RNQV9TSElGVCk7DQo+ID4gKyAgICAgcmVn
X2RhdGEgfD0gKCh1MzIpUlhfRE1BX0JVUlNUXzI1NiA8PCBSWF9NWF9ETUFfU0hJRlQpOw0KPiA+
ICsgICAgIFJUTF9XMTYoUlhfQ09ORklHXzAsICh1MTYpcmVnX2RhdGEpOw0KPiA+ICsNCj4gPiAr
ICAgICAvKiBOZXcgUnggRGVzY3JpdHBvciAqLw0KPiA+ICsgICAgIHJlZ19kYXRhID0gUlRMX1Ix
NihSWF9DT05GSUdfMSk7DQo+ID4gKyAgICAgcmVnX2RhdGEgfD0gKHUzMilSWF9ORVdfREVTQ19G
T1JNQVRfRU47DQo+ID4gKyAgICAgcmVnX2RhdGEgfD0gKHUzMilQQ0lFX05FV19GTE9XOw0KPiA+
ICsgICAgIC8qIFJ4IEZldGNoIERlc2MgTnVtYmVyICovDQo+ID4gKyAgICAgcmVnX2RhdGEgJj0g
figodTMyKVJYX01BWF9GRVRDSF9ERVNDX01BU0sgPDwNCj4gUlhfTUFYX0ZFVENIX0RFU0NfU0hJ
RlQpOw0KPiA+ICsgICAgIHJlZ19kYXRhIHw9ICgodTMyKTB4RiA8PCBSWF9NQVhfRkVUQ0hfREVT
Q19TSElGVCk7DQo+ID4gKyAgICAgUlRMX1cxNihSWF9DT05GSUdfMSwgKHUxNilyZWdfZGF0YSk7
DQo+ID4gKw0KPiA+ICsgICAgIC8qIFJ4IHF1ZXVlIG51bWJlcnMgKi8NCj4gPiArICAgICByZWdf
ZGF0YSA9IFJUTF9SMTYoRkNSKTsNCj4gPiArICAgICByZWdfZGF0YSAmPSB+KEZDUl9SWFFfTUFT
SyA8PCBGQ1JfUlhRX1NISUZUKTsNCj4gPiArICAgICBzd2l0Y2ggKHRwLT5mdW5jX3J4X3F1ZXVl
X251bSkgew0KPiA+ICsgICAgIGNhc2UgMToNCj4gPiArICAgICAgICAgICAgIHJlZ19kYXRhIHw9
ICgweDF1IDw8IEZDUl9SWFFfU0hJRlQpOw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+ID4g
KyAgICAgY2FzZSAyOg0KPiA+ICsgICAgICAgICAgICAgcmVnX2RhdGEgfD0gKDB4MnUgPDwgRkNS
X1JYUV9TSElGVCk7DQo+ID4gKyAgICAgICAgICAgICBicmVhazsNCj4gPiArICAgICBjYXNlIDQ6
DQo+ID4gKyAgICAgICAgICAgICByZWdfZGF0YSB8PSAoMHgzdSA8PCBGQ1JfUlhRX1NISUZUKTsN
Cj4gPiArICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsgICAgIGRlZmF1bHQ6DQo+ID4gKyAgICAg
ICAgICAgICAvKiBub3RoaW5nIHRvIGRvLiAqLw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+
ID4gKyAgICAgfQ0KPiA+ICsgICAgIFJUTF9XMTYoRkNSLCAodTE2KXJlZ19kYXRhKTsNCj4gPiAr
DQo+ID4gKyAgICAgLyogaW50ZXJydXB0IG1pdGlnYXRpb24gKi8NCj4gPiArICAgICBydGFzZV9p
bnRlcnJ1cHRfbWl0aWdhdGlvbih0cCk7DQo+ID4gKw0KPiA+ICsgICAgIC8qIFNldCBUeCBETUEg
YnVyc3Qgc2l6ZSBhbmQgSW50ZXJmcmFtZSBHYXAgVGltZSAqLw0KPiA+ICsgICAgIHJlZ19kYXRh
ID0gUlRMX1IzMihUWF9DT05GSUdfMCk7DQo+ID4gKyAgICAgcmVnX2RhdGEgJj0gfigoKHUzMilU
WF9ETUFfTUFTSyA8PCBUWF9ETUFfU0hJRlQpDQo+ID4gKyAgICAgICAgICAgICAgICAgICB8ICgo
dTMyKVRYX0lOVEVSX0ZSQU1FX0dBUF9NQVNLIDw8DQo+IFRYX0lOVEVSX0ZSQU1FX0dBUF9TSElG
VCkpOw0KPiA+ICsgICAgIHJlZ19kYXRhIHw9ICgoKHUzMilUWF9ETUFfQlVSU1RfVU5MSU1JVEVE
IDw8IFRYX0RNQV9TSElGVCkNCj4gPiArICAgICAgICAgICAgICAgICAgfCAoKHUzMilJTlRFUkZS
QU1FR0FQIDw8DQo+IFRYX0lOVEVSX0ZSQU1FX0dBUF9TSElGVCkpOw0KPiA+ICsgICAgIFJUTF9X
MzIoVFhfQ09ORklHXzAsIHJlZ19kYXRhKTsNCj4gPiArDQo+ID4gKyAgICAgLyogTmV3IFR4IERl
c2NyaXB0b3IgKi8NCj4gPiArICAgICBSVExfVzE2KFRGVU5fQ1RSTCwgKHUxNikoUlRMX1IxNihU
RlVOX0NUUkwpIHwNCj4gVFhfTkVXX0RFU0NfRk9STUFUX0VOKSk7DQo+ID4gKw0KPiA+ICsgICAg
IC8qIFR4IEZldGNoIERlc2MgTnVtYmVyICovDQo+ID4gKyAgICAgUlRMX1c4KFRERk5SLCAweDEw
KTsNCj4gPiArDQo+ID4gKyAgICAgLyogdGFnIG51bSBzZWxlY3QgKi8NCj4gPiArICAgICByZWdf
ZGF0YSA9IFJUTF9SMTYoTVRQUyk7DQo+ID4gKyAgICAgcmVnX2RhdGEgJj0gfigodTMyKTB4N3Ug
PDwgOCk7DQo+ID4gKyAgICAgcmVnX2RhdGEgfD0gKCh1MzIpMHg0dSA8PCA4KTsNCj4gPiArICAg
ICBSVExfVzE2KE1UUFMsICh1MTYpcmVnX2RhdGEpOw0KPiA+ICsNCj4gPiArICAgICAvKiBUeCBx
dWV1ZSBudW1iZXJzICovDQo+ID4gKyAgICAgcmVnX2RhdGEgPSBSVExfUjE2KFRYX0NPTkZJR18x
KTsNCj4gPiArICAgICByZWdfZGF0YSAmPSB+KCh1MzIpMHgzdSA8PCAxMCk7DQo+ID4gKyAgICAg
c3dpdGNoICh0cC0+dHhfcXVldWVfY3RybCkgew0KPiA+ICsgICAgIGNhc2UgMToNCj4gPiArICAg
ICAgICAgICAgIGJyZWFrOw0KPiA+ICsgICAgIGNhc2UgMjoNCj4gPiArICAgICAgICAgICAgIHJl
Z19kYXRhIHw9ICgodTMyKTB4MXUgPDwgMTApOw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+
ID4gKyAgICAgY2FzZSAzOg0KPiA+ICsgICAgIGNhc2UgNDoNCj4gPiArICAgICAgICAgICAgIHJl
Z19kYXRhIHw9ICgodTMyKTB4MnUgPDwgMTApOw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+
ID4gKyAgICAgZGVmYXVsdDoNCj4gPiArICAgICAgICAgICAgIHJlZ19kYXRhIHw9ICgodTMyKTB4
M3UgPDwgMTApOw0KPiA+ICsgICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAgICAgfQ0KPiA+ICsg
ICAgIFJUTF9XMTYoVFhfQ09ORklHXzEsICh1MTYpcmVnX2RhdGEpOw0KPiA+ICsNCj4gPiArICAg
ICAvKiBUT0sgY29uZGl0aW9uICovDQo+ID4gKyAgICAgUlRMX1cxNihUT0tTRUwsIDB4NTU1NSk7
DQo+ID4gKw0KPiA+ICsgICAgIHJ0YXNlX3RhbGx5X2NvdW50ZXJfYWRkcl9maWxsKHRwKTsNCj4g
PiArICAgICBydGFzZV9kZXNjX2FkZHJfZmlsbCh0cCk7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChy
dGFzZV9od19zZXRfZmVhdHVyZXMoZGV2LCBkZXYtPmZlYXR1cmVzKSAhPSAwKQ0KPiA+ICsgICAg
ICAgICAgICAgbmV0ZGV2X2FsZXJ0KGRldiwgInVuYWJsZSB0byBzZXQgaHcgZmVhdHVyZXNcbiIp
Ow0KPiA+ICsNCj4gPiArICAgICAvKiBUQkQ6IGVuYWJsZSBmbG93IGNvbnRyb2wgKi8NCj4gPiAr
ICAgICByZWdfZGF0YSA9IFJUTF9SMTYoQ1BMVVNfQ01EKTsNCj4gPiArICAgICByZWdfZGF0YSB8
PSAodTMyKShGT1JDRV9UWEZMT1dfRU4gfCBGT1JDRV9SWEZMT1dfRU4pOw0KPiA+ICsgICAgIFJU
TF9XMTYoQ1BMVVNfQ01ELCAodTE2KXJlZ19kYXRhKTsNCj4gPiArICAgICAvKiBTZXQgTmVhciBG
SUZPIFRocmVzaG9sZCAtIHJ4IG1pc3NlZCBpc3N1ZS4gKi8NCj4gPiArICAgICBSVExfVzE2KFJG
SUZPTkZVTEwsIDB4MTkwKTsNCj4gPiArDQo+ID4gKyAgICAgUlRMX1cxNihSTVMsICh1MTYpdHAt
PnJ4X2J1Zl9zeik7DQo+ID4gKw0KPiA+ICsgICAgIC8qIFNldCBSeCBwYWNrZXQgZmlsdGVyICov
DQo+ID4gKyAgICAgcnRhc2VfaHdfc2V0X3J4X3BhY2tldF9maWx0ZXIoZGV2KTsNCj4gPiArDQo+
ID4gKyAgICAgLyogZW5hYmxlIGVwaHkgaW50ZXJydXB0ICovDQo+ID4gKyAgICAgbWFjX29jcF93
cml0ZSh0cCwgMHhFQUQwLCAweEZGMDcpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICt2b2lkIHJ0YXNl
X2h3X3N0YXJ0KGNvbnN0IHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpDQo+ID4gK3sNCj4gPiArICAg
ICBjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+
ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArDQo+ID4g
KyAgICAgLyogc2V0IHdhdGNoZG9nIHRpbWUgKi8NCj4gPiArICAgICBSVExfVzMyKFRJTUVPVVQw
X0FERFIsIFRJTUVPVVRfU0VUX1RJTUUpOw0KPiA+ICsgICAgIC8qIHJlc2V0IHRpbWVyICovDQo+
ID4gKyAgICAgUlRMX1czMihUQ1RSMCwgMHgwKTsNCj4gPiArDQo+ID4gKyAgICAgcnRhc2Vfbmlj
X2VuYWJsZShkZXYpOw0KPiA+ICsgICAgIHJ0YXNlX2VuYWJsZV9od19pbnRlcnJ1cHQodHApOw0K
PiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IHJ0YXNlX2NoYW5nZV9tdHUoc3RydWN0IG5l
dF9kZXZpY2UgKmRldiwgaW50IG5ld19tdHUpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgcnRh
c2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsgICAgIGludCByZXQgPSAw
Ow0KPiA+ICsgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7DQo+ID4gKw0KPiA+ICsgICAgIGlmICgo
dHAtPnN3X2ZsYWcgJiBTV0ZfU1JJT1ZfRU5BQkxFRCkgIT0gMHUpIHsNCj4gPiArICAgICAgICAg
ICAgIHJldCA9IC1FUEVSTTsNCj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX291dDsNCj4gPiAr
ICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHNwaW5fbG9ja19pcnFzYXZlKCZ0cC0+bG9jaywgZmxh
Z3MpOw0KPiA+ICsgICAgIGRldi0+bXR1ID0gKHUzMiluZXdfbXR1Ow0KPiA+ICsgICAgIHNwaW5f
dW5sb2NrX2lycXJlc3RvcmUoJnRwLT5sb2NrLCBmbGFncyk7DQo+ID4gKw0KPiA+ICsgICAgIGlm
ICghbmV0aWZfcnVubmluZyhkZXYpKQ0KPiA+ICsgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4g
Kw0KPiA+ICsgICAgIHJ0YXNlX2Rvd24oZGV2KTsNCj4gPiArDQo+ID4gKyAgICAgc3Bpbl9sb2Nr
X2lycXNhdmUoJnRwLT5sb2NrLCBmbGFncyk7DQo+ID4gKw0KPiA+ICsgICAgIHJ0YXNlX3NldF9y
eGJ1ZnNpemUodHAsIGRldik7DQo+ID4gKw0KPiA+ICsgICAgIHJldCA9IHJ0YXNlX2luaXRfcmlu
ZyhkZXYpOw0KPiA+ICsNCj4gPiArICAgICBpZiAocmV0IDwgMCkgew0KPiA+ICsgICAgICAgICAg
ICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiArICAgICAg
ICAgICAgIGdvdG8gZXJyX291dDsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIG5ldGlm
X3N0b3BfcXVldWUoZGV2KTsNCj4gPiArICAgICBuZXRpZl9jYXJyaWVyX29mZihkZXYpOw0KPiA+
ICsgICAgIHJ0YXNlX2h3X2NvbmZpZyhkZXYpOw0KPiA+ICsgICAgIHNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJnRwLT5sb2NrLCBmbGFncyk7DQo+ID4gKw0KPiA+ICsgICAgIC8qIGFsd2F5cyBsaW5r
LCBzbyBzdGFydCB0byB0cmFuc21pdCAmIHJlY2VpdmUgKi8NCj4gPiArICAgICBydGFzZV9od19z
dGFydChkZXYpOw0KPiA+ICsgICAgIG5ldGlmX2NhcnJpZXJfb24oZGV2KTsNCj4gPiArICAgICBu
ZXRpZl93YWtlX3F1ZXVlKGRldik7DQo+ID4gKw0KPiA+ICtvdXQ6DQo+ID4gKyAgICAgbmV0ZGV2
X3VwZGF0ZV9mZWF0dXJlcyhkZXYpOw0KPiA+ICsNCj4gPiArZXJyX291dDoNCj4gPiArICAgICBy
ZXR1cm4gcmV0Ow0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW5saW5lIHZvaWQgcnRhc2Vf
bWFrZV91bnVzYWJsZV9ieV9hc2ljKHJ4X2Rlc2MgKmRlc2MpDQo+ID4gK3sNCj4gPiArICAgICBk
ZXNjLT5kZXNjX2NtZC5hZGRyID0gMHgwQkFEQkFEQkFEQkFEQkFEdUxMOw0KPiA+ICsgICAgIGRl
c2MtPmRlc2NfY21kLm9wdHMxICY9IH5jcHVfdG9fbGUzMihERVNDX09XTiB8IFJTVkRfTUFTSyk7
DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBydGFzZV9tYXJrX3RvX2Fz
aWMocnhfZGVzYyAqZGVzYywgdTMyIHJ4X2J1Zl9zeikNCj4gPiArew0KPiA+ICsgICAgIHUzMiBl
b3IgPSAodTMyKShsZTMyX3RvX2NwdShkZXNjLT5kZXNjX2NtZC5vcHRzMSkgJiBSSU5HX0VORCk7
DQo+ID4gKw0KPiA+ICsgICAgIGRlc2MtPmRlc2NfY21kLm9wdHMxID0gY3B1X3RvX2xlMzIoREVT
Q19PV04gfCBlb3IgfCByeF9idWZfc3opOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW5s
aW5lIHZvaWQgcnRhc2VfbWFwX3RvX2FzaWMocnhfZGVzYyAqZGVzYywgZG1hX2FkZHJfdCBtYXBw
aW5nLA0KPiB1MzIgcnhfYnVmX3N6KQ0KPiA+ICt7DQo+ID4gKyAgICAgZGVzYy0+ZGVzY19jbWQu
YWRkciA9IGNwdV90b19sZTY0KG1hcHBpbmcpOw0KPiA+ICsgICAgIC8qIG1ha2Ugc3VyZSB0aGUg
cGh5c2ljYWwgYWRkcmVzcyBoYXMgYmVlbiB1cGRhdGVkICovDQo+ID4gKyAgICAgd21iKCk7DQo+
ID4gKyAgICAgcnRhc2VfbWFya190b19hc2ljKGRlc2MsIHJ4X2J1Zl9zeik7DQo+ID4gK30NCj4g
PiArDQo+ID4gK3N0YXRpYyBzMzIgcnRhc2VfYWxsb2Nfcnhfc2tiKGNvbnN0IHN0cnVjdCBydGFz
ZV9yaW5nICpyaW5nLCBzdHJ1Y3Qgc2tfYnVmZg0KPiAqKnBfc2tfYnVmZiwNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcnhfZGVzYyAqZGVzYywgZG1hX2FkZHJfdCAqcnhfcGh5X2Fk
ZHIsDQo+IHUzMiByeF9idWZfc3osIHU4IGluX2ludHIpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1
Y3QgcnRhc2VfaW50X3ZlY3RvciAqaXZlYyA9IHJpbmctPml2ZWM7DQo+ID4gKyAgICAgY29uc3Qg
c3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gaXZlYy0+dHA7DQo+ID4gKyAgICAgc3RydWN0IHNr
X2J1ZmYgKnNrYiA9IE5VTEw7DQo+ID4gKyAgICAgZG1hX2FkZHJfdCBtYXBwaW5nOw0KPiA+ICsg
ICAgIHMzMiByZXQgPSAwOw0KPiA+ICsNCj4gPiArICAgICBpZiAoaW5faW50ciAhPSAwdSkNCj4g
PiArICAgICAgICAgICAgIHNrYiA9IFJUTF9BTExPQ19TS0JfSU5UUihpdmVjLT5uYXBpLCAocnhf
YnVmX3N6ICsNCj4gUlRLX1JYX0FMSUdOKSk7DQo+ID4gKyAgICAgZWxzZQ0KPiA+ICsgICAgICAg
ICAgICAgc2tiID0gZGV2X2FsbG9jX3NrYigocnhfYnVmX3N6ICsgUlRLX1JYX0FMSUdOKSk7DQo+
ID4gKw0KPiA+ICsgICAgIGlmICh1bmxpa2VseSghc2tiKSkNCj4gPiArICAgICAgICAgICAgIGdv
dG8gZXJyX291dDsNCj4gPiArDQo+ID4gKyAgICAgc2tiX3Jlc2VydmUoc2tiLCAoczMyKVJUS19S
WF9BTElHTik7DQo+ID4gKw0KPiA+ICsgICAgIG1hcHBpbmcgPSBkbWFfbWFwX3NpbmdsZSgmdHAt
PnBkZXYtPmRldiwgc2tiLT5kYXRhLCByeF9idWZfc3osDQo+IERNQV9GUk9NX0RFVklDRSk7DQo+
ID4gKyAgICAgaWYgKHVubGlrZWx5KGRtYV9tYXBwaW5nX2Vycm9yKCZ0cC0+cGRldi0+ZGV2LCBt
YXBwaW5nKSkpIHsNCj4gPiArICAgICAgICAgICAgIGlmICh1bmxpa2VseShuZXRfcmF0ZWxpbWl0
KCkpKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBuZXRpZl9lcnIodHAsIGRydiwgdHAtPmRl
diwgIkZhaWxlZCB0byBtYXAgUlgNCj4gRE1BIVxuIik7DQo+ID4gKw0KPiA+ICsgICAgICAgICAg
ICAgZ290byBlcnJfb3V0Ow0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgKnBfc2tfYnVm
ZiA9IHNrYjsNCj4gPiArICAgICAqcnhfcGh5X2FkZHIgPSBtYXBwaW5nOw0KPiA+ICsgICAgIHJ0
YXNlX21hcF90b19hc2ljKGRlc2MsIG1hcHBpbmcsIHJ4X2J1Zl9zeik7DQo+ID4gKyAgICAgZ290
byBvdXQ7DQo+ID4gKw0KPiA+ICtlcnJfb3V0Og0KPiA+ICsgICAgIGlmIChza2IpDQo+ID4gKyAg
ICAgICAgICAgICBkZXZfa2ZyZWVfc2tiKHNrYik7DQo+ID4gKw0KPiA+ICsgICAgIHJldCA9IC1F
Tk9NRU07DQo+ID4gKyAgICAgcnRhc2VfbWFrZV91bnVzYWJsZV9ieV9hc2ljKGRlc2MpOw0KPiA+
ICsNCj4gPiArb3V0Og0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4g
K3N0YXRpYyB2b2lkIHJ0YXNlX3J4X3JpbmdfY2xlYXIoc3RydWN0IHJ0YXNlX3JpbmcgKnJpbmcp
DQo+ID4gK3sNCj4gPiArICAgICB1MzIgaTsNCj4gPiArICAgICByeF9kZXNjICpkZXNjOw0KPiA+
ICsgICAgIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IHJpbmctPml2ZWMtPnRwOw0K
PiA+ICsNCj4gPiArICAgICBmb3IgKGkgPSAwdTsgaSA8IE5VTV9ERVNDOyBpKyspIHsNCj4gPiAr
ICAgICAgICAgICAgIGRlc2MgPSByaW5nLT5kZXNjICsgKHNpemVvZihyeF9kZXNjKSAqIGkpOw0K
PiA+ICsNCj4gPiArICAgICAgICAgICAgIGlmIChyaW5nLT5za2J1ZmZbaV0pIHsNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgZG1hX3VubWFwX3NpbmdsZSgmdHAtPnBkZXYtPmRldiwNCj4gcmlu
Zy0+bWlzLmRhdGFfcGh5X2FkZHJbaV0sIHRwLT5yeF9idWZfc3osDQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgRE1BX0ZST01fREVWSUNFKTsNCj4gPiArDQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIGRldl9rZnJlZV9za2IocmluZy0+c2tidWZmW2ldKTsNCj4g
PiArDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJpbmctPnNrYnVmZltpXSA9IE5VTEw7DQo+
ID4gKw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBydGFzZV9tYWtlX3VudXNhYmxlX2J5X2Fz
aWMoZGVzYyk7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+ICt9DQo+ID4g
Kw0KPiA+ICt2b2lkIHJ0YXNlX3J4X2NsZWFyKHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCkNCj4g
PiArew0KPiA+ICsgICAgIHUzMiBpOw0KPiA+ICsNCj4gPiArICAgICBmb3IgKGkgPSAwdTsgaSA8
IHRwLT5mdW5jX3J4X3F1ZXVlX251bTsgaSsrKQ0KPiA+ICsgICAgICAgICAgICAgcnRhc2Vfcnhf
cmluZ19jbGVhcigmdHAtPnJ4X3JpbmdbaV0pOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMg
dTMyIHJ0YXNlX3J4X3JpbmdfZmlsbChzdHJ1Y3QgcnRhc2VfcmluZyAqcmluZywgdTMyIHJpbmdf
c3RhcnQsIHUzMg0KPiByaW5nX2VuZCwgdTggaW5faW50cikNCj4gPiArew0KPiA+ICsgICAgIGNv
bnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IHJpbmctPml2ZWMtPnRwOw0KPiA+ICsgICAg
IHUzMiBjdXI7DQo+ID4gKw0KPiA+ICsgICAgIGZvciAoY3VyID0gcmluZ19zdGFydDsgKHJpbmdf
ZW5kIC0gY3VyKSA+IDB1OyBjdXIrKykgew0KPiA+ICsgICAgICAgICAgICAgczMyIHJldCA9IDA7
DQo+ID4gKyAgICAgICAgICAgICB1MzIgaSA9IGN1ciAlIE5VTV9ERVNDOw0KPiA+ICsgICAgICAg
ICAgICAgcnhfZGVzYyAqZGVzYyA9IHJpbmctPmRlc2MgKyAoc2l6ZW9mKHJ4X2Rlc2MpICogaSk7
DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgaWYgKHJpbmctPnNrYnVmZltpXSkNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgY29udGludWU7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgcmV0
ID0gcnRhc2VfYWxsb2Nfcnhfc2tiKHJpbmcsICZyaW5nLT5za2J1ZmZbaV0sIGRlc2MsDQo+ICZy
aW5nLT5taXMuZGF0YV9waHlfYWRkcltpXSwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB0cC0+cnhfYnVmX3N6LCBpbl9pbnRyKTsNCj4gPiArICAgICAgICAgICAg
IGlmIChyZXQgPCAwKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiArICAg
ICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiAoY3VyIC0gcmluZ19zdGFydCk7DQo+ID4gK30N
Cj4gPiArDQo+ID4gK3N0YXRpYyBpbmxpbmUgdm9pZCBydGFzZV9tYXJrX2FzX2xhc3RfZGVzY3Jp
cHRvcihyeF9kZXNjICpkZXNjKQ0KPiA+ICt7DQo+ID4gKyAgICAgZGVzYy0+ZGVzY19jbWQub3B0
czEgfD0gY3B1X3RvX2xlMzIoUklOR19FTkQpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMg
dm9pZCBydGFzZV9kZXNjX2FkZHJfZmlsbChjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAp
DQo+ID4gK3sNCj4gPiArICAgICB1MTYgaSA9IDA7DQo+ID4gKyAgICAgdTE2IGNtZCA9IDA7DQo+
ID4gKyAgICAgY29uc3Qgc3RydWN0IHJ0YXNlX3JpbmcgKnJpbmc7DQo+ID4gKyAgICAgdm9pZCBf
X2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsNCj4gPiArICAgICBmb3IgKGkg
PSAwdTsgaSA8IHRwLT5mdW5jX3R4X3F1ZXVlX251bTsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAg
ICByaW5nID0gJnRwLT50eF9yaW5nW2ldOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIFJUTF9X
MzIoVFhfREVTQ19TVEFSVF9BRERSMCwgKHUzMikocmluZy0+cGh5X2FkZHIgJg0KPiBETUFfQklU
X01BU0soMzIpKSk7DQo+ID4gKyAgICAgICAgICAgICBSVExfVzMyKFRYX0RFU0NfU1RBUlRfQURE
UjQsICh1MzIpKHJpbmctPnBoeV9hZGRyDQo+ID4+IDMyKSk7DQo+ID4gKyAgICAgICAgICAgICBj
bWQgPSBpIHwgKHUxNilUWF9ERVNDX0NNRF9XRSB8DQo+ICh1MTYpVFhfREVTQ19DTURfQ1M7DQo+
ID4gKyAgICAgICAgICAgICBSVExfVzE2KFRYX0RFU0NfQ09NTUFORCwgY21kKTsNCj4gPiArICAg
ICAgICAgICAgIHVzbGVlcF9yYW5nZSgxMDAsIDExMCk7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4g
PiArICAgICBmb3IgKGkgPSAwdTsgaSA8IHRwLT5mdW5jX3J4X3F1ZXVlX251bTsgaSsrKSB7DQo+
ID4gKyAgICAgICAgICAgICByaW5nID0gJnRwLT5yeF9yaW5nW2ldOw0KPiA+ICsNCj4gPiArICAg
ICAgICAgICAgIGlmIChpID09IDB1KSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIFJUTF9X
MzIoUTBfUlhfREVTQ19BRERSMCwNCj4gKHUzMikoKHJpbmctPnBoeV9hZGRyICYgRE1BX0JJVF9N
QVNLKDMyKSkpKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgUlRMX1czMihRMF9SWF9ERVND
X0FERFI0LA0KPiAodTMyKShyaW5nLT5waHlfYWRkciA+PiAzMikpOw0KPiA+ICsgICAgICAgICAg
ICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgUlRMX1czMigoUTFfUlhfREVT
Q19BRERSMCArICgoaSAtIDF1KSAqIDh1KSksDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKHUzMikocmluZy0+cGh5X2FkZHIgJg0KPiBETUFfQklUX01BU0soMzIpKSk7DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIFJUTF9XMzIoKFExX1JYX0RFU0NfQUREUjQgKyAoKGkgLSAx
dSkgKiA4dSkpLA0KPiAodTMyKShyaW5nLT5waHlfYWRkciA+PiAzMikpOw0KPiA+ICsgICAgICAg
ICAgICAgfQ0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRh
c2VfdHhfZGVzY19pbml0KHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCwgdTE2IGlkeCkNCj4gPiAr
ew0KPiA+ICsgICAgIHUzMiBpID0gMDsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcmluZyAqcmlu
ZyA9ICZ0cC0+dHhfcmluZ1tpZHhdOw0KPiA+ICsgICAgIHR4X2Rlc2MgKmRlc2M7DQo+ID4gKw0K
PiA+ICsgICAgIG1lbXNldChyaW5nLT5kZXNjLCAweDAsIFJUQVNFX1RYX1JJTkdfREVTQ19TSVpF
KTsNCj4gPiArICAgICBtZW1zZXQocmluZy0+c2tidWZmLCAweDAsIChOVU1fREVTQyAqIHNpemVv
ZihzdHJ1Y3Qgc2tfYnVmZiAqKSkpOw0KPiA+ICsgICAgIHJpbmctPmN1cl9pZHggPSAwOw0KPiA+
ICsgICAgIHJpbmctPmRpcnR5X2lkeCA9IDA7DQo+ID4gKyAgICAgcmluZy0+cHJpdl9kaXJ0eV9p
ZHggPSAwOw0KPiA+ICsgICAgIHJpbmctPmR1cGxpY2F0ZV9kaXJ0eV9jb3VudCA9IDA7DQo+ID4g
KyAgICAgcmluZy0+aW5kZXggPSBpZHg7DQo+ID4gKw0KPiA+ICsgICAgIGZvciAoaSA9IDB1OyBp
IDwgTlVNX0RFU0M7IGkrKykgew0KPiA+ICsgICAgICAgICAgICAgcmluZy0+bWlzLmxlbltpXSA9
IDA7DQo+ID4gKyAgICAgICAgICAgICBpZiAoKE5VTV9ERVNDIC0gMXUpID09IGkpIHsNCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgZGVzYyA9IHJpbmctPmRlc2MgKyAoc2l6ZW9mKHR4X2Rlc2Mp
ICogaSk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGRlc2MtPm9wdHMxID0gY3B1X3RvX2xl
MzIoUklOR19FTkQpOw0KPiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsgICAgIH0NCj4gPiArDQo+
ID4gKyAgICAgcmluZy0+cmluZ19oYW5kbGVyID0gdHhfaGFuZGxlcjsNCj4gPiArICAgICBpZiAo
aWR4IDwgNHUpIHsNCj4gPiArICAgICAgICAgICAgIHJpbmctPml2ZWMgPSAmdHAtPmludF92ZWN0
b3JbaWR4XTsNCj4gPiArICAgICAgICAgICAgIGxpc3RfYWRkX3RhaWwoJnJpbmctPnJpbmdfZW50
cnksDQo+ICZ0cC0+aW50X3ZlY3RvcltpZHhdLnJpbmdfbGlzdCk7DQo+ID4gKyAgICAgfSBlbHNl
IHsNCj4gPiArICAgICAgICAgICAgIHJpbmctPml2ZWMgPSAmdHAtPmludF92ZWN0b3JbMF07DQo+
ID4gKyAgICAgICAgICAgICBsaXN0X2FkZF90YWlsKCZyaW5nLT5yaW5nX2VudHJ5LA0KPiAmdHAt
PmludF92ZWN0b3JbMF0ucmluZ19saXN0KTsNCj4gPiArICAgICB9DQo+ID4gK30NCj4gPiArDQo+
ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX3J4X2Rlc2NfaW5pdChzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAq
dHAsIHUxNiBpZHgpDQo+ID4gK3sNCj4gPiArICAgICB1MTYgaSA9IDA7DQo+ID4gKyAgICAgc3Ry
dWN0IHJ0YXNlX3JpbmcgKnJpbmcgPSAmdHAtPnJ4X3JpbmdbaWR4XTsNCj4gPiArDQo+ID4gKyAg
ICAgbWVtc2V0KHJpbmctPmRlc2MsIDB4MCwgUlRBU0VfUlhfUklOR19ERVNDX1NJWkUpOw0KPiA+
ICsgICAgIG1lbXNldChyaW5nLT5za2J1ZmYsIDB4MCwgKE5VTV9ERVNDICogc2l6ZW9mKHN0cnVj
dCBza19idWZmICopKSk7DQo+ID4gKyAgICAgcmluZy0+Y3VyX2lkeCA9IDA7DQo+ID4gKyAgICAg
cmluZy0+ZGlydHlfaWR4ID0gMDsNCj4gPiArICAgICByaW5nLT5pbmRleCA9IGlkeDsNCj4gPiAr
DQo+ID4gKyAgICAgZm9yIChpID0gMHU7IGkgPCBOVU1fREVTQzsgaSsrKQ0KPiA+ICsgICAgICAg
ICAgICAgcmluZy0+bWlzLmRhdGFfcGh5X2FkZHJbaV0gPSAwOw0KPiA+ICsNCj4gPiArICAgICBy
aW5nLT5yaW5nX2hhbmRsZXIgPSByeF9oYW5kbGVyOw0KPiA+ICsgICAgIHJpbmctPml2ZWMgPSAm
dHAtPmludF92ZWN0b3JbaWR4XTsNCj4gPiArICAgICBsaXN0X2FkZF90YWlsKCZyaW5nLT5yaW5n
X2VudHJ5LCAmdHAtPmludF92ZWN0b3JbaWR4XS5yaW5nX2xpc3QpOw0KPiA+ICt9DQo+ID4gKw0K
PiA+ICtzMzIgcnRhc2VfaW5pdF9yaW5nKGNvbnN0IHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpDQo+
ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihk
ZXYpOw0KPiA+ICsgICAgIHUxNiBpID0gMDsNCj4gPiArICAgICBzMzIgcmMgPSAwOw0KPiA+ICsN
Cj4gPiArICAgICBmb3IgKGkgPSAwdTsgaSA8IHRwLT5mdW5jX3R4X3F1ZXVlX251bTsgaSsrKQ0K
PiA+ICsgICAgICAgICAgICAgcnRhc2VfdHhfZGVzY19pbml0KHRwLCBpKTsNCj4gPiArDQo+ID4g
KyAgICAgZm9yIChpID0gMHU7IGkgPCB0cC0+ZnVuY19yeF9xdWV1ZV9udW07IGkrKykgew0KPiA+
ICsgICAgICAgICAgICAgcnRhc2VfcnhfZGVzY19pbml0KHRwLCBpKTsNCj4gPiArICAgICAgICAg
ICAgIGlmIChydGFzZV9yeF9yaW5nX2ZpbGwoJnRwLT5yeF9yaW5nW2ldLCAwLCBOVU1fREVTQywg
MCkgIT0NCj4gTlVNX0RFU0MpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX291
dDsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBydGFzZV9tYXJrX2FzX2xhc3RfZGVzY3JpcHRv
cih0cC0+cnhfcmluZ1tpXS5kZXNjDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICArIChzaXplb2YocnhfZGVzYykgKg0KPiAoTlVNX0RFU0MgLSAxdSkpKTsN
Cj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGdvdG8gb3V0Ow0KPiA+ICsNCj4gPiArZXJy
X291dDoNCj4gPiArICAgICBydGFzZV9yeF9jbGVhcih0cCk7DQo+ID4gKyAgICAgcmMgPSAtRU5P
TUVNOw0KPiA+ICtvdXQ6DQo+ID4gKyAgICAgcmV0dXJuIHJjOw0KPiA+ICt9DQo+ID4gKw0KPiA+
ICsjZGVmaW5lIFJUS19PUFRTMV9ERUJVR19WQUxVRSAweDBCQURCRUVGDQo+ID4gKyNkZWZpbmUg
UlRLX01BR0lDX05VTUJFUiAgICAgIDB4MEJBREJBREJBREJBREJBRHVMTA0KPiA+ICtzdGF0aWMg
dm9pZCBydGFzZV91bm1hcF90eF9za2Ioc3RydWN0IHBjaV9kZXYgKnBkZXYsIHUzMiBsZW4sIHR4
X2Rlc2MNCj4gKmRlc2MpDQo+ID4gK3sNCj4gPiArICAgICBkbWFfdW5tYXBfc2luZ2xlKCZwZGV2
LT5kZXYsIGxlNjRfdG9fY3B1KGRlc2MtPmFkZHIpLCBsZW4sDQo+IERNQV9UT19ERVZJQ0UpOw0K
PiA+ICsgICAgIGRlc2MtPm9wdHMxID0gY3B1X3RvX2xlMzIoUlRLX09QVFMxX0RFQlVHX1ZBTFVF
KTsNCj4gPiArICAgICBkZXNjLT5vcHRzMiA9IDB4MDA7DQo+ID4gKyAgICAgZGVzYy0+YWRkciA9
IFJUS19NQUdJQ19OVU1CRVI7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNl
X3R4X2NsZWFyX3JhbmdlKHN0cnVjdCBydGFzZV9yaW5nICpyaW5nLCB1MzIgc3RhcnQsIHUzMiBu
KQ0KPiA+ICt7DQo+ID4gKyAgICAgdTMyIGk7DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IHJ0YXNl
X3ByaXZhdGUgKnRwID0gcmluZy0+aXZlYy0+dHA7DQo+ID4gKyAgICAgc3RydWN0IG5ldF9kZXZp
Y2UgKmRldiA9IHRwLT5kZXY7DQo+ID4gKw0KPiA+ICsgICAgIGZvciAoaSA9IDB1OyBpIDwgbjsg
aSsrKSB7DQo+ID4gKyAgICAgICAgICAgICB1MzIgZW50cnkgPSAoc3RhcnQgKyBpKSAlIE5VTV9E
RVNDOw0KPiA+ICsgICAgICAgICAgICAgdTMyIGxlbiA9IHJpbmctPm1pcy5sZW5bZW50cnldOw0K
PiA+ICsNCj4gPiArICAgICAgICAgICAgIGlmIChsZW4gIT0gMHUpIHsNCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IHNrX2J1ZmYgKnNrYiA9IHJpbmctPnNrYnVmZltlbnRyeV07DQo+
ID4gKw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBydGFzZV91bm1hcF90eF9za2IodHAtPnBk
ZXYsIGxlbiwgcmluZy0+ZGVzYyArDQo+IChzaXplb2YodHhfZGVzYykgKiBlbnRyeSkpOw0KPiA+
ICsgICAgICAgICAgICAgICAgICAgICByaW5nLT5taXMubGVuW2VudHJ5XSA9IDA7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIGlmIChza2IpIHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBkZXYtPnN0YXRzLnR4X2Ryb3BwZWQrKzsNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBkZXZfa2ZyZWVfc2tiX2FueShza2IpOw0KPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHJpbmctPnNrYnVmZltlbnRyeV0gPSBOVUxMOw0KPiA+ICsgICAgICAgICAg
ICAgICAgICAgICB9DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+ICt9DQo+
ID4gKw0KPiA+ICt2b2lkIHJ0YXNlX3R4X2NsZWFyKHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCkN
Cj4gPiArew0KPiA+ICsgICAgIHUxNiBpOw0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9yaW5nICpy
aW5nOw0KPiA+ICsNCj4gPiArICAgICBmb3IgKGkgPSAwdTsgaSA8IHRwLT5mdW5jX3R4X3F1ZXVl
X251bTsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICByaW5nID0gJnRwLT50eF9yaW5nW2ldOw0K
PiA+ICsgICAgICAgICAgICAgcnRhc2VfdHhfY2xlYXJfcmFuZ2UocmluZywgcmluZy0+ZGlydHlf
aWR4LCBOVU1fREVTQyk7DQo+ID4gKyAgICAgICAgICAgICByaW5nLT5jdXJfaWR4ID0gMDsNCj4g
PiArICAgICAgICAgICAgIHJpbmctPmRpcnR5X2lkeCA9IDA7DQo+ID4gKyAgICAgICAgICAgICBy
aW5nLT5wcml2X2RpcnR5X2lkeCA9IDA7DQo+ID4gKyAgICAgICAgICAgICByaW5nLT5kdXBsaWNh
dGVfZGlydHlfY291bnQgPSAwOw0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3Rh
dGljIHZvaWQgcnRhc2Vfd2FpdF9mb3JfcXVpZXNjZW5jZShjb25zdCBzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2KQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0
ZGV2X3ByaXYoZGV2KTsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfaW50X3ZlY3RvciAqaXZlYzsN
Cj4gPiArICAgICB1MzIgaTsNCj4gPiArDQo+ID4gKyAgICAgZm9yIChpID0gMDsgaSA8IHRwLT5p
bnRfbnVtczsgaSsrKSB7DQo+ID4gKyAgICAgICAgICAgICBpdmVjID0gJnRwLT5pbnRfdmVjdG9y
W2ldOw0KPiA+ICsgICAgICAgICAgICAgc3luY2hyb25pemVfaXJxKGl2ZWMtPmlycSk7DQo+ID4g
KyAgICAgICAgICAgICAvKiBXYWl0IGZvciBhbnkgcGVuZGluZyBOQVBJIHRhc2sgdG8gY29tcGxl
dGUgKi8NCj4gPiArICAgICAgICAgICAgIG5hcGlfZGlzYWJsZSgmaXZlYy0+bmFwaSk7DQo+ID4g
KyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBydGFzZV9pcnFfbWFza19hbmRfYWNrKHRwKTsNCj4g
PiArDQo+ID4gKyAgICAgZm9yIChpID0gMDsgaSA8IHRwLT5pbnRfbnVtczsgaSsrKSB7DQo+ID4g
KyAgICAgICAgICAgICBpdmVjID0gJnRwLT5pbnRfdmVjdG9yW2ldOw0KPiA+ICsgICAgICAgICAg
ICAgbmFwaV9lbmFibGUoJml2ZWMtPm5hcGkpOw0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsN
Cj4gPiArc3RhdGljIHZvaWQgZHVtcF90eF9kZXNjKGNvbnN0IHN0cnVjdCBydGFzZV9yaW5nICpy
aW5nKQ0KPiA+ICt7DQo+ID4gKyAgICAgY29uc3QgdHhfZGVzYyAqZGVzYzsNCj4gPiArICAgICB1
MTYgaSA9IDB1Ow0KPiA+ICsNCj4gPiArICAgICBwcl9pbmZvKCIlczolZCIsIF9fZnVuY19fLCBf
X0xJTkVfXyk7DQo+ID4gKyAgICAgZm9yIChpID0gMHU7IGkgPCBOVU1fVFhfREVTQzsgaSsrKSB7
DQo+ID4gKyAgICAgICAgICAgICBkZXNjID0gcmluZy0+ZGVzYyArIChzaXplb2YodHhfZGVzYykg
KiBpKTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBwcl9pbmZvKCJvcHRzMSA9IDB4JXgiLCBk
ZXNjLT5vcHRzMSk7DQo+ID4gKyAgICAgICAgICAgICBwcl9pbmZvKCJvcHRzMiA9IDB4JXgiLCBk
ZXNjLT5vcHRzMik7DQo+ID4gKyAgICAgICAgICAgICBwcl9pbmZvKCJhZGRyICA9IDB4JWxseCIs
IGRlc2MtPmFkZHIpOw0KPiA+ICsgICAgIH0NCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHMz
MiBydGFzZV9kZWJ1Z19tc2coY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0cnVjdA0K
PiBydGFzZV9wcml2YXRlICp0cCkNCj4gPiArew0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBydGFz
ZV9yaW5nICpyaW5nOw0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9f
YWRkcjsNCj4gPiArICAgICBzMzIgbiA9IDA7DQo+ID4gKyAgICAgczMyIG1heF9yZWdfc2l6ZSA9
IFJUQVNFX1BDSV9SRUdTX1NJWkU7DQo+ID4gKyAgICAgdTMyIGR3b3JkX3JkOw0KPiA+ICsgICAg
IGNvbnN0IHN0cnVjdCBydGFzZV9jb3VudGVycyAqY291bnRlcnM7DQo+ID4gKyAgICAgZG1hX2Fk
ZHJfdCBwYWRkcjsNCj4gPiArICAgICB1MzIgY21kOw0KPiA+ICsgICAgIHUzMiB3YWl0X2NudDsN
Cj4gPiArDQo+ID4gKyAgICAgcHJfaW5mbygiRHJpdmVyIEluZm86Iik7DQo+ID4gKyAgICAgcHJf
aW5mbygiaW50IHZlY3RvciBpcnEgPSAlaSIsIHRwLT5pbnRfdmVjdG9yWzBdLmlycSk7DQo+ID4g
Kw0KPiA+ICsgICAgIHJpbmcgPSAmdHAtPnR4X3JpbmdbMF07DQo+ID4gKyAgICAgcHJfaW5mbygi
VHggZGVzY3JpcHRvciBpbmZvOiIpOw0KPiA+ICsgICAgIHByX2luZm8oIlR4IGN1cl9pZHggPSAw
eCV4IiwgcmluZy0+Y3VyX2lkeCk7DQo+ID4gKyAgICAgcHJfaW5mbygiVHggZGlydHlfaWR4ID0g
MHgleCIsIHJpbmctPmRpcnR5X2lkeCk7DQo+ID4gKyAgICAgcHJfaW5mbygiVHggcGh5X2FkZHIg
PSAweCVsbHgiLCByaW5nLT5waHlfYWRkcik7DQo+ID4gKyAgICAgZHVtcF90eF9kZXNjKHJpbmcp
Ow0KPiA+ICsNCj4gPiArICAgICByaW5nID0gJnRwLT5yeF9yaW5nWzBdOw0KPiA+ICsgICAgIHBy
X2luZm8oIlJ4IGRlc2NyaXB0b3IgaW5mbzoiKTsNCj4gPiArICAgICBwcl9pbmZvKCJSeCBjdXJf
aWR4ID0gMHgleCIsIHJpbmctPmN1cl9pZHgpOw0KPiA+ICsgICAgIHByX2luZm8oIlJ4IGRpcnR5
X2lkeCA9IDB4JXgiLCByaW5nLT5kaXJ0eV9pZHgpOw0KPiA+ICsgICAgIHByX2luZm8oIlJ4IHBo
eV9hZGRyID0gMHglbGx4IiwgcmluZy0+cGh5X2FkZHIpOw0KPiA+ICsNCj4gPiArICAgICBwcl9p
bmZvKCJEZXZpY2UgUmVnaXN0ZXJzOiIpOw0KPiA+ICsgICAgIHByX2luZm8oIkNoaXAgQ29tbWFu
ZCA9IDB4JTAyeCIsIFJUTF9SOChDSElQX0NNRCkpOw0KPiA+ICsgICAgIHByX2luZm8oIklNUiA9
ICUwOHgiLCBSVExfUjMyKElNUjApKTsNCj4gPiArICAgICBwcl9pbmZvKCJJU1IgPSAlMDh4Iiwg
UlRMX1IzMihJU1IwKSk7DQo+ID4gKyAgICAgcHJfaW5mbygiQm9vdCBDdHJsIFJlZygweEUwMDQp
ID0gJTA0eCIsIFJUTF9SMTYoMHg2MDA0KSk7DQo+ID4gKyAgICAgcHJfaW5mbygiRVBIWSBJU1Io
MHhFMDE0KSA9ICUwNHgiLCBSVExfUjE2KDB4NjAxNCkpOw0KPiA+ICsgICAgIHByX2luZm8oIkVQ
SFkgSU1SKDB4RTAxNikgPSAlMDR4IiwgUlRMX1IxNigweDYwMTYpKTsNCj4gPiArICAgICBwcl9p
bmZvKCJDTEtTVyBTRVQgUkVHKDB4RTAxOCkgPSAlMDR4IiwgUlRMX1IxNigweDYwMTgpKTsNCj4g
PiArDQo+ID4gKyAgICAgcHJfaW5mbygiRHVtcCBQQ0kgUmVnaXN0ZXJzOiIpOw0KPiA+ICsNCj4g
PiArICAgICB3aGlsZSAobiA8IG1heF9yZWdfc2l6ZSkgew0KPiA+ICsgICAgICAgICAgICAgaWYg
KChuICUgRFdPUkRfTU9EKSA9PSAwKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBwcl9pbmZv
KCJcbjB4JTAzeDpcdCIsIG4pOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIHBjaV9yZWFkX2Nv
bmZpZ19kd29yZCh0cC0+cGRldiwgbiwgJmR3b3JkX3JkKTsNCj4gPiArICAgICAgICAgICAgIHBy
X2luZm8oIiUwOHggIiwgZHdvcmRfcmQpOw0KPiA+ICsgICAgICAgICAgICAgbiArPSA0Ow0KPiA+
ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgcHJfaW5mbygiRHVtcCBUYWxseSBDb3VudGVyOiIp
Ow0KPiA+ICsgICAgIGNvdW50ZXJzID0gdHAtPnRhbGx5X3ZhZGRyOw0KPiA+ICsgICAgIHBhZGRy
ID0gdHAtPnRhbGx5X3BhZGRyOw0KPiA+ICsgICAgIFJUTF9XMzIoRFRDQ1I0LCAodTMyKShwYWRk
ciA+PiAzMikpOw0KPiA+ICsgICAgIGNtZCA9ICh1MzIpKHBhZGRyICYgRE1BX0JJVF9NQVNLKDMy
KSk7DQo+ID4gKyAgICAgUlRMX1czMihEVENDUjAsIGNtZCk7DQo+ID4gKyAgICAgUlRMX1czMihE
VENDUjAsICh1MzIpKGNtZCB8IENPVU5URVJfRFVNUCkpOw0KPiA+ICsgICAgIHdhaXRfY250ID0g
MDsNCj4gPiArICAgICB3aGlsZSAoKFJUTF9SMzIoRFRDQ1IwKSAmIENPVU5URVJfRFVNUCkgIT0g
MHUpIHsNCj4gPiArICAgICAgICAgICAgIHVzbGVlcF9yYW5nZSgxMCwgMjApOw0KPiA+ICsNCj4g
PiArICAgICAgICAgICAgIHdhaXRfY250Kys7DQo+ID4gKyAgICAgICAgICAgICBpZiAod2FpdF9j
bnQgPiAyMHUpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsgICAgIH0N
Cj4gPiArICAgICBwcl9pbmZvKCJ0eF9wYWNrZXRzXHQlbGxkXG4iLCBsZTY0X3RvX2NwdShjb3Vu
dGVycy0+dHhfcGFja2V0cykpOw0KPiA+ICsgICAgIHByX2luZm8oInJ4X3BhY2tldHNcdCVsbGRc
biIsIGxlNjRfdG9fY3B1KGNvdW50ZXJzLT5yeF9wYWNrZXRzKSk7DQo+ID4gKyAgICAgcHJfaW5m
bygidHhfZXJyb3JzXHQlbGxkXG4iLCBsZTY0X3RvX2NwdShjb3VudGVycy0+dHhfZXJyb3JzKSk7
DQo+ID4gKyAgICAgcHJfaW5mbygicnhfbWlzc2VkXHQlbGxkXG4iLCBsZTY0X3RvX2NwdShjb3Vu
dGVycy0+cnhfbWlzc2VkKSk7DQo+ID4gKyAgICAgcHJfaW5mbygiYWxpZ25fZXJyb3JzXHQlbGxk
XG4iLCBsZTY0X3RvX2NwdShjb3VudGVycy0+YWxpZ25fZXJyb3JzKSk7DQo+ID4gKyAgICAgcHJf
aW5mbygidHhfb25lX2NvbGxpc2lvblx0JWxsZFxuIiwNCj4gbGU2NF90b19jcHUoY291bnRlcnMt
PnR4X29uZV9jb2xsaXNpb24pKTsNCj4gPiArICAgICBwcl9pbmZvKCJ0eF9tdWx0aV9jb2xsaXNp
b25cdCVsbGRcbiIsDQo+IGxlNjRfdG9fY3B1KGNvdW50ZXJzLT50eF9tdWx0aV9jb2xsaXNpb24p
KTsNCj4gPiArICAgICBwcl9pbmZvKCJyeF91bmljYXN0XHQlbGxkXG4iLCBsZTY0X3RvX2NwdShj
b3VudGVycy0+cnhfdW5pY2FzdCkpOw0KPiA+ICsgICAgIHByX2luZm8oInJ4X2Jyb2FkY2FzdFx0
JWxsZFxuIiwNCj4gbGU2NF90b19jcHUoY291bnRlcnMtPnJ4X2Jyb2FkY2FzdCkpOw0KPiA+ICsg
ICAgIHByX2luZm8oInJ4X211bHRpY2FzdFx0JWxsZFxuIiwgbGU2NF90b19jcHUoY291bnRlcnMt
PnJ4X211bHRpY2FzdCkpOw0KPiA+ICsgICAgIHByX2luZm8oInR4X2Fib3J0ZWRcdCVsbGRcbiIs
IGxlNjRfdG9fY3B1KGNvdW50ZXJzLT50eF9hYm9ydGVkKSk7DQo+ID4gKyAgICAgcHJfaW5mbygi
dHhfdW5kZXJ1blx0JWxsZFxuIiwgbGU2NF90b19jcHUoY291bnRlcnMtPnR4X3VuZGVydW4pKTsN
Cj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIDA7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB2
b2lkIHJ0YXNlX3N3X3Jlc2V0KHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpDQo+ID4gK3sNCj4gPiAr
ICAgICBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsg
ICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7DQo+ID4gKw0KPiA+ICsgICAgIG5ldGRldl9pbmZvKGRl
diwgIiVzIGlzIHRyaWdnZXJlZC4iLCBfX2Z1bmNfXyk7DQo+ID4gKyAgICAgc3Bpbl9sb2NrX2ly
cXNhdmUoJnRwLT5sb2NrLCBmbGFncyk7DQo+ID4gKyAgICAgbmV0aWZfc3RvcF9xdWV1ZShkZXYp
Ow0KPiA+ICsgICAgIG5ldGlmX2NhcnJpZXJfb2ZmKGRldik7DQo+ID4gKyAgICAgaWYgKCh0cC0+
c3dfZmxhZyAmIFNXRl9TUklPVl9FTkFCTEVEKSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAg
cnRhc2VfaXJxX21hc2tfYW5kX2Fjayh0cCk7DQo+ID4gKyAgICAgICAgICAgICBydGFzZV9mdW5j
X2Rpc2FibGUodHApOw0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICBydGFz
ZV9od19yZXNldChkZXYpOw0KPiA+ICsgICAgIH0NCj4gPiArICAgICBzcGluX3VubG9ja19pcnFy
ZXN0b3JlKCZ0cC0+bG9jaywgZmxhZ3MpOw0KPiA+ICsNCj4gPiArICAgICAvKiBMZXQncyB3YWl0
IGEgYml0IHdoaWxlIGFueSAoYXN5bmMpIGlycSBsYW5kcyBvbiAqLw0KPiA+ICsgICAgIHJ0YXNl
X3dhaXRfZm9yX3F1aWVzY2VuY2UoZGV2KTsNCj4gPiArICAgICBydGFzZV90eF9jbGVhcih0cCk7
DQo+ID4gKyAgICAgcnRhc2VfcnhfY2xlYXIodHApOw0KPiA+ICsNCj4gPiArICAgICBpZiAocnRh
c2VfaW5pdF9yaW5nKGRldikgIT0gMCkNCj4gPiArICAgICAgICAgICAgIG5ldGRldl9hbGVydChk
ZXYsICJ1bmFibGUgdG8gaW5pdCByaW5nXG4iKTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKCh0cC0+
c3dfZmxhZyAmIFNXRl9TUklPVl9FTkFCTEVEKSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAg
cnRhc2VfZnVuY19lbmFibGUodHApOw0KPiA+ICsgICAgICAgICAgICAgcnRhc2VfZW5hYmxlX2h3
X2ludGVycnVwdCh0cCk7DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIHJ0
YXNlX2h3X2NvbmZpZyhkZXYpOw0KPiA+ICsgICAgICAgICAgICAgLyogYWx3YXlzIGxpbmssIHNv
IHN0YXJ0IHRvIHRyYW5zbWl0ICYgcmVjZWl2ZSAqLw0KPiA+ICsgICAgICAgICAgICAgcnRhc2Vf
aHdfc3RhcnQoZGV2KTsNCj4gPiArICAgICB9DQo+ID4gKyAgICAgbmV0aWZfY2Fycmllcl9vbihk
ZXYpOw0KPiA+ICsgICAgIG5ldGlmX3dha2VfcXVldWUoZGV2KTsNCj4gPiArDQo+ID4gKyAgICAg
LyogU2V0IHRpbWVvdXRfc3RhdGUgKi8NCj4gPiArICAgICB0cC0+dGltZW91dF9zdGF0ZSA9IFRJ
TUVPVVRfRVJST1I7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX3R4X3Rp
bWVvdXQoc3RydWN0IG5ldF9kZXZpY2UgKmRldiwgdW5zaWduZWQgaW50IHR4cXVldWUpDQo+ID4g
K3sNCj4gPiArICAgICAodm9pZCl0eHF1ZXVlOw0KPiA+ICsgICAgIHJ0YXNlX3N3X3Jlc2V0KGRl
dik7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBzMzIgcnRhc2VfeG1pdF9mcmFncyhzdHJ1
Y3QgcnRhc2VfcmluZyAqcmluZywgc3RydWN0IHNrX2J1ZmYgKnNrYiwgdTMyDQo+IG9wdHMxLCB1
MzIgb3B0czIpDQo+ID4gK3sNCj4gPiArICAgICBjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAq
dHAgPSByaW5nLT5pdmVjLT50cDsNCj4gPiArICAgICBjb25zdCBzdHJ1Y3Qgc2tiX3NoYXJlZF9p
bmZvICppbmZvID0gc2tiX3NoaW5mbyhza2IpOw0KPiA+ICsgICAgIHUzMiBjdXJfZnJhZywgZW50
cnk7DQo+ID4gKyAgICAgdHhfZGVzYyAqdHhkID0gTlVMTDsNCj4gPiArICAgICBjb25zdCB1OCBu
cl9mcmFncyA9IGluZm8tPm5yX2ZyYWdzOw0KPiA+ICsgICAgIHU2NCBwa3RfbGVuX2NudCA9IDA7
DQo+ID4gKyAgICAgczMyIHJjID0gMDsNCj4gPiArDQo+ID4gKyAgICAgZW50cnkgPSByaW5nLT5j
dXJfaWR4Ow0KPiA+ICsgICAgIGZvciAoY3VyX2ZyYWcgPSAwOyBjdXJfZnJhZyA8IG5yX2ZyYWdz
OyBjdXJfZnJhZysrKSB7DQo+ID4gKyAgICAgICAgICAgICBjb25zdCBza2JfZnJhZ190ICpmcmFn
ID0gJmluZm8tPmZyYWdzW2N1cl9mcmFnXTsNCj4gPiArICAgICAgICAgICAgIGRtYV9hZGRyX3Qg
bWFwcGluZzsNCj4gPiArICAgICAgICAgICAgIHUzMiBzdGF0dXMsIGxlbjsNCj4gPiArICAgICAg
ICAgICAgIHZvaWQgKmFkZHI7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgZW50cnkgPSAoZW50
cnkgKyAxdSkgJSBOVU1fREVTQzsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICB0eGQgPSByaW5n
LT5kZXNjICsgKHNpemVvZih0eF9kZXNjKSAqIGVudHJ5KTsNCj4gPiArICAgICAgICAgICAgIGxl
biA9IHNrYl9mcmFnX3NpemUoZnJhZyk7DQo+ID4gKyAgICAgICAgICAgICBhZGRyID0gc2tiX2Zy
YWdfYWRkcmVzcyhmcmFnKTsNCj4gPiArICAgICAgICAgICAgIG1hcHBpbmcgPSBkbWFfbWFwX3Np
bmdsZSgmdHAtPnBkZXYtPmRldiwgYWRkciwgbGVuLA0KPiBETUFfVE9fREVWSUNFKTsNCj4gPiAr
DQo+ID4gKyAgICAgICAgICAgICBpZiAodW5saWtlbHkoZG1hX21hcHBpbmdfZXJyb3IoJnRwLT5w
ZGV2LT5kZXYsDQo+IG1hcHBpbmcpKSkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBpZiAo
dW5saWtlbHkobmV0X3JhdGVsaW1pdCgpKSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBuZXRpZl9lcnIodHAsIGRydiwgdHAtPmRldiwgIkZhaWxlZCB0bw0KPiBtYXAgVFggZnJh
Z21lbnRzIERNQSFcbiIpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgZ290byBl
cnJfb3V0Ow0KPiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIGlm
ICgoKGVudHJ5ICsgMXUpICUgTlVNX0RFU0MpID09IDB1KQ0KPiA+ICsgICAgICAgICAgICAgICAg
ICAgICBzdGF0dXMgPSAob3B0czEgfCBsZW4gfCAodTMyKVJJTkdfRU5EKTsNCj4gPiArICAgICAg
ICAgICAgIGVsc2UNCj4gPiArICAgICAgICAgICAgICAgICAgICAgc3RhdHVzID0gb3B0czEgfCBs
ZW47DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgaWYgKGN1cl9mcmFnID09ICgodTMyKW5yX2Zy
YWdzIC0gMXUpKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJpbmctPnNrYnVmZltlbnRy
eV0gPSBza2I7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHN0YXR1cyB8PSAodTMyKVRYX0xB
U1RfRlJBRzsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgICAgICAgICB0
eGQtPmFkZHIgPSBjcHVfdG9fbGU2NChtYXBwaW5nKTsNCj4gPiArICAgICAgICAgICAgIHJpbmct
Pm1pcy5sZW5bZW50cnldID0gbGVuOw0KPiA+ICsgICAgICAgICAgICAgdHhkLT5vcHRzMiA9IGNw
dV90b19sZTMyKG9wdHMyKTsNCj4gPiArICAgICAgICAgICAgIC8qIG1ha2Ugc3VyZSB0aGUgb3Bl
cmF0aW5nIGZpZWxkcyBoYXZlIGJlZW4gdXBkYXRlZCAqLw0KPiA+ICsgICAgICAgICAgICAgd21i
KCk7DQo+ID4gKyAgICAgICAgICAgICB0eGQtPm9wdHMxID0gY3B1X3RvX2xlMzIoc3RhdHVzKTsN
Cj4gPiArICAgICAgICAgICAgIHBrdF9sZW5fY250ICs9IGxlbjsNCj4gPiArICAgICB9DQo+ID4g
Kw0KPiA+ICsgICAgIHJjID0gKHMzMiljdXJfZnJhZzsNCj4gPiArICAgICBnb3RvIG91dDsNCj4g
PiArDQo+ID4gK2Vycl9vdXQ6DQo+ID4gKyAgICAgcnRhc2VfdHhfY2xlYXJfcmFuZ2UocmluZywg
cmluZy0+Y3VyX2lkeCArIDF1LCBjdXJfZnJhZyk7DQo+ID4gKyAgICAgcmMgPSAtRUlPOw0KPiA+
ICtvdXQ6DQo+ID4gKyAgICAgcmV0dXJuIHJjOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMg
aW5saW5lIF9fYmUxNiBnZXRfcHJvdG9jb2woY29uc3Qgc3RydWN0IHNrX2J1ZmYgKnNrYikNCj4g
PiArew0KPiA+ICsgICAgIF9fYmUxNiBwcm90b2NvbDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHNr
Yi0+cHJvdG9jb2wgPT0gaHRvbnMoRVRIX1BfODAyMVEpKQ0KPiA+ICsgICAgICAgICAgICAgcHJv
dG9jb2wgPSB2bGFuX2V0aF9oZHIoc2tiKS0+aF92bGFuX2VuY2Fwc3VsYXRlZF9wcm90bzsNCj4g
PiArICAgICBlbHNlDQo+ID4gKyAgICAgICAgICAgICBwcm90b2NvbCA9IHNrYi0+cHJvdG9jb2w7
DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiBwcm90b2NvbDsNCj4gPiArfQ0KPiA+ICsNCj4gPiAr
c3RhdGljIGlubGluZSB1MzIgcnRhc2VfdHhfY3N1bShzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBjb25z
dCBzdHJ1Y3QgbmV0X2RldmljZQ0KPiAqZGV2KQ0KPiA+ICt7DQo+ID4gKyAgICAgdTMyIGNzdW1f
Y21kID0gMDsNCj4gPiArICAgICB1OCBzd19jYWxjX2NzdW0gPSBGQUxTRTsNCj4gPiArDQo+ID4g
KyAgICAgaWYgKHNrYi0+aXBfc3VtbWVkID09ICh1OClDSEVDS1NVTV9QQVJUSUFMKSB7DQo+ID4g
KyAgICAgICAgICAgICB1OCBpcF9wcm90b2NvbCA9IElQUFJPVE9fUkFXOw0KPiA+ICsNCj4gPiAr
ICAgICAgICAgICAgIHN3aXRjaCAoZ2V0X3Byb3RvY29sKHNrYikpIHsNCj4gPiArICAgICAgICAg
ICAgIGNhc2UgaHRvbnMoRVRIX1BfSVApOg0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBpZiAo
KGRldi0+ZmVhdHVyZXMgJiBORVRJRl9GX0lQX0NTVU0pICE9IDB1KSB7DQo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaXBfcHJvdG9jb2wgPSBpcF9oZHIoc2tiKS0+cHJvdG9jb2w7
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3N1bV9jbWQgPSAodTMyKVRYX0lQ
Q1NfQzsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgfQ0KPiA+ICsgICAgICAgICAgICAgICAg
ICAgICBicmVhazsNCj4gPiArICAgICAgICAgICAgIGNhc2UgaHRvbnMoRVRIX1BfSVBWNik6DQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIGlmICgoZGV2LT5mZWF0dXJlcyAmIE5FVElGX0ZfSVBW
Nl9DU1VNKSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiB0
cmFuc3BvcnRfb2Zmc2V0ID0NCj4gKHUzMilza2JfdHJhbnNwb3J0X29mZnNldChza2IpOw0KPiA+
ICsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHRyYW5zcG9ydF9vZmZz
ZXQgPiAwdSkgJiYNCj4gKHRyYW5zcG9ydF9vZmZzZXQgPD0gVENQSE9fTUFYKSkgew0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXBfcHJvdG9jb2wgPQ0KPiBpcHY2
X2hkcihza2IpLT5uZXh0aGRyOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY3N1bV9jbWQgPQ0KPiAodTMyKVRYX0lQVjZGX0M7DQo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjc3VtX2NtZCB8PSB0cmFuc3BvcnRfb2Zmc2V0DQo+IDw8
IFRDUEhPX1NISUZUOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgfQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBicmVhazsN
Cj4gPiArICAgICAgICAgICAgIGRlZmF1bHQ6DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGlm
ICh1bmxpa2VseShuZXRfcmF0ZWxpbWl0KCkpKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGRwcmludGsoImNoZWNrc3VtX3BhcnRpYWwgcHJvdG89JXghXG4iLA0KPiBza2ItPnBy
b3RvY29sKTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsg
ICAgICAgICAgICAgfQ0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIGlmIChpcF9wcm90b2NvbCA9
PSAodTgpSVBQUk9UT19UQ1ApDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGNzdW1fY21kIHw9
ICh1MzIpVFhfVENQQ1NfQzsNCj4gPiArICAgICAgICAgICAgIGVsc2UgaWYgKGlwX3Byb3RvY29s
ID09ICh1OClJUFBST1RPX1VEUCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgY3N1bV9jbWQg
fD0gKHUzMilUWF9VRFBDU19DOw0KPiA+ICsgICAgICAgICAgICAgZWxzZQ0KPiA+ICsgICAgICAg
ICAgICAgICAgICAgICBuZXRkZXZfaW5mbyhkZXYsICIlcyBjb21tYW5kIGVycm9yLlxuIiwNCj4g
X19mdW5jX18pOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIGlmIChjc3VtX2NtZCA9PSAwdSkg
ew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBzd19jYWxjX2NzdW0gPSBUUlVFOw0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICBXQVJOX09OKDEpOyAvKiB3ZSBuZWVkIGEgV0FSTigpICovDQo+
ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBpZiAoc3df
Y2FsY19jc3VtICE9IDB1KSB7DQo+ID4gKyAgICAgICAgICAgICBza2JfY2hlY2tzdW1faGVscChz
a2IpOw0KPiA+ICsgICAgICAgICAgICAgY3N1bV9jbWQgPSAwOw0KPiA+ICsgICAgIH0NCj4gPiAr
DQo+ID4gKyAgICAgcmV0dXJuIGNzdW1fY21kOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICsvKiBydGFz
ZV9jc3VtX3dvcmthcm91bmQoKQ0KPiA+ICsgKiBUaGUgaHcgbGltaXRlcyB0aGUgdmFsdWUgdGhl
IHRyYW5zcG9ydCBvZmZzZXQuIFdoZW4gdGhlIG9mZnNldCBpcyBvdXQgb2YNCj4gdGhlDQo+ID4g
KyAqIHJhbmdlLCBjYWxjdWxhdGUgdGhlIGNoZWNrc3VtIGJ5IHN3Lg0KPiA+ICsgKi8NCj4gPiAr
c3RhdGljIHZvaWQgcnRhc2VfY3N1bV93b3JrYXJvdW5kKGNvbnN0IHN0cnVjdCBydGFzZV9wcml2
YXRlICp0cCwgc3RydWN0DQo+IHNrX2J1ZmYgKnNrYikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVj
dCBuZXRfZGV2aWNlX3N0YXRzICpzdGF0czsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHNrYl9zaGlu
Zm8oc2tiKS0+Z3NvX3NpemUgIT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgIG5ldGRldl9mZWF0
dXJlc190IGZlYXR1cmVzID0gdHAtPmRldi0+ZmVhdHVyZXM7DQo+ID4gKyAgICAgICAgICAgICBz
dHJ1Y3Qgc2tfYnVmZiAqc2VncyA9IE5VTEw7DQo+ID4gKyAgICAgICAgICAgICBzdHJ1Y3Qgc2tf
YnVmZiAqbnNrYjsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBmZWF0dXJlcyAmPSB+KE5FVElG
X0ZfU0cgfCBORVRJRl9GX0lQVjZfQ1NVTSB8DQo+IE5FVElGX0ZfVFNPNik7DQo+ID4gKyAgICAg
ICAgICAgICBzZWdzID0gc2tiX2dzb19zZWdtZW50KHNrYiwgZmVhdHVyZXMpOw0KPiA+ICsgICAg
ICAgICAgICAgaWYgKElTX0VSUihzZWdzKSB8fCAoIXNlZ3MpKQ0KPiA+ICsgICAgICAgICAgICAg
ICAgICAgICBnb3RvIGRyb3A7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgZG8gew0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICBuc2tiID0gc2VnczsNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgc2VncyA9IHNlZ3MtPm5leHQ7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIG5za2ItPm5l
eHQgPSBOVUxMOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBydGFzZV9zdGFydF94bWl0KG5z
a2IsIHRwLT5kZXYpOw0KPiA+ICsgICAgICAgICAgICAgfSB3aGlsZSAoc2Vncyk7DQo+ID4gKw0K
PiA+ICsgICAgICAgICAgICAgZGV2X2NvbnN1bWVfc2tiX2FueShza2IpOw0KPiA+ICsgICAgICAg
ICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAgfSBlbHNlIGlmIChza2ItPmlwX3N1bW1lZCA9PSAo
dTgpQ0hFQ0tTVU1fUEFSVElBTCkgew0KPiA+ICsgICAgICAgICAgICAgaWYgKHNrYl9jaGVja3N1
bV9oZWxwKHNrYikgPCAwKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBnb3RvIGRyb3A7DQo+
ID4gKw0KPiA+ICsgICAgICAgICAgICAgcnRhc2Vfc3RhcnRfeG1pdChza2IsIHRwLT5kZXYpOw0K
PiA+ICsgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAg
ICAgICAgICAgIGdvdG8gZHJvcDsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICtkcm9wOg0KPiA+
ICsgICAgIHN0YXRzID0gJnRwLT5kZXYtPnN0YXRzOw0KPiA+ICsgICAgIHN0YXRzLT50eF9kcm9w
cGVkKys7DQo+ID4gKyAgICAgZGV2X2tmcmVlX3NrYl9hbnkoc2tiKTsNCj4gPiArDQo+ID4gK291
dDoNCj4gPiArICAgICByZXR1cm47DQo+ID4gK30NCj4gPiArDQo+ID4gKy8qIG1zZG5fZ2lhbnRf
c2VuZF9jaGVjaygpDQo+ID4gKyAqIEFjY29yZGluZyB0byB0aGUgZG9jdW1lbnQgb2YgbWljcm9z
b2Z0LCB0aGUgVENQIFBzZXVkbyBIZWFkZXIgZXhjbHVkZXMNCj4gdGhlDQo+ID4gKyAqIHBhY2tl
dCBsZW5ndGggZm9yIElQdjYgVENQIGxhcmdlIHBhY2tldHMuDQo+ID4gKyAqLw0KPiA+ICtzdGF0
aWMgczMyIG1zZG5fZ2lhbnRfc2VuZF9jaGVjayhzdHJ1Y3Qgc2tfYnVmZiAqc2tiKQ0KPiA+ICt7
DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IGlwdjZoZHIgKmlwdjZoOw0KPiA+ICsgICAgIHN0cnVj
dCB0Y3BoZHIgKnRoOw0KPiA+ICsgICAgIHMzMiByZXQ7DQo+ID4gKw0KPiA+ICsgICAgIHJldCA9
IHNrYl9jb3dfaGVhZChza2IsIDApOw0KPiA+ICsNCj4gPiArICAgICBpZiAocmV0ID09IDApIHsN
Cj4gPiArICAgICAgICAgICAgIGlwdjZoID0gaXB2Nl9oZHIoc2tiKTsNCj4gPiArICAgICAgICAg
ICAgIHRoID0gdGNwX2hkcihza2IpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIHRoLT5jaGVj
ayA9IDA7DQo+ID4gKyAgICAgICAgICAgICB0aC0+Y2hlY2sgPSB+dGNwX3Y2X2NoZWNrKDAsICZp
cHY2aC0+c2FkZHIsDQo+ICZpcHY2aC0+ZGFkZHIsIDApOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+
ID4gKyAgICAgcmV0dXJuIHJldDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIG5ldGRldl90
eF90IHJ0YXNlX3N0YXJ0X3htaXQoc3RydWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IG5ldF9kZXZp
Y2UNCj4gKmRldikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9
IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX3JpbmcgKnJpbmc7DQo+
ID4gKyAgICAgdTMyIHFfaWR4Ow0KPiA+ICsgICAgIHUzMiBlbnRyeTsNCj4gPiArICAgICB0eF9k
ZXNjICp0eGQ7DQo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRy
Ow0KPiA+ICsgICAgIGRtYV9hZGRyX3QgbWFwcGluZzsNCj4gPiArICAgICB1MzIgbGVuOw0KPiA+
ICsgICAgIHUzMiBvcHRzMTsNCj4gPiArICAgICB1MzIgb3B0czI7DQo+ID4gKyAgICAgbmV0ZGV2
X3R4X3QgcmV0ID0gTkVUREVWX1RYX09LOw0KPiA+ICsgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7
DQo+ID4gKyAgICAgdTY0IGxhcmdlX3NlbmRfZW47DQo+ID4gKyAgICAgczMyIGZyYWdzOw0KPiA+
ICsNCj4gPiArICAgICBzcGluX2xvY2tfaXJxc2F2ZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiAr
DQo+ID4gKyAgICAgLyogbXVsdGlxdWV1ZXMgKi8NCj4gPiArICAgICBxX2lkeCA9IHNrYl9nZXRf
cXVldWVfbWFwcGluZyhza2IpOw0KPiA+ICsgICAgIHJpbmcgPSAmdHAtPnR4X3JpbmdbcV9pZHhd
Ow0KPiA+ICsNCj4gPiArICAgICBpZiAodW5saWtlbHkoVFhfQlVGRlNfQVZBSUwocmluZykgPCBz
a2Jfc2hpbmZvKHNrYiktPm5yX2ZyYWdzKSkgew0KPiA+ICsgICAgICAgICAgICAgaWYgKG5ldGlm
X21zZ19kcnYodHApICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBuZXRkZXZfZXJy
KGRldiwgIiVzOiBCVUchIFR4IFJpbmcgZnVsbCB3aGVuDQo+IHF1ZXVlIGF3YWtlIVxuIiwgZGV2
LT5uYW1lKTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9zdG9wOw0KPiA+ICsg
ICAgIH0NCj4gPiArDQo+ID4gKyAgICAgZW50cnkgPSByaW5nLT5jdXJfaWR4ICUgTlVNX0RFU0M7
DQo+ID4gKyAgICAgdHhkID0gcmluZy0+ZGVzYyArIChzaXplb2YodHhfZGVzYykgKiBlbnRyeSk7
DQo+ID4gKw0KPiA+ICsgICAgIGlmICh1bmxpa2VseShsZTMyX3RvX2NwdSh0eGQtPm9wdHMxKSAm
IERFU0NfT1dOKSkNCj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX3N0b3A7DQo+ID4gKw0KPiA+
ICsgICAgIG9wdHMxID0gKHUzMilERVNDX09XTjsNCj4gPiArICAgICBvcHRzMiA9IHJ0YXNlX3R4
X3ZsYW5fdGFnKHRwLCBza2IpOw0KPiA+ICsgICAgIGxhcmdlX3NlbmRfZW4gPSAwOw0KPiA+ICsN
Cj4gPiArICAgICBpZiAoKGRldi0+ZmVhdHVyZXMgJiAoTkVUSUZfRl9UU08gfCBORVRJRl9GX1RT
TzYpKSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAgdTMyIG1zcyA9IHNrYl9zaGluZm8oc2ti
KS0+Z3NvX3NpemU7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgLyogVENQIFNlZ21lbnRhdGlv
biBPZmZsb2FkIChvciBUQ1AgTGFyZ2UgU2VuZCkgKi8NCj4gPiArICAgICAgICAgICAgIGlmICht
c3MgIT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgdTMyIHRyYW5zcG9ydF9vZmZz
ZXQgPQ0KPiAodTMyKXNrYl90cmFuc3BvcnRfb2Zmc2V0KHNrYik7DQo+ID4gKw0KPiA+ICsgICAg
ICAgICAgICAgICAgICAgICBhc3NlcnQoKHRyYW5zcG9ydF9vZmZzZXQgJSAyKSA9PSAwKTsNCj4g
PiArICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChnZXRfcHJvdG9jb2woc2tiKSkgew0KPiA+
ICsgICAgICAgICAgICAgICAgICAgICBjYXNlIGh0b25zKEVUSF9QX0lQKToNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZiAodHJhbnNwb3J0X29mZnNldCA8PSAxMjh1KSB7DQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRzMSB8PQ0KPiAodTMy
KUdJQU5UX1NFTkRfVjQ7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBvcHRzMSB8PSB0cmFuc3BvcnRfb2Zmc2V0IDw8DQo+IEdUVENQSE9fU0hJRlQ7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRzMiB8PSBtaW4obXNzLCBNU1Nf
TUFYKQ0KPiA8PCAxODsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGxhcmdlX3NlbmRfZW4gPSAxOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0N
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgY2FzZSBodG9ucyhFVEhfUF9JUFY2KToNCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpZiAobXNkbl9naWFudF9zZW5kX2NoZWNrKHNrYikgIT0gMCkgew0KPiA+
ICsNCj4gc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ0YXNlX2NzdW1fd29ya2Fyb3VuZCh0
cCwNCj4gc2tiKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdv
dG8gb3V0Ow0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCj4gPiArDQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyYW5zcG9ydF9vZmZzZXQgPD0gMTI4
dSkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0czEgfD0N
Cj4gKHUzMilHSUFOVF9TRU5EX1Y2Ow0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgb3B0czEgfD0gdHJhbnNwb3J0X29mZnNldCA8PA0KPiBHVFRDUEhPX1NISUZUOw0K
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0czIgfD0gbWluKG1z
cywgTVNTX01BWCkNCj4gPDwgMTg7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBsYXJnZV9zZW5kX2VuID0gMTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB9DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgKHVubGlrZWx5KG5ldF9yYXRlbGltaXQoKSkpDQo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBkcHJpbnRrKCJ0c28gcHJvdG89JXghXG4iLA0KPiBza2It
PnByb3RvY29sKTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJl
YWs7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgIGlmIChsYXJnZV9zZW5kX2VuID09IDB1KQ0KPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGdvdG8gZXJyX2RtYV8wOw0KPiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsg
ICAgIH0NCj4gPiArDQo+ID4gKyAgICAgaWYgKGxhcmdlX3NlbmRfZW4gPT0gMHUpIHsNCj4gPiAr
ICAgICAgICAgICAgIGlmIChza2ItPmlwX3N1bW1lZCA9PSAodTgpQ0hFQ0tTVU1fUEFSVElBTCkN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgb3B0czIgfD0gcnRhc2VfdHhfY3N1bShza2IsIGRl
dik7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBmcmFncyA9IHJ0YXNlX3htaXRfZnJh
Z3MocmluZywgc2tiLCBvcHRzMSwgb3B0czIpOw0KPiA+ICsgICAgIGlmICh1bmxpa2VseShmcmFn
cyA8IDApKQ0KPiA+ICsgICAgICAgICAgICAgZ290byBlcnJfZG1hXzA7DQo+ID4gKw0KPiA+ICsg
ICAgIGlmIChmcmFncyAhPSAwKSB7DQo+ID4gKyAgICAgICAgICAgICBsZW4gPSBza2JfaGVhZGxl
bihza2IpOw0KPiA+ICsgICAgICAgICAgICAgb3B0czEgfD0gKHUzMilUWF9GSVJTVF9GUkFHOw0K
PiA+ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICBsZW4gPSBza2ItPmxlbjsNCj4g
PiArICAgICAgICAgICAgIHJpbmctPnNrYnVmZltlbnRyeV0gPSBza2I7DQo+ID4gKyAgICAgICAg
ICAgICBvcHRzMSB8PSAodTMyKShUWF9GSVJTVF9GUkFHIHwgVFhfTEFTVF9GUkFHKTsNCj4gPiAr
ICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGlmICgoKChlbnRyeSArIDF1KSAlIE5VTV9ERVNDKSA9
PSAwdSkpDQo+ID4gKyAgICAgICAgICAgICBvcHRzMSB8PSAobGVuIHwgKHUzMilSSU5HX0VORCk7
DQo+ID4gKyAgICAgZWxzZQ0KPiA+ICsgICAgICAgICAgICAgb3B0czEgfD0gbGVuOw0KPiA+ICsN
Cj4gPiArICAgICBtYXBwaW5nID0gZG1hX21hcF9zaW5nbGUoJnRwLT5wZGV2LT5kZXYsIHNrYi0+
ZGF0YSwgbGVuLA0KPiBETUFfVE9fREVWSUNFKTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHVubGlr
ZWx5KGRtYV9tYXBwaW5nX2Vycm9yKCZ0cC0+cGRldi0+ZGV2LCBtYXBwaW5nKSkpIHsNCj4gPiAr
ICAgICAgICAgICAgIGlmICh1bmxpa2VseShuZXRfcmF0ZWxpbWl0KCkpKQ0KPiA+ICsgICAgICAg
ICAgICAgICAgICAgICBuZXRpZl9lcnIodHAsIGRydiwgZGV2LCAiRmFpbGVkIHRvIG1hcCBUWA0K
PiBETUEhXG4iKTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBnb3RvIGVycl9kbWFfMTsNCj4g
PiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHJpbmctPm1pcy5sZW5bZW50cnldID0gbGVuOw0K
PiA+ICsgICAgIHR4ZC0+YWRkciA9IGNwdV90b19sZTY0KG1hcHBpbmcpOw0KPiA+ICsgICAgIHR4
ZC0+b3B0czIgPSBjcHVfdG9fbGUzMihvcHRzMik7DQo+ID4gKyAgICAgdHhkLT5vcHRzMSA9IGNw
dV90b19sZTMyKG9wdHMxICYgfkRFU0NfT1dOKTsNCj4gPiArICAgICAvKiBtYWtlIHN1cmUgdGhl
IG9wZXJhdGluZyBmaWVsZHMgaGF2ZSBiZWVuIHVwZGF0ZWQgKi8NCj4gPiArICAgICB3bWIoKTsN
Cj4gPiArICAgICB0eGQtPm9wdHMxID0gY3B1X3RvX2xlMzIob3B0czEpOw0KPiA+ICsgICAgIHNr
Yl90eF90aW1lc3RhbXAoc2tiKTsNCj4gPiArDQo+ID4gKyAgICAgLyogdHggbmVlZHMgdG8gc2Vl
IGRlc2NyaXB0b3IgY2hhbmdlcyBiZWZvcmUgdXBkYXRlZCBjdXJfaWR4ICovDQo+ID4gKyAgICAg
c21wX3dtYigpOw0KPiA+ICsgICAgIHJpbmctPmN1cl9pZHggKz0gKHUzMilmcmFncyArIDF1Ow0K
PiA+ICsNCj4gPiArICAgICAvKiBtYWtlIHN1cmUgZGlzY3JpcHRvciBoYXMgYmVlbiB1cGRhdGVk
IGJlZm9yZSBoYXJkd2FyZSBwb2xsaW5nICovDQo+ID4gKyAgICAgd21iKCk7DQo+ID4gKyAgICAg
Lyogc2V0IHBvbGxpbmcgYml0ICovDQo+ID4gKyAgICAgUlRMX1c4KFRQUE9MTCwgKHU4KShCSVQo
cmluZy0+aW5kZXgpKSk7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChUWF9CVUZGU19BVkFJTChyaW5n
KSA8IE1BWF9TS0JfRlJBR1MpIHsNCj4gPiArICAgICAgICAgICAgIG5ldGlmX3N0b3BfcXVldWUo
ZGV2KTsNCj4gPiArICAgICAgICAgICAgIC8qIG1ha2Ugc3VyZSBjdXJfaWR4IGFuZCBkaXJ0eV9p
ZHggaGF2ZSBiZWVuIHVwZGF0ZWQgKi8NCj4gPiArICAgICAgICAgICAgIHNtcF9ybWIoKTsNCj4g
PiArICAgICAgICAgICAgIGlmIChUWF9CVUZGU19BVkFJTChyaW5nKSA+PSBNQVhfU0tCX0ZSQUdT
KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBuZXRpZl93YWtlX3F1ZXVlKGRldik7DQo+ID4g
KyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ0cC0+bG9j
aywgZmxhZ3MpOw0KPiA+ICsgICAgIGdvdG8gb3V0Ow0KPiA+ICsNCj4gPiArZXJyX2RtYV8xOg0K
PiA+ICsgICAgIHJpbmctPnNrYnVmZltlbnRyeV0gPSBOVUxMOw0KPiA+ICsgICAgIHJ0YXNlX3R4
X2NsZWFyX3JhbmdlKHJpbmcsIHJpbmctPmN1cl9pZHggKyAxdSwgKHUzMilmcmFncyk7DQo+ID4g
Kw0KPiA+ICtlcnJfZG1hXzA6DQo+ID4gKyAgICAgZGV2LT5zdGF0cy50eF9kcm9wcGVkKys7DQo+
ID4gKyAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiAr
ICAgICBkZXZfa2ZyZWVfc2tiX2FueShza2IpOw0KPiA+ICsgICAgIHJldCA9IE5FVERFVl9UWF9P
SzsNCj4gPiArICAgICBnb3RvIG91dDsNCj4gPiArDQo+ID4gK2Vycl9zdG9wOg0KPiA+ICsgICAg
IG5ldGlmX3N0b3BfcXVldWUoZGV2KTsNCj4gPiArICAgICByZXQgPSBORVRERVZfVFhfQlVTWTsN
Cj4gPiArICAgICBkZXYtPnN0YXRzLnR4X2Ryb3BwZWQrKzsNCj4gPiArICAgICBzcGluX3VubG9j
a19pcnFyZXN0b3JlKCZ0cC0+bG9jaywgZmxhZ3MpOw0KPiA+ICsNCj4gPiArb3V0Og0KPiA+ICsg
ICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBzMzIgdHhfaGFuZGxl
cihzdHJ1Y3QgcnRhc2VfcmluZyAqcmluZywgczMyIGJ1ZGdldCkNCj4gPiArew0KPiA+ICsgICAg
IGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IHJpbmctPml2ZWMtPnRwOw0KPiA+ICsg
ICAgIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYgPSB0cC0+ZGV2Ow0KPiA+ICsgICAgIHUzMiBkaXJ0
eV90eDsNCj4gPiArICAgICB1MzIgdHhfbGVmdDsNCj4gPiArICAgICB2b2lkIF9faW9tZW0gKmlv
YWRkciA9IHRwLT5tbWlvX2FkZHI7DQo+ID4gKyAgICAgczMyIHdvcmtkb25lID0gMDsNCj4gPiAr
DQo+ID4gKyAgICAgZGlydHlfdHggPSByaW5nLT5kaXJ0eV9pZHg7DQo+ID4gKyAgICAgLyogbWFr
ZSBzdXJlIHRoZSBpbmRleCBoYXMgYmVlbiB1cGRhdGVkICovDQo+ID4gKyAgICAgc21wX3JtYigp
Ow0KPiA+ICsgICAgIHR4X2xlZnQgPSByaW5nLT5jdXJfaWR4IC0gZGlydHlfdHg7DQo+ID4gKw0K
PiA+ICsgICAgIHdoaWxlICh0eF9sZWZ0ID4gMHUpIHsNCj4gPiArICAgICAgICAgICAgIHUzMiBl
bnRyeSA9IGRpcnR5X3R4ICUgTlVNX0RFU0M7DQo+ID4gKyAgICAgICAgICAgICB0eF9kZXNjICpk
ZXNjID0gcmluZy0+ZGVzYyArIChzaXplb2YodHhfZGVzYykgKiBlbnRyeSk7DQo+ID4gKyAgICAg
ICAgICAgICB1MzIgbGVuID0gcmluZy0+bWlzLmxlbltlbnRyeV07DQo+ID4gKyAgICAgICAgICAg
ICB1MzIgc3RhdHVzOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIC8qIG1ha2Ugc3VyZSBkaXNj
cmlwdG9yIGhhcyBiZWVuIHVwZGF0ZWQgKi8NCj4gPiArICAgICAgICAgICAgIHJtYigpOw0KPiA+
ICsgICAgICAgICAgICAgc3RhdHVzID0gbGUzMl90b19jcHUoZGVzYy0+b3B0czEpOw0KPiA+ICsN
Cj4gPiArICAgICAgICAgICAgIGlmICgoc3RhdHVzICYgREVTQ19PV04pICE9IDB1KSB7DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIHR4X2xlZnQgPSAwOw0KPiA+ICsgICAgICAgICAgICAgICAg
ICAgICBjb250aW51ZTsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgICAg
ICAgICBkZXYtPnN0YXRzLnR4X2J5dGVzICs9IGxlbjsNCj4gPiArICAgICAgICAgICAgIGRldi0+
c3RhdHMudHhfcGFja2V0cysrOw0KPiA+ICsgICAgICAgICAgICAgcnRhc2VfdW5tYXBfdHhfc2ti
KHRwLT5wZGV2LCBsZW4sIGRlc2MpOw0KPiA+ICsgICAgICAgICAgICAgcmluZy0+bWlzLmxlbltl
bnRyeV0gPSAwOw0KPiA+ICsgICAgICAgICAgICAgaWYgKHJpbmctPnNrYnVmZltlbnRyeV0pIHsN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgZGV2X2NvbnN1bWVfc2tiX2FueShyaW5nLT5za2J1
ZmZbZW50cnldKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgcmluZy0+c2tidWZmW2VudHJ5
XSA9IE5VTEw7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgICAgICAgICBkaXJ0eV90
eCsrOw0KPiA+ICsgICAgICAgICAgICAgdHhfbGVmdC0tOw0KPiA+ICsgICAgICAgICAgICAgd29y
a2RvbmUrKzsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBpZiAod29ya2RvbmUgPT0gYnVkZ2V0
KSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHR4X2xlZnQgPSAwOw0KPiA+ICsgICAgICAg
ICAgICAgICAgICAgICBjb250aW51ZTsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiArICAgICB9
DQo+ID4gKw0KPiA+ICsgICAgIGlmIChyaW5nLT5kaXJ0eV9pZHggIT0gZGlydHlfdHgpIHsNCj4g
PiArICAgICAgICAgICAgIHJpbmctPmRpcnR5X2lkeCA9IGRpcnR5X3R4Ow0KPiA+ICsgICAgICAg
ICAgICAgLyogbWFrZSBzdXJlIHRoZSBpbmRleCBoYXMgYmVlbiB1cGRhdGVkICovDQo+ID4gKyAg
ICAgICAgICAgICBzbXBfd21iKCk7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgaWYgKG5ldGlm
X3F1ZXVlX3N0b3BwZWQoZGV2KSAmJiAoVFhfQlVGRlNfQVZBSUwocmluZykgPj0NCj4gTUFYX1NL
Ql9GUkFHUykpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIG5ldGlmX3dha2VfcXVldWUoZGV2
KTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAvKiBtYWtlIHN1cmUgdGhlIGluZGV4IGhhcyBi
ZWVuIHVwZGF0ZWQgKi8NCj4gPiArICAgICAgICAgICAgIHNtcF9ybWIoKTsNCj4gPiArICAgICAg
ICAgICAgIGlmIChyaW5nLT5jdXJfaWR4ICE9IGRpcnR5X3R4KQ0KPiA+ICsgICAgICAgICAgICAg
ICAgICAgICBSVExfVzgoVFBQT0xMLCAodTgpKEJJVChyaW5nLT5pbmRleCkpKTsNCj4gPiArICAg
ICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiB3b3JrZG9uZTsNCj4gPiArfQ0KPiA+ICsNCj4g
PiArc3RhdGljIGlubGluZSBzMzIgcnRhc2VfZnJhZ21lbnRlZF9mcmFtZSh1MzIgc3RhdHVzKQ0K
PiA+ICt7DQo+ID4gKyAgICAgczMyIHJldDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKChzdGF0dXMg
JiAoUlhfRklSU1RfRlJBRyB8IFJYX0xBU1RfRlJBRykpICE9IChSWF9GSVJTVF9GUkFHIHwNCj4g
UlhfTEFTVF9GUkFHKSkNCj4gPiArICAgICAgICAgICAgIHJldCA9IDE7DQo+ID4gKyAgICAgZWxz
ZQ0KPiA+ICsgICAgICAgICAgICAgcmV0ID0gMDsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIHJl
dDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGlubGluZSB2b2lkIHJ0YXNlX3J4X2NzdW0o
Y29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwLCBzdHJ1Y3QNCj4gc2tfYnVmZiAqc2tiLA0K
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByeF9kZXNjICpkZXNjKQ0K
PiA+ICt7DQo+ID4gKyAgICAgdTMyIG9wdHMyID0gbGUzMl90b19jcHUoZGVzYy0+ZGVzY19zdGF0
dXMub3B0czIpOw0KPiA+ICsNCj4gPiArICAgICAodm9pZCl0cDsNCj4gPiArDQo+ID4gKyAgICAg
LyogcnggY3N1bSBvZmZsb2FkICovDQo+ID4gKyAgICAgaWYgKCgoKG9wdHMyICYgUlhfVjRGKSAh
PSAwdSkgJiYgKChvcHRzMiAmIFJYX0lQRikgPT0gMHUpKSB8fCAoKG9wdHMyDQo+ICYgUlhfVjZG
KSAhPSAwdSkpIHsNCj4gPiArICAgICAgICAgICAgIGlmICgoKChvcHRzMiAmIFJYX1RDUFQpICE9
IDB1KSAmJiAoKG9wdHMyICYgUlhfVENQRikgPT0NCj4gMHUpKQ0KPiA+ICsgICAgICAgICAgICAg
ICAgIHx8ICgoKG9wdHMyICYgUlhfVURQVCkgIT0gMHUpICYmICgob3B0czIgJiBSWF9VRFBGKQ0K
PiA9PSAwdSkpKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHNrYi0+aXBfc3VtbWVkID0g
Q0hFQ0tTVU1fVU5ORUNFU1NBUlk7DQo+ID4gKyAgICAgICAgICAgICB9IGVsc2Ugew0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICBza2ItPmlwX3N1bW1lZCA9IENIRUNLU1VNX05PTkU7DQo+ID4g
KyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIHNr
Yi0+aXBfc3VtbWVkID0gQ0hFQ0tTVU1fTk9ORTsNCj4gPiArICAgICB9DQo+ID4gK30NCj4gPiAr
DQo+ID4gK3N0YXRpYyBpbmxpbmUgczMyIHJ0YXNlX3RyeV9yeF9jb3B5KGNvbnN0IHN0cnVjdCBy
dGFzZV9yaW5nICpyaW5nLCBzdHJ1Y3QNCj4gc2tfYnVmZiAqKnBfc2tfYnVmZiwNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTMyIHBrdF9zaXplLCByeF9kZXNjICpkZXNj
LCB1MzINCj4gcnhfYnVmX3N6KQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX2ludF92
ZWN0b3IgKml2ZWMgPSByaW5nLT5pdmVjOw0KPiA+ICsgICAgIHMzMiByZXQgPSAtMTsNCj4gPiAr
DQo+ID4gKyAgICAgaWYgKChzMzIpcGt0X3NpemUgPCByeF9jb3B5YnJlYWspIHsNCj4gPiArICAg
ICAgICAgICAgIHN0cnVjdCBza19idWZmICpza2I7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAg
c2tiID0gUlRMX0FMTE9DX1NLQl9JTlRSKGl2ZWMtPm5hcGksICgodTMyKXBrdF9zaXplICsNCj4g
KHUzMilSVEtfUlhfQUxJR04pKTsNCj4gPiArICAgICAgICAgICAgIGlmIChza2IpIHsNCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgdTggKnBfc2tfYnVmZl9kYXRhOw0KPiA+ICsNCj4g
PiArICAgICAgICAgICAgICAgICAgICAgcF9za19idWZmX2RhdGEgPSBwX3NrX2J1ZmZbMF0tPmRh
dGE7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHNrYl9yZXNlcnZlKHNrYiwgKHMzMilSVEtf
UlhfQUxJR04pOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBwcmVmZXRjaChwX3NrX2J1ZmZf
ZGF0YSAtIFJUS19SWF9BTElHTik7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIG1lbWNweShz
a2ItPmRhdGEsIHBfc2tfYnVmZl9kYXRhLA0KPiAodTY0KXBrdF9zaXplKTsNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgKnBfc2tfYnVmZiA9IHNrYjsNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgcnRhc2VfbWFya190b19hc2ljKGRlc2MsIHJ4X2J1Zl9zeik7DQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgIHJldCA9IDA7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+
ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbmxpbmUgdm9p
ZCBydGFzZV9yeF9za2IoY29uc3Qgc3RydWN0IHJ0YXNlX3JpbmcgKnJpbmcsIHN0cnVjdCBza19i
dWZmDQo+ICpza2IpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfaW50X3ZlY3RvciAq
aXZlYyA9IHJpbmctPml2ZWM7DQo+ID4gKw0KPiA+ICsgICAgIG5hcGlfZ3JvX3JlY2VpdmUoJml2
ZWMtPm5hcGksIHNrYik7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBzMzIgcnhfaGFuZGxl
cihzdHJ1Y3QgcnRhc2VfcmluZyAqcmluZywgczMyIGJ1ZGdldCkNCj4gPiArew0KPiA+ICsgICAg
IGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IHJpbmctPml2ZWMtPnRwOw0KPiA+ICsg
ICAgIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYgPSB0cC0+ZGV2Ow0KPiA+ICsgICAgIHUzMiBjdXJf
cng7DQo+ID4gKyAgICAgdTMyIGRlbHRhOw0KPiA+ICsgICAgIHUzMiBlbnRyeTsNCj4gPiArICAg
ICBzMzIgd29ya2RvbmUgPSAwOw0KPiA+ICsgICAgIHJ4X2Rlc2MgKmRlc2M7DQo+ID4gKyAgICAg
dTMyIHN0YXR1czsNCj4gPiArICAgICBzdHJ1Y3Qgc2tfYnVmZiAqc2tiOw0KPiA+ICsgICAgIHUz
MiBwa3Rfc2l6ZTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKCFyaW5nLT5kZXNjKQ0KPiA+ICsgICAg
ICAgICAgICAgZ290byByeF9vdXQ7DQo+ID4gKw0KPiA+ICsgICAgIGN1cl9yeCA9IHJpbmctPmN1
cl9pZHg7DQo+ID4gKyAgICAgZW50cnkgPSBjdXJfcnggJSAodTMyKU5VTV9ERVNDOw0KPiA+ICsg
ICAgIGRlc2MgPSByaW5nLT5kZXNjICsgKHNpemVvZihyeF9kZXNjKSAqIGVudHJ5KTsNCj4gPiAr
DQo+ID4gKyAgICAgZG8gew0KPiA+ICsgICAgICAgICAgICAgLyogbWFrZSBzdXJlIGRpc2NyaXB0
b3IgaGFzIGJlZW4gdXBkYXRlZCAqLw0KPiA+ICsgICAgICAgICAgICAgcm1iKCk7DQo+ID4gKyAg
ICAgICAgICAgICBzdGF0dXMgPSBsZTMyX3RvX2NwdShkZXNjLT5kZXNjX3N0YXR1cy5vcHRzMSk7
DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgaWYgKChzdGF0dXMgJiBERVNDX09XTikgIT0gMHUp
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsNCj4gPiArICAgICAgICAg
ICAgIGlmICh1bmxpa2VseShzdGF0dXMgJiBSWF9SRVMpKSB7DQo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgIGlmIChuZXRpZl9tc2dfcnhfZXJyKHRwKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBuZXRkZXZfaW5mbyhkZXYsICIlczogUnggRVJST1IuIHN0YXR1cw0K
PiA9ICUwOHhcbiIsIGRldi0+bmFtZSwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdGF0dXMpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ZGV2LT5zdGF0cy5yeF9lcnJvcnMrKzsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
IGlmICgoc3RhdHVzICYgKFJYX1JXVCB8IFJYX1JVTlQpKSAhPSAwdSkNCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBkZXYtPnN0YXRzLnJ4X2xlbmd0aF9lcnJvcnMrKzsNCj4gPiAr
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGlmICgoc3RhdHVzICYgUlhfQ1JDKSAhPSAwdSkN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXYtPnN0YXRzLnJ4X2NyY19lcnJv
cnMrKzsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGlmICgoZGV2LT5mZWF0dXJl
cyAmIE5FVElGX0ZfUlhBTEwpICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGdvdG8gcHJvY2Vzc19wa3Q7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBy
dGFzZV9tYXJrX3RvX2FzaWMoZGVzYywgdHAtPnJ4X2J1Zl9zeik7DQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsNCj4gPiArcHJv
Y2Vzc19wa3Q6DQo+ID4gKyAgICAgICAgICAgICBpZiAobGlrZWx5KChkZXYtPmZlYXR1cmVzICYg
TkVUSUZfRl9SWEZDUykgPT0gMHUpKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBwa3Rfc2l6
ZSA9IChzdGF0dXMgJiAweDAwMDAzRkZGdSkgLSA0dTsNCj4gPiArICAgICAgICAgICAgIGVsc2UN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgcGt0X3NpemUgPSAoc3RhdHVzICYgMHgwMDAwM0ZG
RnUpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIC8qIFRoZSBkcml2ZXIgZG9lcyBub3Qgc3Vw
cG9ydCBpbmNvbWluZyBmcmFnbWVudGVkDQo+ID4gKyAgICAgICAgICAgICAgKiBmcmFtZXMuIFRo
ZXkgYXJlIHNlZW4gYXMgYSBzeW1wdG9tIG9mIG92ZXItbXR1DQo+ID4gKyAgICAgICAgICAgICAg
KiBzaXplZCBmcmFtZXMuDQo+ID4gKyAgICAgICAgICAgICAgKi8NCj4gPiArICAgICAgICAgICAg
IGlmICh1bmxpa2VseShydGFzZV9mcmFnbWVudGVkX2ZyYW1lKHN0YXR1cykpKSB7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIGRldi0+c3RhdHMucnhfZHJvcHBlZCsrOw0KPiA+ICsgICAgICAg
ICAgICAgICAgICAgICBkZXYtPnN0YXRzLnJ4X2xlbmd0aF9lcnJvcnMrKzsNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgcnRhc2VfbWFya190b19hc2ljKGRlc2MsIHRwLT5yeF9idWZfc3opOw0K
PiA+ICsgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCj4gPiArICAgICAgICAgICAgIH0N
Cj4gPiArDQo+ID4gKyAgICAgICAgICAgICBza2IgPSByaW5nLT5za2J1ZmZbZW50cnldOw0KPiA+
ICsgICAgICAgICAgICAgZG1hX3N5bmNfc2luZ2xlX2Zvcl9jcHUoJnRwLT5wZGV2LT5kZXYsDQo+
IHJpbmctPm1pcy5kYXRhX3BoeV9hZGRyW2VudHJ5XSwNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHRwLT5yeF9idWZfc3osDQo+IERNQV9GUk9NX0RFVklDRSk7DQo+
ID4gKw0KPiA+ICsgICAgICAgICAgICAgaWYgKHJ0YXNlX3RyeV9yeF9jb3B5KHJpbmcsICZza2Is
IHBrdF9zaXplLCBkZXNjLA0KPiB0cC0+cnhfYnVmX3N6KSAhPSAwKSB7DQo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgIGRtYV91bm1hcF9zaW5nbGUoJnRwLT5wZGV2LT5kZXYsDQo+IHJpbmctPm1p
cy5kYXRhX3BoeV9hZGRyW2VudHJ5XSwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB0cC0+cnhfYnVmX3N6LA0KPiBETUFfRlJPTV9ERVZJQ0UpOw0KPiA+ICsgICAg
ICAgICAgICAgICAgICAgICByaW5nLT5za2J1ZmZbZW50cnldID0gTlVMTDsNCj4gPiArICAgICAg
ICAgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGRtYV9zeW5jX3Npbmds
ZV9mb3JfZGV2aWNlKCZ0cC0+cGRldi0+ZGV2LA0KPiByaW5nLT5taXMuZGF0YV9waHlfYWRkcltl
bnRyeV0sDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHRwLT5yeF9idWZfc3osDQo+IERNQV9GUk9NX0RFVklDRSk7DQo+ID4gKyAgICAgICAgICAg
ICB9DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgaWYgKChkZXYtPmZlYXR1cmVzICYgTkVUSUZf
Rl9SWENTVU0pICE9IDB1KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBydGFzZV9yeF9jc3Vt
KHRwLCBza2IsIGRlc2MpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIHNrYi0+ZGV2ID0gZGV2
Ow0KPiA+ICsgICAgICAgICAgICAgc2tiX3B1dChza2IsIHBrdF9zaXplKTsNCj4gPiArICAgICAg
ICAgICAgIHNrYi0+cHJvdG9jb2wgPSBldGhfdHlwZV90cmFucyhza2IsIGRldik7DQo+ID4gKw0K
PiA+ICsgICAgICAgICAgICAgaWYgKHNrYi0+cGt0X3R5cGUgPT0gKHU4KVBBQ0tFVF9NVUxUSUNB
U1QpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGRldi0+c3RhdHMubXVsdGljYXN0Kys7DQo+
ID4gKw0KPiA+ICsgICAgICAgICAgICAgaWYgKHJ0YXNlX3J4X3ZsYW5fc2tiKGRlc2MsIHNrYikg
PCAwKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBydGFzZV9yeF9za2IocmluZywgc2tiKTsN
Cj4gPiArDQo+ID4gKyAgICAgICAgICAgICBkZXYtPnN0YXRzLnJ4X2J5dGVzICs9ICh1NjQpcGt0
X3NpemU7DQo+ID4gKyAgICAgICAgICAgICBkZXYtPnN0YXRzLnJ4X3BhY2tldHMrKzsNCj4gPiAr
b3V0Og0KPiA+ICsgICAgICAgICAgICAgd29ya2RvbmUrKzsNCj4gPiArICAgICAgICAgICAgIGN1
cl9yeCsrOw0KPiA+ICsgICAgICAgICAgICAgZW50cnkgPSBjdXJfcnggJSBOVU1fREVTQzsNCj4g
PiArICAgICAgICAgICAgIGRlc2MgPSByaW5nLT5kZXNjICsgKHNpemVvZihyeF9kZXNjKSAqIGVu
dHJ5KTsNCj4gPiArICAgICAgICAgICAgIHByZWZldGNoKGRlc2MpOw0KPiA+ICsNCj4gPiArICAg
ICB9IHdoaWxlICh3b3JrZG9uZSAhPSBidWRnZXQpOw0KPiA+ICsNCj4gPiArICAgICByaW5nLT5j
dXJfaWR4ID0gY3VyX3J4Ow0KPiA+ICsgICAgIGRlbHRhID0gcnRhc2VfcnhfcmluZ19maWxsKHJp
bmcsIHJpbmctPmRpcnR5X2lkeCwgcmluZy0+Y3VyX2lkeCwgMSk7DQo+ID4gKw0KPiA+ICsgICAg
IGlmICgoZGVsdGEgPT0gMHUpICYmICh3b3JrZG9uZSAhPSAwKSAmJiBuZXRpZl9tc2dfaW50cih0
cCkpDQo+ID4gKyAgICAgICAgICAgICBuZXRkZXZfaW5mbyhkZXYsICIlczogbm8gUnggYnVmZmVy
IGFsbG9jYXRlZFxuIiwNCj4gZGV2LT5uYW1lKTsNCj4gPiArDQo+ID4gKyAgICAgcmluZy0+ZGly
dHlfaWR4ICs9IGRlbHRhOw0KPiA+ICsNCj4gPiArICAgICAvKiBGSVhNRTogdW50aWwgdGhlcmUg
aXMgcGVyaW9kaWMgdGltZXIgdG8gdHJ5IGFuZCByZWZpbGwgdGhlIHJpbmcsDQo+ID4gKyAgICAg
ICogYSB0ZW1wb3Jhcnkgc2hvcnRhZ2UgbWF5IGRlZmluaXRlbHkga2lsbCB0aGUgUnggcHJvY2Vz
cy4NCj4gPiArICAgICAgKiAtIGRpc2FibGUgdGhlIGFzaWMgdG8gdHJ5IGFuZCBhdm9pZCBhbiBv
dmVyZmxvdyBhbmQga2ljayBpdCBhZ2Fpbg0KPiA+ICsgICAgICAqICAgYWZ0ZXIgcmVmaWxsID8N
Cj4gPiArICAgICAgKiAtIGhvdyBkbyBvdGhlcnMgZHJpdmVyIGhhbmRsZSB0aGlzIGNvbmRpdGlv
biAoVWggb2guLi4pLg0KPiA+ICsgICAgICAqLw0KPiA+ICsgICAgIGlmICgoKHJpbmctPmRpcnR5
X2lkeCArIE5VTV9ERVNDKSA9PSByaW5nLT5jdXJfaWR4KSAmJg0KPiBuZXRpZl9tc2dfaW50cih0
cCkpDQo+ID4gKyAgICAgICAgICAgICBuZXRkZXZfZW1lcmcoZGV2LCAiJXM6IFJ4IGJ1ZmZlcnMg
ZXhoYXVzdGVkXG4iLA0KPiBkZXYtPm5hbWUpOw0KPiA+ICsNCj4gPiArcnhfb3V0Og0KPiA+ICsg
ICAgIHJldHVybiB3b3JrZG9uZTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArLyogIFRoZSBpbnRlcnJ1
cHQgaGFuZGxlciBkb2VzIFJYUTAgYW5kIFRYUTAsIFRYUTR+NyBpbnRlcnJ1dHAgc3RhdHVzLg0K
PiA+ICsgKi8NCj4gPiArc3RhdGljIGlycXJldHVybl90IHJ0YXNlX2ludGVycnVwdChpbnQgaXJx
LCB2b2lkICpkZXZfaW5zdGFuY2UpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgbmV0X2Rldmlj
ZSAqZGV2ID0gKHN0cnVjdCBuZXRfZGV2aWNlICopZGV2X2luc3RhbmNlOw0KPiA+ICsgICAgIHN0
cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAgICAgc3Ry
dWN0IHJ0YXNlX2ludF92ZWN0b3IgKml2ZWMgPSAmdHAtPmludF92ZWN0b3JbMF07DQo+ID4gKyAg
ICAgdm9pZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHUzMiBz
dGF0dXM7DQo+ID4gKyAgICAgczMyIGhhbmRsZWQgPSAwOw0KPiA+ICsNCj4gPiArICAgICAodm9p
ZClpcnE7DQo+ID4gKw0KPiA+ICsgICAgIGRvIHsNCj4gPiArICAgICAgICAgICAgIHN0YXR1cyA9
IFJUTF9SMzIoaXZlYy0+aXNyX2FkZHIpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIGlmICgo
c3RhdHVzICYgTUJYKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgcXVldWVfd29y
ayh3b3JrX3F1ZXVlLCAmdHAtPm1zZ193b3JrKTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBp
ZiAoKHN0YXR1cyAmIFRJTUVPVVQwKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAg
cXVldWVfd29yayh3b3JrX3F1ZXVlLCAmdHAtPndhdGNoZG9nX3dvcmspOw0KPiA+ICsNCj4gPiAr
I2lmZGVmIFJUTERCRw0KPiA+ICsgICAgICAgICAgICAgaWYgKHN0YXR1cyAmIFJEVSkNCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgbmV0ZGV2X2luZm8oZGV2LCAiUEYgcmVjZWl2ZSBSRFUgISEh
ISEhISEhIik7DQo+ID4gKw0KPiA+ICsjZW5kaWYNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBo
YW5kbGVkID0gMTsNCj4gPiArICAgICAgICAgICAgIFJUTF9XMzIoaXZlYy0+aW1yX2FkZHIsIDB4
MCk7DQo+ID4gKyAgICAgICAgICAgICBSVExfVzMyKGl2ZWMtPmlzcl9hZGRyLCAodTMyKShzdGF0
dXMgJiB+Rk9WVykpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIHN0YXR1cyAmPSAodTMyKSh+
TUJYKTsNCj4gPiArICAgICAgICAgICAgIGlmICgoc3RhdHVzICYgaXZlYy0+aW1yKSAhPSAwdSkg
ew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBpZiAobGlrZWx5KFJUTF9ORVRJRl9SWF9TQ0hF
RFVMRV9QUkVQKGRldiwNCj4gJml2ZWMtPm5hcGkpKSkNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBfX1JUTF9ORVRJRl9SWF9TQ0hFRFVMRShkZXYsDQo+ICZpdmVjLT5uYXBpKTsN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobmV0aWZfbXNnX2ludHIodHApICE9
IDB1KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldGRldl9pbmZvKGRldiwg
IiVzOiBpbnRlcnJ1cHQgJTA4eCBpbg0KPiBwb2xsXG4iLCBkZXYtPm5hbWUsIHN0YXR1cyk7DQo+
ID4gKw0KPiA+ICsgICAgICAgICAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgUlRMX1czMihpdmVjLT5pbXJfYWRkciwgKHUzMikoaXZlYy0+aW1yICYNCj4gfk1CWCkpOw0K
PiA+ICsgICAgICAgICAgICAgfQ0KPiA+ICsNCj4gPiArICAgICB9IHdoaWxlIChmYWxzZSk7DQo+
ID4gKw0KPiA+ICsgICAgIHJldHVybiBJUlFfUkVUVkFMKGhhbmRsZWQpOw0KPiA+ICt9DQo+ID4g
Kw0KPiA+ICsvKiAgVGhlIGludGVycnVwdCBoYW5kbGVyIGRvZXMgUlhRMSZUWFExIG9yIFJYUTIm
VFhRMiBvcg0KPiBSWFEzJlRYUTMgaW50ZXJydXRwDQo+ID4gKyAqICBzdGF0dXMgYWNjb3JkaW5n
IHRvIGludGVycnVwdCB2ZWN0b3IuDQo+ID4gKyAqLw0KPiA+ICtzdGF0aWMgaXJxcmV0dXJuX3Qg
cnRhc2VfcV9pbnRlcnJ1cHQoaW50IGlycSwgdm9pZCAqZGV2X2luc3RhbmNlKQ0KPiA+ICt7DQo+
ID4gKyAgICAgc3RydWN0IHJ0YXNlX2ludF92ZWN0b3IgKml2ZWMgPSAoc3RydWN0IHJ0YXNlX2lu
dF92ZWN0b3INCj4gKilkZXZfaW5zdGFuY2U7DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IHJ0YXNl
X3ByaXZhdGUgKnRwID0gaXZlYy0+dHA7DQo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICppb2FkZHIg
PSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHUxNiBzdGF0dXM7DQo+ID4gKyAgICAgaW50IGhh
bmRsZWQgPSAwOw0KPiA+ICsNCj4gPiArICAgICAodm9pZClpcnE7DQo+ID4gKw0KPiA+ICsgICAg
IGRvIHsNCj4gPiArICAgICAgICAgICAgIHN0YXR1cyA9IFJUTF9SMTYoaXZlYy0+aXNyX2FkZHIp
Ow0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIGhhbmRsZWQgPSAxOw0KPiA+ICsgICAgICAgICAg
ICAgUlRMX1cxNihpdmVjLT5pbXJfYWRkciwgMHgwKTsNCj4gPiArICAgICAgICAgICAgIFJUTF9X
MTYoaXZlYy0+aXNyX2FkZHIsIHN0YXR1cyk7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgLyog
ZG9uJ3Qgc3VwcG9ydCB3aXRob3V0IE5BUEkgKi8NCj4gPiArICAgICAgICAgICAgIGlmIChsaWtl
bHkoUlRMX05FVElGX1JYX1NDSEVEVUxFX1BSRVAoZGV2LA0KPiAmaXZlYy0+bmFwaSkpKQ0KPiA+
ICsgICAgICAgICAgICAgICAgICAgICBfX1JUTF9ORVRJRl9SWF9TQ0hFRFVMRShkZXYsICZpdmVj
LT5uYXBpKTsNCj4gPiArICAgICAgICAgICAgIGVsc2UNCj4gPiArICAgICAgICAgICAgICAgICAg
ICAgbmV0ZGV2X2luZm8odHAtPmRldiwgIiVzOiBpbnRlcnJ1cHQgJTA0eCBpbg0KPiBwb2xsXG4i
LCBpdmVjLT5uYW1lLCBzdGF0dXMpOw0KPiA+ICsNCj4gPiArICAgICB9IHdoaWxlIChmYWxzZSk7
DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiBJUlFfUkVUVkFMKGhhbmRsZWQpOw0KPiA+ICt9DQo+
ID4gKw0KPiA+ICtzdGF0aWMgaW50IHJ0YXNlX3BvbGwoc3RydWN0IG5hcGlfc3RydWN0ICpuYXBp
LCBpbnQgYnVkZ2V0KQ0KPiA+ICt7DQo+ID4gKyAgICAgY29uc3Qgc3RydWN0IHJ0YXNlX2ludF92
ZWN0b3IgKml2ZWMgPSBjb250YWluZXJfb2YobmFwaSwgc3RydWN0DQo+IHJ0YXNlX2ludF92ZWN0
b3IsIG5hcGkpOw0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IGl2
ZWMtPnRwOw0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsN
Cj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcmluZyAqcmluZzsNCj4gPiArICAgICBpbnQgdG90YWxf
d29ya2RvbmUgPSAwOw0KPiA+ICsgICAgIHMzMiB3b3JrZG9uZSA9IDA7DQo+ID4gKyAgICAgczMy
IGNsZWFuX2ZsYWcgPSAxOw0KPiA+ICsNCj4gPiArICAgICAvKiBjbGFuZy1mb3JtYXQgb2ZmICov
DQo+ID4gKyAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeShyaW5nLCAmaXZlYy0+cmluZ19saXN0LCBy
aW5nX2VudHJ5KSB7DQo+ID4gKyAgICAgICAgICAgICB3b3JrZG9uZSA9IHJpbmctPnJpbmdfaGFu
ZGxlcihyaW5nLCBidWRnZXQpOw0KPiA+ICsgICAgICAgICAgICAgdG90YWxfd29ya2RvbmUgKz0g
d29ya2RvbmU7DQo+ID4gKyAgICAgICAgICAgICBpZiAod29ya2RvbmUgPT0gYnVkZ2V0KQ0KPiA+
ICsgICAgICAgICAgICAgICAgICAgICBjbGVhbl9mbGFnID0gMDsNCj4gPiArICAgICB9DQo+ID4g
KyAgICAgLyogY2xhbmctZm9ybWF0IG9uICovDQo+ID4gKw0KPiA+ICsgICAgIGlmIChjbGVhbl9m
bGFnICE9IDApIHsNCj4gPiArICAgICAgICAgICAgIHRvdGFsX3dvcmtkb25lID0gbWluKHRvdGFs
X3dvcmtkb25lLCBidWRnZXQgLSAxKTsNCj4gPiArICAgICAgICAgICAgIGlmIChsaWtlbHkobmFw
aV9jb21wbGV0ZV9kb25lKG5hcGksIHRvdGFsX3dvcmtkb25lKSkpIHsNCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgaWYgKGl2ZWMtPmluZGV4ID09IDB1KQ0KPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIFJUTF9XMzIoaXZlYy0+aW1yX2FkZHIsIGl2ZWMtPmltcik7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIGVsc2UNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBSVExfVzE2KGl2ZWMtPmltcl9hZGRyLA0KPiAodTE2KWl2ZWMtPmltcik7DQo+ID4gKyAgICAg
ICAgICAgICB9DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIC8qIHN0aWxs
IG5lZWQgdG8gcG9sbCAqLw0KPiA+ICsgICAgICAgICAgICAgdG90YWxfd29ya2RvbmUgPSBidWRn
ZXQ7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICByZXR1cm4gdG90YWxfd29ya2RvbmU7
DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX2Rvd24oc3RydWN0IG5ldF9k
ZXZpY2UgKmRldikNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9
IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAgICAgdW5zaWduZWQgbG9uZyBmbGFnczsNCj4gPiAr
ICAgICB1MzIgaSA9IDB1Ow0KPiA+ICsNCj4gPiArICAgICBuZXRpZl9zdG9wX3F1ZXVlKGRldik7
DQo+ID4gKw0KPiA+ICsgICAgIC8qIEdpdmUgYSByYWNpbmcgaGFyZF9zdGFydF94bWl0IGEgZmV3
IGN5Y2xlcyB0byBjb21wbGV0ZS4gKi8NCj4gPiArICAgICBzeW5jaHJvbml6ZV9yY3UoKTsNCj4g
PiArDQo+ID4gKyAgICAgc3Bpbl9sb2NrX2lycXNhdmUoJnRwLT5sb2NrLCBmbGFncyk7DQo+ID4g
Kw0KPiA+ICsgICAgIG5ldGlmX2NhcnJpZXJfb2ZmKGRldik7DQo+ID4gKw0KPiA+ICsgICAgIGlm
ICgodHAtPnN3X2ZsYWcgJiBTV0ZfU1JJT1ZfRU5BQkxFRCkgIT0gMHUpIHsNCj4gPiArICAgICAg
ICAgICAgIHJ0YXNlX2lycV9tYXNrX2FuZF9hY2sodHApOw0KPiA+ICsgICAgICAgICAgICAgcnRh
c2VfZnVuY19kaXNhYmxlKHRwKTsNCj4gPiArICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAgICAg
ICAgcnRhc2VfaHdfcmVzZXQoZGV2KTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHNw
aW5fdW5sb2NrX2lycXJlc3RvcmUoJnRwLT5sb2NrLCBmbGFncyk7DQo+ID4gKw0KPiA+ICsgICAg
IGZvciAoaSA9IDB1OyBpIDwgdHAtPmludF9udW1zOyBpKyspDQo+ID4gKyAgICAgICAgICAgICBz
eW5jaHJvbml6ZV9pcnEodHAtPmludF92ZWN0b3JbaV0uaXJxKTsNCj4gPiArDQo+ID4gKyAgICAg
c3Bpbl9sb2NrX2lycXNhdmUoJnRwLT5sb2NrLCBmbGFncyk7DQo+ID4gKw0KPiA+ICsgICAgIHJ0
YXNlX3R4X2NsZWFyKHRwKTsNCj4gPiArDQo+ID4gKyAgICAgcnRhc2VfcnhfY2xlYXIodHApOw0K
PiA+ICsNCj4gPiArICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ0cC0+bG9jaywgZmxhZ3Mp
Ow0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IHJ0YXNlX2Nsb3NlKHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAg
PSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsgICAgIGNvbnN0IHN0cnVjdCBwY2lfZGV2ICpwZGV2
ID0gdHAtPnBkZXY7DQo+ID4gKyAgICAgdTMyIGkgPSAwOw0KPiA+ICsNCj4gPiArICAgICBydGFz
ZV9kb3duKGRldik7DQo+ID4gKw0KPiA+ICsgICAgIGlmICgodHAtPnN3X2ZsYWcgJiBTV0ZfTVNJ
WF9FTkFCTEVEKSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAgZnJlZV9pcnEodHAtPmludF92
ZWN0b3JbaV0uaXJxLCBkZXYpOw0KPiA+ICsgICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IHRw
LT5pbnRfbnVtczsgaSsrKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBmcmVlX2lycSh0cC0+
aW50X3ZlY3RvcltpXS5pcnEsICZ0cC0+aW50X3ZlY3RvcltpXSk7DQo+ID4gKw0KPiA+ICsgICAg
IH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICBmcmVlX2lycShwZGV2LT5pcnEsIGRldik7DQo+
ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBydGFzZV9mcmVlX2Rlc2ModHApOw0KPiA+ICsN
Cj4gPiArICAgICByZXR1cm4gMDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRh
c2Vfc2h1dGRvd24oc3RydWN0IHBjaV9kZXYgKnBkZXYpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1
Y3QgbmV0X2RldmljZSAqZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOw0KPiA+ICsgICAgIGNv
bnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKw0K
PiA+ICsgICAgIGlmIChuZXRpZl9ydW5uaW5nKGRldikpIHsNCj4gPiArICAgICAgICAgICAgIGlm
IChydGFzZV9jbG9zZShkZXYpICE9IDApDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIG5ldGRl
dl9hbGVydChkZXYsICJ1bmFibGUgdG8gY2xvc2VcbiIpOw0KPiA+ICsgICAgIH0NCj4gPiArICAg
ICBydGFzZV9yZXNldF9pbnRlcnJ1cHQocGRldiwgdHApOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtz
dGF0aWMgdm9pZCBydGFzZV9nZXRfc3RhdHM2NChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBzdHJ1
Y3QgcnRubF9saW5rX3N0YXRzNjQNCj4gKnN0YXRzKQ0KPiA+ICt7DQo+ID4gKyAgICAgY29uc3Qg
c3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0ZGV2X3ByaXYoZGV2KTsNCj4gPiArICAgICBj
b25zdCBzdHJ1Y3QgcnRhc2VfY291bnRlcnMgKmNvdW50ZXJzID0gdHAtPnRhbGx5X3ZhZGRyOw0K
PiA+ICsgICAgIGRtYV9hZGRyX3QgcGFkZHIgPSB0cC0+dGFsbHlfcGFkZHI7DQo+ID4gKw0KPiA+
ICsgICAgIGlmIChjb3VudGVycykgew0KPiA+ICsgICAgICAgICAgICAgbmV0ZGV2X3N0YXRzX3Rv
X3N0YXRzNjQoc3RhdHMsICZkZXYtPnN0YXRzKTsNCj4gPiArICAgICAgICAgICAgIGRldl9mZXRj
aF9zd19uZXRzdGF0cyhzdGF0cywgZGV2LT50c3RhdHMpOw0KPiA+ICsNCj4gPiArICAgICAgICAg
ICAgIC8qIEZldGNoIGFkZGl0aW9uYWwgY291bnRlciB2YWx1ZXMgbWlzc2luZyBpbiBzdGF0cyBj
b2xsZWN0ZWQNCj4gYnkgZHJpdmVyIGZyb20gdGFsbHkNCj4gPiArICAgICAgICAgICAgICAqIGNv
dW50ZXINCj4gPiArICAgICAgICAgICAgICAqLw0KPiA+ICsgICAgICAgICAgICAgcnRhc2VfZHVt
cF90YWxseV9jb3VudGVyKHRwLCBwYWRkcik7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgc3Rh
dHMtPnR4X2Vycm9ycyA9IGxlNjRfdG9fY3B1KGNvdW50ZXJzLT50eF9lcnJvcnMpOw0KPiA+ICsg
ICAgICAgICAgICAgc3RhdHMtPmNvbGxpc2lvbnMgPQ0KPiBsZTY0X3RvX2NwdShjb3VudGVycy0+
dHhfbXVsdGlfY29sbGlzaW9uKTsNCj4gPiArICAgICAgICAgICAgIHN0YXRzLT50eF9hYm9ydGVk
X2Vycm9ycyA9DQo+IGxlNjRfdG9fY3B1KGNvdW50ZXJzLT50eF9hYm9ydGVkKTsNCj4gPiArICAg
ICAgICAgICAgIHN0YXRzLT5yeF9taXNzZWRfZXJyb3JzID0NCj4gbGU2NF90b19jcHUoY291bnRl
cnMtPnJ4X21pc3NlZCk7DQo+ID4gKyAgICAgfQ0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMg
dm9pZCBydGFzZV92bGFuX2ZpbHRlcihjb25zdCBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAsIHU4
IGVuYWJsZWQpDQo+ID4gK3sNCj4gPiArICAgICB2b2lkIF9faW9tZW0gKmlvYWRkciA9IHRwLT5t
bWlvX2FkZHI7DQo+ID4gKyAgICAgdTE2IHRtcCA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChl
bmFibGVkID09IDF1KSB7DQo+ID4gKyAgICAgICAgICAgICAvKiBQRkNSICovDQo+ID4gKyAgICAg
ICAgICAgICB0bXAgPSBSVExfUjE2KEZDUik7DQo+ID4gKyAgICAgICAgICAgICBpZiAoKHRtcCAm
IEZDUl9WTEFOX0ZUUl9FTikgPT0gMHUpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIFJUTF9X
MTYoRkNSLCAodTE2KSh0bXAgfCBGQ1JfVkxBTl9GVFJfRU4pKTsNCj4gPiArDQo+ID4gKyAgICAg
ICAgICAgICAvKiBQQ1BSICovDQo+ID4gKyAgICAgICAgICAgICB0bXAgPSBSVExfUjE2KFBDUFIp
Ow0KPiA+ICsgICAgICAgICAgICAgaWYgKCh0bXAgJiBQQ1BSX1ZMQU5fRlRSX0VOKSA9PSAwdSkN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgUlRMX1cxNihQQ1BSLCAodTE2KSh0bXAgfA0KPiBQ
Q1BSX1ZMQU5fRlRSX0VOKSk7DQo+ID4gKw0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAg
ICAgICAgICAvKiBQRkNSICovDQo+ID4gKyAgICAgICAgICAgICB0bXAgPSBSVExfUjE2KEZDUik7
DQo+ID4gKyAgICAgICAgICAgICBpZiAoKHRtcCAmIEZDUl9WTEFOX0ZUUl9FTikgIT0gMHUpDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIFJUTF9XMTYoRkNSLCAodTE2KSh0bXAgJg0KPiB+RkNS
X1ZMQU5fRlRSX0VOKSk7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgLyogUENQUiAqLw0KPiA+
ICsgICAgICAgICAgICAgdG1wID0gUlRMX1IxNihQQ1BSKTsNCj4gPiArICAgICAgICAgICAgIGlm
ICgodG1wICYgUENQUl9WTEFOX0ZUUl9FTikgPT0gMHUpDQo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgIFJUTF9XMTYoUENQUiwgKHUxNikodG1wICYNCj4gflBDUFJfVkxBTl9GVFJfRU4pKTsNCj4g
PiArICAgICB9DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgcnRhc2Vfdmxhbl9yeF9h
ZGRfdmlkKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsIF9fYmUxNiBwcm90b2NvbCwNCj4gdTE2IHZp
ZCkNCj4gPiArew0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9w
cml2KGRldik7DQo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRy
Ow0KPiA+ICsgICAgIHUxNiBpID0gMHU7DQo+ID4gKyAgICAgdTE2IHRtcF9tZW0gPSAwOw0KPiA+
ICsgICAgIGludCByZXQgPSAwOw0KPiA+ICsNCj4gPiArICAgICBpZiAoYmUxNl90b19jcHUocHJv
dG9jb2wpICE9ICh1MTYpRVRIX1BfODAyMVEpIHsNCj4gPiArICAgICAgICAgICAgIHJldCA9IC1F
SU5WQUw7DQo+ID4gKyAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiArICAgICB9DQo+ID4gKw0K
PiA+ICsgICAgIC8qIHZsYW4gZmlsdGVyIHRhYmxlICovDQo+ID4gKyAgICAgZm9yIChpID0gMHU7
IGkgPCBWTEFOX0ZJTFRFUl9FTlRSWV9OVU07IGkrKykgew0KPiA+ICsgICAgICAgICAgICAgaWYg
KCh0cC0+dmxhbl9maWx0ZXJfY3RybCAmIEJJVChpKSkgPT0gMHUpIHsNCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgdHAtPnZsYW5fZmlsdGVyX2N0cmwgfD0gKHUzMilCSVQoaSk7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIHRwLT52bGFuX2ZpbHRlcl92aWRbaV0gPSB2aWQ7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIFJUTF9XMzIoKFZMQU5fRU5UUllfMCArIChpICogNHUpKSwgKHZp
ZCB8DQo+IFZMQU5fRU5UUllfQ0FSRUJJVCkpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgdG1wX21lbSA9IFJUTF9SMTYoKFZMQU5fRU5UUllfTUVNXzAgKw0KPiAoKGkgLyAydSkg
KiAydSkpKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgdG1wX21lbSB8PSAoKHUxNikweDF1
IDw8ICgoaSAlIDJ1KSAqIDh1KSk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIFJUTF9XMTYo
KFZMQU5fRU5UUllfTUVNXzAgKyAoKGkgLyAydSkgKiAydSkpLA0KPiB0bXBfbWVtKTsNCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAg
ICAgfQ0KPiA+ICsNCj4gPiArICAgICBpZiAoaSA9PSBWTEFOX0ZJTFRFUl9FTlRSWV9OVU0pIHsN
Cj4gPiArICAgICAgICAgICAgIHJldCA9IC1FTk9NRU07DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4g
PiArICAgICAgICAgICAgIC8qIGNoZWNrIHZsYW4gZmlsdGVyIGVuYWJsZWQgKi8NCj4gPiArICAg
ICAgICAgICAgIHJ0YXNlX3ZsYW5fZmlsdGVyKHRwLCAxdSk7DQo+ID4gKyAgICAgfQ0KPiA+ICsN
Cj4gPiArb3V0Og0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0
YXRpYyBpbnQgcnRhc2Vfdmxhbl9yeF9raWxsX3ZpZChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCBf
X2JlMTYgcHJvdG9jb2wsDQo+IHUxNiB2aWQpDQo+ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgcnRh
c2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsgICAgIHZvaWQgX19pb21l
bSAqaW9hZGRyID0gdHAtPm1taW9fYWRkcjsNCj4gPiArICAgICB1MTYgaSA9IDB1Ow0KPiA+ICsg
ICAgIHUxNiB0bXBfbWVtID0gMDsNCj4gPiArICAgICBzMzIgcmMgPSAwOw0KPiA+ICsNCj4gPiAr
ICAgICBpZiAoYmUxNl90b19jcHUocHJvdG9jb2wpICE9ICh1MTYpRVRIX1BfODAyMVEpIHsNCj4g
PiArICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsNCj4gPiArICAgICAgICAgICAgIGdvdG8gb3V0
Ow0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgLyogdmxhbiBmaWx0ZXIgdGFibGUgKi8N
Cj4gPiArICAgICBmb3IgKGkgPSAwdTsgaSA8IFZMQU5fRklMVEVSX0VOVFJZX05VTTsgaSsrKSB7
DQo+ID4gKyAgICAgICAgICAgICBpZiAodHAtPnZsYW5fZmlsdGVyX3ZpZFtpXSA9PSB2aWQpIHsN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgdHAtPnZsYW5fZmlsdGVyX2N0cmwgJj0gKHUzMiko
fkJJVChpKSk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHRwLT52bGFuX2ZpbHRlcl92aWRb
aV0gPSAwOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBSVExfVzMyKChWTEFOX0VOVFJZXzAg
KyAoaSAqIDR1KSksIDApOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgdG1wX21l
bSA9IFJUTF9SMTYoKFZMQU5fRU5UUllfTUVNXzAgKw0KPiAoKGkgLyAydSkgKiAydSkpKTsNCj4g
PiArICAgICAgICAgICAgICAgICAgICAgdG1wX21lbSAmPSAofigodTE2KTB4MXUgPDwgKChpICUg
MnUpICogOHUpKSk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIFJUTF9XMTYoKFZMQU5fRU5U
UllfTUVNXzAgKyAoKGkgLyAydSkgKiAydSkpLA0KPiB0bXBfbWVtKTsNCj4gPiArICAgICAgICAg
ICAgICAgICAgICAgYnJlYWs7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+
ICsNCj4gPiArICAgICAvKiBjaGVjayB2bGFuIGZpbHRlciBlbmFibGVkICovDQo+ID4gKyAgICAg
aWYgKHRwLT52bGFuX2ZpbHRlcl9jdHJsID09IDB1KSB7DQo+ID4gKyAgICAgICAgICAgICAvKiBk
aXNhYmxlIHZsYW4gZmlsdGVyICovDQo+ID4gKyAgICAgICAgICAgICBydGFzZV92bGFuX2ZpbHRl
cih0cCwgMHUpOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gK291dDoNCj4gPiArICAgICByZXR1
cm4gcmM7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX3NldF9od19jYnMo
Y29uc3Qgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwLCB1MzIgcXVldWUpDQo+ID4gK3sNCj4gPiAr
ICAgICB2b2lkIF9faW9tZW0gKmlvYWRkciA9IHRwLT5tbWlvX2FkZHI7DQo+ID4gKyAgICAgdTMy
IGkgPSAwOw0KPiA+ICsgICAgIHUzMiBpZGxlID0gKHUzMil0cC0+dHhfcW9zW3F1ZXVlXS5pZGxl
c2xvcGUgKiBSVEFTRV8xVF9DTE9DSzsNCj4gPiArICAgICB1MzIgcmVnViA9IDA7DQo+ID4gKw0K
PiA+ICsgICAgIHJlZ1YgPSBpZGxlIC8gUlRBU0VfMVRfUE9XRVI7DQo+ID4gKyAgICAgcmVnViA8
PD0gUlRBU0VfSURMRVNMT1BFX0lOVF9TSElGVDsNCj4gPiArICAgICBpZGxlICU9IFJUQVNFXzFU
X1BPV0VSOw0KPiA+ICsgICAgIGZvciAoaSA9IDA7IGkgPCBSVEFTRV9JRExFU0xPUEVfSU5UX1NI
SUZUOyBpKyspIHsNCj4gPiArICAgICAgICAgICAgIGlkbGUgKj0gMnU7DQo+ID4gKyAgICAgICAg
ICAgICBpZiAoKGlkbGUgLyBSVEFTRV8xVF9QT1dFUikgPT0gMXUpDQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgIHJlZ1YgfD0gKCh1MzIpMHgxdSA8PA0KPiAoUlRBU0VfSURMRVNMT1BFX0lOVF9T
SElGVCAtIGkgLSAxdSkpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIGlkbGUgJT0gUlRBU0Vf
MVRfUE9XRVI7DQo+ID4gKyAgICAgfQ0KPiA+ICsgICAgIFJUTF9XMzIoKFRYUUNSRFRfMCArIChx
dWV1ZSAqIDR1KSksIHJlZ1YpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IHJ0YXNl
X3NldHVwX3RjX2NicyhzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAsIGNvbnN0IHN0cnVjdA0KPiB0
Y19jYnNfcW9wdF9vZmZsb2FkICpxb3B0KQ0KPiA+ICt7DQo+ID4gKyAgICAgdTMyIHF1ZXVlID0g
KHUzMilxb3B0LT5xdWV1ZTsNCj4gPiArDQo+ID4gKyAgICAgLyogcmVjb3JkIHNldHRpbmdzICov
DQo+ID4gKyAgICAgdHAtPnR4X3Fvc1txdWV1ZV0uaGljcmVkaXQgPSBxb3B0LT5oaWNyZWRpdDsN
Cj4gPiArICAgICB0cC0+dHhfcW9zW3F1ZXVlXS5sb2NyZWRpdCA9IHFvcHQtPmxvY3JlZGl0Ow0K
PiA+ICsgICAgIHRwLT50eF9xb3NbcXVldWVdLmlkbGVzbG9wZSA9IHFvcHQtPmlkbGVzbG9wZTsN
Cj4gPiArICAgICB0cC0+dHhfcW9zW3F1ZXVlXS5zZW5kc2xvcGUgPSBxb3B0LT5zZW5kc2xvcGU7
DQo+ID4gKw0KPiA+ICsgICAgIC8qIHNldCBoYXJkd2FyZSBjYnMgKi8NCj4gPiArICAgICBydGFz
ZV9zZXRfaHdfY2JzKHRwLCBxdWV1ZSk7DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiAwOw0KPiA+
ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IHJ0YXNlX3NldHVwX3RjKHN0cnVjdCBuZXRfZGV2
aWNlICpkZXYsIGVudW0gdGNfc2V0dXBfdHlwZSB0eXBlLA0KPiB2b2lkICp0eXBlX2RhdGEpDQo+
ID4gK3sNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZfcHJpdihk
ZXYpOw0KPiA+ICsgICAgIGludCByZXQgPSAwOw0KPiA+ICsNCj4gPiArICAgICBzd2l0Y2ggKHR5
cGUpIHsNCj4gPiArICAgICBjYXNlIFRDX1NFVFVQX1FESVNDX01RUFJJTzoNCj4gPiArICAgICAg
ICAgICAgIGJyZWFrOw0KPiA+ICsgICAgIGNhc2UgVENfU0VUVVBfQkxPQ0s6DQo+ID4gKyAgICAg
ICAgICAgICBicmVhazsNCj4gPiArICAgICBjYXNlIFRDX1NFVFVQX1FESVNDX0NCUzoNCj4gPiAr
ICAgICAgICAgICAgIHJldCA9IHJ0YXNlX3NldHVwX3RjX2Nicyh0cCwgdHlwZV9kYXRhKTsNCj4g
PiArICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsgICAgIGRlZmF1bHQ6DQo+ID4gKyAgICAgICAg
ICAgICByZXQgPSAtRU9QTk9UU1VQUDsNCj4gPiArICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsg
ICAgIH0NCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIHJldDsNCj4gPiArfQ0KPiA+ICsNCj4gPiAr
I2lmZGVmIENPTkZJR19QTQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBydGFzZV9zdXNwZW5kKHN0
cnVjdCBwY2lfZGV2ICpwZGV2LCBwbV9tZXNzYWdlX3Qgc3RhdGUpDQo+ID4gK3sNCj4gPiArICAg
ICBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOw0KPiA+ICsg
ICAgIHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAg
ICAgdW5zaWduZWQgbG9uZyBmbGFnczsNCj4gPiArDQo+ID4gKyAgICAgKHZvaWQpc3RhdGU7DQo+
ID4gKw0KPiA+ICsgICAgIGlmICghbmV0aWZfcnVubmluZyhkZXYpKQ0KPiA+ICsgICAgICAgICAg
ICAgZ290byBvdXQ7DQo+ID4gKw0KPiA+ICsgICAgIG5ldGlmX3N0b3BfcXVldWUoZGV2KTsNCj4g
PiArDQo+ID4gKyAgICAgbmV0aWZfY2Fycmllcl9vZmYoZGV2KTsNCj4gPiArDQo+ID4gKyAgICAg
bmV0aWZfZGV2aWNlX2RldGFjaChkZXYpOw0KPiA+ICsNCj4gPiArICAgICBzcGluX2xvY2tfaXJx
c2F2ZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKCh0cC0+c3dfZmxh
ZyAmIFNXRl9TUklPVl9FTkFCTEVEKSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAgcnRhc2Vf
aXJxX21hc2tfYW5kX2Fjayh0cCk7DQo+ID4gKyAgICAgICAgICAgICBydGFzZV9mdW5jX2Rpc2Fi
bGUodHApOw0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICBydGFzZV9od19y
ZXNldChkZXYpOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgc3Bpbl91bmxvY2tfaXJx
cmVzdG9yZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiArDQo+ID4gK291dDoNCj4gPiArICAgICBw
Y2lfc2F2ZV9zdGF0ZShwZGV2KTsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIDA7DQo+ID4gK30N
Cj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgcnRhc2VfcmVzdW1lKHN0cnVjdCBwY2lfZGV2ICpwZGV2
KQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IG5ldF9kZXZpY2UgKmRldiA9IHBjaV9nZXRfZHJ2
ZGF0YShwZGV2KTsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBuZXRkZXZf
cHJpdihkZXYpOw0KPiA+ICsNCj4gPiArICAgICBwY2lfc2V0X3Bvd2VyX3N0YXRlKHBkZXYsIFBD
SV9EMCk7DQo+ID4gKyAgICAgcGNpX3Jlc3RvcmVfc3RhdGUocGRldik7DQo+ID4gKyAgICAgcGNp
X2VuYWJsZV93YWtlKHBkZXYsIFBDSV9EMCwgMCk7DQo+ID4gKw0KPiA+ICsgICAgIC8qIHJlc3Rv
cmUgbGFzdCBtb2RpZmllZCBtYWMgYWRkcmVzcyAqLw0KPiA+ICsgICAgIHJ0YXNlX3Jhcl9zZXQo
dHAsIGRldi0+ZGV2X2FkZHIpOw0KPiA+ICsNCj4gPiArICAgICBpZiAoIW5ldGlmX3J1bm5pbmco
ZGV2KSkNCj4gPiArICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsNCj4gPiArICAgICBydGFz
ZV93YWl0X2Zvcl9xdWllc2NlbmNlKGRldik7DQo+ID4gKyAgICAgbmV0aWZfZGV2aWNlX2F0dGFj
aChkZXYpOw0KPiA+ICsNCj4gPiArICAgICBydGFzZV90eF9jbGVhcih0cCk7DQo+ID4gKyAgICAg
cnRhc2VfcnhfY2xlYXIodHApOw0KPiA+ICsNCj4gPiArICAgICBpZiAocnRhc2VfaW5pdF9yaW5n
KGRldikgIT0gMCkNCj4gPiArICAgICAgICAgICAgIG5ldGRldl9hbGVydChkZXYsICJ1bmFibGUg
dG8gaW5pdCByaW5nXG4iKTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKCh0cC0+c3dfZmxhZyAmIFNX
Rl9TUklPVl9FTkFCTEVEKSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAgcnRhc2VfZnVuY19l
bmFibGUodHApOw0KPiA+ICsgICAgICAgICAgICAgcnRhc2VfZW5hYmxlX2h3X2ludGVycnVwdCh0
cCk7DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIHJ0YXNlX2h3X2NvbmZp
ZyhkZXYpOw0KPiA+ICsgICAgICAgICAgICAgLyogYWx3YXlzIGxpbmssIHNvIHN0YXJ0IHRvIHRy
YW5zbWl0ICYgcmVjZWl2ZSAqLw0KPiA+ICsgICAgICAgICAgICAgcnRhc2VfaHdfc3RhcnQoZGV2
KTsNCj4gPiArICAgICB9DQo+ID4gKyAgICAgbmV0aWZfY2Fycmllcl9vbihkZXYpOw0KPiA+ICsg
ICAgIG5ldGlmX3dha2VfcXVldWUoZGV2KTsNCj4gPiArDQo+ID4gK291dDoNCj4gPiArICAgICBy
ZXR1cm4gMDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArI2VuZGlmIC8qIENPTkZJR19QTSAqLw0KPiA+
ICsNCj4gPiArc3RhdGljIHN0cnVjdCBwY2lfZHJpdmVyIHJ0YXNlX3BjaV9kcml2ZXIgPSB7DQo+
ID4gKyAgICAgLm5hbWUgPSBNT0RVTEVOQU1FLA0KPiA+ICsgICAgIC5pZF90YWJsZSA9IHJ0YXNl
X3BjaV90YmwsDQo+ID4gKyAgICAgLnByb2JlID0gcnRhc2VfaW5pdF9vbmUsDQo+ID4gKyAgICAg
LnJlbW92ZSA9IHJ0YXNlX3JlbW92ZV9vbmUsDQo+ID4gKyAgICAgLnNodXRkb3duID0gcnRhc2Vf
c2h1dGRvd24sDQo+ID4gKyNpZmRlZiBDT05GSUdfUE0NCj4gPiArICAgICAuc3VzcGVuZCA9IHJ0
YXNlX3N1c3BlbmQsDQo+ID4gKyAgICAgLnJlc3VtZSA9IHJ0YXNlX3Jlc3VtZSwNCj4gPiArI2Vu
ZGlmDQo+ID4gKyNpZmRlZiBDT05GSUdfU1JJT1YNCj4gPiArICAgICAuc3Jpb3ZfY29uZmlndXJl
ID0gcnRhc2VfcGNpX3NyaW92X2NvbmZpZ3VyZSwNCj4gPiArI2VuZGlmDQo+ID4gK307DQo+ID4g
Kw0KPiA+ICsvKiAgcnRhc2Ugc3dpdGNoIGNvbnRyb2wgZnVuY3Rpb24NCj4gPiArICovDQo+IA0K
PiBQbGVhc2UgdXNlIHN0YW5kYXJkIGtlcm5lbCBtZWFucyBpbnN0ZWFkIG9mIHByb3ByaWV0YXJ5
IGludGVyZmFjZXMuDQo+IA0KPiA+ICsjZGVmaW5lIFNXQ19EUklWRVJfTkFNRSAgInJ0YXNlX3N3
YyINCj4gPiArI2RlZmluZSBTV0NfRFJJVkVSX01BSk9SIDIwMA0KPiA+ICsjZGVmaW5lIFNXQ19D
TURfUkVHX0dFVCAgNzANCj4gPiArI2RlZmluZSBTV0NfQ01EX1JFR19TRVQgIDcxDQo+ID4gKyNk
ZWZpbmUgU1dDX0NNRF9UWVBFXzggICAwDQo+ID4gKyNkZWZpbmUgU1dDX0NNRF9UWVBFXzE2ICAx
DQo+ID4gKyNkZWZpbmUgU1dDX0NNRF9UWVBFXzMyICAyDQo+ID4gKyNkZWZpbmUgU1dDX1BBR0Vf
QUREUiAgICAweDgwMDANCj4gPiArI2RlZmluZSBTV0NfUEFHRV9NQVNLICAgIDB4RkZGRjgwMDB1
DQo+ID4gKyNkZWZpbmUgU1dDX0FERFJfTUFTSyAgICAweDAwMDA3RkZGdQ0KPiA+ICsNCj4gPiAr
I2lmZGVmIFNXQ19EUklWRVJfREJHDQo+ID4gKyNkZWZpbmUgU1dDX0RSSVZFUl9JTkZPKGZtdCwg
YXJnLi4uKSBwcl9pbmZvKCIlczolZCAiIGZtdCwgX19mdW5jX18sDQo+IF9fTElORV9fLCAjI2Fy
ZykNCj4gPiArI2Vsc2UNCj4gPiArI2RlZmluZSBTV0NfRFJJVkVSX0lORk8oZm10LCBhcmcuLi4p
DQo+ID4gKyNlbmRpZg0KPiA+ICsNCj4gPiArc3RydWN0IHJ0YXNlX3N3Y19jbWRfdCB7DQo+ID4g
KyAgICAgdTggdHlwZTsNCj4gPiArICAgICB1MzIgcmVnX2FkZHI7DQo+ID4gKyAgICAgdTMyIHJl
Z192YWx1ZTsNCj4gPiArfTsNCj4gPiArDQo+ID4gK3N0cnVjdCBydGFzZV9zd2NfZGV2X3Qgew0K
PiA+ICsgICAgIHN0cnVjdCBjZGV2IHN3Y19jZGV2Ow0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAq
c3djX2lvYWRkcjsNCj4gPiArICAgICB1MTYgaW5pdF9mbGFnOw0KPiA+ICt9Ow0KPiA+ICsNCj4g
PiArc3RhdGljIHN0cnVjdCBydGFzZV9zd2NfZGV2X3QgcnRhc2Vfc3djX2RldmljZTsNCj4gPiAr
c3RhdGljIHN0cnVjdCBwY2lfZGV2aWNlX2lkIHJ0YXNlX3N3Y19wY2lfdGFibGVbXSA9IHsNCj4g
PiArICAgICB7DQo+ID4gKyAgICAgICAgICAgICBQQ0lfREVWSUNFKFBDSV9WRU5ET1JfSURfUkVB
TFRFSywgMHg5MDZGKSwNCj4gPiArICAgICB9LA0KPiA+ICsgICAgIHsNCj4gPiArICAgICAgICAg
ICAgIDAsDQo+ID4gKyAgICAgfSwNCj4gPiArfTsNCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgcnRh
c2Vfc3djX29wZW4oc3RydWN0IGlub2RlICpwX2lub2RlLCBzdHJ1Y3QgZmlsZSAqcF9maWxlKQ0K
PiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX3N3Y19kZXZfdCAqc3djX2RldiA9DQo+ID4g
KyAgICAgICAgICAgICBjb250YWluZXJfb2YocF9pbm9kZS0+aV9jZGV2LCBzdHJ1Y3QgcnRhc2Vf
c3djX2Rldl90LA0KPiBzd2NfY2Rldik7DQo+ID4gKw0KPiA+ICsgICAgIHBfZmlsZS0+cHJpdmF0
ZV9kYXRhID0gc3djX2RldjsNCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIDA7DQo+ID4gK30NCj4g
PiArDQo+ID4gK3N0YXRpYyBpbnQgcnRhc2Vfc3djX3JlbGVhc2Uoc3RydWN0IGlub2RlICpwX2lu
b2RlLCBzdHJ1Y3QgZmlsZSAqcF9maWxlKQ0KPiA+ICt7DQo+ID4gKyAgICAgKHZvaWQpcF9pbm9k
ZTsNCj4gPiArICAgICAodm9pZClwX2ZpbGU7DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiAwOw0K
PiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9zd2NfZ2V0X2Zyb21fcHRtKHN0
cnVjdCBydGFzZV9wdG1fY21kX3QgKmNtZCkNCj4gPiArew0KPiA+ICsgICAgIGNvbnN0IHZvaWQg
X19pb21lbSAqaW9hZGRyID0gcnRhc2Vfc3djX2RldmljZS5zd2NfaW9hZGRyOw0KPiA+ICsgICAg
IHUzMiBhZGRyID0gY21kLT5yZWdfYWRkciAmICh1MzIpU1dDX0FERFJfTUFTSzsNCj4gPiArDQo+
ID4gKyAgICAgY21kLT5yZWdfdmFsdWUgPSBSVExfUjMyKGFkZHIpOw0KPiA+ICt9DQo+ID4gKw0K
PiA+ICtzdGF0aWMgczMyIHJ0YXNlX3B0bV9nZXRfY2xvY2soY29uc3Qgc3RydWN0IGlmcmVxICpp
ZnIsIGNvbnN0IHN0cnVjdA0KPiBydGFzZV9wcml2YXRlICp0cCkNCj4gPiArew0KPiA+ICsgICAg
IHZvaWQgX19pb21lbSAqaW9hZGRyID0gcnRhc2Vfc3djX2RldmljZS5zd2NfaW9hZGRyOw0KPiA+
ICsgICAgIHZvaWQgKnVzZXJhZGRyID0gKHZvaWQgKilpZnItPmlmcl9kYXRhOw0KPiA+ICsgICAg
IHN0cnVjdCBydGFzZV9wdG1fY21kX3QgY21kOw0KPiA+ICsgICAgIHMzMiBpOw0KPiA+ICsgICAg
IHUzMiBwYWdlX2FkZHI7DQo+ID4gKyAgICAgdTY0IHRtcCA9IDA7DQo+ID4gKyAgICAgczMyIHJl
dCA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIG1lbXNldCgmY21kLCAwLCBzaXplb2Yoc3RydWN0IHJ0
YXNlX3B0bV9jbWRfdCkpOw0KPiA+ICsNCj4gPiArICAgICBpZiAoY29weV9mcm9tX3VzZXIoJmNt
ZCwgdXNlcmFkZHIsIHNpemVvZihzdHJ1Y3QNCj4gcnRhc2VfcHRtX2NtZF90KSkgIT0gMHUpIHsN
Cj4gPiArICAgICAgICAgICAgIHJldCA9IC1FRkFVTFQ7DQo+ID4gKyAgICAgICAgICAgICBnb3Rv
IG91dDsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHBhZ2VfYWRkciA9IGNtZC5yZWdf
YWRkciAmIFNXQ19QQUdFX01BU0s7DQo+ID4gKyAgICAgUlRMX1czMihTV0NfUEFHRV9BRERSLCBw
YWdlX2FkZHIpOw0KPiA+ICsNCj4gPiArICAgICBjbWQucHRwX3NlY29uZCA9IDA7DQo+ID4gKyAg
ICAgY21kLnB0cF9uYW5vX3NlY29uZCA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIGZvciAoaSA9IDA7
IGkgPCAzOyBpKyspIHsNCj4gPiArICAgICAgICAgICAgIHJ0YXNlX3N3Y19nZXRfZnJvbV9wdG0o
JmNtZCk7DQo+ID4gKyAgICAgICAgICAgICBjbWQucmVnX2FkZHIgKz0gNHU7DQo+ID4gKyAgICAg
ICAgICAgICBpZiAoaSA9PSAwKSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGNtZC5wdHBf
bmFub19zZWNvbmQgPSBjbWQucmVnX3ZhbHVlOw0KPiA+ICsgICAgICAgICAgICAgfSBlbHNlIHsN
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgdG1wID0gKCh1NjQpY21kLnJlZ192YWx1ZSA8PCAo
MzJ1ICogKCh1NjQpaSAtDQo+IDF1KSkpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBjbWQu
cHRwX3NlY29uZCArPSB0bXA7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+
ICsNCj4gPiArICAgICBpb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIGNtZC5wdG1f
dGltZSA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIGZvciAoaSA9IDE7IGkgPCAzOyBpKyspIHsNCj4g
PiArICAgICAgICAgICAgIGNtZC5wdG1fdGltZSArPSAoKHU2NClSVExfUjMyKGNtZC5wdG1fYWRk
cikgPDwgKDMydSAqDQo+ICgodTY0KWkgLSAxdSkpKTsNCj4gPiArICAgICAgICAgICAgIGNtZC5w
dG1fYWRkciArPSA0dTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X3Rv
X3VzZXIodXNlcmFkZHIsICZjbWQsIHNpemVvZihzdHJ1Y3QgcnRhc2VfcHRtX2NtZF90KSkgIT0N
Cj4gMHUpDQo+ID4gKyAgICAgICAgICAgICByZXQgPSAtRUZBVUxUOw0KPiA+ICsNCj4gPiArb3V0
Og0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBzMzIg
cnRhc2VfcHRtX3N3Y19nZXQoY29uc3Qgc3RydWN0IGlmcmVxICppZnIsIGNvbnN0IHN0cnVjdA0K
PiBydGFzZV9wcml2YXRlICp0cCkNCj4gPiArew0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9h
ZGRyID0gcnRhc2Vfc3djX2RldmljZS5zd2NfaW9hZGRyOw0KPiA+ICsgICAgIHZvaWQgKnVzZXJh
ZGRyID0gKHZvaWQgKilpZnItPmlmcl9kYXRhOw0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9wdG1f
Y21kX3QgY21kOw0KPiA+ICsgICAgIHUzMiBwYWdlX2FkZHI7DQo+ID4gKyAgICAgczMyIHJldCA9
IDA7DQo+ID4gKw0KPiA+ICsgICAgICh2b2lkKXRwOw0KPiA+ICsNCj4gPiArICAgICBpZiAoY29w
eV9mcm9tX3VzZXIoJmNtZCwgdXNlcmFkZHIsIHNpemVvZihzdHJ1Y3QNCj4gcnRhc2VfcHRtX2Nt
ZF90KSkgIT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgIHJldCA9IC1FRkFVTFQ7DQo+ID4gKyAg
ICAgICAgICAgICBnb3RvIG91dDsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHBhZ2Vf
YWRkciA9IGNtZC5yZWdfYWRkciAmIFNXQ19QQUdFX01BU0s7DQo+ID4gKyAgICAgUlRMX1czMihT
V0NfUEFHRV9BRERSLCBwYWdlX2FkZHIpOw0KPiA+ICsgICAgIHJ0YXNlX3N3Y19nZXRfZnJvbV9w
dG0oJmNtZCk7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X3RvX3VzZXIodXNlcmFkZHIsICZj
bWQsIHNpemVvZihzdHJ1Y3QgcnRhc2VfcHRtX2NtZF90KSkgIT0NCj4gMHUpIHsNCj4gPiArICAg
ICAgICAgICAgIHJldCA9IC1FRkFVTFQ7DQo+ID4gKyAgICAgICAgICAgICBnb3RvIG91dDsNCj4g
PiArICAgICB9DQo+ID4gKw0KPiA+ICtvdXQ6DQo+ID4gKyAgICAgcmV0dXJuIHJldDsNCj4gPiAr
fQ0KPiA+ICsNCj4gPiArc3RhdGljIHMzMiBydGFzZV9wdG1fc3djX3NldChjb25zdCBzdHJ1Y3Qg
aWZyZXEgKmlmciwgY29uc3Qgc3RydWN0DQo+IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7DQo+
ID4gKyAgICAgdm9pZCBfX2lvbWVtICppb2FkZHIgPSBydGFzZV9zd2NfZGV2aWNlLnN3Y19pb2Fk
ZHI7DQo+ID4gKyAgICAgY29uc3Qgdm9pZCAqdXNlcmFkZHIgPSAodm9pZCAqKWlmci0+aWZyX2Rh
dGE7DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX3B0bV9jbWRfdCBjbWQ7DQo+ID4gKyAgICAgdTMy
IHBhZ2VfYWRkcjsNCj4gPiArICAgICB1MzIgYWRkcjsNCj4gPiArICAgICBzMzIgcmV0ID0gMDsN
Cj4gPiArDQo+ID4gKyAgICAgKHZvaWQpdHA7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChjb3B5X2Zy
b21fdXNlcigmY21kLCB1c2VyYWRkciwgc2l6ZW9mKHN0cnVjdA0KPiBydGFzZV9wdG1fY21kX3Qp
KSAhPSAwdSkgew0KPiA+ICsgICAgICAgICAgICAgcmV0ID0gLUVGQVVMVDsNCj4gPiArICAgICB9
IGVsc2Ugew0KPiA+ICsgICAgICAgICAgICAgcGFnZV9hZGRyID0gY21kLnJlZ19hZGRyICYgU1dD
X1BBR0VfTUFTSzsNCj4gPiArICAgICAgICAgICAgIGFkZHIgPSBjbWQucmVnX2FkZHIgJiBTV0Nf
QUREUl9NQVNLOw0KPiA+ICsgICAgICAgICAgICAgUlRMX1czMihTV0NfUEFHRV9BRERSLCBwYWdl
X2FkZHIpOw0KPiA+ICsgICAgICAgICAgICAgUlRMX1czMihhZGRyLCBjbWQucmVnX3ZhbHVlKTsN
Cj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiAr
DQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX3N3Y19yZWdfZ2V0KHN0cnVjdCBydGFzZV9zd2NfY21k
X3QgKmNtZCkNCj4gPiArew0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gcnRhc2Vf
c3djX2RldmljZS5zd2NfaW9hZGRyOw0KPiA+ICsgICAgIHUzMiBwYWdlX2FkZHIgPSBjbWQtPnJl
Z19hZGRyICYgU1dDX1BBR0VfTUFTSzsNCj4gPiArICAgICB1MzIgYWRkciA9IGNtZC0+cmVnX2Fk
ZHIgJiBTV0NfQUREUl9NQVNLOw0KPiA+ICsNCj4gPiArICAgICBSVExfVzMyKFNXQ19QQUdFX0FE
RFIsIHBhZ2VfYWRkcik7DQo+ID4gKyAgICAgc3dpdGNoIChjbWQtPnR5cGUpIHsNCj4gPiArICAg
ICBjYXNlIFNXQ19DTURfVFlQRV84Og0KPiA+ICsgICAgICAgICAgICAgY21kLT5yZWdfdmFsdWUg
PSBSVExfUjgoYWRkcik7DQo+ID4gKyAgICAgICAgICAgICBicmVhazsNCj4gPiArICAgICBjYXNl
IFNXQ19DTURfVFlQRV8xNjoNCj4gPiArICAgICAgICAgICAgIGNtZC0+cmVnX3ZhbHVlID0gUlRM
X1IxNihhZGRyKTsNCj4gPiArICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsgICAgIGNhc2UgU1dD
X0NNRF9UWVBFXzMyOg0KPiA+ICsgICAgIGRlZmF1bHQ6DQo+ID4gKyAgICAgICAgICAgICBjbWQt
PnJlZ192YWx1ZSA9IFJUTF9SMzIoYWRkcik7DQo+ID4gKyAgICAgICAgICAgICBicmVhazsNCj4g
PiArICAgICB9DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX3N3Y19yZWdf
c2V0KGNvbnN0IHN0cnVjdCBydGFzZV9zd2NfY21kX3QgKmNtZCkNCj4gPiArew0KPiA+ICsgICAg
IHZvaWQgX19pb21lbSAqaW9hZGRyID0gcnRhc2Vfc3djX2RldmljZS5zd2NfaW9hZGRyOw0KPiA+
ICsgICAgIHUzMiBwYWdlX2FkZHIgPSBjbWQtPnJlZ19hZGRyICYgU1dDX1BBR0VfTUFTSzsNCj4g
PiArICAgICB1MzIgYWRkciA9IGNtZC0+cmVnX2FkZHIgJiBTV0NfQUREUl9NQVNLOw0KPiA+ICsN
Cj4gPiArICAgICBSVExfVzMyKFNXQ19QQUdFX0FERFIsIHBhZ2VfYWRkcik7DQo+ID4gKyAgICAg
c3dpdGNoIChjbWQtPnR5cGUpIHsNCj4gPiArICAgICBjYXNlIFNXQ19DTURfVFlQRV84Og0KPiA+
ICsgICAgICAgICAgICAgUlRMX1c4KGFkZHIsICh1OCljbWQtPnJlZ192YWx1ZSk7DQo+ID4gKyAg
ICAgICAgICAgICBicmVhazsNCj4gPiArICAgICBjYXNlIFNXQ19DTURfVFlQRV8xNjoNCj4gPiAr
ICAgICAgICAgICAgIFJUTF9XMTYoYWRkciwgKHUxNiljbWQtPnJlZ192YWx1ZSk7DQo+ID4gKyAg
ICAgICAgICAgICBicmVhazsNCj4gPiArICAgICBjYXNlIFNXQ19DTURfVFlQRV8zMjoNCj4gPiAr
ICAgICBkZWZhdWx0Og0KPiA+ICsgICAgICAgICAgICAgUlRMX1czMihhZGRyLCBjbWQtPnJlZ192
YWx1ZSk7DQo+ID4gKyAgICAgICAgICAgICBicmVhazsNCj4gPiArICAgICB9DQo+ID4gK30NCj4g
PiArDQo+ID4gK3N0YXRpYyBsb25nIHJ0YXNlX3N3Y19pb2N0bChzdHJ1Y3QgZmlsZSAqcF9maWxl
LCB1bnNpZ25lZCBpbnQgY21kLCB1bnNpZ25lZA0KPiBsb25nIGFyZykNCj4gPiArew0KPiA+ICsg
ICAgIGxvbmcgcmMgPSAwOw0KPiA+ICsgICAgIHN0cnVjdCBydGFzZV9zd2NfY21kX3Qgc3dfY21k
Ow0KPiA+ICsNCj4gPiArICAgICAodm9pZClwX2ZpbGU7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChy
dGFzZV9zd2NfZGV2aWNlLmluaXRfZmxhZyA9PSAxdSkgew0KPiA+ICsgICAgICAgICAgICAgcmMg
PSAtRU5YSU87DQo+ID4gKyAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiArICAgICB9DQo+ID4g
Kw0KPiA+ICsgICAgIHJjID0gKHM2NCkoY29weV9mcm9tX3VzZXIoJnN3X2NtZCwgKHZvaWQgKilh
cmcsIHNpemVvZihzdHJ1Y3QNCj4gcnRhc2Vfc3djX2NtZF90KSkpOw0KPiA+ICsNCj4gPiArICAg
ICBpZiAocmMgIT0gMCkgew0KPiA+ICsgICAgICAgICAgICAgU1dDX0RSSVZFUl9JTkZPKCJydGFz
ZV9zd2MgY29weV9mcm9tX3VzZXIgZmFpbGVkLiIpOw0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4g
KyAgICAgICAgICAgICBzd2l0Y2ggKGNtZCkgew0KPiA+ICsgICAgICAgICAgICAgY2FzZSBTV0Nf
Q01EX1JFR19HRVQ6DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJ0YXNlX3N3Y19yZWdfZ2V0
KCZzd19jbWQpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICByYyA9IChzNjQpKGNvcHlfdG9f
dXNlcigodm9pZCAqKWFyZywgJnN3X2NtZCwNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2l6ZW9mKHN0cnVjdA0KPiBydGFzZV9zd2NfY21kX3QpKSk7
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsNCj4gPiArICAgICAgICAg
ICAgIGNhc2UgU1dDX0NNRF9SRUdfU0VUOg0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBydGFz
ZV9zd2NfcmVnX3NldCgmc3dfY21kKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgcmMgPSAo
czY0KShjb3B5X3RvX3VzZXIoKHZvaWQgKilhcmcsICZzd19jbWQsDQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZihzdHJ1Y3QNCj4gcnRhc2Vf
c3djX2NtZF90KSkpOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiArDQo+
ID4gKyAgICAgICAgICAgICBkZWZhdWx0Og0KPiA+ICsgICAgICAgICAgICAgICAgICAgICByYyA9
IC1FTk9UVFk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICsgICAgICAg
ICAgICAgfQ0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gK291dDoNCj4gPiArICAgICByZXR1cm4g
cmM7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRp
b25zIHJ0YXNlX3N3Y19mb3BzID0gew0KPiA+ICsgICAgIC5vd25lciA9IFRISVNfTU9EVUxFLA0K
PiA+ICsgICAgIC5vcGVuID0gcnRhc2Vfc3djX29wZW4sDQo+ID4gKyAgICAgLnJlbGVhc2UgPSBy
dGFzZV9zd2NfcmVsZWFzZSwNCj4gPiArICAgICAudW5sb2NrZWRfaW9jdGwgPSBydGFzZV9zd2Nf
aW9jdGwsDQo+ID4gK307DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IHJ0YXNlX3N3Y19pbml0X29u
ZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgY29uc3Qgc3RydWN0DQo+IHBjaV9kZXZpY2VfaWQgKmVu
dCkNCj4gPiArew0KPiA+ICsgICAgIGludCByYzsNCj4gPiArICAgICB2b2lkIF9faW9tZW0gKmlv
YWRkciA9IE5VTEw7DQo+ID4gKyAgICAgZGV2X3QgZGV2bm8gPSBNS0RFVihTV0NfRFJJVkVSX01B
Sk9SLCAwKTsNCj4gPiArDQo+ID4gKyAgICAgKHZvaWQpZW50Ow0KPiA+ICsNCj4gPiArICAgICBy
dGFzZV9zd2NfZGV2aWNlLmluaXRfZmxhZyA9IDE7DQo+ID4gKyAgICAgcmMgPSBwY2lfZW5hYmxl
X2RldmljZShwZGV2KTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHJjICE9IDApDQo+ID4gKyAgICAg
ICAgICAgICBTV0NfRFJJVkVSX0lORk8oInJ0YXNlX3N3YyBlbmFibGUgZGV2aWNlIGZhaWxlZC4i
KTsNCj4gPiArICAgICBlbHNlDQo+ID4gKyAgICAgICAgICAgICByYyA9IHBjaV9yZXF1ZXN0X3Jl
Z2lvbnMocGRldiwgU1dDX0RSSVZFUl9OQU1FKTsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHJjID09
IDApIHsNCj4gPiArICAgICAgICAgICAgIHJjID0gZG1hX3NldF9tYXNrX2FuZF9jb2hlcmVudCgm
cGRldi0+ZGV2LA0KPiBETUFfQklUX01BU0soNjQpKTsNCj4gPiArICAgICAgICAgICAgIGlmIChy
YyAhPSAwKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICByYyA9IGRtYV9zZXRfbWFza19hbmRf
Y29oZXJlbnQoJnBkZXYtPmRldiwNCj4gRE1BX0JJVF9NQVNLKDMyKSk7DQo+ID4gKyAgICAgfQ0K
PiA+ICsNCj4gPiArICAgICBpZiAocmMgIT0gMCkgew0KPiA+ICsgICAgICAgICAgICAgU1dDX0RS
SVZFUl9JTkZPKCJydGFzZV9zd2MgcmVxdWVzdCByZWdpb25zIGZhaWxlZC4iKTsNCj4gPiArICAg
ICAgICAgICAgIHBjaV9kaXNhYmxlX2RldmljZShwZGV2KTsNCj4gPiArICAgICB9IGVsc2Ugew0K
PiA+ICsgICAgICAgICAgICAgcGNpX3NldF9tYXN0ZXIocGRldik7DQo+ID4gKyAgICAgICAgICAg
ICBpb2FkZHIgPSBpb3JlbWFwKHBjaV9yZXNvdXJjZV9zdGFydChwZGV2LCAwKSwNCj4gcGNpX3Jl
c291cmNlX2xlbihwZGV2LCAwKSk7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBpZiAo
IWlvYWRkcikgew0KPiA+ICsgICAgICAgICAgICAgU1dDX0RSSVZFUl9JTkZPKCJydGFzZV9zd2Mg
aW9yZW1hcCBmYWlsZWQuIik7DQo+ID4gKyAgICAgICAgICAgICBwY2lfcmVsZWFzZV9yZWdpb25z
KHBkZXYpOw0KPiA+ICsgICAgICAgICAgICAgcGNpX2Rpc2FibGVfZGV2aWNlKHBkZXYpOw0KPiA+
ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICByYyA9IHJlZ2lzdGVyX2NocmRldl9y
ZWdpb24oZGV2bm8sIDEsDQo+IFNXQ19EUklWRVJfTkFNRSk7DQo+ID4gKyAgICAgfQ0KPiA+ICsN
Cj4gPiArICAgICBpZiAocmMgIT0gMCkgew0KPiA+ICsgICAgICAgICAgICAgU1dDX0RSSVZFUl9J
TkZPKCJydGFzZV9zd2MgcmVnaXN0ZXIgY2hhcmFjdGVyIGRldmljZQ0KPiBmYWlsZWQuIik7DQo+
ID4gKyAgICAgICAgICAgICBpb3VubWFwKGlvYWRkcik7DQo+ID4gKyAgICAgICAgICAgICBwY2lf
cmVsZWFzZV9yZWdpb25zKHBkZXYpOw0KPiA+ICsgICAgICAgICAgICAgcGNpX2Rpc2FibGVfZGV2
aWNlKHBkZXYpOw0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICBydGFzZV9z
d2NfZGV2aWNlLnN3Y19pb2FkZHIgPSBpb2FkZHI7DQo+ID4gKyAgICAgICAgICAgICBjZGV2X2lu
aXQoJnJ0YXNlX3N3Y19kZXZpY2Uuc3djX2NkZXYsICZydGFzZV9zd2NfZm9wcyk7DQo+ID4gKyAg
ICAgICAgICAgICBydGFzZV9zd2NfZGV2aWNlLnN3Y19jZGV2Lm93bmVyID0gVEhJU19NT0RVTEU7
DQo+ID4gKyAgICAgICAgICAgICBjZGV2X2FkZCgmcnRhc2Vfc3djX2RldmljZS5zd2NfY2Rldiwg
ZGV2bm8sIDEpOw0KPiA+ICsgICAgICAgICAgICAgcnRhc2Vfc3djX2RldmljZS5pbml0X2ZsYWcg
PSAwOw0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgcmV0dXJuIHJjOw0KPiA+ICt9DQo+
ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBydGFzZV9zd2NfcmVtb3ZlX29uZShzdHJ1Y3QgcGNpX2Rl
diAqcGRldikNCj4gPiArew0KPiA+ICsgICAgIGlvdW5tYXAocnRhc2Vfc3djX2RldmljZS5zd2Nf
aW9hZGRyKTsNCj4gPiArICAgICBwY2lfcmVsZWFzZV9yZWdpb25zKHBkZXYpOw0KPiA+ICsgICAg
IHBjaV9kaXNhYmxlX2RldmljZShwZGV2KTsNCj4gPiArICAgICBjZGV2X2RlbCgmcnRhc2Vfc3dj
X2RldmljZS5zd2NfY2Rldik7DQo+ID4gKyAgICAgdW5yZWdpc3Rlcl9jaHJkZXZfcmVnaW9uKE1L
REVWKFNXQ19EUklWRVJfTUFKT1IsIDApLCAxKTsNCj4gPiArICAgICBydGFzZV9zd2NfZGV2aWNl
LmluaXRfZmxhZyA9IDE7DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBzdHJ1Y3QgcGNpX2Ry
aXZlciBydGFzZV9zd2NfcGNpX2RyaXZlciA9IHsNCj4gPiArICAgICAubmFtZSA9IFNXQ19EUklW
RVJfTkFNRSwNCj4gPiArICAgICAuaWRfdGFibGUgPSBydGFzZV9zd2NfcGNpX3RhYmxlLA0KPiA+
ICsgICAgIC5wcm9iZSA9IHJ0YXNlX3N3Y19pbml0X29uZSwNCj4gPiArICAgICAucmVtb3ZlID0g
cnRhc2Vfc3djX3JlbW92ZV9vbmUsDQo+ID4gK307DQo+ID4gKw0KPiA+ICtzdGF0aWMgaW50IF9f
aW5pdCBydGFzZV9pbml0X21vZHVsZSh2b2lkKQ0KPiA+ICt7DQo+ID4gKyAgICAgaW50IHJldCA9
IDA7DQo+ID4gKw0KPiA+ICsgICAgIHdvcmtfcXVldWUgPSBjcmVhdGVfc2luZ2xldGhyZWFkX3dv
cmtxdWV1ZSgicnRhc2Vfd29ya19xdWV1ZSIpOw0KPiANCj4gV2h5IGRvbid0IHlvdSB1c2Ugb25l
IG9mIHRoZSBzeXN0ZW0gd29ya3F1ZXVlcz8NCj4gDQo+ID4gKyAgICAgaWYgKCF3b3JrX3F1ZXVl
KSB7DQo+ID4gKyAgICAgICAgICAgICByZXQgPSAtRU5PTUVNOw0KPiA+ICsgICAgIH0gZWxzZSB7
DQo+ID4gKyNpZmRlZiBFTkFCTEVfUlRBU0VfUFJPQ0ZTDQo+ID4gKyAgICAgICAgICAgICBydGFz
ZV9wcm9jX21vZHVsZV9pbml0KCk7DQo+ID4gKyNlbmRpZg0KPiA+ICsgICAgICAgICAgICAgcmV0
ID0gcGNpX3JlZ2lzdGVyX2RyaXZlcigmcnRhc2VfcGNpX2RyaXZlcik7DQo+ID4gKyAgICAgICAg
ICAgICBpZiAocmV0ICE9IDApIHsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgZGVzdHJveV93
b3JrcXVldWUod29ya19xdWV1ZSk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHByX2FsZXJ0
KCJydGFzZV9wY2lfZHJpdmVyIHJlZ2lzdGVyIGZhaWxlZC4iKTsNCj4gPiArICAgICAgICAgICAg
IH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJldCA9IHBjaV9yZWdpc3Rlcl9k
cml2ZXIoJnJ0YXNlX3N3Y19wY2lfZHJpdmVyKTsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiAr
DQo+ID4gKyAgICAgICAgICAgICBpZiAocmV0ICE9IDApIHsNCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgcGNpX3VucmVnaXN0ZXJfZHJpdmVyKCZydGFzZV9wY2lfZHJpdmVyKTsNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgZGVzdHJveV93b3JrcXVldWUod29ya19xdWV1ZSk7DQo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIHByX2FsZXJ0KCJydGFzZV9zd2NfcGNpX2RyaXZlciByZWdpc3Rl
ciBmYWlsZWQuIik7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4g
PiArICAgICByZXR1cm4gcmV0Ow0KPiA+ICt9DQo+ID4gKw0KPiA+ICtzdGF0aWMgdm9pZCBfX2V4
aXQgcnRhc2VfY2xlYW51cF9tb2R1bGUodm9pZCkNCj4gPiArew0KPiA+ICsgICAgIHBjaV91bnJl
Z2lzdGVyX2RyaXZlcigmcnRhc2Vfc3djX3BjaV9kcml2ZXIpOw0KPiA+ICsNCj4gPiArICAgICBw
Y2lfdW5yZWdpc3Rlcl9kcml2ZXIoJnJ0YXNlX3BjaV9kcml2ZXIpOw0KPiA+ICsjaWZkZWYgRU5B
QkxFX1JUQVNFX1BST0NGUw0KPiA+ICsgICAgIGlmIChydGFzZV9wcm9jKSB7DQo+ID4gKyAgICAg
ICAgICAgICByZW1vdmVfcHJvY19zdWJ0cmVlKE1PRFVMRU5BTUUsIGluaXRfbmV0LnByb2NfbmV0
KTsNCj4gPiArICAgICAgICAgICAgIHJ0YXNlX3Byb2MgPSBOVUxMOw0KPiA+ICsgICAgIH0NCj4g
PiArI2VuZGlmDQo+ID4gKyAgICAgZGVzdHJveV93b3JrcXVldWUod29ya19xdWV1ZSk7DQo+ID4g
K30NCj4gPiArDQo+ID4gK21vZHVsZV9pbml0KHJ0YXNlX2luaXRfbW9kdWxlKTsNCj4gPiArbW9k
dWxlX2V4aXQocnRhc2VfY2xlYW51cF9tb2R1bGUpOw0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L25ldC9ldGhlcm5ldC9yZWFsdGVrL3J0YXNlL3J0YXNlX3NyaW92LmMNCj4gYi9kcml2ZXJzL25l
dC9ldGhlcm5ldC9yZWFsdGVrL3J0YXNlL3J0YXNlX3NyaW92LmMNCj4gPiBuZXcgZmlsZSBtb2Rl
IDEwMDY0NA0KPiA+IGluZGV4IDAwMDAwMDAwMDAwMC4uOTQ0MWQ1OWEzMjcxDQo+ID4gLS0tIC9k
ZXYvbnVsbA0KPiA+ICsrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L3JlYWx0ZWsvcnRhc2UvcnRh
c2Vfc3Jpb3YuYw0KPiA+IEBAIC0wLDAgKzEsMzI4IEBADQo+ID4gKy8vIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wDQo+ID4gKy8qDQo+ID4gKyAqICBDb3B5cmlnaHQoYykgMjAyMyBS
ZWFsdGVrIFNlbWljb25kdWN0b3IgQ29ycC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4NCj4gPiArICoN
Cj4gPiArICogIEF1dGhvcjoNCj4gPiArICogIFJlYWx0ZWsgQVJEMSBzb2Z0d2FyZSB0ZWFtDQo+
ID4gKyAqLw0KPiA+ICsjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4NCj4gPiArI2luY2x1ZGUgPGxp
bnV4L21vZHVsZS5oPg0KPiA+ICsjaW5jbHVkZSA8bGludXgvcGNpLmg+DQo+ID4gKyNpbmNsdWRl
IDxsaW51eC9uZXRkZXZpY2UuaD4NCj4gPiArI2luY2x1ZGUgPGxpbnV4L2V0aGVyZGV2aWNlLmg+
DQo+ID4gKyNpbmNsdWRlIDxsaW51eC9ydG5ldGxpbmsuaD4NCj4gPiArDQo+ID4gKyNpbmNsdWRl
ICJydGFzZS5oIg0KPiA+ICsjaW5jbHVkZSAicnRhc2Vfc3Jpb3YuaCINCj4gPiArDQo+ID4NCj4g
Ky8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKg0KPiAqKioqKioqKioqKioqKioqDQo+ID4gKyAqICBGdW5jdGlvbg0KPiA+ICsNCj4g
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKg0KPiAqKioqKioqKioqKioqKi8NCj4gPiArc3RhdGljIGludCBydGFzZV9hbGxvY2F0
ZV92Zl9kYXRhKHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCwgaW50IG51bV92ZnMpDQo+ID4gK3sN
Cj4gPiArICAgICBpbnQgcmV0ID0gMDsNCj4gPiArDQo+ID4gKyAgICAgdHAtPnZmX2luZm8gPSBr
Y2FsbG9jKCh1NjQpbnVtX3Zmcywgc2l6ZW9mKHN0cnVjdCB2Zl9pbmZvKSwNCj4gR0ZQX0tFUk5F
TCk7DQo+ID4gKyAgICAgaWYgKCF0cC0+dmZfaW5mbykNCj4gPiArICAgICAgICAgICAgIHJldCA9
IC1FTk9NRU07DQo+ID4gKyAgICAgZWxzZQ0KPiA+ICsgICAgICAgICAgICAgdHAtPm51bV92ZnMg
PSAodTE2KW51bV92ZnM7DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4g
PiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0YXNlX2dldF92ZnMoY29uc3Qgc3RydWN0IHJ0YXNlX3By
aXZhdGUgKnRwKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IHBjaV9kZXYgKnBkZXYgPSB0cC0+
cGRldjsNCj4gPiArICAgICBzdHJ1Y3QgcGNpX2RldiAqdmZfcGRldiA9IE5VTEw7DQo+ID4gKyAg
ICAgdTE2IHZlbmRvciA9IHBkZXYtPnZlbmRvcjsNCj4gPiArICAgICBpbnQgaW5kZXggPSAwOw0K
PiA+ICsgICAgIHUxNiB2Zl9pZCA9IDA7DQo+ID4gKyAgICAgaW50IHNyaW92X3BvcyA9IDA7DQo+
ID4gKw0KPiA+ICsgICAgIHNyaW92X3BvcyA9IChzMzIpcGNpX2ZpbmRfZXh0X2NhcGFiaWxpdHko
cGRldiwNCj4gUENJX0VYVF9DQVBfSURfU1JJT1YpOw0KPiA+ICsNCj4gPiArICAgICBpZiAoc3Jp
b3ZfcG9zID09IDApIHsNCj4gPiArICAgICAgICAgICAgIHNyaW92X3dhcm4oIlx0Y2FuJ3QgZmlu
ZCBzcmlvdiBwb3NpdGlvbi4iKTsNCj4gPiArICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAgICAg
ICAgcGNpX3JlYWRfY29uZmlnX3dvcmQocGRldiwgc3Jpb3ZfcG9zICsgUENJX1NSSU9WX1ZGX0RJ
RCwNCj4gJnZmX2lkKTsNCj4gPiArICAgICAgICAgICAgIHNyaW92X2luZm8oInJ0YXNlIFZGIERl
dmljZSBJRCA9ICUwNHgiLCB2Zl9pZCk7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgdmZfcGRl
diA9IHBjaV9nZXRfZGV2aWNlKHZlbmRvciwgdmZfaWQsIE5VTEwpOw0KPiA+ICsNCj4gPiArICAg
ICAgICAgICAgIGZvciAoOyB2Zl9wZGV2ICE9IE5VTEw7IHZmX3BkZXYgPSBwY2lfZ2V0X2Rldmlj
ZSh2ZW5kb3IsDQo+IHZmX2lkLCB2Zl9wZGV2KSkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAg
ICBpZiAodmZfcGRldi0+aXNfdmlydGZuID09IDB1KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnRpbnVlOw0KPiA+ICsNCj4gPiArI2lmZGVmIENPTkZJR19QQ0lfSU9WDQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIGlmICh2Zl9wZGV2LT5waHlzZm4gIT0gcGRldikNCj4g
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCj4gPiArDQo+ID4gKyNl
bmRpZg0KPiA+ICsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgcGNpX2Rldl9nZXQodmZfcGRl
dik7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHRwLT52Zl9pbmZvW2luZGV4XS52Zl9wY2lf
ZGV2ID0gdmZfcGRldjsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGlmICgrK2lu
ZGV4ID49IChzMzIpdHAtPm51bV92ZnMpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYnJlYWs7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgICAgICAgICBzcmlvdl9p
bmZvKCIlcy4uLmluZGV4ID0gJWkiLCBfX2Z1bmNfXywgaW5kZXgpOw0KPiA+ICsgICAgIH0NCj4g
PiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIHZvaWQgcnRhc2Vfc3Jpb3ZfaHdfc2V0dGluZ3Moc3Ry
dWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7DQo+ID4gKyAgICAgdm9pZCBfX2lvbWVtICpp
b2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHUxNiB0bXBfcmVnID0gMDsNCj4gPiAr
ICAgICB1bnNpZ25lZCBsb25nIGZsYWdzOw0KPiA+ICsNCj4gPiArICAgICBzcmlvdl9pbmZvKCIl
cy4uLnZmX251bSA9ICVpIiwgX19mdW5jX18sIHRwLT5udW1fdmZzKTsNCj4gPiArICAgICBzcGlu
X2xvY2tfaXJxc2F2ZSgmdHAtPmxvY2ssIGZsYWdzKTsNCj4gPiArICAgICBpZiAodHAtPm51bV92
ZnMgIT0gMHUpIHsNCj4gPiArICAgICAgICAgICAgIC8qIHNlbGVjdCByeHEgbnVtYmVyICovDQo+
ID4gKyAgICAgICAgICAgICB0bXBfcmVnID0gUlRMX1IxNihWUUNUUkwpOw0KPiA+ICsgICAgICAg
ICAgICAgdG1wX3JlZyAmPSAodTE2KSh+KDB4N3UgPDwgMnUpKTsNCj4gPiArICAgICAgICAgICAg
IGlmICh0cC0+bnVtX3ZmcyA9PSAxdSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgdG1wX3Jl
ZyB8PSAoMHgzdSA8PCAydSk7DQo+ID4gKyAgICAgICAgICAgICBlbHNlIGlmICh0cC0+bnVtX3Zm
cyA8PSAzdSkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgdG1wX3JlZyB8PSAoMHg0dSA8PCAy
dSk7DQo+ID4gKyAgICAgICAgICAgICBlbHNlDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHRt
cF9yZWcgfD0gKDB4NXUgPDwgMnUpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIFJUTF9XMTYo
VlFDVFJMLCB0bXBfcmVnKTsNCj4gPiArICAgICAgICAgICAgIHNyaW92X2luZm8oIlZRQ1RSTCA9
ICUwNHgiLCBSVExfUjE2KFZRQ1RSTCkpOw0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIC8qIE1h
aWxib3ggaW50ZXJydXB0IG1hc2sgKi8NCj4gPiArICAgICAgICAgICAgIFJUTF9XOChQRk1TR0lN
UiwgMHg3Rik7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgdHAtPnN3X2ZsYWcgfD0gKHUzMilT
V0ZfU1JJT1ZfRU5BQkxFRDsNCj4gPiArICAgICB9IGVsc2Ugew0KPiA+ICsgICAgICAgICAgICAg
LyogcmVzdG9yZSByeHEgbnVtYmVyIFRCRDogcmVzdG9yZSBQRiByeHEgKi8NCj4gPiArICAgICAg
ICAgICAgIHRtcF9yZWcgPSBSVExfUjE2KFZRQ1RSTCk7DQo+ID4gKyAgICAgICAgICAgICB0bXBf
cmVnICY9ICh1MTYpKH4oMHg3dSA8PCAydSkpOw0KPiA+ICsgICAgICAgICAgICAgdG1wX3JlZyB8
PSAoMHgydSA8PCAydSk7DQo+ID4gKyAgICAgICAgICAgICBSVExfVzE2KFZRQ1RSTCwgdG1wX3Jl
Zyk7DQo+ID4gKyAgICAgICAgICAgICBzcmlvdl9pbmZvKCJWUUNUUkwgPSAlMDR4IiwgUlRMX1Ix
NihWUUNUUkwpKTsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICAvKiBNYWlsYm94IGludGVycnVw
dCBtYXNrICovDQo+ID4gKyAgICAgICAgICAgICBSVExfVzgoUEZNU0dJTVIsIDB4MCk7DQo+ID4g
Kw0KPiA+ICsgICAgICAgICAgICAgdHAtPnN3X2ZsYWcgJj0gKHUzMikoflNXRl9TUklPVl9FTkFC
TEVEKTsNCj4gPiArICAgICB9DQo+ID4gKyAgICAgc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdHAt
PmxvY2ssIGZsYWdzKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiArczMyIHJ0YXNlX2Rpc2FibGVfc3Jp
b3Yoc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKQ0KPiA+ICt7DQo+ID4gKyAgICAgdTE2IG51bV92
ZnMgPSB0cC0+bnVtX3ZmczsNCj4gPiArICAgICB1MTYgaW5kZXggPSAwOw0KPiA+ICsgICAgIHMz
MiByZXQgPSAwOw0KPiA+ICsNCj4gPiArICAgICB0cC0+bnVtX3ZmcyA9IDA7DQo+ID4gKyAgICAg
Zm9yIChpbmRleCA9IDA7IGluZGV4IDwgbnVtX3ZmczsgaW5kZXgrKykgew0KPiA+ICsgICAgICAg
ICAgICAgc3RydWN0IHBjaV9kZXYgKnZmX3BkZXYgPSB0cC0+dmZfaW5mb1tpbmRleF0udmZfcGNp
X2RldjsNCj4gPiArDQo+ID4gKyAgICAgICAgICAgICBpZiAodmZfcGRldikgew0KPiA+ICsgICAg
ICAgICAgICAgICAgICAgICBwY2lfZGV2X3B1dCh2Zl9wZGV2KTsNCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgdHAtPnZmX2luZm9baW5kZXhdLnZmX3BjaV9kZXYgPSBOVUxMOw0KPiA+ICsgICAg
ICAgICAgICAgfQ0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gKyAgICAgLyogZnJlZSB2Zl9pbmZv
ICovDQo+ID4gKyAgICAga2ZyZWUodHAtPnZmX2luZm8pOw0KPiA+ICsgICAgIHRwLT52Zl9pbmZv
ID0gTlVMTDsNCj4gPiArDQo+ID4gKyAgICAgLyogcGNpIGRpc2FiZSBzcmlvdiovDQo+ID4gKyAg
ICAgaWYgKHBjaV92ZnNfYXNzaWduZWQodHAtPnBkZXYpICE9IDApIHsNCj4gPiArICAgICAgICAg
ICAgIHNyaW92X3dhcm4oIlZGcyBhcmUgYXNzaWduZWQgISIpOw0KPiA+ICsgICAgICAgICAgICAg
cmV0ID0gLUVQRVJNOw0KPiA+ICsgICAgIH0gZWxzZSB7DQo+ID4gKyAgICAgICAgICAgICBwY2lf
ZGlzYWJsZV9zcmlvdih0cC0+cGRldik7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgLyogc3Jp
b3YgaGFyZHdhcmUgc2V0dGluZ3MgKi8NCj4gPiArICAgICAgICAgICAgIHJ0YXNlX3NyaW92X2h3
X3NldHRpbmdzKHRwKTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiByZXQ7
DQo+ID4gK30NCj4gPiArDQo+ID4gK3N0YXRpYyBpbnQgcnRhc2VfcGNpX3NyaW92X2VuYWJsZShz
dHJ1Y3QgcGNpX2RldiAqcGRldiwgaW50IG51bV92ZnMpDQo+ID4gK3sNCj4gPiArICAgICBjb25z
dCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOw0KPiA+ICsg
ICAgIHN0cnVjdCBydGFzZV9wcml2YXRlICp0cCA9IG5ldGRldl9wcml2KGRldik7DQo+ID4gKyAg
ICAgaW50IGVyciA9IDA7DQo+ID4gKyAgICAgdTE2IGV4aXN0ZWRfdmZzID0gKHUxNilwY2lfbnVt
X3ZmKHBkZXYpOw0KPiA+ICsgICAgIGludCByZXQgPSAwOw0KPiA+ICsNCj4gPiArICAgICBpZiAo
dHAtPm51bV92ZnMgPT0gKHUzMiludW1fdmZzKQ0KPiA+ICsgICAgICAgICAgICAgcmV0ID0gLUVJ
TlZBTDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKChleGlzdGVkX3ZmcyAhPSAwdSkgJiYgKGV4aXN0
ZWRfdmZzICE9ICh1MzIpbnVtX3ZmcykpIHsNCj4gPiArICAgICAgICAgICAgIGVyciA9IHJ0YXNl
X2Rpc2FibGVfc3Jpb3YodHApOw0KPiA+ICsgICAgICAgICAgICAgaWYgKGVyciAhPSAwKSB7DQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIHJldCA9IGVycjsNCj4gPiArICAgICAgICAgICAgICAg
ICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAgICAgICAgICB9DQo+ID4gKyAgICAgfSBlbHNlIGlm
ICgoZXhpc3RlZF92ZnMgIT0gMHUpICYmIChleGlzdGVkX3ZmcyA9PSAodTMyKW51bV92ZnMpKSB7
DQo+ID4gKyAgICAgICAgICAgICByZXQgPSBudW1fdmZzOw0KPiA+ICsgICAgICAgICAgICAgZ290
byBvdXQ7DQo+ID4gKyAgICAgfSBlbHNlIHsNCj4gPiArICAgICAgICAgICAgIHNyaW92X3dhcm4o
ImV4aXN0ZWRfdmZzID0gMFxuIik7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBlcnIg
PSBydGFzZV9hbGxvY2F0ZV92Zl9kYXRhKHRwLCBudW1fdmZzKTsNCj4gPiArICAgICBpZiAoZXJy
ICE9IDApIHsNCj4gPiArICAgICAgICAgICAgIHNyaW92X3dhcm4oImFsbG9jYXRlIHZmIGRhdGEg
ZmFpbGVkLiIpOw0KPiA+ICsgICAgICAgICAgICAgcmV0ID0gZXJyOw0KPiA+ICsgICAgICAgICAg
ICAgZ290byBvdXQ7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICBlcnIgPSBwY2lfZW5h
YmxlX3NyaW92KHBkZXYsIG51bV92ZnMpOw0KPiA+ICsgICAgIGlmIChlcnIgIT0gMCkgew0KPiA+
ICsgICAgICAgICAgICAgc3Jpb3Zfd2FybigicGNpX2VuYWJsZV9zcmlvdiBmYWlsZWQ6ICVkXG4i
LCBlcnIpOw0KPiA+ICsgICAgICAgICAgICAgcmV0ID0gZXJyOw0KPiA+ICsgICAgICAgICAgICAg
Z290byBvdXQ7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiArICAgICAvKiBzcmlvdiBoYXJkd2Fy
ZSBzZXR0aW5ncyAqLw0KPiA+ICsgICAgIHJ0YXNlX3NyaW92X2h3X3NldHRpbmdzKHRwKTsNCj4g
PiArDQo+ID4gKyAgICAgcnRhc2VfZ2V0X3Zmcyh0cCk7DQo+ID4gKw0KPiA+ICtvdXQ6DQo+ID4g
KyAgICAgcmV0dXJuIHJldDsNCj4gPiArfQ0KPiA+ICsNCj4gPiArc3RhdGljIGludCBydGFzZV9w
Y2lfc3Jpb3ZfZGlzYWJsZShzdHJ1Y3QgcGNpX2RldiAqcGRldikNCj4gPiArew0KPiA+ICsgICAg
IGNvbnN0IHN0cnVjdCBuZXRfZGV2aWNlICpkZXYgPSBwY2lfZ2V0X2RydmRhdGEocGRldik7DQo+
ID4gKyAgICAgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0ZGV2X3ByaXYoZGV2KTsNCj4g
PiArICAgICBpbnQgZXJyOw0KPiA+ICsNCj4gPiArICAgICBpZiAoKHRwLT5udW1fdmZzID09IDB1
KSAmJiAocGNpX251bV92ZihwZGV2KSA9PSAwKSkNCj4gPiArICAgICAgICAgICAgIGVyciA9IC1F
SU5WQUw7DQo+ID4gKyAgICAgZWxzZQ0KPiA+ICsgICAgICAgICAgICAgZXJyID0gcnRhc2VfZGlz
YWJsZV9zcmlvdih0cCk7DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiBlcnI7DQo+ID4gK30NCj4g
PiArDQo+ID4gKy8qIFRCRDogbmVlZCB0byBtb2RpZnksIG5vdyBhbGwgZW5hYmxlICovDQo+ID4g
K3N0YXRpYyB2b2lkIHJ0YXNlX3NyaW92X2NyKGNvbnN0IHN0cnVjdCBydGFzZV9wcml2YXRlICp0
cCkNCj4gPiArew0KPiA+ICsgICAgIHZvaWQgX19pb21lbSAqaW9hZGRyID0gdHAtPm1taW9fYWRk
cjsNCj4gPiArICAgICB1MTYgY3IgPSBSVExfUjE2KEZDUik7DQo+ID4gKw0KPiA+ICsgICAgIGNy
IHw9ICh1MTYpKEZDUl9CQVJfRU4gfCBGQ1JfTUFSX0VOIHwgRkNSX1RYX0xPT1BCQUNLX0VOKTsN
Cj4gPiArICAgICBSVExfVzE2KEZDUiwgY3IpOw0KPiA+ICsNCj4gPiArICAgICBSVExfVzE2KExC
S19DVFJMLCAodTE2KShMQktfQVRMRCB8IExCS19DTFIpKTsNCj4gPiArfQ0KPiA+ICsNCj4gPiAr
aW50IHJ0YXNlX3BjaV9zcmlvdl9jb25maWd1cmUoc3RydWN0IHBjaV9kZXYgKnBkZXYsIGludCBu
dW1fdmZzKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IG5ldF9kZXZpY2UgKmRldiA9IHBjaV9n
ZXRfZHJ2ZGF0YShwZGV2KTsNCj4gPiArICAgICBzdHJ1Y3QgcnRhc2VfcHJpdmF0ZSAqdHAgPSBu
ZXRkZXZfcHJpdihkZXYpOw0KPiA+ICsgICAgIGludCByZXQgPSAwOw0KPiA+ICsNCj4gPiArICAg
ICBzcmlvdl9pbmZvKCIlcy4uLiVpIiwgX19mdW5jX18sIG51bV92ZnMpOw0KPiA+ICsNCj4gPiAr
ICAgICBuZXRpZl9zdG9wX3F1ZXVlKGRldik7DQo+ID4gKyAgICAgaWYgKCh0cC0+c3dfZmxhZyAm
IFNXRl9TUklPVl9FTkFCTEVEKSAhPSAwdSkNCj4gPiArICAgICAgICAgICAgIHJ0YXNlX2Z1bmNf
ZGlzYWJsZSh0cCk7DQo+ID4gKw0KPiA+ICsgICAgIHJ0YXNlX2h3X3Jlc2V0KGRldik7DQo+ID4g
KyAgICAgcnRhc2VfdHhfY2xlYXIodHApOw0KPiA+ICsgICAgIHJ0YXNlX3J4X2NsZWFyKHRwKTsN
Cj4gPiArDQo+ID4gKyAgICAgaWYgKHJ0YXNlX2luaXRfcmluZyhkZXYpICE9IDApDQo+ID4gKyAg
ICAgICAgICAgICBuZXRkZXZfaW5mbyh0cC0+ZGV2LCAidW5hYmxlIHRvIGluaXQgcmluZ1xuIik7
DQo+ID4gKw0KPiA+ICsgICAgIGlmIChudW1fdmZzID09IDApDQo+ID4gKyAgICAgICAgICAgICBy
ZXQgPSBydGFzZV9wY2lfc3Jpb3ZfZGlzYWJsZShwZGV2KTsNCj4gPiArICAgICBlbHNlDQo+ID4g
KyAgICAgICAgICAgICByZXQgPSBydGFzZV9wY2lfc3Jpb3ZfZW5hYmxlKHBkZXYsIG51bV92ZnMp
Ow0KPiA+ICsNCj4gPiArICAgICBpZiAocmV0ICE9IC1FSU5WQUwpIHsNCj4gPiArICAgICAgICAg
ICAgIG1kZWxheSgxMCk7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICAgcnRhc2VfaHdfc2V0X3J4
X3BhY2tldF9maWx0ZXIoZGV2KTsNCj4gPiArICAgICAgICAgICAgIHJ0YXNlX2h3X3N0YXJ0KGRl
dik7DQo+ID4gKyAgICAgICAgICAgICBpZiAoKHRwLT5zd19mbGFnICYgU1dGX1NSSU9WX0VOQUJM
RUQpICE9IDB1KSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJ0YXNlX2Z1bmNfZW5hYmxl
KHRwKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgcnRhc2Vfc3Jpb3ZfY3IodHApOw0KPiA+
ICsgICAgICAgICAgICAgfQ0KPiA+ICsNCj4gPiArICAgICAgICAgICAgIG5ldGlmX3dha2VfcXVl
dWUoZGV2KTsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4g
K30NCj4gPiArDQo+ID4gK3N0YXRpYyB2b2lkIHJ0bF9zZXRfdmZfbWFjKHN0cnVjdCBydGFzZV9w
cml2YXRlICp0cCwgaW50IHZmLCBjb25zdCB1OCAqbWFjKQ0KPiA+ICt7DQo+ID4gKyAgICAgdm9p
ZCBfX2lvbWVtICppb2FkZHIgPSB0cC0+bW1pb19hZGRyOw0KPiA+ICsgICAgIHVuc2lnbmVkIGxv
bmcgZmxhZ3M7DQo+ID4gKyAgICAgdTE2IHRtcDsNCj4gPiArDQo+ID4gKyAgICAgc3Bpbl9sb2Nr
X2lycXNhdmUoJnRwLT5sb2NrLCBmbGFncyk7DQo+ID4gKw0KPiA+ICsgICAgIHRtcCA9ICgodTE2
KW1hY1swXSA8PCA4KSB8ICh1MTYpbWFjWzFdOw0KPiA+ICsgICAgIFJUTF9XMTYoKChzMzIpVkZf
TUFDXzAgKyAodmYgKiA4KSksIHRtcCk7DQo+ID4gKyAgICAgdG1wID0gKCh1MTYpbWFjWzJdIDw8
IDgpIHwgKHUxNiltYWNbM107DQo+ID4gKyAgICAgUlRMX1cxNigoKHMzMilWRl9NQUNfMiArICh2
ZiAqIDgpKSwgdG1wKTsNCj4gPiArICAgICB0bXAgPSAoKHUxNiltYWNbNF0gPDwgOCkgfCAodTE2
KW1hY1s1XTsNCj4gPiArICAgICBSVExfVzE2KCgoczMyKVZGX01BQ180ICsgKHZmICogOCkpLCB0
bXApOw0KPiA+ICsNCj4gPiArICAgICBzcGluX3VubG9ja19pcnFyZXN0b3JlKCZ0cC0+bG9jaywg
ZmxhZ3MpOw0KPiA+ICt9DQo+ID4gKw0KPiA+ICsjaWZkZWYgSUZMQV9WRl9NQVgNCj4gPiAraW50
IHJ0YXNlX3NldF92Zl9tYWMoc3RydWN0IG5ldF9kZXZpY2UgKm5ldGRldiwgaW50IHZmLCB1OCAq
bWFjKQ0KPiA+ICt7DQo+ID4gKyAgICAgc3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0ZGV2
X3ByaXYobmV0ZGV2KTsNCj4gPiArICAgICBzdHJ1Y3QgdmZfaW5mbyAqdmZfaW5mbyA9IE5VTEw7
DQo+ID4gKyAgICAgaW50IHJldCA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIHNyaW92X2luZm8oIiVz
OnZmID0gJWksIE1BQzolMDJ4OiUwMng6JTAyeDolMDJ4OiUwMng6JTAyeCIsDQo+IF9fZnVuY19f
LCB2ZiwgbWFjWzBdLCBtYWNbMV0sDQo+ID4gKyAgICAgICAgICAgICAgICBtYWNbMl0sIG1hY1sz
XSwgbWFjWzRdLCBtYWNbNV0pOw0KPiA+ICsNCj4gPiArICAgICBpZiAodmYgPj0gKHMxNil0cC0+
bnVtX3Zmcykgew0KPiA+ICsgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsNCj4gPiArICAgICB9
IGVsc2Ugew0KPiA+ICsgICAgICAgICAgICAgdmZfaW5mbyA9ICZ0cC0+dmZfaW5mb1t2Zl07DQo+
ID4gKw0KPiA+ICsgICAgICAgICAgICAgaWYgKGlzX3ZhbGlkX2V0aGVyX2FkZHIobWFjKSkgew0K
PiA+ICsgICAgICAgICAgICAgICAgICAgICBydGxfc2V0X3ZmX21hYyh0cCwgdmYsIG1hYyk7DQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgIG1lbWNweSh2Zl9pbmZvLT52Zl9tYWMsIG1hYywgRVRI
X0FMRU4pOw0KPiA+ICsgICAgICAgICAgICAgfSBlbHNlIGlmIChpc196ZXJvX2V0aGVyX2FkZHIo
bWFjKSkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBydGxfc2V0X3ZmX21hYyh0cCwgdmYs
IG1hYyk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIG1lbWNweSh2Zl9pbmZvLT52Zl9tYWMs
IG1hYywgRVRIX0FMRU4pOw0KPiA+ICsgICAgICAgICAgICAgfSBlbHNlIHsNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsNCj4gPiArICAgICAgICAgICAgIH0NCj4gPiAr
ICAgICB9DQo+ID4gKw0KPiA+ICsgICAgIHJldHVybiByZXQ7DQo+ID4gK30NCj4gPiArDQo+ID4g
K2ludCBydGFzZV9nZXRfdmZfY29uZmlnKHN0cnVjdCBuZXRfZGV2aWNlICpuZXRkZXYsIGludCB2
Ziwgc3RydWN0IGlmbGFfdmZfaW5mbw0KPiAqaXZpKQ0KPiA+ICt7DQo+ID4gKyAgICAgY29uc3Qg
c3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwID0gbmV0ZGV2X3ByaXYobmV0ZGV2KTsNCj4gPiArICAg
ICBjb25zdCBzdHJ1Y3QgdmZfaW5mbyAqdmZfaW5mbyA9IE5VTEw7DQo+ID4gKyAgICAgaW50IHJl
dCA9IDA7DQo+ID4gKw0KPiA+ICsgICAgIHNyaW92X2luZm8oIiVzLi4uJWkiLCBfX2Z1bmNfXywg
dmYpOw0KPiA+ICsNCj4gPiArICAgICBpZiAodmYgPj0gKHMxNil0cC0+bnVtX3Zmcykgew0KPiA+
ICsgICAgICAgICAgICAgc3Jpb3ZfaW5mbygiJXMuLi4laSBFSU5WQUwiLCBfX2Z1bmNfXywgdmYp
Ow0KPiA+ICsgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsNCj4gPiArICAgICB9IGVsc2Ugew0K
PiA+ICsgICAgICAgICAgICAgdmZfaW5mbyA9ICZ0cC0+dmZfaW5mb1t2Zl07DQo+ID4gKyAgICAg
ICAgICAgICBpdmktPnZmID0gKHUzMil2ZjsNCj4gPiArICAgICAgICAgICAgIG1lbWNweShpdmkt
Pm1hYywgdmZfaW5mby0+dmZfbWFjLCBFVEhfQUxFTik7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4g
PiArICAgICByZXR1cm4gcmV0Ow0KPiA+ICt9DQo+ID4gKyNlbmRpZg0KPiA+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL25ldC9ldGhlcm5ldC9yZWFsdGVrL3J0YXNlL3J0YXNlX3NyaW92LmgNCj4gYi9k
cml2ZXJzL25ldC9ldGhlcm5ldC9yZWFsdGVrL3J0YXNlL3J0YXNlX3NyaW92LmgNCj4gPiBuZXcg
ZmlsZSBtb2RlIDEwMDY0NA0KPiA+IGluZGV4IDAwMDAwMDAwMDAwMC4uNjJkYWZiZDE4ZjlhDQo+
ID4gLS0tIC9kZXYvbnVsbA0KPiA+ICsrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L3JlYWx0ZWsv
cnRhc2UvcnRhc2Vfc3Jpb3YuaA0KPiA+IEBAIC0wLDAgKzEsMzAgQEANCj4gPiArLyogU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8NCj4gPiArLyoNCj4gPiArICogIENvcHlyaWdo
dChjKSAyMDIzIFJlYWx0ZWsgU2VtaWNvbmR1Y3RvciBDb3JwLiBBbGwgcmlnaHRzIHJlc2VydmVk
Lg0KPiA+ICsgKg0KPiA+ICsgKiAgQXV0aG9yOg0KPiA+ICsgKiAgUmVhbHRlayBBUkQgc29mdHdh
cmUgdGVhbQ0KPiA+ICsgKi8NCj4gPiArI2lmbmRlZiBSVEFTRV9TUklPVl9IXw0KPiA+ICsjZGVm
aW5lIFJUQVNFX1NSSU9WX0hfDQo+ID4gKw0KPiA+ICsvKiAgRGVmaW5lcw0KPiA+ICsgKi8NCj4g
PiArI2lmZGVmIFNSSU9WX0RFQlVHDQo+ID4gKyNkZWZpbmUgc3Jpb3Zfd2Fybihmb3JtYXQsIGFy
Z3MuLi4pIHByX3dhcm5pbmcoZm9ybWF0LCAjI2FyZ3MpDQo+ID4gKyNkZWZpbmUgc3Jpb3ZfaW5m
byhmb3JtYXQsIGFyZ3MuLi4pIHByX2luZm8oZm9ybWF0LCAjI2FyZ3MpDQo+ID4gKyNlbHNlDQo+
ID4gKyNkZWZpbmUgc3Jpb3Zfd2Fybihmb3JtYXQsIGFyZ3MuLi4pDQo+ID4gKyNkZWZpbmUgc3Jp
b3ZfaW5mbyhmb3JtYXQsIGFyZ3MuLi4pDQo+ID4gKyNlbmRpZg0KPiA+ICsNCj4gPiArLyogIEZ1
bmN0aW9uIFByb3RvdHlwZQ0KPiA+ICsgKi8NCj4gPiArczMyIHJ0YXNlX2Rpc2FibGVfc3Jpb3Yo
c3RydWN0IHJ0YXNlX3ByaXZhdGUgKnRwKTsNCj4gPiAraW50IHJ0YXNlX3BjaV9zcmlvdl9jb25m
aWd1cmUoc3RydWN0IHBjaV9kZXYgKnBkZXYsIGludCBudW1fdmZzKTsNCj4gPiArI2lmZGVmIElG
TEFfVkZfTUFYDQo+ID4gK2ludCBydGFzZV9zZXRfdmZfbWFjKHN0cnVjdCBuZXRfZGV2aWNlICpu
ZXRkZXYsIGludCB2ZiwgdTggKm1hYyk7DQo+ID4gK2ludCBydGFzZV9nZXRfdmZfY29uZmlnKHN0
cnVjdCBuZXRfZGV2aWNlICpuZXRkZXYsIGludCB2Ziwgc3RydWN0IGlmbGFfdmZfaW5mbw0KPiAq
aXZpKTsNCj4gPiArI2VuZGlmDQo+ID4gKw0KPiA+ICsjZW5kaWYgLyogUlRBU0VfU1JJT1ZfSF8g
Ki8NCj4gDQo+IA0KPiAtLS0tLS1QbGVhc2UgY29uc2lkZXIgdGhlIGVudmlyb25tZW50IGJlZm9y
ZSBwcmludGluZyB0aGlzIGUtbWFpbC4NCg==

Return-Path: <linux-kernel+bounces-88248-lists+linux-kernel=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from sy.mirrors.kernel.org (sy.mirrors.kernel.org [147.75.48.161])
	by mail.lfdr.de (Postfix) with ESMTPS id 4A3D886DF25
	for <lists+linux-kernel@lfdr.de>; Fri,  1 Mar 2024 11:22:45 +0100 (CET)
Received: from smtp.subspace.kernel.org (wormhole.subspace.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by sy.mirrors.kernel.org (Postfix) with ESMTPS id 3514DB23085
	for <lists+linux-kernel@lfdr.de>; Fri,  1 Mar 2024 10:22:42 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id C5A966AFB6;
	Fri,  1 Mar 2024 10:22:36 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=microchip.com header.i=@microchip.com header.b="lAMTiEsh";
	dkim=pass (2048-bit key) header.d=microchip.com header.i=@microchip.com header.b="PoiOs93x"
Received: from esa.microchip.iphmx.com (esa.microchip.iphmx.com [68.232.154.123])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id C5A096A329;
	Fri,  1 Mar 2024 10:22:18 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=fail smtp.client-ip=68.232.154.123
ARC-Seal:i=2; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1709288546; cv=fail; b=kfgDrS6s8ssAlElmHsrlv+f3FuNOCao79/jnrAe6HYgjMjeWDRYBCcRYlAAdHHztJzgX05MGraPTmNqwbvo2JTYt64fshnX2rlXty2h5eU0kygzRr9G1s+UCBnC4DNisHkGq7JROneHCMRRtmiU8vTkXiKsqXlfErJqRV5+kEWo=
ARC-Message-Signature:i=2; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1709288546; c=relaxed/simple;
	bh=wUy0Fz+uPKxvqjOQbATv8kfiZCkBdxohnwWlTq8Zjm8=;
	h=From:To:CC:Subject:Date:Message-ID:References:In-Reply-To:
	 Content-Type:MIME-Version; b=I01suJt8sS7RL2Hk/HENiDxwNCubEtTAcLU4YoGcl17GllnIHFqIOWtm6K2qlaOz3irYplC9diGroD6Wcn+bkpenYhd9s7RZrn2AwYXmvnzb7ESA+E3M8lueDXmm32E5L9FjLpPA9oOCMUhbnUZ1I3Ue8US/NXwjKOl9jSCoRfk=
ARC-Authentication-Results:i=2; smtp.subspace.kernel.org; dmarc=pass (p=quarantine dis=none) header.from=microchip.com; spf=pass smtp.mailfrom=microchip.com; dkim=pass (2048-bit key) header.d=microchip.com header.i=@microchip.com header.b=lAMTiEsh; dkim=pass (2048-bit key) header.d=microchip.com header.i=@microchip.com header.b=PoiOs93x; arc=fail smtp.client-ip=68.232.154.123
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=quarantine dis=none) header.from=microchip.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=microchip.com
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
  d=microchip.com; i=@microchip.com; q=dns/txt; s=mchp;
  t=1709288539; x=1740824539;
  h=from:to:cc:subject:date:message-id:references:
   in-reply-to:mime-version;
  bh=wUy0Fz+uPKxvqjOQbATv8kfiZCkBdxohnwWlTq8Zjm8=;
  b=lAMTiEshtzWdq18DVRGmgdKe2qDE0D68cOajg2C03ggxU2OUo21+zied
   BMzkDN0w75wL2ChmfRjLs9c7J2WzsKWtsQf+qCa/Ks6yUiXsdGuCRsTj0
   0OuzyN5V0vI/1Kh9iCyzxqOtx2TQ+2L1mTtKylBvlF2fKXu6hWXFHU/Vd
   8LAS7Jopk7fSrMzgRtJTPU+XE321vXTFpcfMJaE831Pc0HbWwoYGqj193
   rBD2xLMDiZ0Q9wXzZrbnpVeU3x8Vn7nXlXifm3Wyxzgba5VnD54DGlCDk
   cmDhqbTjQaWGBjgaOjC2tI4TrBz3P3yww4QF4bYi/ml+pAfkkCVi7kiBH
   g==;
X-CSE-ConnectionGUID: q0rvypiGREO/8CMLoqAkLQ==
X-CSE-MsgGUID: rSDdpkQlTFCCEUHmhx2FBA==
X-IronPort-AV: E=Sophos;i="6.06,195,1705388400"; 
   d="c'?scan'208";a="17597368"
X-Amp-Result: UNKNOWN
X-Amp-Original-Verdict: FILE UNKNOWN
Received: from unknown (HELO email.microchip.com) ([170.129.1.10])
  by esa2.microchip.iphmx.com with ESMTP/TLS/ECDHE-RSA-AES128-GCM-SHA256; 01 Mar 2024 03:22:17 -0700
Received: from chn-vm-ex03.mchp-main.com (10.10.85.151) by
 chn-vm-ex03.mchp-main.com (10.10.85.151) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2507.35; Fri, 1 Mar 2024 03:22:13 -0700
Received: from NAM10-BN7-obe.outbound.protection.outlook.com (10.10.215.250)
 by email.microchip.com (10.10.87.152) with Microsoft SMTP Server
 (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id
 15.1.2507.35 via Frontend Transport; Fri, 1 Mar 2024 03:22:13 -0700
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=TQBsFkjpoCNmG6/mOTphgpxxaK+wNpHJn6p0XVbFu+Ys5DHF8Txvqe33twtpxazKSjL760Sn8XD0TEJS4OfKUOn0S9n0XDWKn7CCm7ha9tCnF4Zjy4ZVUnnsHv+kMVy4zqWnPp+YC3DZbSwlmWt8KvgpbCNP4fQVPL45R6IjehOw1c3EQPqSWVMSjdgOA13g0waagy6lMx5FpPHIERaDpKZomE3iM6NVufI2bEPJPBO0oZEMhHd3JBG1kFRK+Tkm3AyLOYl6oJsZR0Wg+hBwF4JbPwz8wOibOsyK2oJBLJo6kCS+wFvuuPJDsx1kFV5kGjA7BmpydnchKjo0cEuL/w==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=RkiM/8MQMyLrBGCNVHK99ljGvm+imT0A/88oduXr9PI=;
 b=OWReEOoa2p/rc1qZlqmXBlPPnC1MHlS7yG4rj78jDOZGsswJWvSKJzKoDLxqgfQqMNr8++PbV4vUjGI3OiATVLysbVw/Vir68IKrWMdsF2HqZR4RjQSjO/bRoDkVpU91x0wQ5Q9RpvE5yvdq061eVa80x/D0+I3tx8ZJ/sM0z1Hyevrx3p8GJtbk8DpCLjb0ZmzV+xEtuMiabOmSlm+eaaGCqY2lFPYY9pc5h+W6fO1JtJMm3+FvG8BNwNyimDswRjeLAnVi3kx/FBDn8UMsvbjLxwtoGVPZDMPcNZ1FiWr1ZPASNkWEeR2KoU9iS1J3sQ81c10Aq4r1+Ov4KEflgg==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=microchip.com; dmarc=pass action=none
 header.from=microchip.com; dkim=pass header.d=microchip.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=microchip.com;
 s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=RkiM/8MQMyLrBGCNVHK99ljGvm+imT0A/88oduXr9PI=;
 b=PoiOs93xTidrn/OetGhfSPV2LcJFVDN/BvpylHTbnKAmrH/uEP9KDZu45qolnWCogJYudoudnHhcNDRrX7Bp4KyR7dlx9VZmBidLPThnhEbqTILiOdnGhTqiAIBJksKWgEwhQqKH2YT4DBUEc8PwoypYYvVB/CxwSk4HxPm5OM4bJZoVcNe9aJpptv6mK5oUHDcA3leqoBjZ5vDFd+HuXsgWEcqtC1BH+WTP1/Upcj7FrE0tywrsoBSo5W5vVyJZwLiSY5+Bn5eZeKeGQozPpEQYS097FJw3QUhgqjq64BnnwFwoxRbHVcWEJujPpmNZ/ZKJI+EeuL37k8sdWFYmUA==
Received: from LV8PR11MB8700.namprd11.prod.outlook.com (2603:10b6:408:201::22)
 by DM4PR11MB8089.namprd11.prod.outlook.com (2603:10b6:8:17f::14) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.7339.24; Fri, 1 Mar
 2024 10:22:09 +0000
Received: from LV8PR11MB8700.namprd11.prod.outlook.com
 ([fe80::bef5:e3b9:4214:8eda]) by LV8PR11MB8700.namprd11.prod.outlook.com
 ([fe80::bef5:e3b9:4214:8eda%6]) with mapi id 15.20.7339.009; Fri, 1 Mar 2024
 10:22:09 +0000
From: <Raju.Lakkaraju@microchip.com>
To: <andrew@lunn.ch>
CC: <netdev@vger.kernel.org>, <davem@davemloft.net>, <kuba@kernel.org>,
	<linux-kernel@vger.kernel.org>, <Bryan.Whitehead@microchip.com>,
	<richardcochran@gmail.com>, <UNGLinuxDriver@microchip.com>
Subject: RE: [PATCH net 3/3] net: lan743x: Address problems with wake option
 flags configuration sequences
Thread-Topic: [PATCH net 3/3] net: lan743x: Address problems with wake option
 flags configuration sequences
Thread-Index: AQHaaIt96K5hsZSvW06kwmptrB0k3LEdb70AgAOX2pCAAGkJgIABOvSQ
Date: Fri, 1 Mar 2024 10:22:09 +0000
Message-ID: <LV8PR11MB8700FC048AB32D6E7168855E9F5E2@LV8PR11MB8700.namprd11.prod.outlook.com>
References: <20240226080934.46003-1-Raju.Lakkaraju@microchip.com>
 <20240226080934.46003-4-Raju.Lakkaraju@microchip.com>
 <b83b74b7-3221-4747-8b71-17738c18c042@lunn.ch>
 <LV8PR11MB8700C2F9461F4200431446D49F5F2@LV8PR11MB8700.namprd11.prod.outlook.com>
 <e038ec4e-c54d-4628-8997-90510c0d96ab@lunn.ch>
In-Reply-To: <e038ec4e-c54d-4628-8997-90510c0d96ab@lunn.ch>
Accept-Language: en-GB, en-US
Content-Language: en-US
X-MS-Has-Attach: yes
X-MS-TNEF-Correlator:
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=microchip.com;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: LV8PR11MB8700:EE_|DM4PR11MB8089:EE_
x-ms-office365-filtering-correlation-id: 88a20d2a-cac3-4e04-4800-08dc39d9740f
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: YmgOyZUP34tXljCfG52u1/2ugzjcivCqxz8IRvwPMGJjd/KxSmA0gvpHvnRi3BybcJua12RTnSNdrNG6f2mHus41OQEWl6lzyDZMMwrD5tJ9YdvDNvygub04jmH3GfV2UcA4XVpMVB9qnSFfVqv/2A2ZbyBIaAX/oAAQLCAbLym/49/Zq9SKmndNyrcEkgUxkdPrC6Ny2vYZYINoIrHpvEnTLg8WB2kxnUCJ8ay3uBdZnuY0rO50THDfQURe6OH2edjEKkzY1zwTeNHQclJAplFEtTChfWVnFXIN8SgoUROmN8wxKJTQ0+VYTbnAdVQZ5NwSMVUnZ+68cie2zXinC1LjNcczLrk9ehDVeUaJR45MyJg76UklWXsD4ZhGjNop0sCpqvVOnYp/nr4LloJCYOBTmYCGbCeXu8Qdd3I0OP3npdyYtZmcm1/ZS8QGp4FNL+SegKzKIX8TmyCUiw6D/lVDkyx8tbc/RVtoLuU+9xFMXsOxC5pp5r6DQEY0Dn5+DklqB5WfKLD9FojTJpEvaxKscUlxOYJGy44XKytMx2w8i9wQ7t0Ne0PK3fi8o/dqhGRgNz1PclEv/IiQc3BaxFjsUh/01oEsugv5a8XdGDKcmyBnNuzQJYPAEtJ7/zH3Ig3p9jzfh5aIvum3OUkqcf/D1sva9DMSbDkjyntu2qENhviX9LwcP3hvVmO8zBfybdVx104jJ9DL0LAPiwzvf25BXdxjhGhs0XoV6Rh8bZA=
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:LV8PR11MB8700.namprd11.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230031)(38070700009);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?M01mME9OTlVlbFNRazB5V0I0MHVCRkJpQnFZeWQ2TDBSZzdoZDZYZS8ybkNH?=
 =?utf-8?B?YkR6OXhET1UyVzVjRmxWK1JQdnlzNWE5WktoZnpSeENURldkZm5hL3MydUVV?=
 =?utf-8?B?VHdYcDE2TVgvaVMvYUVUMm5BL2N4Qm85amlQb1AxbFJ3OWg0R0tpKzJndmJa?=
 =?utf-8?B?Qjd6SXQwZ3U3U2lHTnljTllJbWIwL0gxZnlYME5ZeXNuaFpRMUJrblB2T2pD?=
 =?utf-8?B?SVVCRW5NUjRMTUsxZ1owUGlBUklmb1ZkMS9GQ09QTDFpSUkvd1pBaGUwVTdS?=
 =?utf-8?B?a3E2Vk1QQkFoSkkyQmd1V21JOUlhMTgzRFYwTXlaVXY2b0svcWlDdVZOWTRr?=
 =?utf-8?B?akVvNVlYcmF0VDA2YmNMRmxQQXBMS3BISkJERnFWYi9BcTNXOEFNZHJkYUxx?=
 =?utf-8?B?OXNDV0pUZlFMZnpYRWlPekl1eGFlRnNqYTdjVXhpTkwrdnlSWEozQXdlRXdp?=
 =?utf-8?B?ektGMDFzMDNQRnd2M0VMcldFN1dGVkRWS1poVWlNalJLMVMza3hnSkJqZ2kw?=
 =?utf-8?B?L0U5NkRFSW9KOUlVNGk2S1NQV3VvVEZENE4vbFNtNy9mMnlJUjVWK2FMNXJM?=
 =?utf-8?B?M253RGhJQ0JVTDUrMmRramNLdkJ6akhtZ2lLZ1dtT1JRS2d4VXZUV25lWDhR?=
 =?utf-8?B?ekh6Z3ZIcnR3VjRIcUxhSXE0Qi9mblBTMDJqSVNJRlFjTmJ4cG1LYzZCT3NC?=
 =?utf-8?B?d3lFTUZ5bVRHRHA3enhJSFZ2L3czM1NBeC9EU1NRRFFPUUR3S2pLdllWemZZ?=
 =?utf-8?B?Sk9wNlBUV1ZvWlkwQVNlUndlSDRHTVlOai94ZVYrOEdPa3lzQWNoU3gydWRF?=
 =?utf-8?B?QTlkSktrRURPRmRyVVdGTUdMQVdISllDbWxBZW1VV0tzdktYZ0JJVWlSbVla?=
 =?utf-8?B?cVprYlh5b01zWGx6UjV0Um15YURWWnJFUDIxNC9zK0NVN0hYY1VjdS83NEdk?=
 =?utf-8?B?bkRaNGlJS2NDSlk3bSsvTTV6ajJxL1FHZXZTRzBnbjBBaG9GU1RDNE01WjhZ?=
 =?utf-8?B?akQ4QmR1M0c2NmV4YWREazU3WUpoWHN0anNQR3VHaHZUM0tWVWlSNE1rdm1t?=
 =?utf-8?B?TzNtemZCQUswODgrcFpuRndoNU12RG9Bb3UzNDg0YWpHN0dPbXZVOGYyL2hW?=
 =?utf-8?B?cjFJNWxsSEtHQjdSYUdpQ1VLTVJ3RkZjeW1DYzYvaGQyS3ppQmV3aTF2RmJ2?=
 =?utf-8?B?UXFSTjNKSHlJVzNwRW92OWZoeU9QSFZ0L25lTWthSjdlRlU1cWZBcVhKUi8z?=
 =?utf-8?B?bjBGVzd1bndFcmtoRVdncmo5dzBjRVZ5cTBHaU1YZHk0WVJlRjhLZm5ReW9v?=
 =?utf-8?B?S3dXMURNbVdibzVDU1o5ZlRMQWRjb3FWb05pZ0lnVFdqVmFQR0NTYW45NGZn?=
 =?utf-8?B?Rmg5QUtrb3VEaWRTM3QwOUt2cDZEL21zZUFiREJuemNSanBTckVSUXgyVmdQ?=
 =?utf-8?B?STMxYnRVZEJNenNIcXVFV2NmUDdKeE5zTEdBaEtVbUdIaHJ1RUpCY2UvRjNt?=
 =?utf-8?B?U3pGbjEvd0xBbmlFRWx3eTVaQXBzajVjY3NDcFBqZnRDckQ0Zm9MaXdXRDhL?=
 =?utf-8?B?T3J5aVpJZUw5YVg5ak90MDdxRmh5a3JsWWx1OWhjMTNlSnJrY1dXbkM2d0NI?=
 =?utf-8?B?Z1VFUUhNbHNQSWI4WkdibWVkY0M4cURveklZaDN0WU1MbUhUQmJnU1VVZ3hE?=
 =?utf-8?B?L21SU3lMd2g4WENseUkreEkvT3pyTEVaV2s5Sk5mbWJpcUcva05nTDN5UEJK?=
 =?utf-8?B?TW5iYVR1RWxZckE4YmZYblR3bXNqNkdLdGJ1MGhucmdOWGJUYjMrSUNZMGxa?=
 =?utf-8?B?NUlHZHZZNGErdWltWHJwcHNSWDlmYllObndCMTI2dUtiaDdHVkJUMDVRYVEy?=
 =?utf-8?B?WHQyQy9SbEhaYWdOYmF3aWgyWmFtSTFvSnFzSVpEV0hpRlJKVTBUTzlyU2JG?=
 =?utf-8?B?TnNHVVZ0M0s5elJ6allxZXV6dEcrRkxaTmFxalI2M0FBcWNyRi9pcnhIQm04?=
 =?utf-8?B?TFlRaHBCb3FoSkNkaFkzaVIwc3pld0tJNGZ4ZUIwR2FGZDhjdlU0dDdGeHRV?=
 =?utf-8?B?QkZzdmk1bWtWdUNYSm9xcDFEVWMxOHAwMXRMRXNWLzFzaTlJcUQwaE5GQllS?=
 =?utf-8?B?bVdyYnZTR3hpS3JZZm5FMFVuYUZHZU1yNUJVUTM1RFdhbWdveXluYURtM2hm?=
 =?utf-8?B?Rmc9PQ==?=
Content-Type: multipart/mixed;
	boundary="_002_LV8PR11MB8700FC048AB32D6E7168855E9F5E2LV8PR11MB8700namp_"
Precedence: bulk
X-Mailing-List: linux-kernel@vger.kernel.org
List-Id: <linux-kernel.vger.kernel.org>
List-Subscribe: <mailto:linux-kernel+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-kernel+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: LV8PR11MB8700.namprd11.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 88a20d2a-cac3-4e04-4800-08dc39d9740f
X-MS-Exchange-CrossTenant-originalarrivaltime: 01 Mar 2024 10:22:09.7319
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3f4057f3-b418-4d4e-ba84-d55b4e897d88
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 5WIq/YHnfKvXUaS4c96Opv/wP+IQu4aKAlZIRQpaDUwOyYPnJWrSi767S6PnLZUaVI0ftgyeUbuJPkhEHZ9Oy3GwUPpecRydGi0u+ute3I8=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM4PR11MB8089

--_002_LV8PR11MB8700FC048AB32D6E7168855E9F5E2LV8PR11MB8700namp_
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

SGkgQW5kcmV3LA0KDQo+IC0tLS0tT3JpZ2luYWwgTWVzc2FnZS0tLS0tDQo+IEZyb206IEFuZHJl
dyBMdW5uIDxhbmRyZXdAbHVubi5jaD4NCj4gU2VudDogVGh1cnNkYXksIEZlYnJ1YXJ5IDI5LCAy
MDI0IDg6MzYgUE0NCj4gVG86IFJhanUgTGFra2FyYWp1IC0gSTMwNDk5IDxSYWp1Lkxha2thcmFq
dUBtaWNyb2NoaXAuY29tPg0KPiBDYzogbmV0ZGV2QHZnZXIua2VybmVsLm9yZzsgZGF2ZW1AZGF2
ZW1sb2Z0Lm5ldDsga3ViYUBrZXJuZWwub3JnOyBsaW51eC0NCj4ga2VybmVsQHZnZXIua2VybmVs
Lm9yZzsgQnJ5YW4gV2hpdGVoZWFkIC0gQzIxOTU4DQo+IDxCcnlhbi5XaGl0ZWhlYWRAbWljcm9j
aGlwLmNvbT47IHJpY2hhcmRjb2NocmFuQGdtYWlsLmNvbTsNCj4gVU5HTGludXhEcml2ZXIgPFVO
R0xpbnV4RHJpdmVyQG1pY3JvY2hpcC5jb20+DQo+IFN1YmplY3Q6IFJlOiBbUEFUQ0ggbmV0IDMv
M10gbmV0OiBsYW43NDN4OiBBZGRyZXNzIHByb2JsZW1zIHdpdGggd2FrZSBvcHRpb24NCj4gZmxh
Z3MgY29uZmlndXJhdGlvbiBzZXF1ZW5jZXMNCj4gDQo+IEVYVEVSTkFMIEVNQUlMOiBEbyBub3Qg
Y2xpY2sgbGlua3Mgb3Igb3BlbiBhdHRhY2htZW50cyB1bmxlc3MgeW91IGtub3cgdGhlDQo+IGNv
bnRlbnQgaXMgc2FmZQ0KPiANCj4gT24gVGh1LCBGZWIgMjksIDIwMjQgYXQgMDg6NTk6MjBBTSAr
MDAwMCwgUmFqdS5MYWtrYXJhanVAbWljcm9jaGlwLmNvbQ0KPiB3cm90ZToNCj4gPiBIaSBBbmRy
ZXcsDQo+ID4NCj4gPiBUaGFuayB5b3UgZm9yIHJldmlldyBjb21tZW50cy4NCj4gPg0KPiA+ID4g
LS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gPiA+IEZyb206IEFuZHJldyBMdW5uIDxhbmRy
ZXdAbHVubi5jaD4NCj4gPiA+IFNlbnQ6IFR1ZXNkYXksIEZlYnJ1YXJ5IDI3LCAyMDI0IDc6Mjgg
QU0NCj4gPiA+IFRvOiBSYWp1IExha2thcmFqdSAtIEkzMDQ5OSA8UmFqdS5MYWtrYXJhanVAbWlj
cm9jaGlwLmNvbT4NCj4gPiA+IENjOiBuZXRkZXZAdmdlci5rZXJuZWwub3JnOyBkYXZlbUBkYXZl
bWxvZnQubmV0OyBrdWJhQGtlcm5lbC5vcmc7DQo+ID4gPiBsaW51eC0ga2VybmVsQHZnZXIua2Vy
bmVsLm9yZzsgQnJ5YW4gV2hpdGVoZWFkIC0gQzIxOTU4DQo+ID4gPiA8QnJ5YW4uV2hpdGVoZWFk
QG1pY3JvY2hpcC5jb20+OyByaWNoYXJkY29jaHJhbkBnbWFpbC5jb207DQo+ID4gPiBVTkdMaW51
eERyaXZlciA8VU5HTGludXhEcml2ZXJAbWljcm9jaGlwLmNvbT4NCj4gPiA+IFN1YmplY3Q6IFJl
OiBbUEFUQ0ggbmV0IDMvM10gbmV0OiBsYW43NDN4OiBBZGRyZXNzIHByb2JsZW1zIHdpdGgNCj4g
PiA+IHdha2Ugb3B0aW9uIGZsYWdzIGNvbmZpZ3VyYXRpb24gc2VxdWVuY2VzDQo+ID4gPg0KPiA+
ID4gRVhURVJOQUwgRU1BSUw6IERvIG5vdCBjbGljayBsaW5rcyBvciBvcGVuIGF0dGFjaG1lbnRz
IHVubGVzcyB5b3UNCj4gPiA+IGtub3cgdGhlIGNvbnRlbnQgaXMgc2FmZQ0KPiA+ID4NCj4gPiA+
IE9uIE1vbiwgRmViIDI2LCAyMDI0IGF0IDAxOjM5OjM0UE0gKzA1MzAsIFJhanUgTGFra2FyYWp1
IHdyb3RlOg0KPiA+ID4gPiBXYWtlIG9wdGlvbnMgaGFuZGxpbmcgaGFzIGJlZW4gcmV3b3JrZWQg
YXMgZm9sbG93czoNCj4gPiA+ID4gYS4gV2Ugb25seSBlbmFibGUgc2VjdXJlIG9uIG1hZ2ljIHBh
Y2tldCB3aGVuIGJvdGggc2VjdXJlIGFuZCBtYWdpYw0KPiB3b2wNCj4gPiA+ID4gICAgb3B0aW9u
cyBhcmUgcmVxdWVzdGVkIHRvZ2V0aGVyLg0KPiA+ID4gPiBiLiBJZiBzZWN1cmUtb24gbWFnaWMg
cGFja2V0IGhhZCBiZWVuIHByZXZpb3VzbHkgZW5hYmxlZCwgYW5kIGENCj4gPiA+IHN1YnNlcXVl
bnQNCj4gPiA+ID4gICAgY29tbWFuZCBkb2VzIG5vdCBpbmNsdWRlIGl0LCB3ZSBhZGQgaXQuIFRo
aXMgd2FzIGRvbmUgdG8gd29ya2Fyb3VuZA0KPiBhDQo+ID4gPiA+ICAgIHByb2JsZW0gd2l0aCB0
aGUgJ3BtLXN1c3BlbmQnIGFwcGxpY2F0aW9uIHdoaWNoIGlzIHVuYXdhcmUgb2YNCj4gc2VjdXJl
LW9uDQo+ID4gPiA+ICAgIG1hZ2ljIHBhY2tldCBiZWluZyBlbmFibGVkIGFuZCBjYW4gdW5pbnRl
bnRpb25hbGx5IGRpc2FibGUgaXQgcHJpb3IgdG8NCj4gPiA+ID4gICAgcHV0dGluZyB0aGUgc3lz
dGVtIGludG8gc3VzcGVuZC4NCj4gPiA+DQo+ID4gPiBUaGlzIHNlZW1zIHRvIGJlIGluIGEgYml0
IG9mIGEgZ3JleSBhcmVhLiBCdXQgZXRodG9vbCBzYXlzOg0KPiA+ID4NCj4gPiA+ICAgICAgICAg
ICAgd29sIHB8dXxtfGJ8YXxnfHN8ZnxkLi4uDQo+ID4gPiAgICAgICAgICAgICAgICAgICBTZXRz
ICBXYWtlLW9uLUxBTiAgb3B0aW9ucy4gICBOb3QgIGFsbCBkZXZpY2VzIHN1cHBvcnQgdGhpcy4N
Cj4gPiA+ICAgICAgICAgICAgICAgICAgIFRoZSBhcmd1bWVudCB0byB0aGlzIG9wdGlvbiBpcyBh
IHN0cmluZyBvZiBjaGFyYWN0ZXJzIHNwZWNp4oCQDQo+ID4gPiAgICAgICAgICAgICAgICAgICBm
eWluZyB3aGljaCBvcHRpb25zIHRvIGVuYWJsZS4NCj4gPiA+ICAgICAgICAgICAgICAgICAgIHAg
ICBXYWtlIG9uIFBIWSBhY3Rpdml0eQ0KPiA+ID4gICAgICAgICAgICAgICAgICAgdSAgIFdha2Ug
b24gdW5pY2FzdCBtZXNzYWdlcw0KPiA+ID4gICAgICAgICAgICAgICAgICAgbSAgIFdha2Ugb24g
bXVsdGljYXN0IG1lc3NhZ2VzDQo+ID4gPiAgICAgICAgICAgICAgICAgICBiICAgV2FrZSBvbiBi
cm9hZGNhc3QgbWVzc2FnZXMNCj4gPiA+ICAgICAgICAgICAgICAgICAgIGEgICBXYWtlIG9uIEFS
UA0KPiA+ID4gICAgICAgICAgICAgICAgICAgZyAgIFdha2Ugb24gTWFnaWNQYWNrZXTihKINCj4g
PiA+ICAgICAgICAgICAgICAgICAgIHMgICBFbmFibGUgU2VjdXJlT27ihKIgcGFzc3dvcmQgZm9y
IE1hZ2ljUGFja2V04oSiDQo+ID4gPiAgICAgICAgICAgICAgICAgICBmICAgV2FrZSBvbiBmaWx0
ZXIocykNCj4gPiA+ICAgICAgICAgICAgICAgICAgIGQgICBEaXNhYmxlICh3YWtlIG9uICBub3Ro
aW5nKS4gICBUaGlzICBvcHRpb24NCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICBjbGVhcnMg
YWxsIHByZXZpb3VzIG9wdGlvbnMuDQo+ID4gPg0KPiA+ID4gZCBjbGVhcnMgZXZlcnl0aGluZy4g
QWxsIG90aGVyIHRoaW5ncyBlbmFibGUgb25lIG9wdGlvbi4gVGhlcmUgZG9lcw0KPiA+ID4gbm90
IGFwcGVhciB0byBiZSBhIHdheSB0byBkaXNhYmxlIGEgc2luZ2xlIG9wdGlvbiwgYW5kIGkgd291
bGQgc2F5LA0KPiA+ID4gYWRkaW5nIG9wdGlvbnMgaXMgaW5jcmVtZW50YWwuDQo+ID4gPg0KPiA+
DQo+ID4gWWVzLiAiZCIgY2xlYXJzIGV2ZXJ5dGhpbmcuDQo+ID4gQnV0LCBpZiB3ZSBlbmFibGUg
ImciIHRoZW4gZW5hYmxlICJhIiwgImciIG9wdGlvbiBvdmVyd3JpdHRlbiBieSAiYSINCj4gDQo+
IFRoaXMgaXMgd2hlcmUgaSBzYXkgaXQgaXMgYSBiaXQgb2YgYSBncmV5IGFyZWEuIEZvciBtZSwg
dGhleSBhcmUgaW5jcmVtZW50YWwuIFlvdQ0KPiBjYW4gZW5hYmxlIGEgYW5kIHRoZW4gbGF0ZXIg
ZW5hYmxlIGcsIGFuZCB5b3Ugc2hvdWxkIGhhdmUgYm90aCBlbmFibGVkLg0KPiANCg0KWWVzLiBC
dXQsIGl0J3MgIkV0aHRvb2wiIGlzc3VlLg0KRXZlbiB0aG91Z2ggZXRodG9vbCBnZXQgdGhlIFdP
TCBjb25maWd1cmF0aW9uIGJlZm9yZSB0byBzZXQsIG92ZXIgd3JpdHRlbiB3aXRoIHdhbnRlZCB3
b2wgcmVxdWVzdCBjb25maWd1cmF0aW9uLg0KDQo+ID4gUGxlYXNlIGZpbmQgdGhlIGF0dGFjaGVk
IGxvZyBpbmZvcm1hdGlvbg0KPiA+ID4gU286DQo+ID4gPg0KPiA+ID4gPiBhLiBXZSBvbmx5IGVu
YWJsZSBzZWN1cmUgb24gbWFnaWMgcGFja2V0IHdoZW4gYm90aCBzZWN1cmUgYW5kIG1hZ2ljDQo+
IHdvbA0KPiA+ID4gPiAgICBvcHRpb25zIGFyZSByZXF1ZXN0ZWQgdG9nZXRoZXIuDQo+ID4gPg0K
PiA+ID4gSSBkb24ndCB0aGluayB0aGV5IG5lZWQgdG8gYmUgcmVxdWVzdGVkIHRvZ2V0aGVyLiBJ
IHRoaW5rIHlvdSBjYW4NCj4gPiA+IGZpcnN0IGVuYWJsZSBXYWtlIG9uIE1hZ2ljUGFja2V0IGFu
ZCB0aGVuIGluIGEgc2Vjb25kIGNhbGwgdG8NCj4gPiA+IGV0aHRvb2wgRW5hYmxlIFNlY3VyZU9u
IHBhc3N3b3JkIGZvciBNYWdpY1BhY2tldC4gSSBhbHNvIGRvbid0IHRoaW5rDQo+ID4gPiBpdCB3
b3VsZCB1bnJlYXNvbmFibGUgdG8gYWNjZXB0IEVuYWJsZSBTZWN1cmVPbiBwYXNzd29yZCBmb3IN
Cj4gPiA+IE1hZ2ljUGFja2V0IGFuZCBoYXZlIHRoYXQgaW1wbHkgV2FrZSBvbiBNYWdpY1BhY2tl
dC4NCj4gPiA+DQo+ID4NCj4gPiBJZiB3ZSBuZWVkIHRvIGVuYWJsZSBhbnkgMiBvcHRpb25zLCB3
ZSBoYXZlIHRvIHByb3ZpZGUgYm90aCBvcHRpb25zDQo+IHRvZ2V0aGVyLg0KPiA+IGkuZS4NCj4g
PiBzdWRvIGV0aHRvb2wgLXMgZW5wOXMwIHdvbCBnYQ0KPiANCj4gd2hpY2ggaSB0aGluayBpcyB3
cm9uZy4gQSBkcml2ZXIgc2hvdWxkIGFsbG93IGluY3JlbWVudGFsIGFkZGluZyBXb0wgb3B0aW9u
cy4NCj4gDQoNCk9rLg0KDQo+ID4NCj4gPiA+IEFuZDoNCj4gPiA+DQo+ID4gPiA+IGIuIElmIHNl
Y3VyZS1vbiBtYWdpYyBwYWNrZXQgaGFkIGJlZW4gcHJldmlvdXNseSBlbmFibGVkLCBhbmQgYQ0K
PiA+ID4gc3Vic2VxdWVudA0KPiA+ID4gPiAgICBjb21tYW5kIGRvZXMgbm90IGluY2x1ZGUgaXQs
IHdlIGFkZCBpdC4NCj4gPiA+DQo+ID4gPiBJZiB0aGVyZSBoYXMgbm90IGJlZW4gYSBkLCBzZWN1
cmUtb24gbWFnaWMgcGFja2V0IHNob3VsZCByZW1haW4NCj4gPiA+IGVuYWJsZWQgdW50aWwgdGhl
cmUgaXMgYSBkLg0KPiA+ID4NCj4gPg0KPiA+IFRoaXMgaXMgbm90IGhhcHBlbmVkIHdpdGggZXhp
c3RpbmcgIkV0aHRvb2wiLg0KPiA+IFBsZWFzZSBmaW5kIHRoZSBsb2cgaW5mb3JtYXRpb24gaW4g
YW4gYXR0YWNobWVudCBmaWxlLg0KPiANCj4gVGhhdCBjb3VsZCBqdXN0IGJlIGEgZHJpdmVyIGJ1
Zy4NCj4gDQo+IFRha2UgYSBzdGVwIGJhY2suIElzIHRoZXJlIGFueSBjbGVhciBkb2N1bWVudGF0
aW9uIGFib3V0IGhvdyBldGh0b29sIC1zIHdvbA0KPiBzaG91bGQgcmVhbGx5IHdvcms/IEFueSBj
b21tZW50cyBpbiB0aGUgY29kZT8gQW55IG1hbiBwYWdlDQo+IGRvY3VtZW50YXRpb24uDQo+IA0K
DQpJJ20gbm90IGFibGUgdG8gZmluZCAgYW55IG1vcmUgImV0aHRvb2wiIGRvY3VtZW50YXRpb25z
IG90aGVyIHRoYW4gZXRodG9vbCBtYW4gcGFnZS4NCg0KSSBoYXZlIGdvbmUgdGhyb3VnaCB0aGUg
ZXRodG9vbCBhcHBsaWNhdGlvbiBjb2RlLg0KKGdpdDovL2dpdC5rZXJuZWwub3JnL3B1Yi9zY20v
bmV0d29yay9ldGh0b29sL2V0aHRvb2wuZ2l0KSBhbmQgY2hlY2sgdGhlIFdPTCBvcHRpb25zLg0K
DQpJbiBpb2N0bCBtZXRob2QgKE5vdCBuZXRsaW5rKSwgZG9fc3NldCggKSBmdW5jdGlvbiwgYmVm
b3JlIHNldCB0aGUgcGFyYW1ldGVycywgZmlyc3QgZ2V0IHRoZSBXT0wgY29uZmlndXJhdGlvbi4N
CihpLmUuIGluIGV0aHRvb2wuYyBmaWxlLCBMaW5lIG5vLiAzMjk0KQ0KDQpUaGVuLCBhc3NpZ24v
b3ZlcndyaXRlIFdPTCB3YW50ZWQgY29uZmlnIHRvIHdvbG9wdHMgcGFyYW1ldGVyLg0KDQpFeGlz
dGluZyBDb2RlOiAgRnJvbSBMaW5lIDMyOTAgLSAgMzMxMg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMNCjMyOTAg
ICAgICAgICBpZiAoZ3dvbF9jaGFuZ2VkKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICANCjMyOTEgICAgICAgICAgICAgICAgIHN0cnVjdCBldGh0
b29sX3dvbGluZm8gd29sOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCjMy
OTIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICANCjMyOTMgICAgICAgICAgICAgICAgIHdvbC5jbWQg
PSBFVEhUT09MX0dXT0w7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAN
CjMyOTQgICAgICAgICAgICAgICAgIGVyciA9IHNlbmRfaW9jdGwoY3R4LCAmd29sKTsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCjMyOTUgICAgICAgICAgICAgICAgIGlmIChl
cnIgPCAwKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICANCjMyOTYgICAgICAgICAgICAgICAgICAgICAgICAgcGVycm9yKCJDYW5ub3QgZ2V0IGN1cnJl
bnQgd2FrZS1vbi1sYW4gc2V0dGluZ3MiKTsgICAgICANCjMyOTcgICAgICAgICAgICAgICAgIH0g
ZWxzZSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICANCjMyOTggICAgICAgICAgICAgICAgICAgICAgICAgLyogQ2hhbmdlIGV2ZXJ5dGhpbmcg
dGhlIHVzZXIgc3BlY2lmaWVkLiAqLyAgICAgICAgICAgICANCjMyOTkgICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKHdvbF9jaGFuZ2UpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICANCjMzMDAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b2wud29sb3B0
cyA9IHdvbF93YW50ZWQ7ICAgICAgICAgICAgICAgICAgICAgICANCjMzMDEgICAgICAgICAgICAg
ICAgICAgICAgICAgaWYgKHNvcGFzc19jaGFuZ2UpIHsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICANCjMzMDIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgaTsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCjMzMDMgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgU09QQVNTX01BWDsgaSsrKSAg
ICAgICAgICAgICAgICANCjMzMDQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHdvbC5zb3Bhc3NbaV0gPSBzb3Bhc3Nfd2FudGVkW2ldOyAgICAgICANCjMzMDUgICAgICAg
ICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICANCjMzMDYgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCjMzMDcgICAg
ICAgICAgICAgICAgICAgICAgICAgLyogVHJ5IHRvIHBlcmZvcm0gdGhlIHVwZGF0ZS4gKi8gICAg
ICAgICAgICAgICAgICAgICAgICANCjMzMDggICAgICAgICAgICAgICAgICAgICAgICAgd29sLmNt
ZCA9IEVUSFRPT0xfU1dPTDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCjMzMDkg
ICAgICAgICAgICAgICAgICAgICAgICAgZXJyID0gc2VuZF9pb2N0bChjdHgsICZ3b2wpOyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICANCjMzMTAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg
KGVyciA8IDApICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICANCjMz
MTEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJyb3IoIkNhbm5vdCBzZXQgbmV3
IHdha2Utb24tbGFuIHNldHRpbmdzIik7ICANCjMzMTIgICAgICAgICAgICAgICAgIH0NCiMjIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
IyMjIyMjIyMjDQpDdXJyZW50IGlzc3VlIGlzIG92ZXJ3cml0aW5nIHdvbG9wdHMgd2l0aCB3b2xf
d2FudGVkDQppLmUuDQozMzAwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29sLndv
bG9wdHMgPSB3b2xfd2FudGVkOyAgICAgICAgICAgICAgICAgICAgICAgDQoNCkluc3RlYWQgb2Yg
b3ZlciB3cml0ZSwgTmVlZCB0byAiT1IiIHRoZSB3b2xvcHRzIGFuZCB3b2xfd2FudGVkDQppLmUu
DQozMzAwICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29sLndvbG9wdHMgfD0gd29s
X3dhbnRlZA0KIA0KRmluYWwgY29kZSBjaGFuZ2VzIHNob3VsZCBiZToNCiMjIyMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
DQozMjkwICAgICAgICAgaWYgKGd3b2xfY2hhbmdlZCkgeyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQozMjkxICAgICAgICAgICAgICAgICBzdHJ1
Y3QgZXRodG9vbF93b2xpbmZvIHdvbDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgDQozMjkyICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQozMjkzICAgICAgICAgICAgICAgICB3
b2wuY21kID0gRVRIVE9PTF9HV09MOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgDQozMjk0ICAgICAgICAgICAgICAgICBlcnIgPSBzZW5kX2lvY3RsKGN0eCwgJndvbCk7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQozMjk1ICAgICAgICAgICAgICAg
ICBpZiAoZXJyIDwgMCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgDQozMjk2ICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnJvcigiQ2Fubm90IGdl
dCBjdXJyZW50IHdha2Utb24tbGFuIHNldHRpbmdzIik7ICAgICAgDQozMjk3ICAgICAgICAgICAg
ICAgICB9IGVsc2UgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgDQozMjk4ICAgICAgICAgICAgICAgICAgICAgICAgIC8qIENoYW5nZSBldmVy
eXRoaW5nIHRoZSB1c2VyIHNwZWNpZmllZC4gKi8gICAgICAgICAgICAgDQozMjk5ICAgICAgICAg
ICAgICAgICAgICAgICAgIGlmICh3b2xfY2hhbmdlICAmJiB3b2xfd2FudGVkKSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQozMzAwICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgd29sLndvbG9wdHMgfD0gd29sX3dhbnRlZDsNCgkJICAgICBlbHNlIGlmICh3
b2xfY2hhbmdlICAmJiAhd29sX3dhbnRlZCkNCgkJCXdvbC53b2xvcHRzID0gMCAgICAgICAgICAg
ICAgICAgICAgICAgDQozMzAxICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3Bhc3NfY2hh
bmdlKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQozMzAyICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgaW50IGk7ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgDQozMzAzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9y
IChpID0gMDsgaSA8IFNPUEFTU19NQVg7IGkrKykgICAgICAgICAgICAgICAgDQozMzA0ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b2wuc29wYXNzW2ldID0gc29wYXNz
X3dhbnRlZFtpXTsgICAgICAgDQozMzA1ICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQozMzA2ICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgDQozMzA3ICAgICAgICAgICAgICAgICAgICAgICAgIC8qIFRy
eSB0byBwZXJmb3JtIHRoZSB1cGRhdGUuICovICAgICAgICAgICAgICAgICAgICAgICAgDQozMzA4
ICAgICAgICAgICAgICAgICAgICAgICAgIHdvbC5jbWQgPSBFVEhUT09MX1NXT0w7ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgDQozMzA5ICAgICAgICAgICAgICAgICAgICAgICAgIGVy
ciA9IHNlbmRfaW9jdGwoY3R4LCAmd29sKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQoz
MzEwICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIgPCAwKSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgDQozMzExICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgcGVycm9yKCJDYW5ub3Qgc2V0IG5ldyB3YWtlLW9uLWxhbiBzZXR0aW5ncyIpOyAg
DQozMzEyICAgICAgICAgICAgICAgICB9DQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQpTaW1pbGFyIGNoYW5n
ZXMgcmVxdWlyZSBpbiBuZXRsaW5rIGZ1bmN0aW9ucyBhbHNvLiANCg0KPiBMZXRzIGZpcnN0IHVu
ZGVyc3RhbmQgaG93IGl0IGlzIGV4cGVjdGVkIHRvIHdvcmsuIFRoZW4gd2UgY2FuIGRlY2lkZWQg
aWYgdGhlDQo+IGRyaXZlciBpcyBpbXBsZW1lbnRpbmcgaXQgY29ycmVjdGx5Lg0KPiANCj4gICAg
QW5kcmV3DQoNClBsZWFzZSBmaW5kIHRoZSAiZXRodG9vbCIgYXBwbGljYXRpb24gY29kZSBtYWlu
IGZpbGUgYXMgYXR0YWNobWVudCBmaWxlLg0KDQpUaGFua3MsDQpSYWp1DQo=

--_002_LV8PR11MB8700FC048AB32D6E7168855E9F5E2LV8PR11MB8700namp_
Content-Type: text/plain; name="ethtool.c"
Content-Description: ethtool.c
Content-Disposition: attachment; filename="ethtool.c"; size=161479;
	creation-date="Fri, 01 Mar 2024 10:11:52 GMT";
	modification-date="Fri, 01 Mar 2024 10:22:09 GMT"
Content-Transfer-Encoding: base64

LyoKICogZXRodG9vbC5jOiBMaW51eCBldGhlcm5ldCBkZXZpY2UgY29uZmlndXJhdGlvbiB0b29s
LgogKgogKiBDb3B5cmlnaHQgKEMpIDE5OTggRGF2aWQgUy4gTWlsbGVyIChkYXZlbUBkbS5jb2Jh
bHRtaWNyby5jb20pCiAqIFBvcnRpb25zIENvcHlyaWdodCAyMDAxIFN1biBNaWNyb3N5c3RlbXMK
ICogS2VybmVsIDIuNCB1cGRhdGUgQ29weXJpZ2h0IDIwMDEgSmVmZiBHYXJ6aWsgPGpnYXJ6aWtA
bWFuZHJha2Vzb2Z0LmNvbT4KICogV2FrZS1vbi1MQU4sbmF0c2VtaSxtaXNjIHN1cHBvcnQgYnkg
VGltIEhvY2tpbiA8dGhvY2tpbkBzdW4uY29tPgogKiBQb3J0aW9ucyBDb3B5cmlnaHQgMjAwMiBJ
bnRlbAogKiBQb3J0aW9ucyBDb3B5cmlnaHQgKEMpIFN1biBNaWNyb3N5c3RlbXMgMjAwOAogKiBk
b190ZXN0IHN1cHBvcnQgYnkgRWxpIEt1cGVybWFubiA8ZWxpLmt1cGVybWFubkBpbnRlbC5jb20+
CiAqIEVUSFRPT0xfUEhZU19JRCBzdXBwb3J0IGJ5IENocmlzIExlZWNoIDxjaHJpc3RvcGhlci5s
ZWVjaEBpbnRlbC5jb20+CiAqIGUxMDAwIHN1cHBvcnQgYnkgU2NvdHQgRmVsZG1hbiA8c2NvdHQu
ZmVsZG1hbkBpbnRlbC5jb20+CiAqIGUxMDAgc3VwcG9ydCBieSBXZW4gVGFvIDx3ZW4taHdhLnRh
b0BpbnRlbC5jb20+CiAqIGl4Z2Igc3VwcG9ydCBieSBOaWNob2xhcyBOdW5sZXkgPE5pY2hvbGFz
LmQubnVubGV5QGludGVsLmNvbT4KICogYW1kODExMWUgc3VwcG9ydCBieSBSZWVqYSBKb2huIDxy
ZWVqYS5qb2huQGFtZC5jb20+CiAqIGxvbmcgYXJndW1lbnRzIGJ5IEFuZGkgS2xlZW4uCiAqIFNN
U0MgTEFOOTExeCBzdXBwb3J0IGJ5IFN0ZXZlIEdsZW5kaW5uaW5nIDxzdGV2ZS5nbGVuZGlubmlu
Z0BzbXNjLmNvbT4KICogUnggTmV0d29yayBGbG93IENvbnRyb2wgY29uZmlndXJhdGlvbiBzdXBw
b3J0IDxzYW50d29uYS5iZWhlcmFAc3VuLmNvbT4KICogVmFyaW91cyBmZWF0dXJlcyBieSBCZW4g
SHV0Y2hpbmdzIDxiaHV0Y2hpbmdzQHNvbGFyZmxhcmUuY29tPjsKICoJQ29weXJpZ2h0IDIwMDks
IDIwMTAgU29sYXJmbGFyZSBDb21tdW5pY2F0aW9ucwogKiBNREktWCBzZXQgc3VwcG9ydCBieSBK
ZXNzZSBCcmFuZGVidXJnIDxqZXNzZS5icmFuZGVidXJnQGludGVsLmNvbT4KICoJQ29weXJpZ2h0
IDIwMTIgSW50ZWwgQ29ycG9yYXRpb24KICogdm14bmV0MyBzdXBwb3J0IGJ5IFNocmlrcmlzaG5h
IEtoYXJlIDxza2hhcmVAdm13YXJlLmNvbT4KICogVmFyaW91cyBmZWF0dXJlcyBieSBCZW4gSHV0
Y2hpbmdzIDxiZW5AZGVjYWRlbnQub3JnLnVrPjsKICoJQ29weXJpZ2h0IDIwMDgtMjAxMCwgMjAx
My0yMDE2IEJlbiBIdXRjaGluZ3MKICogUVNGUCsvUVNGUDI4IERPTSBzdXBwb3J0IGJ5IFZpZHlh
IFNhZ2FyIFJhdmlwYXRpIDx2aWR5YUBjdW11bHVzbmV0d29ya3MuY29tPgogKgogKiBUT0RPOgog
KiAgICogc2hvdyBzZXR0aW5ncyBmb3IgYWxsIGRldmljZXMKICovCgojaW5jbHVkZSAiaW50ZXJu
YWwuaCIKI2luY2x1ZGUgPHN0cmluZy5oPgojaW5jbHVkZSA8c3RyaW5ncy5oPgojaW5jbHVkZSA8
c3RkbGliLmg+CiNpbmNsdWRlIDxzeXMvc3RhdC5oPgojaW5jbHVkZSA8c3RkaW8uaD4KI2luY2x1
ZGUgPHN0ZGRlZi5oPgojaW5jbHVkZSA8c3RkYm9vbC5oPgojaW5jbHVkZSA8ZXJybm8uaD4KI2lu
Y2x1ZGUgPHN5cy91dHNuYW1lLmg+CiNpbmNsdWRlIDxsaW1pdHMuaD4KI2luY2x1ZGUgPGN0eXBl
Lmg+CiNpbmNsdWRlIDxpbnR0eXBlcy5oPgoKI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4KI2luY2x1
ZGUgPG5ldGluZXQvaW4uaD4KI2luY2x1ZGUgPGFycGEvaW5ldC5oPgoKI2luY2x1ZGUgPGxpbnV4
L2lvY3RsLmg+CiNpbmNsdWRlIDxsaW51eC9zb2NraW9zLmg+CiNpbmNsdWRlIDxsaW51eC9uZXRs
aW5rLmg+CgojaW5jbHVkZSAiY29tbW9uLmgiCiNpbmNsdWRlICJuZXRsaW5rL2V4dGFwaS5oIgoK
I2lmbmRlZiBNQVhfQUREUl9MRU4KI2RlZmluZSBNQVhfQUREUl9MRU4JMzIKI2VuZGlmCgojZGVm
aW5lIEtFUk5FTF9WRVJTSU9OKGEsYixjKSAoKChhKSA8PCAxNikgKyAoKGIpIDw8IDgpICsgKGMp
KQoKc3RhdGljIHZvaWQgZXhpdF9iYWRfYXJncyh2b2lkKSBfX2F0dHJpYnV0ZV9fKChub3JldHVy
bikpOwoKc3RhdGljIHZvaWQgZXhpdF9iYWRfYXJncyh2b2lkKQp7CglmcHJpbnRmKHN0ZGVyciwK
CQkiZXRodG9vbDogYmFkIGNvbW1hbmQgbGluZSBhcmd1bWVudChzKVxuIgoJCSJGb3IgbW9yZSBp
bmZvcm1hdGlvbiBydW4gZXRodG9vbCAtaFxuIik7CglleGl0KDEpOwp9CgpzdGF0aWMgdm9pZCBl
eGl0X25sb25seV9wYXJhbShjb25zdCBjaGFyICpuYW1lKSBfX2F0dHJpYnV0ZV9fKChub3JldHVy
bikpOwoKc3RhdGljIHZvaWQgZXhpdF9ubG9ubHlfcGFyYW0oY29uc3QgY2hhciAqbmFtZSkKewoJ
ZnByaW50ZihzdGRlcnIsCgkJImV0aHRvb2w6IHBhcmFtZXRlciAnJXMnIGNhbiBiZSB1c2VkIG9u
bHkgd2l0aCBuZXRsaW5rXG4iLAoJCW5hbWUpOwoJZXhpdCgxKTsKfQoKdHlwZWRlZiBlbnVtIHsK
CUNNRExfTk9ORSwKCUNNRExfQk9PTCwKCUNNRExfUzMyLAoJQ01ETF9VOCwKCUNNRExfVTE2LAoJ
Q01ETF9VMzIsCglDTURMX1U2NCwKCUNNRExfQkUxNiwKCUNNRExfSVA0LAoJQ01ETF9TVFIsCglD
TURMX0ZMQUcsCglDTURMX01BQywKfSBjbWRsaW5lX3R5cGVfdDsKCnN0cnVjdCBjbWRsaW5lX2lu
Zm8gewoJY29uc3QgY2hhciAqbmFtZTsKCWNtZGxpbmVfdHlwZV90IHR5cGU7CgkvKiBQb2ludHMg
dG8gaW50IChCT09MKSwgczMyLCB1MTYsIHUzMiAoVTMyL0ZMQUcvSVA0KSwgdTY0LAoJICogY2hh
ciAqIChTVFIpIG9yIHU4WzZdIChNQUMpLiAgRm9yIEZMQUcsIHRoZSB2YWx1ZSBhY2N1bXVsYXRl
cwoJICogYWxsIGZsYWdzIHRvIGJlIHNldC4gKi8KCXZvaWQgKndhbnRlZF92YWw7Cgl2b2lkICpp
b2N0bF92YWw7CgkvKiBGb3IgRkxBRywgdGhlIGZsYWcgdmFsdWUgdG8gYmUgc2V0L2NsZWFyZWQg
Ki8KCXUzMiBmbGFnX3ZhbDsKCS8qIEZvciBGTEFHLCBwb2ludHMgdG8gdTMyIGFuZCBhY2N1bXVs
YXRlcyBhbGwgZmxhZ3Mgc2Vlbi4KCSAqIEZvciBhbnl0aGluZyBlbHNlLCBwb2ludHMgdG8gaW50
IGFuZCBpcyBzZXQgaWYgdGhlIG9wdGlvbiBpcwoJICogc2Vlbi4gKi8KCXZvaWQgKnNlZW5fdmFs
Owp9OwoKc3RydWN0IGZlYXR1cmVfZGVmIHsKCWNoYXIgbmFtZVtFVEhfR1NUUklOR19MRU5dOwoJ
aW50IG9mZl9mbGFnX2luZGV4OyAvKiBpbmRleCBpbiBvZmZfZmxhZ19kZWY7IG5lZ2F0aXZlIGlm
IG5vbmUgbWF0Y2ggKi8KfTsKCnN0cnVjdCBmZWF0dXJlX2RlZnMgewoJc2l6ZV90IG5fZmVhdHVy
ZXM7CgkvKiBOdW1iZXIgb2YgZmVhdHVyZXMgZWFjaCBvZmZsb2FkIGZsYWcgaXMgYXNzb2NpYXRl
ZCB3aXRoICovCgl1bnNpZ25lZCBpbnQgb2ZmX2ZsYWdfbWF0Y2hlZFtPRkZfRkxBR19ERUZfU0la
RV07CgkvKiBOYW1lIGFuZCBvZmZsb2FkIGZsYWcgaW5kZXggZm9yIGVhY2ggZmVhdHVyZSAqLwoJ
c3RydWN0IGZlYXR1cmVfZGVmIGRlZlswXTsKfTsKCiNkZWZpbmUgRkVBVFVSRV9CSVRTX1RPX0JM
T0NLUyhuX2JpdHMpCQlESVZfUk9VTkRfVVAobl9iaXRzLCAzMlUpCiNkZWZpbmUgRkVBVFVSRV9X
T1JEKGJsb2NrcywgaW5kZXgsIGZpZWxkKQkoKGJsb2NrcylbKGluZGV4KSAvIDMyVV0uZmllbGQp
CiNkZWZpbmUgRkVBVFVSRV9GSUVMRF9GTEFHKGluZGV4KQkJKDFVIDw8IChpbmRleCkgJSAzMlUp
CiNkZWZpbmUgRkVBVFVSRV9CSVRfU0VUKGJsb2NrcywgaW5kZXgsIGZpZWxkKQkJCVwKCShGRUFU
VVJFX1dPUkQoYmxvY2tzLCBpbmRleCwgZmllbGQpIHw9IEZFQVRVUkVfRklFTERfRkxBRyhpbmRl
eCkpCiNkZWZpbmUgRkVBVFVSRV9CSVRfQ0xFQVIoYmxvY2tzLCBpbmRleCwgZmllbGQpCQkJXAoJ
KEZFQVRVUkVfV09SRChibG9ja3MsIGluZGV4LCBmaWxlZCkgJj0gfkZFQVRVUkVfRklFTERfRkxB
RyhpbmRleCkpCiNkZWZpbmUgRkVBVFVSRV9CSVRfSVNfU0VUKGJsb2NrcywgaW5kZXgsIGZpZWxk
KQkJXAoJKEZFQVRVUkVfV09SRChibG9ja3MsIGluZGV4LCBmaWVsZCkgJiBGRUFUVVJFX0ZJRUxE
X0ZMQUcoaW5kZXgpKQoKc3RhdGljIGxvbmcgbG9uZwpnZXRfaW50X3JhbmdlKGNoYXIgKnN0ciwg
aW50IGJhc2UsIGxvbmcgbG9uZyBtaW4sIGxvbmcgbG9uZyBtYXgpCnsKCWxvbmcgbG9uZyB2OwoJ
Y2hhciAqZW5kcDsKCglpZiAoIXN0cikKCQlleGl0X2JhZF9hcmdzKCk7CgllcnJubyA9IDA7Cgl2
ID0gc3RydG9sbChzdHIsICZlbmRwLCBiYXNlKTsKCWlmIChlcnJubyB8fCAqZW5kcCB8fCB2IDwg
bWluIHx8IHYgPiBtYXgpCgkJZXhpdF9iYWRfYXJncygpOwoJcmV0dXJuIHY7Cn0KCnN0YXRpYyB1
bnNpZ25lZCBsb25nIGxvbmcKZ2V0X3VpbnRfcmFuZ2UoY2hhciAqc3RyLCBpbnQgYmFzZSwgdW5z
aWduZWQgbG9uZyBsb25nIG1heCkKewoJdW5zaWduZWQgbG9uZyBsb25nIHY7CgljaGFyICplbmRw
OwoKCWlmICghc3RyKQoJCWV4aXRfYmFkX2FyZ3MoKTsKCWVycm5vID0gMDsKCXYgPSBzdHJ0b3Vs
bChzdHIsICZlbmRwLCBiYXNlKTsKCWlmIChlcnJubyB8fCAqZW5kcCB8fCB2ID4gbWF4KQoJCWV4
aXRfYmFkX2FyZ3MoKTsKCXJldHVybiB2Owp9CgpzdGF0aWMgaW50IGdldF9pbnQoY2hhciAqc3Ry
LCBpbnQgYmFzZSkKewoJcmV0dXJuIGdldF9pbnRfcmFuZ2Uoc3RyLCBiYXNlLCBJTlRfTUlOLCBJ
TlRfTUFYKTsKfQoKc3RhdGljIHUzMiBnZXRfdTMyKGNoYXIgKnN0ciwgaW50IGJhc2UpCnsKCXJl
dHVybiBnZXRfdWludF9yYW5nZShzdHIsIGJhc2UsIDB4ZmZmZmZmZmYpOwp9CgpzdGF0aWMgdm9p
ZCBnZXRfbWFjX2FkZHIoY2hhciAqc3JjLCB1bnNpZ25lZCBjaGFyICpkZXN0KQp7CglpbnQgY291
bnQ7CglpbnQgaTsKCWludCBidWZbRVRIX0FMRU5dOwoKCWNvdW50ID0gc3NjYW5mKHNyYywgIiUy
eDolMng6JTJ4OiUyeDolMng6JTJ4IiwKCQkmYnVmWzBdLCAmYnVmWzFdLCAmYnVmWzJdLCAmYnVm
WzNdLCAmYnVmWzRdLCAmYnVmWzVdKTsKCWlmIChjb3VudCAhPSBFVEhfQUxFTikKCQlleGl0X2Jh
ZF9hcmdzKCk7CgoJZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspCgkJZGVzdFtpXSA9IGJ1Zltp
XTsKfQoKc3RhdGljIGludCBwYXJzZV9oZXhfdTMyX2JpdG1hcChjb25zdCBjaGFyICpzLAoJCQkJ
dW5zaWduZWQgaW50IG5iaXRzLCB1MzIgKnJlc3VsdCkKewoJY29uc3QgdW5zaWduZWQgaW50IG53
b3JkcyA9IF9fS0VSTkVMX0RJVl9ST1VORF9VUChuYml0cywgMzIpOwoJc2l6ZV90IHNsZW4gPSBz
dHJsZW4ocyk7CglzaXplX3QgaTsKCgkvKiBpZ25vcmUgb3B0aW9uYWwgJzB4JyBwcmVmaXggKi8K
CWlmICgoc2xlbiA+IDIpICYmIChzdHJuY2FzZWNtcChzLCAiMHgiLCAyKSA9PSAwKSkgewoJCXNs
ZW4gLT0gMjsKCQlzICs9IDI7Cgl9CgoJaWYgKHNsZW4gPiA4ICogbndvcmRzKSAgLyogdXAgdG8g
MiBkaWdpdHMgcGVyIGJ5dGUgKi8KCQlyZXR1cm4gLTE7CgoJbWVtc2V0KHJlc3VsdCwgMCwgNCAq
IG53b3Jkcyk7Cglmb3IgKGkgPSAwOyBpIDwgc2xlbjsgKytpKSB7CgkJY29uc3QgdW5zaWduZWQg
aW50IHNoaWZ0ID0gKHNsZW4gLSAxIC0gaSkgKiA0OwoJCXUzMiAqZGVzdCA9ICZyZXN1bHRbc2hp
ZnQgLyAzMl07CgkJdTMyIG5pYmJsZTsKCgkJaWYgKCdhJyA8PSBzW2ldICYmIHNbaV0gPD0gJ2Yn
KQoJCQluaWJibGUgPSAweGEgKyAoc1tpXSAtICdhJyk7CgkJZWxzZSBpZiAoJ0EnIDw9IHNbaV0g
JiYgc1tpXSA8PSAnRicpCgkJCW5pYmJsZSA9IDB4YSArIChzW2ldIC0gJ0EnKTsKCQllbHNlIGlm
ICgnMCcgPD0gc1tpXSAmJiBzW2ldIDw9ICc5JykKCQkJbmliYmxlID0gKHNbaV0gLSAnMCcpOwoJ
CWVsc2UKCQkJcmV0dXJuIC0xOwoKCQkqZGVzdCB8PSAobmliYmxlIDw8IChzaGlmdCAlIDMyKSk7
Cgl9CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyB2b2lkIHBhcnNlX2dlbmVyaWNfY21kbGluZShzdHJ1
Y3QgY21kX2NvbnRleHQgKmN0eCwKCQkJCSAgaW50ICpjaGFuZ2VkLAoJCQkJICBzdHJ1Y3QgY21k
bGluZV9pbmZvICppbmZvLAoJCQkJICB1bnNpZ25lZCBpbnQgbl9pbmZvKQp7Cgl1bnNpZ25lZCBp
bnQgYXJnYyA9IGN0eC0+YXJnYzsKCWNoYXIgKiphcmdwID0gY3R4LT5hcmdwOwoJdW5zaWduZWQg
aW50IGksIGlkeDsKCWludCBmb3VuZDsKCglmb3IgKGkgPSAwOyBpIDwgYXJnYzsgaSsrKSB7CgkJ
Zm91bmQgPSAwOwoJCWZvciAoaWR4ID0gMDsgaWR4IDwgbl9pbmZvOyBpZHgrKykgewoJCQlpZiAo
IXN0cmNtcChpbmZvW2lkeF0ubmFtZSwgYXJncFtpXSkpIHsKCQkJCWZvdW5kID0gMTsKCQkJCSpj
aGFuZ2VkID0gMTsKCQkJCWlmIChpbmZvW2lkeF0udHlwZSAhPSBDTURMX0ZMQUcgJiYKCQkJCSAg
ICBpbmZvW2lkeF0uc2Vlbl92YWwpCgkJCQkJKihpbnQgKilpbmZvW2lkeF0uc2Vlbl92YWwgPSAx
OwoJCQkJaSArPSAxOwoJCQkJaWYgKGkgPj0gYXJnYykKCQkJCQlleGl0X2JhZF9hcmdzKCk7CgkJ
CQlzd2l0Y2ggKGluZm9baWR4XS50eXBlKSB7CgkJCQljYXNlIENNRExfQk9PTDogewoJCQkJCWlu
dCAqcCA9IGluZm9baWR4XS53YW50ZWRfdmFsOwoJCQkJCWlmICghc3RyY21wKGFyZ3BbaV0sICJv
biIpKQoJCQkJCQkqcCA9IDE7CgkJCQkJZWxzZSBpZiAoIXN0cmNtcChhcmdwW2ldLCAib2ZmIikp
CgkJCQkJCSpwID0gMDsKCQkJCQllbHNlCgkJCQkJCWV4aXRfYmFkX2FyZ3MoKTsKCQkJCQlicmVh
azsKCQkJCX0KCQkJCWNhc2UgQ01ETF9TMzI6IHsKCQkJCQlzMzIgKnAgPSBpbmZvW2lkeF0ud2Fu
dGVkX3ZhbDsKCQkJCQkqcCA9IGdldF9pbnRfcmFuZ2UoYXJncFtpXSwgMCwKCQkJCQkJCSAgIC0w
eDgwMDAwMDAwTEwsCgkJCQkJCQkgICAweDdmZmZmZmZmKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJ
CWNhc2UgQ01ETF9VODogewoJCQkJCXU4ICpwID0gaW5mb1tpZHhdLndhbnRlZF92YWw7CgkJCQkJ
KnAgPSBnZXRfdWludF9yYW5nZShhcmdwW2ldLCAwLCAweGZmKTsKCQkJCQlicmVhazsKCQkJCX0K
CQkJCWNhc2UgQ01ETF9VMTY6IHsKCQkJCQl1MTYgKnAgPSBpbmZvW2lkeF0ud2FudGVkX3ZhbDsK
CQkJCQkqcCA9IGdldF91aW50X3JhbmdlKGFyZ3BbaV0sIDAsIDB4ZmZmZik7CgkJCQkJYnJlYWs7
CgkJCQl9CgkJCQljYXNlIENNRExfVTMyOiB7CgkJCQkJdTMyICpwID0gaW5mb1tpZHhdLndhbnRl
ZF92YWw7CgkJCQkJKnAgPSBnZXRfdWludF9yYW5nZShhcmdwW2ldLCAwLAoJCQkJCQkJICAgIDB4
ZmZmZmZmZmYpOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJY2FzZSBDTURMX1U2NDogewoJCQkJCXU2
NCAqcCA9IGluZm9baWR4XS53YW50ZWRfdmFsOwoJCQkJCSpwID0gZ2V0X3VpbnRfcmFuZ2UoCgkJ
CQkJCWFyZ3BbaV0sIDAsCgkJCQkJCTB4ZmZmZmZmZmZmZmZmZmZmZkxMKTsKCQkJCQlicmVhazsK
CQkJCX0KCQkJCWNhc2UgQ01ETF9CRTE2OiB7CgkJCQkJdTE2ICpwID0gaW5mb1tpZHhdLndhbnRl
ZF92YWw7CgkJCQkJKnAgPSBjcHVfdG9fYmUxNigKCQkJCQkJZ2V0X3VpbnRfcmFuZ2UoYXJncFtp
XSwgMCwKCQkJCQkJCSAgICAgICAweGZmZmYpKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWNhc2Ug
Q01ETF9JUDQ6IHsKCQkJCQl1MzIgKnAgPSBpbmZvW2lkeF0ud2FudGVkX3ZhbDsKCQkJCQlzdHJ1
Y3QgaW5fYWRkciBpbjsKCQkJCQlpZiAoIWluZXRfcHRvbihBRl9JTkVULCBhcmdwW2ldLCAmaW4p
KQoJCQkJCQlleGl0X2JhZF9hcmdzKCk7CgkJCQkJKnAgPSBpbi5zX2FkZHI7CgkJCQkJYnJlYWs7
CgkJCQl9CgkJCQljYXNlIENNRExfTUFDOgoJCQkJCWdldF9tYWNfYWRkcihhcmdwW2ldLAoJCQkJ
CQkgICAgIGluZm9baWR4XS53YW50ZWRfdmFsKTsKCQkJCQlicmVhazsKCQkJCWNhc2UgQ01ETF9G
TEFHOiB7CgkJCQkJdTMyICpwOwoJCQkJCXAgPSBpbmZvW2lkeF0uc2Vlbl92YWw7CgkJCQkJKnAg
fD0gaW5mb1tpZHhdLmZsYWdfdmFsOwoJCQkJCWlmICghc3RyY21wKGFyZ3BbaV0sICJvbiIpKSB7
CgkJCQkJCXAgPSBpbmZvW2lkeF0ud2FudGVkX3ZhbDsKCQkJCQkJKnAgfD0gaW5mb1tpZHhdLmZs
YWdfdmFsOwoJCQkJCX0gZWxzZSBpZiAoc3RyY21wKGFyZ3BbaV0sICJvZmYiKSkgewoJCQkJCQll
eGl0X2JhZF9hcmdzKCk7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJY2FzZSBDTURMX1NU
UjogewoJCQkJCWNoYXIgKipzID0gaW5mb1tpZHhdLndhbnRlZF92YWw7CgkJCQkJKnMgPSBzdHJk
dXAoYXJncFtpXSk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQlkZWZhdWx0OgoJCQkJCWV4aXRfYmFk
X2FyZ3MoKTsKCQkJCX0KCQkJCWJyZWFrOwoJCQl9CgkJfQoJCWlmICghZm91bmQpCgkJCWV4aXRf
YmFkX2FyZ3MoKTsKCX0KfQoKc3RhdGljIHZvaWQgZmxhZ190b19jbWRsaW5lX2luZm8oY29uc3Qg
Y2hhciAqbmFtZSwgdTMyIHZhbHVlLAoJCQkJIHUzMiAqd2FudGVkLCB1MzIgKm1hc2ssCgkJCQkg
c3RydWN0IGNtZGxpbmVfaW5mbyAqY2xpKQp7CgltZW1zZXQoY2xpLCAwLCBzaXplb2YoKmNsaSkp
OwoJY2xpLT5uYW1lID0gbmFtZTsKCWNsaS0+dHlwZSA9IENNRExfRkxBRzsKCWNsaS0+ZmxhZ192
YWwgPSB2YWx1ZTsKCWNsaS0+d2FudGVkX3ZhbCA9IHdhbnRlZDsKCWNsaS0+c2Vlbl92YWwgPSBt
YXNrOwp9CgpzdGF0aWMgaW50IHJ4Zmxvd19zdHJfdG9fdHlwZShjb25zdCBjaGFyICpzdHIpCnsK
CWludCBmbG93X3R5cGUgPSAwOwoKCWlmICghc3RyY21wKHN0ciwgInRjcDQiKSkKCQlmbG93X3R5
cGUgPSBUQ1BfVjRfRkxPVzsKCWVsc2UgaWYgKCFzdHJjbXAoc3RyLCAidWRwNCIpKQoJCWZsb3df
dHlwZSA9IFVEUF9WNF9GTE9XOwoJZWxzZSBpZiAoIXN0cmNtcChzdHIsICJhaDQiKSB8fCAhc3Ry
Y21wKHN0ciwgImVzcDQiKSkKCQlmbG93X3R5cGUgPSBBSF9FU1BfVjRfRkxPVzsKCWVsc2UgaWYg
KCFzdHJjbXAoc3RyLCAic2N0cDQiKSkKCQlmbG93X3R5cGUgPSBTQ1RQX1Y0X0ZMT1c7CgllbHNl
IGlmICghc3RyY21wKHN0ciwgInRjcDYiKSkKCQlmbG93X3R5cGUgPSBUQ1BfVjZfRkxPVzsKCWVs
c2UgaWYgKCFzdHJjbXAoc3RyLCAidWRwNiIpKQoJCWZsb3dfdHlwZSA9IFVEUF9WNl9GTE9XOwoJ
ZWxzZSBpZiAoIXN0cmNtcChzdHIsICJhaDYiKSB8fCAhc3RyY21wKHN0ciwgImVzcDYiKSkKCQlm
bG93X3R5cGUgPSBBSF9FU1BfVjZfRkxPVzsKCWVsc2UgaWYgKCFzdHJjbXAoc3RyLCAic2N0cDYi
KSkKCQlmbG93X3R5cGUgPSBTQ1RQX1Y2X0ZMT1c7CgllbHNlIGlmICghc3RyY21wKHN0ciwgImV0
aGVyIikpCgkJZmxvd190eXBlID0gRVRIRVJfRkxPVzsKCglyZXR1cm4gZmxvd190eXBlOwp9Cgpz
dGF0aWMgaW50IGRvX3ZlcnNpb24oc3RydWN0IGNtZF9jb250ZXh0ICpjdHggX19tYXliZV91bnVz
ZWQpCnsKCWZwcmludGYoc3Rkb3V0LAoJCVBBQ0tBR0UgIiB2ZXJzaW9uICIgVkVSU0lPTgojaWZu
ZGVmIEVUSFRPT0xfRU5BQkxFX1BSRVRUWV9EVU1QCgkJIiAocHJldHR5IGR1bXBzIGRpc2FibGVk
KSIKI2VuZGlmCgkJIlxuIik7CglyZXR1cm4gMDsKfQoKLyogbGluayBtb2RlIHJvdXRpbmVzICov
CgpzdGF0aWMgRVRIVE9PTF9ERUNMQVJFX0xJTktfTU9ERV9NQVNLKGFsbF9hZHZlcnRpc2VkX21v
ZGVzKTsKc3RhdGljIEVUSFRPT0xfREVDTEFSRV9MSU5LX01PREVfTUFTSyhhbGxfYWR2ZXJ0aXNl
ZF9mbGFncyk7CgpzdGF0aWMgdm9pZCBpbml0X2dsb2JhbF9saW5rX21vZGVfbWFza3Modm9pZCkK
ewoJc3RhdGljIGNvbnN0IGVudW0gZXRodG9vbF9saW5rX21vZGVfYml0X2luZGljZXMKCQlhbGxf
YWR2ZXJ0aXNlZF9tb2Rlc19iaXRzW10gPSB7CgkJRVRIVE9PTF9MSU5LX01PREVfMTBiYXNlVF9I
YWxmX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8xMGJhc2VUX0Z1bGxfQklULAoJCUVUSFRPT0xf
TElOS19NT0RFXzEwMGJhc2VUX0hhbGZfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzEwMGJhc2VU
X0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzEwMDBiYXNlVF9IYWxmX0JJVCwKCQlFVEhU
T09MX0xJTktfTU9ERV8xMDAwYmFzZVRfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMTAw
MDBiYXNlVF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8yNTAwYmFzZVhfRnVsbF9CSVQs
CgkJRVRIVE9PTF9MSU5LX01PREVfMTAwMGJhc2VLWF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktf
TU9ERV8xMDAwMGJhc2VLWDRfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMTAwMDBiYXNl
S1JfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMTAwMDBiYXNlUl9GRUNfQklULAoJCUVU
SFRPT0xfTElOS19NT0RFXzIwMDAwYmFzZU1MRDJfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01P
REVfMjAwMDBiYXNlS1IyX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzQwMDAwYmFzZUtS
NF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV80MDAwMGJhc2VDUjRfRnVsbF9CSVQsCgkJ
RVRIVE9PTF9MSU5LX01PREVfNDAwMDBiYXNlU1I0X0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19N
T0RFXzQwMDAwYmFzZUxSNF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV81NjAwMGJhc2VL
UjRfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfNTYwMDBiYXNlQ1I0X0Z1bGxfQklULAoJ
CUVUSFRPT0xfTElOS19NT0RFXzU2MDAwYmFzZVNSNF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktf
TU9ERV81NjAwMGJhc2VMUjRfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMjUwMDBiYXNl
Q1JfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMjUwMDBiYXNlS1JfRnVsbF9CSVQsCgkJ
RVRIVE9PTF9MSU5LX01PREVfMjUwMDBiYXNlU1JfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01P
REVfNTAwMDBiYXNlQ1IyX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzUwMDAwYmFzZUtS
Ml9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8xMDAwMDBiYXNlS1I0X0Z1bGxfQklULAoJ
CUVUSFRPT0xfTElOS19NT0RFXzEwMDAwMGJhc2VTUjRfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5L
X01PREVfMTAwMDAwYmFzZUNSNF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8xMDAwMDBi
YXNlTFI0X0VSNF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV81MDAwMGJhc2VTUjJfRnVs
bF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMTAwMGJhc2VYX0Z1bGxfQklULAoJCUVUSFRPT0xf
TElOS19NT0RFXzEwMDAwYmFzZUNSX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzEwMDAw
YmFzZVNSX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzEwMDAwYmFzZUxSX0Z1bGxfQklU
LAoJCUVUSFRPT0xfTElOS19NT0RFXzEwMDAwYmFzZUxSTV9GdWxsX0JJVCwKCQlFVEhUT09MX0xJ
TktfTU9ERV8xMDAwMGJhc2VFUl9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8yNTAwYmFz
ZVRfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfNTAwMGJhc2VUX0Z1bGxfQklULAoJCUVU
SFRPT0xfTElOS19NT0RFXzUwMDAwYmFzZUtSX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RF
XzUwMDAwYmFzZVNSX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzUwMDAwYmFzZUNSX0Z1
bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzUwMDAwYmFzZUxSX0VSX0ZSX0Z1bGxfQklULAoJ
CUVUSFRPT0xfTElOS19NT0RFXzUwMDAwYmFzZURSX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19N
T0RFXzEwMDAwMGJhc2VLUjJfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMTAwMDAwYmFz
ZVNSMl9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8xMDAwMDBiYXNlQ1IyX0Z1bGxfQklU
LAoJCUVUSFRPT0xfTElOS19NT0RFXzEwMDAwMGJhc2VMUjJfRVIyX0ZSMl9GdWxsX0JJVCwKCQlF
VEhUT09MX0xJTktfTU9ERV8xMDAwMDBiYXNlRFIyX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19N
T0RFXzIwMDAwMGJhc2VLUjRfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMjAwMDAwYmFz
ZVNSNF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8yMDAwMDBiYXNlTFI0X0VSNF9GUjRf
RnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMjAwMDAwYmFzZURSNF9GdWxsX0JJVCwKCQlF
VEhUT09MX0xJTktfTU9ERV8yMDAwMDBiYXNlQ1I0X0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19N
T0RFXzEwMGJhc2VUMV9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8xMDAwYmFzZVQxX0Z1
bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzQwMDAwMGJhc2VLUjhfRnVsbF9CSVQsCgkJRVRI
VE9PTF9MSU5LX01PREVfNDAwMDAwYmFzZVNSOF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9E
RV80MDAwMDBiYXNlTFI4X0VSOF9GUjhfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfNDAw
MDAwYmFzZURSOF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV80MDAwMDBiYXNlQ1I4X0Z1
bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzEwMDAwMGJhc2VLUl9GdWxsX0JJVCwKCQlFVEhU
T09MX0xJTktfTU9ERV8xMDAwMDBiYXNlU1JfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVf
MTAwMDAwYmFzZUxSX0VSX0ZSX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzEwMDAwMGJh
c2VDUl9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8xMDAwMDBiYXNlRFJfRnVsbF9CSVQs
CgkJRVRIVE9PTF9MSU5LX01PREVfMjAwMDAwYmFzZUtSMl9GdWxsX0JJVCwKCQlFVEhUT09MX0xJ
TktfTU9ERV8yMDAwMDBiYXNlU1IyX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzIwMDAw
MGJhc2VMUjJfRVIyX0ZSMl9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8yMDAwMDBiYXNl
RFIyX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzIwMDAwMGJhc2VDUjJfRnVsbF9CSVQs
CgkJRVRIVE9PTF9MSU5LX01PREVfNDAwMDAwYmFzZUtSNF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJ
TktfTU9ERV80MDAwMDBiYXNlU1I0X0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzQwMDAw
MGJhc2VMUjRfRVI0X0ZSNF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV80MDAwMDBiYXNl
RFI0X0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzQwMDAwMGJhc2VDUjRfRnVsbF9CSVQs
CgkJRVRIVE9PTF9MSU5LX01PREVfMTAwYmFzZUZYX0hhbGZfQklULAoJCUVUSFRPT0xfTElOS19N
T0RFXzEwMGJhc2VGWF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV8xMGJhc2VUMUxfRnVs
bF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfODAwMDAwYmFzZUNSOF9GdWxsX0JJVCwKCQlFVEhU
T09MX0xJTktfTU9ERV84MDAwMDBiYXNlS1I4X0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RF
XzgwMDAwMGJhc2VEUjhfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfODAwMDAwYmFzZURS
OF8yX0Z1bGxfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzgwMDAwMGJhc2VTUjhfRnVsbF9CSVQs
CgkJRVRIVE9PTF9MSU5LX01PREVfODAwMDAwYmFzZVZSOF9GdWxsX0JJVCwKCQlFVEhUT09MX0xJ
TktfTU9ERV8xMGJhc2VUMVNfRnVsbF9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfMTBiYXNlVDFT
X0hhbGZfQklULAoJCUVUSFRPT0xfTElOS19NT0RFXzEwYmFzZVQxU19QMk1QX0hhbGZfQklULAoJ
fTsKCXN0YXRpYyBjb25zdCBlbnVtIGV0aHRvb2xfbGlua19tb2RlX2JpdF9pbmRpY2VzCgkJYWRk
aXRpb25hbF9hZHZlcnRpc2VkX2ZsYWdzX2JpdHNbXSA9IHsKCQlFVEhUT09MX0xJTktfTU9ERV9B
dXRvbmVnX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV9UUF9CSVQsCgkJRVRIVE9PTF9MSU5LX01P
REVfQVVJX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV9NSUlfQklULAoJCUVUSFRPT0xfTElOS19N
T0RFX0ZJQlJFX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV9CTkNfQklULAoJCUVUSFRPT0xfTElO
S19NT0RFX1BhdXNlX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV9Bc3ltX1BhdXNlX0JJVCwKCQlF
VEhUT09MX0xJTktfTU9ERV9CYWNrcGxhbmVfQklULAoJCUVUSFRPT0xfTElOS19NT0RFX0ZFQ19O
T05FX0JJVCwKCQlFVEhUT09MX0xJTktfTU9ERV9GRUNfUlNfQklULAoJCUVUSFRPT0xfTElOS19N
T0RFX0ZFQ19CQVNFUl9CSVQsCgkJRVRIVE9PTF9MSU5LX01PREVfRkVDX0xMUlNfQklULAoJfTsK
CXVuc2lnbmVkIGludCBpOwoKCWV0aHRvb2xfbGlua19tb2RlX3plcm8oYWxsX2FkdmVydGlzZWRf
bW9kZXMpOwoJZXRodG9vbF9saW5rX21vZGVfemVybyhhbGxfYWR2ZXJ0aXNlZF9mbGFncyk7Cglm
b3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShhbGxfYWR2ZXJ0aXNlZF9tb2Rlc19iaXRzKTsgKytp
KSB7CgkJZXRodG9vbF9saW5rX21vZGVfc2V0X2JpdChhbGxfYWR2ZXJ0aXNlZF9tb2Rlc19iaXRz
W2ldLAoJCQkJCSAgYWxsX2FkdmVydGlzZWRfbW9kZXMpOwoJCWV0aHRvb2xfbGlua19tb2RlX3Nl
dF9iaXQoYWxsX2FkdmVydGlzZWRfbW9kZXNfYml0c1tpXSwKCQkJCQkgIGFsbF9hZHZlcnRpc2Vk
X2ZsYWdzKTsKCX0KCglmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShhZGRpdGlvbmFsX2FkdmVy
dGlzZWRfZmxhZ3NfYml0cyk7ICsraSkgewoJCWV0aHRvb2xfbGlua19tb2RlX3NldF9iaXQoCgkJ
CWFkZGl0aW9uYWxfYWR2ZXJ0aXNlZF9mbGFnc19iaXRzW2ldLAoJCQlhbGxfYWR2ZXJ0aXNlZF9m
bGFncyk7Cgl9Cn0KCnN0YXRpYyB2b2lkIGR1bXBfbGlua19jYXBzKGNvbnN0IGNoYXIgKnByZWZp
eCwgY29uc3QgY2hhciAqYW5fcHJlZml4LAoJCQkgICBjb25zdCB1MzIgKm1hc2ssIGludCBsaW5r
X21vZGVfb25seSk7CgpzdGF0aWMgdm9pZCBkdW1wX3N1cHBvcnRlZChjb25zdCBzdHJ1Y3QgZXRo
dG9vbF9saW5rX3VzZXR0aW5ncyAqbGlua191c2V0dGluZ3MpCnsKCWZwcmludGYoc3Rkb3V0LCAi
CVN1cHBvcnRlZCBwb3J0czogWyAiKTsKCWlmIChldGh0b29sX2xpbmtfbW9kZV90ZXN0X2JpdCgK
CQkgICAgRVRIVE9PTF9MSU5LX01PREVfVFBfQklULAoJCSAgICBsaW5rX3VzZXR0aW5ncy0+bGlu
a19tb2Rlcy5zdXBwb3J0ZWQpKQoJCWZwcmludGYoc3Rkb3V0LCAiVFAgIik7CglpZiAoZXRodG9v
bF9saW5rX21vZGVfdGVzdF9iaXQoCgkJICAgIEVUSFRPT0xfTElOS19NT0RFX0FVSV9CSVQsCgkJ
ICAgIGxpbmtfdXNldHRpbmdzLT5saW5rX21vZGVzLnN1cHBvcnRlZCkpCgkJZnByaW50ZihzdGRv
dXQsICJBVUkgIik7CglpZiAoZXRodG9vbF9saW5rX21vZGVfdGVzdF9iaXQoCgkJICAgIEVUSFRP
T0xfTElOS19NT0RFX0JOQ19CSVQsCgkJICAgIGxpbmtfdXNldHRpbmdzLT5saW5rX21vZGVzLnN1
cHBvcnRlZCkpCgkJZnByaW50ZihzdGRvdXQsICJCTkMgIik7CglpZiAoZXRodG9vbF9saW5rX21v
ZGVfdGVzdF9iaXQoCgkJICAgIEVUSFRPT0xfTElOS19NT0RFX01JSV9CSVQsCgkJICAgIGxpbmtf
dXNldHRpbmdzLT5saW5rX21vZGVzLnN1cHBvcnRlZCkpCgkJZnByaW50ZihzdGRvdXQsICJNSUkg
Iik7CglpZiAoZXRodG9vbF9saW5rX21vZGVfdGVzdF9iaXQoCgkJICAgIEVUSFRPT0xfTElOS19N
T0RFX0ZJQlJFX0JJVCwKCQkgICAgbGlua191c2V0dGluZ3MtPmxpbmtfbW9kZXMuc3VwcG9ydGVk
KSkKCQlmcHJpbnRmKHN0ZG91dCwgIkZJQlJFICIpOwoJaWYgKGV0aHRvb2xfbGlua19tb2RlX3Rl
c3RfYml0KAoJCSAgICBFVEhUT09MX0xJTktfTU9ERV9CYWNrcGxhbmVfQklULAoJCSAgICBsaW5r
X3VzZXR0aW5ncy0+bGlua19tb2Rlcy5zdXBwb3J0ZWQpKQoJCWZwcmludGYoc3Rkb3V0LCAiQmFj
a3BsYW5lICIpOwoJZnByaW50ZihzdGRvdXQsICJdXG4iKTsKCglkdW1wX2xpbmtfY2FwcygiU3Vw
cG9ydGVkIiwgIlN1cHBvcnRzIiwKCQkgICAgICAgbGlua191c2V0dGluZ3MtPmxpbmtfbW9kZXMu
c3VwcG9ydGVkLCAwKTsKfQoKLyogUHJpbnQgbGluayBjYXBhYmlsaXR5IGZsYWdzIChzdXBwb3J0
ZWQsIGFkdmVydGlzZWQgb3IgbHBfYWR2ZXJ0aXNlZCkuCiAqIEFzc3VtZXMgdGhhdCB0aGUgY29y
cmVzcG9uZGluZyBTVVBQT1JURUQgYW5kIEFEVkVSVElTRUQgZmxhZ3MgYXJlIGVxdWFsLgogKi8K
c3RhdGljIHZvaWQgZHVtcF9saW5rX2NhcHMoY29uc3QgY2hhciAqcHJlZml4LCBjb25zdCBjaGFy
ICphbl9wcmVmaXgsCgkJCSAgIGNvbnN0IHUzMiAqbWFzaywgaW50IGxpbmtfbW9kZV9vbmx5KQp7
CglzdGF0aWMgY29uc3Qgc3RydWN0IHsKCQlpbnQgc2FtZV9saW5lOyAvKiBwcmludCBvbiBzYW1l
IGxpbmUgYXMgcHJldmlvdXMgKi8KCQl1bnNpZ25lZCBpbnQgYml0X2luZGV4OwoJCWNvbnN0IGNo
YXIgKm5hbWU7Cgl9IG1vZGVfZGVmc1tdID0gewoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfMTBi
YXNlVF9IYWxmX0JJVCwKCQkgICIxMGJhc2VUL0hhbGYiIH0sCgkJeyAxLCBFVEhUT09MX0xJTktf
TU9ERV8xMGJhc2VUX0Z1bGxfQklULAoJCSAgIjEwYmFzZVQvRnVsbCIgfSwKCQl7IDAsIEVUSFRP
T0xfTElOS19NT0RFXzEwMGJhc2VUX0hhbGZfQklULAoJCSAgIjEwMGJhc2VUL0hhbGYiIH0sCgkJ
eyAxLCBFVEhUT09MX0xJTktfTU9ERV8xMDBiYXNlVF9GdWxsX0JJVCwKCQkgICIxMDBiYXNlVC9G
dWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfMTAwMGJhc2VUX0hhbGZfQklULAoJCSAg
IjEwMDBiYXNlVC9IYWxmIiB9LAoJCXsgMSwgRVRIVE9PTF9MSU5LX01PREVfMTAwMGJhc2VUX0Z1
bGxfQklULAoJCSAgIjEwMDBiYXNlVC9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVf
MTAwMDBiYXNlVF9GdWxsX0JJVCwKCQkgICIxMDAwMGJhc2VUL0Z1bGwiIH0sCgkJeyAwLCBFVEhU
T09MX0xJTktfTU9ERV8yNTAwYmFzZVhfRnVsbF9CSVQsCgkJICAiMjUwMGJhc2VYL0Z1bGwiIH0s
CgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV8xMDAwYmFzZUtYX0Z1bGxfQklULAoJCSAgIjEwMDBi
YXNlS1gvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzEwMDAwYmFzZUtYNF9GdWxs
X0JJVCwKCQkgICIxMDAwMGJhc2VLWDQvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RF
XzEwMDAwYmFzZUtSX0Z1bGxfQklULAoJCSAgIjEwMDAwYmFzZUtSL0Z1bGwiIH0sCgkJeyAwLCBF
VEhUT09MX0xJTktfTU9ERV8xMDAwMGJhc2VSX0ZFQ19CSVQsCgkJICAiMTAwMDBiYXNlUl9GRUMi
IH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV8yMDAwMGJhc2VNTEQyX0Z1bGxfQklULAoJCSAg
IjIwMDAwYmFzZU1MRDIvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzIwMDAwYmFz
ZUtSMl9GdWxsX0JJVCwKCQkgICIyMDAwMGJhc2VLUjIvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xf
TElOS19NT0RFXzQwMDAwYmFzZUtSNF9GdWxsX0JJVCwKCQkgICI0MDAwMGJhc2VLUjQvRnVsbCIg
fSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzQwMDAwYmFzZUNSNF9GdWxsX0JJVCwKCQkgICI0
MDAwMGJhc2VDUjQvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzQwMDAwYmFzZVNS
NF9GdWxsX0JJVCwKCQkgICI0MDAwMGJhc2VTUjQvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElO
S19NT0RFXzQwMDAwYmFzZUxSNF9GdWxsX0JJVCwKCQkgICI0MDAwMGJhc2VMUjQvRnVsbCIgfSwK
CQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzU2MDAwYmFzZUtSNF9GdWxsX0JJVCwKCQkgICI1NjAw
MGJhc2VLUjQvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzU2MDAwYmFzZUNSNF9G
dWxsX0JJVCwKCQkgICI1NjAwMGJhc2VDUjQvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19N
T0RFXzU2MDAwYmFzZVNSNF9GdWxsX0JJVCwKCQkgICI1NjAwMGJhc2VTUjQvRnVsbCIgfSwKCQl7
IDAsIEVUSFRPT0xfTElOS19NT0RFXzU2MDAwYmFzZUxSNF9GdWxsX0JJVCwKCQkgICI1NjAwMGJh
c2VMUjQvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzI1MDAwYmFzZUNSX0Z1bGxf
QklULAoJCSAgIjI1MDAwYmFzZUNSL0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV8y
NTAwMGJhc2VLUl9GdWxsX0JJVCwKCQkgICIyNTAwMGJhc2VLUi9GdWxsIiB9LAoJCXsgMCwgRVRI
VE9PTF9MSU5LX01PREVfMjUwMDBiYXNlU1JfRnVsbF9CSVQsCgkJICAiMjUwMDBiYXNlU1IvRnVs
bCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzUwMDAwYmFzZUNSMl9GdWxsX0JJVCwKCQkg
ICI1MDAwMGJhc2VDUjIvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzUwMDAwYmFz
ZUtSMl9GdWxsX0JJVCwKCQkgICI1MDAwMGJhc2VLUjIvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xf
TElOS19NT0RFXzEwMDAwMGJhc2VLUjRfRnVsbF9CSVQsCgkJICAiMTAwMDAwYmFzZUtSNC9GdWxs
IiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfMTAwMDAwYmFzZVNSNF9GdWxsX0JJVCwKCQkg
ICIxMDAwMDBiYXNlU1I0L0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV8xMDAwMDBi
YXNlQ1I0X0Z1bGxfQklULAoJCSAgIjEwMDAwMGJhc2VDUjQvRnVsbCIgfSwKCQl7IDAsIEVUSFRP
T0xfTElOS19NT0RFXzEwMDAwMGJhc2VMUjRfRVI0X0Z1bGxfQklULAoJCSAgIjEwMDAwMGJhc2VM
UjRfRVI0L0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV81MDAwMGJhc2VTUjJfRnVs
bF9CSVQsCgkJICAiNTAwMDBiYXNlU1IyL0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9E
RV8xMDAwYmFzZVhfRnVsbF9CSVQsCgkJICAiMTAwMGJhc2VYL0Z1bGwiIH0sCgkJeyAwLCBFVEhU
T09MX0xJTktfTU9ERV8xMDAwMGJhc2VDUl9GdWxsX0JJVCwKCQkgICIxMDAwMGJhc2VDUi9GdWxs
IiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfMTAwMDBiYXNlU1JfRnVsbF9CSVQsCgkJICAi
MTAwMDBiYXNlU1IvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzEwMDAwYmFzZUxS
X0Z1bGxfQklULAoJCSAgIjEwMDAwYmFzZUxSL0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktf
TU9ERV8xMDAwMGJhc2VMUk1fRnVsbF9CSVQsCgkJICAiMTAwMDBiYXNlTFJNL0Z1bGwiIH0sCgkJ
eyAwLCBFVEhUT09MX0xJTktfTU9ERV8xMDAwMGJhc2VFUl9GdWxsX0JJVCwKCQkgICIxMDAwMGJh
c2VFUi9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfMjUwMGJhc2VUX0Z1bGxfQklU
LAoJCSAgIjI1MDBiYXNlVC9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfNTAwMGJh
c2VUX0Z1bGxfQklULAoJCSAgIjUwMDBiYXNlVC9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5L
X01PREVfNTAwMDBiYXNlS1JfRnVsbF9CSVQsCgkJICAiNTAwMDBiYXNlS1IvRnVsbCIgfSwKCQl7
IDAsIEVUSFRPT0xfTElOS19NT0RFXzUwMDAwYmFzZVNSX0Z1bGxfQklULAoJCSAgIjUwMDAwYmFz
ZVNSL0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV81MDAwMGJhc2VDUl9GdWxsX0JJ
VCwKCQkgICI1MDAwMGJhc2VDUi9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfNTAw
MDBiYXNlTFJfRVJfRlJfRnVsbF9CSVQsCgkJICAiNTAwMDBiYXNlTFJfRVJfRlIvRnVsbCIgfSwK
CQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzUwMDAwYmFzZURSX0Z1bGxfQklULAoJCSAgIjUwMDAw
YmFzZURSL0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV8xMDAwMDBiYXNlS1IyX0Z1
bGxfQklULAoJCSAgIjEwMDAwMGJhc2VLUjIvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19N
T0RFXzEwMDAwMGJhc2VTUjJfRnVsbF9CSVQsCgkJICAiMTAwMDAwYmFzZVNSMi9GdWxsIiB9LAoJ
CXsgMCwgRVRIVE9PTF9MSU5LX01PREVfMTAwMDAwYmFzZUNSMl9GdWxsX0JJVCwKCQkgICIxMDAw
MDBiYXNlQ1IyL0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV8xMDAwMDBiYXNlTFIy
X0VSMl9GUjJfRnVsbF9CSVQsCgkJICAiMTAwMDAwYmFzZUxSMl9FUjJfRlIyL0Z1bGwiIH0sCgkJ
eyAwLCBFVEhUT09MX0xJTktfTU9ERV8xMDAwMDBiYXNlRFIyX0Z1bGxfQklULAoJCSAgIjEwMDAw
MGJhc2VEUjIvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzIwMDAwMGJhc2VLUjRf
RnVsbF9CSVQsCgkJICAiMjAwMDAwYmFzZUtSNC9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5L
X01PREVfMjAwMDAwYmFzZVNSNF9GdWxsX0JJVCwKCQkgICIyMDAwMDBiYXNlU1I0L0Z1bGwiIH0s
CgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV8yMDAwMDBiYXNlTFI0X0VSNF9GUjRfRnVsbF9CSVQs
CgkJICAiMjAwMDAwYmFzZUxSNF9FUjRfRlI0L0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktf
TU9ERV8yMDAwMDBiYXNlRFI0X0Z1bGxfQklULAoJCSAgIjIwMDAwMGJhc2VEUjQvRnVsbCIgfSwK
CQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzIwMDAwMGJhc2VDUjRfRnVsbF9CSVQsCgkJICAiMjAw
MDAwYmFzZUNSNC9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfMTAwYmFzZVQxX0Z1
bGxfQklULAoJCSAgIjEwMGJhc2VUMS9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVf
MTAwMGJhc2VUMV9GdWxsX0JJVCwKCQkgICIxMDAwYmFzZVQxL0Z1bGwiIH0sCgkJeyAwLCBFVEhU
T09MX0xJTktfTU9ERV80MDAwMDBiYXNlS1I4X0Z1bGxfQklULAoJCSAgIjQwMDAwMGJhc2VLUjgv
RnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzQwMDAwMGJhc2VTUjhfRnVsbF9CSVQs
CgkJICAiNDAwMDAwYmFzZVNSOC9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfNDAw
MDAwYmFzZUxSOF9FUjhfRlI4X0Z1bGxfQklULAoJCSAgIjQwMDAwMGJhc2VMUjhfRVI4X0ZSOC9G
dWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfNDAwMDAwYmFzZURSOF9GdWxsX0JJVCwK
CQkgICI0MDAwMDBiYXNlRFI4L0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV80MDAw
MDBiYXNlQ1I4X0Z1bGxfQklULAoJCSAgIjQwMDAwMGJhc2VDUjgvRnVsbCIgfSwKCQl7IDAsIEVU
SFRPT0xfTElOS19NT0RFXzEwMDAwMGJhc2VLUl9GdWxsX0JJVCwKCQkgICIxMDAwMDBiYXNlS1Iv
RnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzEwMDAwMGJhc2VTUl9GdWxsX0JJVCwK
CQkgICIxMDAwMDBiYXNlU1IvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzEwMDAw
MGJhc2VMUl9FUl9GUl9GdWxsX0JJVCwKCQkgICIxMDAwMDBiYXNlTFJfRVJfRlIvRnVsbCIgfSwK
CQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzEwMDAwMGJhc2VEUl9GdWxsX0JJVCwKCQkgICIxMDAw
MDBiYXNlRFIvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzEwMDAwMGJhc2VDUl9G
dWxsX0JJVCwKCQkgICIxMDAwMDBiYXNlQ1IvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19N
T0RFXzIwMDAwMGJhc2VLUjJfRnVsbF9CSVQsCgkJICAiMjAwMDAwYmFzZUtSMi9GdWxsIiB9LAoJ
CXsgMCwgRVRIVE9PTF9MSU5LX01PREVfMjAwMDAwYmFzZVNSMl9GdWxsX0JJVCwKCQkgICIyMDAw
MDBiYXNlU1IyL0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV8yMDAwMDBiYXNlTFIy
X0VSMl9GUjJfRnVsbF9CSVQsCgkJICAiMjAwMDAwYmFzZUxSMl9FUjJfRlIyL0Z1bGwiIH0sCgkJ
eyAwLCBFVEhUT09MX0xJTktfTU9ERV8yMDAwMDBiYXNlRFIyX0Z1bGxfQklULAoJCSAgIjIwMDAw
MGJhc2VEUjIvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzIwMDAwMGJhc2VDUjJf
RnVsbF9CSVQsCgkJICAiMjAwMDAwYmFzZUNSMi9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5L
X01PREVfNDAwMDAwYmFzZUtSNF9GdWxsX0JJVCwKCQkgICI0MDAwMDBiYXNlS1I0L0Z1bGwiIH0s
CgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV80MDAwMDBiYXNlU1I0X0Z1bGxfQklULAoJCSAgIjQw
MDAwMGJhc2VTUjQvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzQwMDAwMGJhc2VM
UjRfRVI0X0ZSNF9GdWxsX0JJVCwKCQkgICI0MDAwMDBiYXNlTFI0X0VSNF9GUjQvRnVsbCIgfSwK
CQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzQwMDAwMGJhc2VEUjRfRnVsbF9CSVQsCgkJICAiNDAw
MDAwYmFzZURSNC9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfNDAwMDAwYmFzZUNS
NF9GdWxsX0JJVCwKCQkgICI0MDAwMDBiYXNlQ1I0L0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJ
TktfTU9ERV8xMDBiYXNlRlhfSGFsZl9CSVQsCgkJICAiMTAwYmFzZUZYL0hhbGYiIH0sCgkJeyAx
LCBFVEhUT09MX0xJTktfTU9ERV8xMDBiYXNlRlhfRnVsbF9CSVQsCgkJICAiMTAwYmFzZUZYL0Z1
bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV8xMGJhc2VUMUxfRnVsbF9CSVQsCgkJICAi
MTBiYXNlVDFML0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV84MDAwMDBiYXNlQ1I4
X0Z1bGxfQklULAoJCSAgIjgwMDAwMGJhc2VDUjgvRnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElO
S19NT0RFXzgwMDAwMGJhc2VLUjhfRnVsbF9CSVQsCgkJICAiODAwMDAwYmFzZUtSOC9GdWxsIiB9
LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfODAwMDAwYmFzZURSOF9GdWxsX0JJVCwKCQkgICI4
MDAwMDBiYXNlRFI4L0Z1bGwiIH0sCgkJeyAwLCBFVEhUT09MX0xJTktfTU9ERV84MDAwMDBiYXNl
RFI4XzJfRnVsbF9CSVQsCgkJICAiODAwMDAwYmFzZURSOF8yL0Z1bGwiIH0sCgkJeyAwLCBFVEhU
T09MX0xJTktfTU9ERV84MDAwMDBiYXNlU1I4X0Z1bGxfQklULAoJCSAgIjgwMDAwMGJhc2VTUjgv
RnVsbCIgfSwKCQl7IDAsIEVUSFRPT0xfTElOS19NT0RFXzgwMDAwMGJhc2VWUjhfRnVsbF9CSVQs
CgkJICAiODAwMDAwYmFzZVZSOC9GdWxsIiB9LAoJCXsgMCwgRVRIVE9PTF9MSU5LX01PREVfMTBi
YXNlVDFTX0Z1bGxfQklULAoJCSAgIjEwYmFzZVQxUy9GdWxsIiB9LAoJCXsgMSwgRVRIVE9PTF9M
SU5LX01PREVfMTBiYXNlVDFTX0hhbGZfQklULAoJCSAgIjEwYmFzZVQxUy9IYWxmIiB9LAoJCXsg
MCwgRVRIVE9PTF9MSU5LX01PREVfMTBiYXNlVDFTX1AyTVBfSGFsZl9CSVQsCgkJICAiMTBiYXNl
VDFTL0hhbGYiIH0sCgl9OwoJaW50IGluZGVudDsKCWludCBkaWQxLCBuZXdfbGluZV9wZW5kOwoJ
aW50IGZlY3JlcG9ydGVkID0gMDsKCXVuc2lnbmVkIGludCBpOwoKCS8qIEluZGVudCBqdXN0IGxp
a2UgdGhlIHNlcGFyYXRlIGZ1bmN0aW9ucyB1c2VkIHRvICovCglpbmRlbnQgPSBzdHJsZW4ocHJl
Zml4KSArIDE0OwoJaWYgKGluZGVudCA8IDI0KQoJCWluZGVudCA9IDI0OwoKCWZwcmludGYoc3Rk
b3V0LCAiCSVzIGxpbmsgbW9kZXM6JSpzIiwgcHJlZml4LAoJCWluZGVudCAtIChpbnQpc3RybGVu
KHByZWZpeCkgLSAxMiwgIiIpOwoJZGlkMSA9IDA7CgluZXdfbGluZV9wZW5kID0gMDsKCWZvciAo
aSA9IDA7IGkgPCBBUlJBWV9TSVpFKG1vZGVfZGVmcyk7IGkrKykgewoJCWlmIChkaWQxICYmICFt
b2RlX2RlZnNbaV0uc2FtZV9saW5lKQoJCQluZXdfbGluZV9wZW5kID0gMTsKCQlpZiAoZXRodG9v
bF9saW5rX21vZGVfdGVzdF9iaXQobW9kZV9kZWZzW2ldLmJpdF9pbmRleCwKCQkJCQkgICAgICAg
bWFzaykpIHsKCQkJaWYgKG5ld19saW5lX3BlbmQpIHsKCQkJCWZwcmludGYoc3Rkb3V0LCAiXG4i
KTsKCQkJCWZwcmludGYoc3Rkb3V0LCAiCSUqcyIsIGluZGVudCwgIiIpOwoJCQkJbmV3X2xpbmVf
cGVuZCA9IDA7CgkJCX0KCQkJZGlkMSsrOwoJCQlmcHJpbnRmKHN0ZG91dCwgIiVzICIsIG1vZGVf
ZGVmc1tpXS5uYW1lKTsKCQl9Cgl9CglpZiAoZGlkMSA9PSAwKQoJCWZwcmludGYoc3Rkb3V0LCAi
Tm90IHJlcG9ydGVkIik7CglmcHJpbnRmKHN0ZG91dCwgIlxuIik7CgoJaWYgKCFsaW5rX21vZGVf
b25seSkgewoJCWZwcmludGYoc3Rkb3V0LCAiCSVzIHBhdXNlIGZyYW1lIHVzZTogIiwgcHJlZml4
KTsKCQlpZiAoZXRodG9vbF9saW5rX21vZGVfdGVzdF9iaXQoCgkJCSAgICBFVEhUT09MX0xJTktf
TU9ERV9QYXVzZV9CSVQsIG1hc2spKSB7CgkJCWZwcmludGYoc3Rkb3V0LCAiU3ltbWV0cmljIik7
CgkJCWlmIChldGh0b29sX2xpbmtfbW9kZV90ZXN0X2JpdCgKCQkJCSAgICBFVEhUT09MX0xJTktf
TU9ERV9Bc3ltX1BhdXNlX0JJVCwgbWFzaykpCgkJCQlmcHJpbnRmKHN0ZG91dCwgIiBSZWNlaXZl
LW9ubHkiKTsKCQkJZnByaW50ZihzdGRvdXQsICJcbiIpOwoJCX0gZWxzZSB7CgkJCWlmIChldGh0
b29sX2xpbmtfbW9kZV90ZXN0X2JpdCgKCQkJCSAgICBFVEhUT09MX0xJTktfTU9ERV9Bc3ltX1Bh
dXNlX0JJVCwgbWFzaykpCgkJCQlmcHJpbnRmKHN0ZG91dCwgIlRyYW5zbWl0LW9ubHlcbiIpOwoJ
CQllbHNlCgkJCQlmcHJpbnRmKHN0ZG91dCwgIk5vXG4iKTsKCQl9CgoJCWZwcmludGYoc3Rkb3V0
LCAiCSVzIGF1dG8tbmVnb3RpYXRpb246ICIsIGFuX3ByZWZpeCk7CgkJaWYgKGV0aHRvb2xfbGlu
a19tb2RlX3Rlc3RfYml0KAoJCQkgICAgRVRIVE9PTF9MSU5LX01PREVfQXV0b25lZ19CSVQsIG1h
c2spKQoJCQlmcHJpbnRmKHN0ZG91dCwgIlllc1xuIik7CgkJZWxzZQoJCQlmcHJpbnRmKHN0ZG91
dCwgIk5vXG4iKTsKCgkJZnByaW50ZihzdGRvdXQsICIJJXMgRkVDIG1vZGVzOiIsIHByZWZpeCk7
CgkJaWYgKGV0aHRvb2xfbGlua19tb2RlX3Rlc3RfYml0KEVUSFRPT0xfTElOS19NT0RFX0ZFQ19O
T05FX0JJVCwKCQkJCQkgICAgICAgbWFzaykpIHsKCQkJZnByaW50ZihzdGRvdXQsICIgTm9uZSIp
OwoJCQlmZWNyZXBvcnRlZCA9IDE7CgkJfQoJCWlmIChldGh0b29sX2xpbmtfbW9kZV90ZXN0X2Jp
dChFVEhUT09MX0xJTktfTU9ERV9GRUNfQkFTRVJfQklULAoJCQkJCSAgICAgICBtYXNrKSkgewoJ
CQlmcHJpbnRmKHN0ZG91dCwgIiBCYXNlUiIpOwoJCQlmZWNyZXBvcnRlZCA9IDE7CgkJfQoJCWlm
IChldGh0b29sX2xpbmtfbW9kZV90ZXN0X2JpdChFVEhUT09MX0xJTktfTU9ERV9GRUNfUlNfQklU
LAoJCQkJCSAgICAgICBtYXNrKSkgewoJCQlmcHJpbnRmKHN0ZG91dCwgIiBSUyIpOwoJCQlmZWNy
ZXBvcnRlZCA9IDE7CgkJfQoJCWlmIChldGh0b29sX2xpbmtfbW9kZV90ZXN0X2JpdChFVEhUT09M
X0xJTktfTU9ERV9GRUNfTExSU19CSVQsCgkJCQkJICAgICAgIG1hc2spKSB7CgkJCWZwcmludGYo
c3Rkb3V0LCAiIExMUlMiKTsKCQkJZmVjcmVwb3J0ZWQgPSAxOwoJCX0KCgkJaWYgKCFmZWNyZXBv
cnRlZCkKCQkJZnByaW50ZihzdGRvdXQsICIgTm90IHJlcG9ydGVkIik7CgkJZnByaW50ZihzdGRv
dXQsICJcbiIpOwoJfQp9CgpzdGF0aWMgaW50CmR1bXBfbGlua191c2V0dGluZ3MoY29uc3Qgc3Ry
dWN0IGV0aHRvb2xfbGlua191c2V0dGluZ3MgKmxpbmtfdXNldHRpbmdzKQp7CglkdW1wX3N1cHBv
cnRlZChsaW5rX3VzZXR0aW5ncyk7CglkdW1wX2xpbmtfY2FwcygiQWR2ZXJ0aXNlZCIsICJBZHZl
cnRpc2VkIiwKCQkgICAgICAgbGlua191c2V0dGluZ3MtPmxpbmtfbW9kZXMuYWR2ZXJ0aXNpbmcs
IDApOwoJaWYgKCFldGh0b29sX2xpbmtfbW9kZV9pc19lbXB0eSgKCQkgICAgbGlua191c2V0dGlu
Z3MtPmxpbmtfbW9kZXMubHBfYWR2ZXJ0aXNpbmcpKQoJCWR1bXBfbGlua19jYXBzKCJMaW5rIHBh
cnRuZXIgYWR2ZXJ0aXNlZCIsCgkJCSAgICAgICAiTGluayBwYXJ0bmVyIGFkdmVydGlzZWQiLAoJ
CQkgICAgICAgbGlua191c2V0dGluZ3MtPmxpbmtfbW9kZXMubHBfYWR2ZXJ0aXNpbmcsIDApOwoK
CWZwcmludGYoc3Rkb3V0LCAiCVNwZWVkOiAiKTsKCWlmIChsaW5rX3VzZXR0aW5ncy0+YmFzZS5z
cGVlZCA9PSAwCgkgICAgfHwgbGlua191c2V0dGluZ3MtPmJhc2Uuc3BlZWQgPT0gKHUxNikoLTEp
CgkgICAgfHwgbGlua191c2V0dGluZ3MtPmJhc2Uuc3BlZWQgPT0gKHUzMikoLTEpKQoJCWZwcmlu
dGYoc3Rkb3V0LCAiVW5rbm93biFcbiIpOwoJZWxzZQoJCWZwcmludGYoc3Rkb3V0LCAiJXVNYi9z
XG4iLCBsaW5rX3VzZXR0aW5ncy0+YmFzZS5zcGVlZCk7CgoJZnByaW50ZihzdGRvdXQsICIJRHVw
bGV4OiAiKTsKCXN3aXRjaCAobGlua191c2V0dGluZ3MtPmJhc2UuZHVwbGV4KSB7CgljYXNlIERV
UExFWF9IQUxGOgoJCWZwcmludGYoc3Rkb3V0LCAiSGFsZlxuIik7CgkJYnJlYWs7CgljYXNlIERV
UExFWF9GVUxMOgoJCWZwcmludGYoc3Rkb3V0LCAiRnVsbFxuIik7CgkJYnJlYWs7CglkZWZhdWx0
OgoJCWZwcmludGYoc3Rkb3V0LCAiVW5rbm93biEgKCVpKVxuIiwgbGlua191c2V0dGluZ3MtPmJh
c2UuZHVwbGV4KTsKCQlicmVhazsKCX07CgoJZnByaW50ZihzdGRvdXQsICIJUG9ydDogIik7Cglz
d2l0Y2ggKGxpbmtfdXNldHRpbmdzLT5iYXNlLnBvcnQpIHsKCWNhc2UgUE9SVF9UUDoKCQlmcHJp
bnRmKHN0ZG91dCwgIlR3aXN0ZWQgUGFpclxuIik7CgkJYnJlYWs7CgljYXNlIFBPUlRfQVVJOgoJ
CWZwcmludGYoc3Rkb3V0LCAiQVVJXG4iKTsKCQlicmVhazsKCWNhc2UgUE9SVF9CTkM6CgkJZnBy
aW50ZihzdGRvdXQsICJCTkNcbiIpOwoJCWJyZWFrOwoJY2FzZSBQT1JUX01JSToKCQlmcHJpbnRm
KHN0ZG91dCwgIk1JSVxuIik7CgkJYnJlYWs7CgljYXNlIFBPUlRfRklCUkU6CgkJZnByaW50Zihz
dGRvdXQsICJGSUJSRVxuIik7CgkJYnJlYWs7CgljYXNlIFBPUlRfREE6CgkJZnByaW50ZihzdGRv
dXQsICJEaXJlY3QgQXR0YWNoIENvcHBlclxuIik7CgkJYnJlYWs7CgljYXNlIFBPUlRfTk9ORToK
CQlmcHJpbnRmKHN0ZG91dCwgIk5vbmVcbiIpOwoJCWJyZWFrOwoJY2FzZSBQT1JUX09USEVSOgoJ
CWZwcmludGYoc3Rkb3V0LCAiT3RoZXJcbiIpOwoJCWJyZWFrOwoJZGVmYXVsdDoKCQlmcHJpbnRm
KHN0ZG91dCwgIlVua25vd24hICglaSlcbiIsIGxpbmtfdXNldHRpbmdzLT5iYXNlLnBvcnQpOwoJ
CWJyZWFrOwoJfTsKCglmcHJpbnRmKHN0ZG91dCwgIglQSFlBRDogJWRcbiIsIGxpbmtfdXNldHRp
bmdzLT5iYXNlLnBoeV9hZGRyZXNzKTsKCWZwcmludGYoc3Rkb3V0LCAiCVRyYW5zY2VpdmVyOiAi
KTsKCXN3aXRjaCAobGlua191c2V0dGluZ3MtPmRlcHJlY2F0ZWQudHJhbnNjZWl2ZXIpIHsKCWNh
c2UgWENWUl9JTlRFUk5BTDoKCQlmcHJpbnRmKHN0ZG91dCwgImludGVybmFsXG4iKTsKCQlicmVh
azsKCWNhc2UgWENWUl9FWFRFUk5BTDoKCQlmcHJpbnRmKHN0ZG91dCwgImV4dGVybmFsXG4iKTsK
CQlicmVhazsKCWRlZmF1bHQ6CgkJZnByaW50ZihzdGRvdXQsICJVbmtub3duIVxuIik7CgkJYnJl
YWs7Cgl9OwoKCWZwcmludGYoc3Rkb3V0LCAiCUF1dG8tbmVnb3RpYXRpb246ICVzXG4iLAoJCShs
aW5rX3VzZXR0aW5ncy0+YmFzZS5hdXRvbmVnID09IEFVVE9ORUdfRElTQUJMRSkgPwoJCSJvZmYi
IDogIm9uIik7CgoJaWYgKGxpbmtfdXNldHRpbmdzLT5iYXNlLnBvcnQgPT0gUE9SVF9UUCkKCQlk
dW1wX21kaXgobGlua191c2V0dGluZ3MtPmJhc2UuZXRoX3RwX21kaXgsCgkJCSAgbGlua191c2V0
dGluZ3MtPmJhc2UuZXRoX3RwX21kaXhfY3RybCk7CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQg
ZHVtcF9kcnZpbmZvKHN0cnVjdCBldGh0b29sX2RydmluZm8gKmluZm8pCnsKCWZwcmludGYoc3Rk
b3V0LAoJCSJkcml2ZXI6ICUuKnNcbiIKCQkidmVyc2lvbjogJS4qc1xuIgoJCSJmaXJtd2FyZS12
ZXJzaW9uOiAlLipzXG4iCgkJImV4cGFuc2lvbi1yb20tdmVyc2lvbjogJS4qc1xuIgoJCSJidXMt
aW5mbzogJS4qc1xuIgoJCSJzdXBwb3J0cy1zdGF0aXN0aWNzOiAlc1xuIgoJCSJzdXBwb3J0cy10
ZXN0OiAlc1xuIgoJCSJzdXBwb3J0cy1lZXByb20tYWNjZXNzOiAlc1xuIgoJCSJzdXBwb3J0cy1y
ZWdpc3Rlci1kdW1wOiAlc1xuIgoJCSJzdXBwb3J0cy1wcml2LWZsYWdzOiAlc1xuIiwKCQkoaW50
KXNpemVvZihpbmZvLT5kcml2ZXIpLCBpbmZvLT5kcml2ZXIsCgkJKGludClzaXplb2YoaW5mby0+
dmVyc2lvbiksIGluZm8tPnZlcnNpb24sCgkJKGludClzaXplb2YoaW5mby0+ZndfdmVyc2lvbiks
IGluZm8tPmZ3X3ZlcnNpb24sCgkJKGludClzaXplb2YoaW5mby0+ZXJvbV92ZXJzaW9uKSwgaW5m
by0+ZXJvbV92ZXJzaW9uLAoJCShpbnQpc2l6ZW9mKGluZm8tPmJ1c19pbmZvKSwgaW5mby0+YnVz
X2luZm8sCgkJaW5mby0+bl9zdGF0cyA/ICJ5ZXMiIDogIm5vIiwKCQlpbmZvLT50ZXN0aW5mb19s
ZW4gPyAieWVzIiA6ICJubyIsCgkJaW5mby0+ZWVkdW1wX2xlbiA/ICJ5ZXMiIDogIm5vIiwKCQlp
bmZvLT5yZWdkdW1wX2xlbiA/ICJ5ZXMiIDogIm5vIiwKCQlpbmZvLT5uX3ByaXZfZmxhZ3MgPyAi
eWVzIiA6ICJubyIpOwoKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IHBhcnNlX3dvbG9wdHMoY2hh
ciAqb3B0c3RyLCB1MzIgKmRhdGEpCnsKCSpkYXRhID0gMDsKCXdoaWxlICgqb3B0c3RyKSB7CgkJ
c3dpdGNoICgqb3B0c3RyKSB7CgkJY2FzZSAncCc6CgkJCSpkYXRhIHw9IFdBS0VfUEhZOwoJCQli
cmVhazsKCQljYXNlICd1JzoKCQkJKmRhdGEgfD0gV0FLRV9VQ0FTVDsKCQkJYnJlYWs7CgkJY2Fz
ZSAnbSc6CgkJCSpkYXRhIHw9IFdBS0VfTUNBU1Q7CgkJCWJyZWFrOwoJCWNhc2UgJ2InOgoJCQkq
ZGF0YSB8PSBXQUtFX0JDQVNUOwoJCQlicmVhazsKCQljYXNlICdhJzoKCQkJKmRhdGEgfD0gV0FL
RV9BUlA7CgkJCWJyZWFrOwoJCWNhc2UgJ2cnOgoJCQkqZGF0YSB8PSBXQUtFX01BR0lDOwoJCQli
cmVhazsKCQljYXNlICdzJzoKCQkJKmRhdGEgfD0gV0FLRV9NQUdJQ1NFQ1VSRTsKCQkJYnJlYWs7
CgkJY2FzZSAnZic6CgkJCSpkYXRhIHw9IFdBS0VfRklMVEVSOwoJCQlicmVhazsKCQljYXNlICdk
JzoKCQkJKmRhdGEgPSAwOwoJCQlicmVhazsKCQlkZWZhdWx0OgoJCQlyZXR1cm4gLTE7CgkJfQoJ
CW9wdHN0cisrOwoJfQoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgcGFyc2VfcnhmaGFzaG9wdHMo
Y2hhciAqb3B0c3RyLCB1MzIgKmRhdGEpCnsKCSpkYXRhID0gMDsKCXdoaWxlICgqb3B0c3RyKSB7
CgkJc3dpdGNoICgqb3B0c3RyKSB7CgkJY2FzZSAnbSc6CgkJCSpkYXRhIHw9IFJYSF9MMkRBOwoJ
CQlicmVhazsKCQljYXNlICd2JzoKCQkJKmRhdGEgfD0gUlhIX1ZMQU47CgkJCWJyZWFrOwoJCWNh
c2UgJ3QnOgoJCQkqZGF0YSB8PSBSWEhfTDNfUFJPVE87CgkJCWJyZWFrOwoJCWNhc2UgJ3MnOgoJ
CQkqZGF0YSB8PSBSWEhfSVBfU1JDOwoJCQlicmVhazsKCQljYXNlICdkJzoKCQkJKmRhdGEgfD0g
UlhIX0lQX0RTVDsKCQkJYnJlYWs7CgkJY2FzZSAnZic6CgkJCSpkYXRhIHw9IFJYSF9MNF9CXzBf
MTsKCQkJYnJlYWs7CgkJY2FzZSAnbic6CgkJCSpkYXRhIHw9IFJYSF9MNF9CXzJfMzsKCQkJYnJl
YWs7CgkJY2FzZSAncic6CgkJCSpkYXRhIHw9IFJYSF9ESVNDQVJEOwoJCQlicmVhazsKCQlkZWZh
dWx0OgoJCQlyZXR1cm4gLTE7CgkJfQoJCW9wdHN0cisrOwoJfQoJcmV0dXJuIDA7Cn0KCnN0YXRp
YyBjaGFyICp1bnBhcnNlX3J4Zmhhc2hvcHRzKHU2NCBvcHRzKQp7CglzdGF0aWMgY2hhciBidWZb
MzAwXTsKCgltZW1zZXQoYnVmLCAwLCBzaXplb2YoYnVmKSk7CgoJaWYgKG9wdHMpIHsKCQlpZiAo
b3B0cyAmIFJYSF9MMkRBKQoJCQlzdHJjYXQoYnVmLCAiTDJEQVxuIik7CgkJaWYgKG9wdHMgJiBS
WEhfVkxBTikKCQkJc3RyY2F0KGJ1ZiwgIlZMQU4gdGFnXG4iKTsKCQlpZiAob3B0cyAmIFJYSF9M
M19QUk9UTykKCQkJc3RyY2F0KGJ1ZiwgIkwzIHByb3RvXG4iKTsKCQlpZiAob3B0cyAmIFJYSF9J
UF9TUkMpCgkJCXN0cmNhdChidWYsICJJUCBTQVxuIik7CgkJaWYgKG9wdHMgJiBSWEhfSVBfRFNU
KQoJCQlzdHJjYXQoYnVmLCAiSVAgREFcbiIpOwoJCWlmIChvcHRzICYgUlhIX0w0X0JfMF8xKQoJ
CQlzdHJjYXQoYnVmLCAiTDQgYnl0ZXMgMCAmIDEgW1RDUC9VRFAgc3JjIHBvcnRdXG4iKTsKCQlp
ZiAob3B0cyAmIFJYSF9MNF9CXzJfMykKCQkJc3RyY2F0KGJ1ZiwgIkw0IGJ5dGVzIDIgJiAzIFtU
Q1AvVURQIGRzdCBwb3J0XVxuIik7Cgl9IGVsc2UgewoJCXNwcmludGYoYnVmLCAiTm9uZSIpOwoJ
fQoKCXJldHVybiBidWY7Cn0KCnN0YXRpYyBpbnQgY29udmVydF9zdHJpbmdfdG9faGFzaGtleShj
aGFyICpyc3NfaGtleSwgdTMyIGtleV9zaXplLAoJCQkJICAgICBjb25zdCBjaGFyICpyc3NfaGtl
eV9zdHJpbmcpCnsKCXUzMiBpID0gMDsKCWludCBoZXhfYnl0ZSwgbGVuOwoKCWRvIHsKCQlpZiAo
aSA+IChrZXlfc2l6ZSAtIDEpKSB7CgkJCWZwcmludGYoc3RkZXJyLAoJCQkJIktleSBpcyB0b28g
bG9uZyBmb3IgZGV2aWNlICgldSA+ICV1KVxuIiwKCQkJCWkgKyAxLCBrZXlfc2l6ZSk7CgkJCWdv
dG8gZXJyOwoJCX0KCgkJaWYgKHNzY2FuZihyc3NfaGtleV9zdHJpbmcsICIlMnglbiIsICZoZXhf
Ynl0ZSwgJmxlbikgPCAxIHx8CgkJICAgIGxlbiAhPSAyKSB7CgkJCWZwcmludGYoc3RkZXJyLCAi
SW52YWxpZCBSU1MgaGFzaCBrZXkgZm9ybWF0XG4iKTsKCQkJZ290byBlcnI7CgkJfQoKCQlyc3Nf
aGtleVtpKytdID0gaGV4X2J5dGU7CgkJcnNzX2hrZXlfc3RyaW5nICs9IDI7CgoJCWlmICgqcnNz
X2hrZXlfc3RyaW5nID09ICc6JykgewoJCQlyc3NfaGtleV9zdHJpbmcrKzsKCQl9IGVsc2UgaWYg
KCpyc3NfaGtleV9zdHJpbmcgIT0gJ1wwJykgewoJCQlmcHJpbnRmKHN0ZGVyciwgIkludmFsaWQg
UlNTIGhhc2gga2V5IGZvcm1hdFxuIik7CgkJCWdvdG8gZXJyOwoJCX0KCgl9IHdoaWxlICgqcnNz
X2hrZXlfc3RyaW5nKTsKCglpZiAoaSAhPSBrZXlfc2l6ZSkgewoJCWZwcmludGYoc3RkZXJyLCAi
S2V5IGlzIHRvbyBzaG9ydCBmb3IgZGV2aWNlICgldSA8ICV1KVxuIiwKCQkJaSwga2V5X3NpemUp
OwoJCWdvdG8gZXJyOwoJfQoKCXJldHVybiAwOwplcnI6CglyZXR1cm4gMjsKfQoKc3RhdGljIGlu
dCBwYXJzZV9oa2V5KGNoYXIgKipyc3NfaGtleSwgdTMyIGtleV9zaXplLAoJCSAgICAgIGNvbnN0
IGNoYXIgKnJzc19oa2V5X3N0cmluZykKewoJaWYgKCFrZXlfc2l6ZSkgewoJCWZwcmludGYoc3Rk
ZXJyLAoJCQkiQ2Fubm90IHNldCBSWCBmbG93IGhhc2ggY29uZmlndXJhdGlvbjpcbiIKCQkJIiBI
YXNoIGtleSBzZXR0aW5nIG5vdCBzdXBwb3J0ZWRcbiIpOwoJCXJldHVybiAxOwoJfQoKCSpyc3Nf
aGtleSA9IG1hbGxvYyhrZXlfc2l6ZSk7CglpZiAoISgqcnNzX2hrZXkpKSB7CgkJcGVycm9yKCJD
YW5ub3QgYWxsb2NhdGUgbWVtb3J5IGZvciBSU1MgaGFzaCBrZXkiKTsKCQlyZXR1cm4gMTsKCX0K
CglpZiAoY29udmVydF9zdHJpbmdfdG9faGFzaGtleSgqcnNzX2hrZXksIGtleV9zaXplLAoJCQkJ
ICAgICAgcnNzX2hrZXlfc3RyaW5nKSkgewoJCWZyZWUoKnJzc19oa2V5KTsKCQkqcnNzX2hrZXkg
PSBOVUxMOwoJCXJldHVybiAyOwoJfQoJcmV0dXJuIDA7Cn0KCiNpZmRlZiBFVEhUT09MX0VOQUJM
RV9QUkVUVFlfRFVNUApzdGF0aWMgY29uc3Qgc3RydWN0IHsKCWNvbnN0IGNoYXIgKm5hbWU7Cglp
bnQgKCpmdW5jKShzdHJ1Y3QgZXRodG9vbF9kcnZpbmZvICppbmZvLCBzdHJ1Y3QgZXRodG9vbF9y
ZWdzICpyZWdzKTsKCn0gZHJpdmVyX2xpc3RbXSA9IHsKCXsgIjgxMzljcCIsIHJlYWx0ZWtfZHVt
cF9yZWdzIH0sCgl7ICI4MTM5dG9vIiwgcmVhbHRla19kdW1wX3JlZ3MgfSwKCXsgInI4MTY5Iiwg
cmVhbHRla19kdW1wX3JlZ3MgfSwKCXsgImRlMjEwNHgiLCBkZTIxMDR4X2R1bXBfcmVncyB9LAoJ
eyAiZTEwMDAiLCBlMTAwMF9kdW1wX3JlZ3MgfSwKCXsgImUxMDAwZSIsIGUxMDAwX2R1bXBfcmVn
cyB9LAoJeyAiaWdiIiwgaWdiX2R1bXBfcmVncyB9LAoJeyAiaXhnYiIsIGl4Z2JfZHVtcF9yZWdz
IH0sCgl7ICJpeGdiZSIsIGl4Z2JlX2R1bXBfcmVncyB9LAoJeyAiaXhnYmV2ZiIsIGl4Z2JldmZf
ZHVtcF9yZWdzIH0sCgl7ICJuYXRzZW1pIiwgbmF0c2VtaV9kdW1wX3JlZ3MgfSwKCXsgImUxMDAi
LCBlMTAwX2R1bXBfcmVncyB9LAoJeyAiYW1kODExMWUiLCBhbWQ4MTExZV9kdW1wX3JlZ3MgfSwK
CXsgInBjbmV0MzIiLCBwY25ldDMyX2R1bXBfcmVncyB9LAoJeyAiZmVjXzh4eCIsIGZlY184eHhf
ZHVtcF9yZWdzIH0sCgl7ICJpYm1fZW1hYyIsIGlibV9lbWFjX2R1bXBfcmVncyB9LAoJeyAidGcz
IiwgdGczX2R1bXBfcmVncyB9LAoJeyAic2tnZSIsIHNrZ2VfZHVtcF9yZWdzIH0sCgl7ICJza3ky
Iiwgc2t5Ml9kdW1wX3JlZ3MgfSwKCXsgInZpb2MiLCB2aW9jX2R1bXBfcmVncyB9LAoJeyAic21z
YzkxMXgiLCBzbXNjOTExeF9kdW1wX3JlZ3MgfSwKCXsgImF0NzZjNTB4LXVzYiIsIGF0NzZjNTB4
X3VzYl9kdW1wX3JlZ3MgfSwKCXsgInNmYyIsIHNmY19kdW1wX3JlZ3MgfSwKCXsgInN0X21hYzEw
MCIsIHN0X21hYzEwMF9kdW1wX3JlZ3MgfSwKCXsgInN0X2dtYWMiLCBzdF9nbWFjX2R1bXBfcmVn
cyB9LAoJeyAiZXQxMzF4IiwgZXQxMzF4X2R1bXBfcmVncyB9LAoJeyAiYWx0ZXJhX3RzZSIsIGFs
dGVyYV90c2VfZHVtcF9yZWdzIH0sCgl7ICJ2bXhuZXQzIiwgdm14bmV0M19kdW1wX3JlZ3MgfSwK
CXsgImZqZXMiLCBmamVzX2R1bXBfcmVncyB9LAoJeyAibGFuNzh4eCIsIGxhbjc4eHhfZHVtcF9y
ZWdzIH0sCgl7ICJkc2EiLCBkc2FfZHVtcF9yZWdzIH0sCgl7ICJmZWMiLCBmZWNfZHVtcF9yZWdz
IH0sCgl7ICJpZ2MiLCBpZ2NfZHVtcF9yZWdzIH0sCgl7ICJibnh0X2VuIiwgYm54dF9kdW1wX3Jl
Z3MgfSwKCXsgImNwc3ctc3dpdGNoIiwgY3Bzd19kdW1wX3JlZ3MgfSwKCXsgImxhbjc0M3giLCBs
YW43NDN4X2R1bXBfcmVncyB9LAoJeyAiZnNsX2VuZXRjIiwgZnNsX2VuZXRjX2R1bXBfcmVncyB9
LAoJeyAiZnNsX2VuZXRjX3ZmIiwgZnNsX2VuZXRjX2R1bXBfcmVncyB9LAoJeyAiaG5zMyIsIGhu
czNfZHVtcF9yZWdzIH0sCn07CiNlbmRpZgoKdm9pZCBkdW1wX2hleChGSUxFICpmaWxlLCBjb25z
dCB1OCAqZGF0YSwgaW50IGxlbiwgaW50IG9mZnNldCkKewoJaW50IGk7CgoJZnByaW50ZihmaWxl
LCAiT2Zmc2V0XHRcdFZhbHVlc1xuIik7CglmcHJpbnRmKGZpbGUsICItLS0tLS1cdFx0LS0tLS0t
Iik7Cglmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKCQlpZiAoaSAlIDE2ID09IDApCgkJCWZw
cmludGYoZmlsZSwgIlxuMHglMDR4Olx0XHQiLCBpICsgb2Zmc2V0KTsKCQlmcHJpbnRmKGZpbGUs
ICIlMDJ4ICIsIGRhdGFbaV0pOwoJfQoJZnByaW50ZihmaWxlLCAiXG4iKTsKfQoKc3RhdGljIGlu
dCBkdW1wX3JlZ3MoaW50IGdyZWdzX2R1bXBfcmF3LCBpbnQgZ3JlZ3NfZHVtcF9oZXgsCgkJICAg
ICBzdHJ1Y3QgZXRodG9vbF9kcnZpbmZvICppbmZvLCBzdHJ1Y3QgZXRodG9vbF9yZWdzICpyZWdz
KQp7CglpZiAoZ3JlZ3NfZHVtcF9yYXcpIHsKCQlmd3JpdGUocmVncy0+ZGF0YSwgcmVncy0+bGVu
LCAxLCBzdGRvdXQpOwoJCWdvdG8gbmVzdGVkOwoJfQoKI2lmZGVmIEVUSFRPT0xfRU5BQkxFX1BS
RVRUWV9EVU1QCglpZiAoIWdyZWdzX2R1bXBfaGV4KSB7CgkJdW5zaWduZWQgaW50IGk7CgoJCWZv
ciAoaSA9IDA7IGkgPCBBUlJBWV9TSVpFKGRyaXZlcl9saXN0KTsgaSsrKQoJCQlpZiAoIXN0cm5j
bXAoZHJpdmVyX2xpc3RbaV0ubmFtZSwgaW5mby0+ZHJpdmVyLAoJCQkJICAgICBFVEhUT09MX0JV
U0lORk9fTEVOKSkgewoJCQkJaWYgKGRyaXZlcl9saXN0W2ldLmZ1bmMoaW5mbywgcmVncykgPT0g
MCkKCQkJCQlnb3RvIG5lc3RlZDsKCQkJCS8qIFRoaXMgdmVyc2lvbiAob3Igc29tZSBvdGhlcgoJ
CQkJICogdmFyaWF0aW9uIGluIHRoZSBkdW1wIGZvcm1hdCkgaXMKCQkJCSAqIG5vdCBoYW5kbGVk
OyBmYWxsIGJhY2sgdG8gaGV4CgkJCQkgKi8KCQkJCWJyZWFrOwoJCQl9Cgl9CiNlbmRpZgoKCWR1
bXBfaGV4KHN0ZG91dCwgcmVncy0+ZGF0YSwgcmVncy0+bGVuLCAwKTsKCm5lc3RlZDoKCS8qIFJl
Y3Vyc2UgZHVtcCBpZiBzb21lIGRydmluZm8gYW5kIHJlZ3Mgc3RydWN0dXJlcyBhcmUgbmVzdGVk
ICovCglpZiAoaW5mby0+cmVnZHVtcF9sZW4gPiByZWdzLT5sZW4gKyBzaXplb2YoKmluZm8pICsg
c2l6ZW9mKCpyZWdzKSkgewoJCWluZm8gPSAoc3RydWN0IGV0aHRvb2xfZHJ2aW5mbyAqKSgmcmVn
cy0+ZGF0YVswXSArIHJlZ3MtPmxlbik7CgkJcmVncyA9IChzdHJ1Y3QgZXRodG9vbF9yZWdzICop
KCZyZWdzLT5kYXRhWzBdICsgcmVncy0+bGVuICsgc2l6ZW9mKCppbmZvKSk7CgoJCXJldHVybiBk
dW1wX3JlZ3MoZ3JlZ3NfZHVtcF9yYXcsIGdyZWdzX2R1bXBfaGV4LCBpbmZvLCByZWdzKTsKCX0K
CglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBkdW1wX2VlcHJvbShpbnQgZ2VlcHJvbV9kdW1wX3Jh
dywKCQkgICAgICAgc3RydWN0IGV0aHRvb2xfZHJ2aW5mbyAqaW5mbyBfX21heWJlX3VudXNlZCwK
CQkgICAgICAgc3RydWN0IGV0aHRvb2xfZWVwcm9tICplZSkKewoJaWYgKGdlZXByb21fZHVtcF9y
YXcpIHsKCQlmd3JpdGUoZWUtPmRhdGEsIDEsIGVlLT5sZW4sIHN0ZG91dCk7CgkJcmV0dXJuIDA7
Cgl9CiNpZmRlZiBFVEhUT09MX0VOQUJMRV9QUkVUVFlfRFVNUAoJaWYgKCFzdHJuY21wKCJuYXRz
ZW1pIiwgaW5mby0+ZHJpdmVyLCBFVEhUT09MX0JVU0lORk9fTEVOKSkgewoJCXJldHVybiBuYXRz
ZW1pX2R1bXBfZWVwcm9tKGluZm8sIGVlKTsKCX0gZWxzZSBpZiAoIXN0cm5jbXAoInRnMyIsIGlu
Zm8tPmRyaXZlciwgRVRIVE9PTF9CVVNJTkZPX0xFTikpIHsKCQlyZXR1cm4gdGczX2R1bXBfZWVw
cm9tKGluZm8sIGVlKTsKCX0KI2VuZGlmCglkdW1wX2hleChzdGRvdXQsIGVlLT5kYXRhLCBlZS0+
bGVuLCBlZS0+b2Zmc2V0KTsKCglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBkdW1wX3Rlc3Qoc3Ry
dWN0IGV0aHRvb2xfdGVzdCAqdGVzdCwKCQkgICAgIHN0cnVjdCBldGh0b29sX2dzdHJpbmdzICpz
dHJpbmdzKQp7Cgl1bnNpZ25lZCBpbnQgaTsKCWludCByYzsKCglyYyA9IHRlc3QtPmZsYWdzICYg
RVRIX1RFU1RfRkxfRkFJTEVEOwoJZnByaW50ZihzdGRvdXQsICJUaGUgdGVzdCByZXN1bHQgaXMg
JXNcbiIsIHJjID8gIkZBSUwiIDogIlBBU1MiKTsKCglpZiAodGVzdC0+ZmxhZ3MgJiBFVEhfVEVT
VF9GTF9FWFRFUk5BTF9MQikKCQlmcHJpbnRmKHN0ZG91dCwgIkV4dGVybmFsIGxvb3BiYWNrIHRl
c3Qgd2FzICVzZXhlY3V0ZWRcbiIsCgkJCSh0ZXN0LT5mbGFncyAmIEVUSF9URVNUX0ZMX0VYVEVS
TkFMX0xCX0RPTkUpID8KCQkJIiIgOiAibm90ICIpOwoKCWlmIChzdHJpbmdzLT5sZW4pCgkJZnBy
aW50ZihzdGRvdXQsICJUaGUgdGVzdCBleHRyYSBpbmZvOlxuIik7CgoJZm9yIChpID0gMDsgaSA8
IHN0cmluZ3MtPmxlbjsgaSsrKSB7CgkJZnByaW50ZihzdGRvdXQsICIlc1x0ICVkXG4iLAoJCQko
Y2hhciAqKShzdHJpbmdzLT5kYXRhICsgaSAqIEVUSF9HU1RSSU5HX0xFTiksCgkJCSh1MzIpIHRl
c3QtPmRhdGFbaV0pOwoJfQoKCWZwcmludGYoc3Rkb3V0LCAiXG4iKTsKCXJldHVybiByYzsKfQoK
c3RhdGljIGludCBkdW1wX3BhdXNlKGNvbnN0IHN0cnVjdCBldGh0b29sX3BhdXNlcGFyYW0gKmVw
YXVzZSwKCQkgICAgICB1MzIgYWR2ZXJ0aXNpbmcsIHUzMiBscF9hZHZlcnRpc2luZykKewoJZnBy
aW50ZihzdGRvdXQsCgkJIkF1dG9uZWdvdGlhdGU6CSVzXG4iCgkJIlJYOgkJJXNcbiIKCQkiVFg6
CQklc1xuIiwKCQllcGF1c2UtPmF1dG9uZWcgPyAib24iIDogIm9mZiIsCgkJZXBhdXNlLT5yeF9w
YXVzZSA/ICJvbiIgOiAib2ZmIiwKCQllcGF1c2UtPnR4X3BhdXNlID8gIm9uIiA6ICJvZmYiKTsK
CglpZiAobHBfYWR2ZXJ0aXNpbmcpIHsKCQlpbnQgYW5fcnggPSAwLCBhbl90eCA9IDA7CgoJCS8q
IFdvcmsgb3V0IG5lZ290aWF0ZWQgcGF1c2UgZnJhbWUgdXNhZ2UgcGVyCgkJICogSUVFRSA4MDIu
My0yMDA1IHRhYmxlIDI4Qi0zLgoJCSAqLwoJCWlmIChhZHZlcnRpc2luZyAmIGxwX2FkdmVydGlz
aW5nICYgQURWRVJUSVNFRF9QYXVzZSkgewoJCQlhbl90eCA9IDE7CgkJCWFuX3J4ID0gMTsKCQl9
IGVsc2UgaWYgKGFkdmVydGlzaW5nICYgbHBfYWR2ZXJ0aXNpbmcgJgoJCQkgICBBRFZFUlRJU0VE
X0FzeW1fUGF1c2UpIHsKCQkJaWYgKGFkdmVydGlzaW5nICYgQURWRVJUSVNFRF9QYXVzZSkKCQkJ
CWFuX3J4ID0gMTsKCQkJZWxzZSBpZiAobHBfYWR2ZXJ0aXNpbmcgJiBBRFZFUlRJU0VEX1BhdXNl
KQoJCQkJYW5fdHggPSAxOwoJCX0KCgkJZnByaW50ZihzdGRvdXQsCgkJCSJSWCBuZWdvdGlhdGVk
Ogklc1xuIgoJCQkiVFggbmVnb3RpYXRlZDoJJXNcbiIsCgkJCWFuX3J4ID8gIm9uIiA6ICJvZmYi
LAoJCQlhbl90eCA/ICJvbiIgOiAib2ZmIik7Cgl9CgoJZnByaW50ZihzdGRvdXQsICJcbiIpOwoJ
cmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgZHVtcF9yaW5nKGNvbnN0IHN0cnVjdCBldGh0b29sX3Jp
bmdwYXJhbSAqZXJpbmcpCnsKCWZwcmludGYoc3Rkb3V0LAoJCSJQcmUtc2V0IG1heGltdW1zOlxu
IgoJCSJSWDoJCSV1XG4iCgkJIlJYIE1pbmk6CSV1XG4iCgkJIlJYIEp1bWJvOgkldVxuIgoJCSJU
WDoJCSV1XG4iLAoJCWVyaW5nLT5yeF9tYXhfcGVuZGluZywKCQllcmluZy0+cnhfbWluaV9tYXhf
cGVuZGluZywKCQllcmluZy0+cnhfanVtYm9fbWF4X3BlbmRpbmcsCgkJZXJpbmctPnR4X21heF9w
ZW5kaW5nKTsKCglmcHJpbnRmKHN0ZG91dCwKCQkiQ3VycmVudCBoYXJkd2FyZSBzZXR0aW5nczpc
biIKCQkiUlg6CQkldVxuIgoJCSJSWCBNaW5pOgkldVxuIgoJCSJSWCBKdW1ibzoJJXVcbiIKCQki
VFg6CQkldVxuIiwKCQllcmluZy0+cnhfcGVuZGluZywKCQllcmluZy0+cnhfbWluaV9wZW5kaW5n
LAoJCWVyaW5nLT5yeF9qdW1ib19wZW5kaW5nLAoJCWVyaW5nLT50eF9wZW5kaW5nKTsKCglmcHJp
bnRmKHN0ZG91dCwgIlxuIik7CglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBkdW1wX2NoYW5uZWxz
KGNvbnN0IHN0cnVjdCBldGh0b29sX2NoYW5uZWxzICplY2hhbm5lbHMpCnsKCWZwcmludGYoc3Rk
b3V0LAoJCSJQcmUtc2V0IG1heGltdW1zOlxuIgoJCSJSWDoJCSV1XG4iCgkJIlRYOgkJJXVcbiIK
CQkiT3RoZXI6CQkldVxuIgoJCSJDb21iaW5lZDoJJXVcbiIsCgkJZWNoYW5uZWxzLT5tYXhfcngs
IGVjaGFubmVscy0+bWF4X3R4LAoJCWVjaGFubmVscy0+bWF4X290aGVyLAoJCWVjaGFubmVscy0+
bWF4X2NvbWJpbmVkKTsKCglmcHJpbnRmKHN0ZG91dCwKCQkiQ3VycmVudCBoYXJkd2FyZSBzZXR0
aW5nczpcbiIKCQkiUlg6CQkldVxuIgoJCSJUWDoJCSV1XG4iCgkJIk90aGVyOgkJJXVcbiIKCQki
Q29tYmluZWQ6CSV1XG4iLAoJCWVjaGFubmVscy0+cnhfY291bnQsIGVjaGFubmVscy0+dHhfY291
bnQsCgkJZWNoYW5uZWxzLT5vdGhlcl9jb3VudCwKCQllY2hhbm5lbHMtPmNvbWJpbmVkX2NvdW50
KTsKCglmcHJpbnRmKHN0ZG91dCwgIlxuIik7CglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBkdW1w
X2NvYWxlc2NlKGNvbnN0IHN0cnVjdCBldGh0b29sX2NvYWxlc2NlICplY29hbCkKewoJZnByaW50
ZihzdGRvdXQsICJBZGFwdGl2ZSBSWDogJXMgIFRYOiAlc1xuIiwKCQllY29hbC0+dXNlX2FkYXB0
aXZlX3J4X2NvYWxlc2NlID8gIm9uIiA6ICJvZmYiLAoJCWVjb2FsLT51c2VfYWRhcHRpdmVfdHhf
Y29hbGVzY2UgPyAib24iIDogIm9mZiIpOwoKCWZwcmludGYoc3Rkb3V0LAoJCSJzdGF0cy1ibG9j
ay11c2VjczogJXVcbiIKCQkic2FtcGxlLWludGVydmFsOiAldVxuIgoJCSJwa3QtcmF0ZS1sb3c6
ICV1XG4iCgkJInBrdC1yYXRlLWhpZ2g6ICV1XG4iCgkJIlxuIgoJCSJyeC11c2VjczogJXVcbiIK
CQkicngtZnJhbWVzOiAldVxuIgoJCSJyeC11c2Vjcy1pcnE6ICV1XG4iCgkJInJ4LWZyYW1lcy1p
cnE6ICV1XG4iCgkJIlxuIgoJCSJ0eC11c2VjczogJXVcbiIKCQkidHgtZnJhbWVzOiAldVxuIgoJ
CSJ0eC11c2Vjcy1pcnE6ICV1XG4iCgkJInR4LWZyYW1lcy1pcnE6ICV1XG4iCgkJIlxuIgoJCSJy
eC11c2Vjcy1sb3c6ICV1XG4iCgkJInJ4LWZyYW1lcy1sb3c6ICV1XG4iCgkJInR4LXVzZWNzLWxv
dzogJXVcbiIKCQkidHgtZnJhbWVzLWxvdzogJXVcbiIKCQkiXG4iCgkJInJ4LXVzZWNzLWhpZ2g6
ICV1XG4iCgkJInJ4LWZyYW1lcy1oaWdoOiAldVxuIgoJCSJ0eC11c2Vjcy1oaWdoOiAldVxuIgoJ
CSJ0eC1mcmFtZXMtaGlnaDogJXVcbiIKCQkiXG4iLAoJCWVjb2FsLT5zdGF0c19ibG9ja19jb2Fs
ZXNjZV91c2VjcywKCQllY29hbC0+cmF0ZV9zYW1wbGVfaW50ZXJ2YWwsCgkJZWNvYWwtPnBrdF9y
YXRlX2xvdywKCQllY29hbC0+cGt0X3JhdGVfaGlnaCwKCgkJZWNvYWwtPnJ4X2NvYWxlc2NlX3Vz
ZWNzLAoJCWVjb2FsLT5yeF9tYXhfY29hbGVzY2VkX2ZyYW1lcywKCQllY29hbC0+cnhfY29hbGVz
Y2VfdXNlY3NfaXJxLAoJCWVjb2FsLT5yeF9tYXhfY29hbGVzY2VkX2ZyYW1lc19pcnEsCgoJCWVj
b2FsLT50eF9jb2FsZXNjZV91c2VjcywKCQllY29hbC0+dHhfbWF4X2NvYWxlc2NlZF9mcmFtZXMs
CgkJZWNvYWwtPnR4X2NvYWxlc2NlX3VzZWNzX2lycSwKCQllY29hbC0+dHhfbWF4X2NvYWxlc2Nl
ZF9mcmFtZXNfaXJxLAoKCQllY29hbC0+cnhfY29hbGVzY2VfdXNlY3NfbG93LAoJCWVjb2FsLT5y
eF9tYXhfY29hbGVzY2VkX2ZyYW1lc19sb3csCgkJZWNvYWwtPnR4X2NvYWxlc2NlX3VzZWNzX2xv
dywKCQllY29hbC0+dHhfbWF4X2NvYWxlc2NlZF9mcmFtZXNfbG93LAoKCQllY29hbC0+cnhfY29h
bGVzY2VfdXNlY3NfaGlnaCwKCQllY29hbC0+cnhfbWF4X2NvYWxlc2NlZF9mcmFtZXNfaGlnaCwK
CQllY29hbC0+dHhfY29hbGVzY2VfdXNlY3NfaGlnaCwKCQllY29hbC0+dHhfbWF4X2NvYWxlc2Nl
ZF9mcmFtZXNfaGlnaCk7CgoJcmV0dXJuIDA7Cn0KCnZvaWQgZHVtcF9wZXJfcXVldWVfY29hbGVz
Y2Uoc3RydWN0IGV0aHRvb2xfcGVyX3F1ZXVlX29wICpwZXJfcXVldWVfb3B0LAoJCQkgICAgIF9f
dTMyICpxdWV1ZV9tYXNrLCBpbnQgbl9xdWV1ZXMpCnsKCXN0cnVjdCBldGh0b29sX2NvYWxlc2Nl
ICplY29hbDsKCWludCBpLCBpZHggPSAwOwoKCWVjb2FsID0gKHN0cnVjdCBldGh0b29sX2NvYWxl
c2NlICopKHBlcl9xdWV1ZV9vcHQgKyAxKTsKCWZvciAoaSA9IDA7IGkgPCBfX0tFUk5FTF9ESVZf
Uk9VTkRfVVAoTUFYX05VTV9RVUVVRSwgMzIpOyBpKyspIHsKCQlpbnQgcXVldWUgPSBpICogMzI7
CgkJX191MzIgbWFzayA9IHF1ZXVlX21hc2tbaV07CgoJCXdoaWxlIChtYXNrID4gMCkgewoJCQlp
ZiAobWFzayAmIDB4MSkgewoJCQkJZnByaW50ZihzdGRvdXQsICJRdWV1ZTogJWRcbiIsIHF1ZXVl
KTsKCQkJCWR1bXBfY29hbGVzY2UoZWNvYWwgKyBpZHgpOwoJCQkJaWR4Kys7CgkJCX0KCQkJbWFz
ayA9IG1hc2sgPj4gMTsKCQkJcXVldWUrKzsKCQl9CgkJaWYgKGlkeCA9PSBuX3F1ZXVlcykKCQkJ
YnJlYWs7Cgl9Cn0KCnN0cnVjdCBmZWF0dXJlX3N0YXRlIHsKCXUzMiBvZmZfZmxhZ3M7CglzdHJ1
Y3QgZXRodG9vbF9nZmVhdHVyZXMgZmVhdHVyZXM7Cn07CgpzdGF0aWMgdm9pZCBkdW1wX29uZV9m
ZWF0dXJlKGNvbnN0IGNoYXIgKmluZGVudCwgY29uc3QgY2hhciAqbmFtZSwKCQkJICAgICBjb25z
dCBzdHJ1Y3QgZmVhdHVyZV9zdGF0ZSAqc3RhdGUsCgkJCSAgICAgY29uc3Qgc3RydWN0IGZlYXR1
cmVfc3RhdGUgKnJlZl9zdGF0ZSwKCQkJICAgICB1MzIgaW5kZXgpCnsKCWlmIChyZWZfc3RhdGUg
JiYKCSAgICAhKEZFQVRVUkVfQklUX0lTX1NFVChzdGF0ZS0+ZmVhdHVyZXMuZmVhdHVyZXMsIGlu
ZGV4LCBhY3RpdmUpIF4KCSAgICAgIEZFQVRVUkVfQklUX0lTX1NFVChyZWZfc3RhdGUtPmZlYXR1
cmVzLmZlYXR1cmVzLCBpbmRleCwgYWN0aXZlKSkpCgkJcmV0dXJuOwoKCXByaW50ZigiJXMlczog
JXMlc1xuIiwKCSAgICAgICBpbmRlbnQsIG5hbWUsCgkgICAgICAgRkVBVFVSRV9CSVRfSVNfU0VU
KHN0YXRlLT5mZWF0dXJlcy5mZWF0dXJlcywgaW5kZXgsIGFjdGl2ZSkgPwoJICAgICAgICJvbiIg
OiAib2ZmIiwKCSAgICAgICAoIUZFQVRVUkVfQklUX0lTX1NFVChzdGF0ZS0+ZmVhdHVyZXMuZmVh
dHVyZXMsIGluZGV4LCBhdmFpbGFibGUpCgkJfHwgRkVBVFVSRV9CSVRfSVNfU0VUKHN0YXRlLT5m
ZWF0dXJlcy5mZWF0dXJlcywgaW5kZXgsCgkJCQkgICAgICBuZXZlcl9jaGFuZ2VkKSkKCSAgICAg
ICA/ICIgW2ZpeGVkXSIKCSAgICAgICA6IChGRUFUVVJFX0JJVF9JU19TRVQoc3RhdGUtPmZlYXR1
cmVzLmZlYXR1cmVzLCBpbmRleCwgcmVxdWVzdGVkKQoJCSAgXiBGRUFUVVJFX0JJVF9JU19TRVQo
c3RhdGUtPmZlYXR1cmVzLmZlYXR1cmVzLCBpbmRleCwgYWN0aXZlKSkKCSAgICAgICA/IChGRUFU
VVJFX0JJVF9JU19TRVQoc3RhdGUtPmZlYXR1cmVzLmZlYXR1cmVzLCBpbmRleCwgcmVxdWVzdGVk
KQoJCSAgPyAiIFtyZXF1ZXN0ZWQgb25dIiA6ICIgW3JlcXVlc3RlZCBvZmZdIikKCSAgICAgICA6
ICIiKTsKfQoKc3RhdGljIHVuc2lnbmVkIGludCBsaW51eF92ZXJzaW9uX2NvZGUodm9pZCkKewoJ
c3RydWN0IHV0c25hbWUgdXRzbmFtZTsKCXVuc2lnbmVkIHZlcnNpb24sIHBhdGNobGV2ZWwsIHN1
YmxldmVsID0gMDsKCglpZiAodW5hbWUoJnV0c25hbWUpKQoJCXJldHVybiAtMTsKCWlmIChzc2Nh
bmYodXRzbmFtZS5yZWxlYXNlLCAiJXUuJXUuJXUiLCAmdmVyc2lvbiwgJnBhdGNobGV2ZWwsICZz
dWJsZXZlbCkgPCAyKQoJCXJldHVybiAtMTsKCXJldHVybiBLRVJORUxfVkVSU0lPTih2ZXJzaW9u
LCBwYXRjaGxldmVsLCBzdWJsZXZlbCk7Cn0KCnN0YXRpYyB2b2lkIGR1bXBfZmVhdHVyZXMoY29u
c3Qgc3RydWN0IGZlYXR1cmVfZGVmcyAqZGVmcywKCQkJICBjb25zdCBzdHJ1Y3QgZmVhdHVyZV9z
dGF0ZSAqc3RhdGUsCgkJCSAgY29uc3Qgc3RydWN0IGZlYXR1cmVfc3RhdGUgKnJlZl9zdGF0ZSkK
ewoJdW5zaWduZWQgaW50IGtlcm5lbF92ZXIgPSBsaW51eF92ZXJzaW9uX2NvZGUoKTsKCXVuc2ln
bmVkIGludCBpLCBqOwoJaW50IGluZGVudDsKCXUzMiB2YWx1ZTsKCglmb3IgKGkgPSAwOyBpIDwg
T0ZGX0ZMQUdfREVGX1NJWkU7IGkrKykgewoJCS8qIERvbid0IHNob3cgZmVhdHVyZXMgd2hvc2Ug
c3RhdGUgaXMgdW5rbm93biBvbiB0aGlzCgkJICoga2VybmVsIHZlcnNpb24KCQkgKi8KCQlpZiAo
ZGVmcy0+b2ZmX2ZsYWdfbWF0Y2hlZFtpXSA9PSAwICYmCgkJICAgICgob2ZmX2ZsYWdfZGVmW2ld
LmdldF9jbWQgPT0gMCAmJgoJCSAgICAgIGtlcm5lbF92ZXIgPCBvZmZfZmxhZ19kZWZbaV0ubWlu
X2tlcm5lbF92ZXIpIHx8CgkJICAgICAob2ZmX2ZsYWdfZGVmW2ldLmdldF9jbWQgPT0gRVRIVE9P
TF9HVUZPICYmCgkJICAgICAga2VybmVsX3ZlciA+PSBLRVJORUxfVkVSU0lPTig0LCAxNCwgMCkp
KSkKCQkJY29udGludWU7CgoJCXZhbHVlID0gb2ZmX2ZsYWdfZGVmW2ldLnZhbHVlOwoKCQkvKiBJ
ZiB0aGlzIG9mZmxvYWQgZmxhZyBtYXRjaGVzIGV4YWN0bHkgb25lIGdlbmVyaWMKCQkgKiBmZWF0
dXJlIHRoZW4gaXQncyByZWR1bmRhbnQgdG8gc2hvdyB0aGUgZmxhZyBhbmQKCQkgKiBmZWF0dXJl
IHN0YXRlcyBzZXBhcmF0ZWx5LiAgT3RoZXJ3aXNlLCBzaG93IHRoZQoJCSAqIGZsYWcgc3RhdGUg
Zmlyc3QuCgkJICovCgkJaWYgKGRlZnMtPm9mZl9mbGFnX21hdGNoZWRbaV0gIT0gMSAmJgoJCSAg
ICAoIXJlZl9zdGF0ZSB8fAoJCSAgICAgKHN0YXRlLT5vZmZfZmxhZ3MgXiByZWZfc3RhdGUtPm9m
Zl9mbGFncykgJiB2YWx1ZSkpIHsKCQkJcHJpbnRmKCIlczogJXNcbiIsCgkJCSAgICAgICBvZmZf
ZmxhZ19kZWZbaV0ubG9uZ19uYW1lLAoJCQkgICAgICAgKHN0YXRlLT5vZmZfZmxhZ3MgJiB2YWx1
ZSkgPyAib24iIDogIm9mZiIpOwoJCQlpbmRlbnQgPSAxOwoJCX0gZWxzZSB7CgkJCWluZGVudCA9
IDA7CgkJfQoKCQkvKiBTaG93IG1hdGNoaW5nIGZlYXR1cmVzICovCgkJZm9yIChqID0gMDsgaiA8
IGRlZnMtPm5fZmVhdHVyZXM7IGorKykgewoJCQlpZiAoZGVmcy0+ZGVmW2pdLm9mZl9mbGFnX2lu
ZGV4ICE9IChpbnQpaSkKCQkJCWNvbnRpbnVlOwoJCQlpZiAoZGVmcy0+b2ZmX2ZsYWdfbWF0Y2hl
ZFtpXSAhPSAxKQoJCQkJLyogU2hvdyBhbGwgbWF0Y2hpbmcgZmVhdHVyZSBzdGF0ZXMgKi8KCQkJ
CWR1bXBfb25lX2ZlYXR1cmUoaW5kZW50ID8gIlx0IiA6ICIiLAoJCQkJCQkgZGVmcy0+ZGVmW2pd
Lm5hbWUsCgkJCQkJCSBzdGF0ZSwgcmVmX3N0YXRlLCBqKTsKCQkJZWxzZQoJCQkJLyogU2hvdyBm
dWxsIHN0YXRlIHdpdGggdGhlIG9sZCBmbGFnIG5hbWUgKi8KCQkJCWR1bXBfb25lX2ZlYXR1cmUo
IiIsIG9mZl9mbGFnX2RlZltpXS5sb25nX25hbWUsCgkJCQkJCSBzdGF0ZSwgcmVmX3N0YXRlLCBq
KTsKCQl9Cgl9CgoJLyogU2hvdyBhbGwgdW5tYXRjaGVkIGZlYXR1cmVzIHRoYXQgaGF2ZSBub24t
bnVsbCBuYW1lcyAqLwoJZm9yIChqID0gMDsgaiA8IGRlZnMtPm5fZmVhdHVyZXM7IGorKykKCQlp
ZiAoZGVmcy0+ZGVmW2pdLm9mZl9mbGFnX2luZGV4IDwgMCAmJiBkZWZzLT5kZWZbal0ubmFtZVsw
XSkKCQkJZHVtcF9vbmVfZmVhdHVyZSgiIiwgZGVmcy0+ZGVmW2pdLm5hbWUsCgkJCQkJIHN0YXRl
LCByZWZfc3RhdGUsIGopOwp9CgpzdGF0aWMgaW50IGR1bXBfcnhmaGFzaChpbnQgZmhhc2gsIHU2
NCB2YWwpCnsKCXN3aXRjaCAoZmhhc2ggJiB+RkxPV19SU1MpIHsKCWNhc2UgVENQX1Y0X0ZMT1c6
CgkJZnByaW50ZihzdGRvdXQsICJUQ1Agb3ZlciBJUFY0IGZsb3dzIik7CgkJYnJlYWs7CgljYXNl
IFVEUF9WNF9GTE9XOgoJCWZwcmludGYoc3Rkb3V0LCAiVURQIG92ZXIgSVBWNCBmbG93cyIpOwoJ
CWJyZWFrOwoJY2FzZSBTQ1RQX1Y0X0ZMT1c6CgkJZnByaW50ZihzdGRvdXQsICJTQ1RQIG92ZXIg
SVBWNCBmbG93cyIpOwoJCWJyZWFrOwoJY2FzZSBBSF9FU1BfVjRfRkxPVzoKCWNhc2UgQUhfVjRf
RkxPVzoKCWNhc2UgRVNQX1Y0X0ZMT1c6CgkJZnByaW50ZihzdGRvdXQsICJJUFNFQyBBSC9FU1Ag
b3ZlciBJUFY0IGZsb3dzIik7CgkJYnJlYWs7CgljYXNlIFRDUF9WNl9GTE9XOgoJCWZwcmludGYo
c3Rkb3V0LCAiVENQIG92ZXIgSVBWNiBmbG93cyIpOwoJCWJyZWFrOwoJY2FzZSBVRFBfVjZfRkxP
VzoKCQlmcHJpbnRmKHN0ZG91dCwgIlVEUCBvdmVyIElQVjYgZmxvd3MiKTsKCQlicmVhazsKCWNh
c2UgU0NUUF9WNl9GTE9XOgoJCWZwcmludGYoc3Rkb3V0LCAiU0NUUCBvdmVyIElQVjYgZmxvd3Mi
KTsKCQlicmVhazsKCWNhc2UgQUhfRVNQX1Y2X0ZMT1c6CgljYXNlIEFIX1Y2X0ZMT1c6CgljYXNl
IEVTUF9WNl9GTE9XOgoJCWZwcmludGYoc3Rkb3V0LCAiSVBTRUMgQUgvRVNQIG92ZXIgSVBWNiBm
bG93cyIpOwoJCWJyZWFrOwoJZGVmYXVsdDoKCQlicmVhazsKCX0KCglpZiAodmFsICYgUlhIX0RJ
U0NBUkQpIHsKCQlmcHJpbnRmKHN0ZG91dCwgIiAtIEFsbCBtYXRjaGluZyBmbG93cyBkaXNjYXJk
ZWQgb24gUlhcbiIpOwoJCXJldHVybiAwOwoJfQoJZnByaW50ZihzdGRvdXQsICIgdXNlIHRoZXNl
IGZpZWxkcyBmb3IgY29tcHV0aW5nIEhhc2ggZmxvdyBrZXk6XG4iKTsKCglmcHJpbnRmKHN0ZG91
dCwgIiVzXG4iLCB1bnBhcnNlX3J4Zmhhc2hvcHRzKHZhbCkpOwoKCXJldHVybiAwOwp9CgpzdGF0
aWMgdm9pZCBkdW1wX2VlZWNtZChzdHJ1Y3QgZXRodG9vbF9lZWUgKmVwKQp7CglFVEhUT09MX0RF
Q0xBUkVfTElOS19NT0RFX01BU0sobGlua19tb2RlKTsKCglmcHJpbnRmKHN0ZG91dCwgIglFRUUg
c3RhdHVzOiAiKTsKCWlmICghZXAtPnN1cHBvcnRlZCkgewoJCWZwcmludGYoc3Rkb3V0LCAibm90
IHN1cHBvcnRlZFxuIik7CgkJcmV0dXJuOwoJfSBlbHNlIGlmICghZXAtPmVlZV9lbmFibGVkKSB7
CgkJZnByaW50ZihzdGRvdXQsICJkaXNhYmxlZFxuIik7Cgl9IGVsc2UgewoJCWZwcmludGYoc3Rk
b3V0LCAiZW5hYmxlZCAtICIpOwoJCWlmIChlcC0+ZWVlX2FjdGl2ZSkKCQkJZnByaW50ZihzdGRv
dXQsICJhY3RpdmVcbiIpOwoJCWVsc2UKCQkJZnByaW50ZihzdGRvdXQsICJpbmFjdGl2ZVxuIik7
Cgl9CgoJZnByaW50ZihzdGRvdXQsICIJVHggTFBJOiIpOwoJaWYgKGVwLT50eF9scGlfZW5hYmxl
ZCkKCQlmcHJpbnRmKHN0ZG91dCwgIiAlZCAodXMpXG4iLCBlcC0+dHhfbHBpX3RpbWVyKTsKCWVs
c2UKCQlmcHJpbnRmKHN0ZG91dCwgIiBkaXNhYmxlZFxuIik7CgoJZXRodG9vbF9saW5rX21vZGVf
emVybyhsaW5rX21vZGUpOwoKCWxpbmtfbW9kZVswXSA9IGVwLT5zdXBwb3J0ZWQ7CglkdW1wX2xp
bmtfY2FwcygiU3VwcG9ydGVkIEVFRSIsICIiLCBsaW5rX21vZGUsIDEpOwoKCWxpbmtfbW9kZVsw
XSA9IGVwLT5hZHZlcnRpc2VkOwoJZHVtcF9saW5rX2NhcHMoIkFkdmVydGlzZWQgRUVFIiwgIiIs
IGxpbmtfbW9kZSwgMSk7CgoJbGlua19tb2RlWzBdID0gZXAtPmxwX2FkdmVydGlzZWQ7CglkdW1w
X2xpbmtfY2FwcygiTGluayBwYXJ0bmVyIGFkdmVydGlzZWQgRUVFIiwgIiIsIGxpbmtfbW9kZSwg
MSk7Cn0KCnN0YXRpYyB2b2lkIGR1bXBfZmVjKHUzMiBmZWMpCnsKCWlmIChmZWMgJiBFVEhUT09M
X0ZFQ19OT05FKQoJCWZwcmludGYoc3Rkb3V0LCAiIE5vbmUiKTsKCWlmIChmZWMgJiBFVEhUT09M
X0ZFQ19BVVRPKQoJCWZwcmludGYoc3Rkb3V0LCAiIEF1dG8iKTsKCWlmIChmZWMgJiBFVEhUT09M
X0ZFQ19PRkYpCgkJZnByaW50ZihzdGRvdXQsICIgT2ZmIik7CglpZiAoZmVjICYgRVRIVE9PTF9G
RUNfQkFTRVIpCgkJZnByaW50ZihzdGRvdXQsICIgQmFzZVIiKTsKCWlmIChmZWMgJiBFVEhUT09M
X0ZFQ19SUykKCQlmcHJpbnRmKHN0ZG91dCwgIiBSUyIpOwoJaWYgKGZlYyAmIEVUSFRPT0xfRkVD
X0xMUlMpCgkJZnByaW50ZihzdGRvdXQsICIgTExSUyIpOwp9CgojZGVmaW5lIE5fU09UUyA3Cgpz
dGF0aWMgY2hhciAqc29fdGltZXN0YW1waW5nX2xhYmVsc1tOX1NPVFNdID0gewoJImhhcmR3YXJl
LXRyYW5zbWl0ICAgICAoU09GX1RJTUVTVEFNUElOR19UWF9IQVJEV0FSRSkiLAoJInNvZnR3YXJl
LXRyYW5zbWl0ICAgICAoU09GX1RJTUVTVEFNUElOR19UWF9TT0ZUV0FSRSkiLAoJImhhcmR3YXJl
LXJlY2VpdmUgICAgICAoU09GX1RJTUVTVEFNUElOR19SWF9IQVJEV0FSRSkiLAoJInNvZnR3YXJl
LXJlY2VpdmUgICAgICAoU09GX1RJTUVTVEFNUElOR19SWF9TT0ZUV0FSRSkiLAoJInNvZnR3YXJl
LXN5c3RlbS1jbG9jayAoU09GX1RJTUVTVEFNUElOR19TT0ZUV0FSRSkiLAoJImhhcmR3YXJlLWxl
Z2FjeS1jbG9jayAoU09GX1RJTUVTVEFNUElOR19TWVNfSEFSRFdBUkUpIiwKCSJoYXJkd2FyZS1y
YXctY2xvY2sgICAgKFNPRl9USU1FU1RBTVBJTkdfUkFXX0hBUkRXQVJFKSIsCn07CgojZGVmaW5l
IE5fVFhfVFlQRVMgKEhXVFNUQU1QX1RYX09ORVNURVBfU1lOQyArIDEpCgpzdGF0aWMgY2hhciAq
dHhfdHlwZV9sYWJlbHNbTl9UWF9UWVBFU10gPSB7Cgkib2ZmICAgICAgICAgICAgICAgICAgIChI
V1RTVEFNUF9UWF9PRkYpIiwKCSJvbiAgICAgICAgICAgICAgICAgICAgKEhXVFNUQU1QX1RYX09O
KSIsCgkib25lLXN0ZXAtc3luYyAgICAgICAgIChIV1RTVEFNUF9UWF9PTkVTVEVQX1NZTkMpIiwK
fTsKCiNkZWZpbmUgTl9SWF9GSUxURVJTIChIV1RTVEFNUF9GSUxURVJfTlRQX0FMTCArIDEpCgpz
dGF0aWMgY2hhciAqcnhfZmlsdGVyX2xhYmVsc1tOX1JYX0ZJTFRFUlNdID0gewoJIm5vbmUgICAg
ICAgICAgICAgICAgICAoSFdUU1RBTVBfRklMVEVSX05PTkUpIiwKCSJhbGwgICAgICAgICAgICAg
ICAgICAgKEhXVFNUQU1QX0ZJTFRFUl9BTEwpIiwKCSJzb21lICAgICAgICAgICAgICAgICAgKEhX
VFNUQU1QX0ZJTFRFUl9TT01FKSIsCgkicHRwdjEtbDQtZXZlbnQgICAgICAgIChIV1RTVEFNUF9G
SUxURVJfUFRQX1YxX0w0X0VWRU5UKSIsCgkicHRwdjEtbDQtc3luYyAgICAgICAgIChIV1RTVEFN
UF9GSUxURVJfUFRQX1YxX0w0X1NZTkMpIiwKCSJwdHB2MS1sNC1kZWxheS1yZXEgICAgKEhXVFNU
QU1QX0ZJTFRFUl9QVFBfVjFfTDRfREVMQVlfUkVRKSIsCgkicHRwdjItbDQtZXZlbnQgICAgICAg
IChIV1RTVEFNUF9GSUxURVJfUFRQX1YyX0w0X0VWRU5UKSIsCgkicHRwdjItbDQtc3luYyAgICAg
ICAgIChIV1RTVEFNUF9GSUxURVJfUFRQX1YyX0w0X1NZTkMpIiwKCSJwdHB2Mi1sNC1kZWxheS1y
ZXEgICAgKEhXVFNUQU1QX0ZJTFRFUl9QVFBfVjJfTDRfREVMQVlfUkVRKSIsCgkicHRwdjItbDIt
ZXZlbnQgICAgICAgIChIV1RTVEFNUF9GSUxURVJfUFRQX1YyX0wyX0VWRU5UKSIsCgkicHRwdjIt
bDItc3luYyAgICAgICAgIChIV1RTVEFNUF9GSUxURVJfUFRQX1YyX0wyX1NZTkMpIiwKCSJwdHB2
Mi1sMi1kZWxheS1yZXEgICAgKEhXVFNUQU1QX0ZJTFRFUl9QVFBfVjJfTDJfREVMQVlfUkVRKSIs
CgkicHRwdjItZXZlbnQgICAgICAgICAgIChIV1RTVEFNUF9GSUxURVJfUFRQX1YyX0VWRU5UKSIs
CgkicHRwdjItc3luYyAgICAgICAgICAgIChIV1RTVEFNUF9GSUxURVJfUFRQX1YyX1NZTkMpIiwK
CSJwdHB2Mi1kZWxheS1yZXEgICAgICAgKEhXVFNUQU1QX0ZJTFRFUl9QVFBfVjJfREVMQVlfUkVR
KSIsCgkibnRwLWFsbCAgICAgICAgICAgICAgIChIV1RTVEFNUF9GSUxURVJfTlRQX0FMTCkiLAp9
OwoKc3RhdGljIGludCBkdW1wX3RzaW5mbyhjb25zdCBzdHJ1Y3QgZXRodG9vbF90c19pbmZvICpp
bmZvKQp7CglpbnQgaTsKCglmcHJpbnRmKHN0ZG91dCwgIkNhcGFiaWxpdGllczpcbiIpOwoKCWZv
ciAoaSA9IDA7IGkgPCBOX1NPVFM7IGkrKykgewoJCWlmIChpbmZvLT5zb190aW1lc3RhbXBpbmcg
JiAoMSA8PCBpKSkKCQkJZnByaW50ZihzdGRvdXQsICJcdCVzXG4iLCBzb190aW1lc3RhbXBpbmdf
bGFiZWxzW2ldKTsKCX0KCglmcHJpbnRmKHN0ZG91dCwgIlBUUCBIYXJkd2FyZSBDbG9jazogIik7
CgoJaWYgKGluZm8tPnBoY19pbmRleCA8IDApCgkJZnByaW50ZihzdGRvdXQsICJub25lXG4iKTsK
CWVsc2UKCQlmcHJpbnRmKHN0ZG91dCwgIiVkXG4iLCBpbmZvLT5waGNfaW5kZXgpOwoKCWZwcmlu
dGYoc3Rkb3V0LCAiSGFyZHdhcmUgVHJhbnNtaXQgVGltZXN0YW1wIE1vZGVzOiIpOwoKCWlmICgh
aW5mby0+dHhfdHlwZXMpCgkJZnByaW50ZihzdGRvdXQsICIgbm9uZVxuIik7CgllbHNlCgkJZnBy
aW50ZihzdGRvdXQsICJcbiIpOwoKCWZvciAoaSA9IDA7IGkgPCBOX1RYX1RZUEVTOyBpKyspIHsK
CQlpZiAoaW5mby0+dHhfdHlwZXMgJiAoMSA8PCBpKSkKCQkJZnByaW50ZihzdGRvdXQsCSJcdCVz
XG4iLCB0eF90eXBlX2xhYmVsc1tpXSk7Cgl9CgoJZnByaW50ZihzdGRvdXQsICJIYXJkd2FyZSBS
ZWNlaXZlIEZpbHRlciBNb2RlczoiKTsKCglpZiAoIWluZm8tPnJ4X2ZpbHRlcnMpCgkJZnByaW50
ZihzdGRvdXQsICIgbm9uZVxuIik7CgllbHNlCgkJZnByaW50ZihzdGRvdXQsICJcbiIpOwoKCWZv
ciAoaSA9IDA7IGkgPCBOX1JYX0ZJTFRFUlM7IGkrKykgewoJCWlmIChpbmZvLT5yeF9maWx0ZXJz
ICYgKDEgPDwgaSkpCgkJCWZwcmludGYoc3Rkb3V0LCAiXHQlc1xuIiwgcnhfZmlsdGVyX2xhYmVs
c1tpXSk7Cgl9CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBzdHJ1Y3QgZXRodG9vbF9nc3RyaW5ncyAq
CmdldF9zdHJpbmdzZXQoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgsIGVudW0gZXRodG9vbF9zdHJp
bmdzZXQgc2V0X2lkLAoJICAgICAgcHRyZGlmZl90IGRydmluZm9fb2Zmc2V0LCBpbnQgbnVsbF90
ZXJtaW5hdGUpCnsKCXN0cnVjdCB7CgkJc3RydWN0IGV0aHRvb2xfc3NldF9pbmZvIGhkcjsKCQl1
MzIgYnVmWzFdOwoJfSBzc2V0X2luZm87CglzdHJ1Y3QgZXRodG9vbF9kcnZpbmZvIGRydmluZm87
Cgl1MzIgbGVuLCBpOwoJc3RydWN0IGV0aHRvb2xfZ3N0cmluZ3MgKnN0cmluZ3M7CgoJc3NldF9p
bmZvLmhkci5jbWQgPSBFVEhUT09MX0dTU0VUX0lORk87Cglzc2V0X2luZm8uaGRyLnJlc2VydmVk
ID0gMDsKCXNzZXRfaW5mby5oZHIuc3NldF9tYXNrID0gMVVMTCA8PCBzZXRfaWQ7CglpZiAoc2Vu
ZF9pb2N0bChjdHgsICZzc2V0X2luZm8pID09IDApIHsKCQljb25zdCB1MzIgKnNzZXRfbGVuZ3Ro
cyA9IHNzZXRfaW5mby5oZHIuZGF0YTsKCgkJbGVuID0gc3NldF9pbmZvLmhkci5zc2V0X21hc2sg
PyBzc2V0X2xlbmd0aHNbMF0gOiAwOwoJfSBlbHNlIGlmIChlcnJubyA9PSBFT1BOT1RTVVBQICYm
IGRydmluZm9fb2Zmc2V0ICE9IDApIHsKCQkvKiBGYWxsYmFjayBmb3Igb2xkIGtlcm5lbCB2ZXJz
aW9ucyAqLwoJCWRydmluZm8uY21kID0gRVRIVE9PTF9HRFJWSU5GTzsKCQlpZiAoc2VuZF9pb2N0
bChjdHgsICZkcnZpbmZvKSkKCQkJcmV0dXJuIE5VTEw7CgkJbGVuID0gKih1MzIgKikoKGNoYXIg
KikmZHJ2aW5mbyArIGRydmluZm9fb2Zmc2V0KTsKCX0gZWxzZSB7CgkJcmV0dXJuIE5VTEw7Cgl9
CgoJc3RyaW5ncyA9IGNhbGxvYygxLCBzaXplb2YoKnN0cmluZ3MpICsgbGVuICogRVRIX0dTVFJJ
TkdfTEVOKTsKCWlmICghc3RyaW5ncykKCQlyZXR1cm4gTlVMTDsKCglzdHJpbmdzLT5jbWQgPSBF
VEhUT09MX0dTVFJJTkdTOwoJc3RyaW5ncy0+c3RyaW5nX3NldCA9IHNldF9pZDsKCXN0cmluZ3Mt
PmxlbiA9IGxlbjsKCWlmIChsZW4gIT0gMCAmJiBzZW5kX2lvY3RsKGN0eCwgc3RyaW5ncykpIHsK
CQlmcmVlKHN0cmluZ3MpOwoJCXJldHVybiBOVUxMOwoJfQoKCWlmIChudWxsX3Rlcm1pbmF0ZSkK
CQlmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspCgkJCXN0cmluZ3MtPmRhdGFbKGkgKyAxKSAqIEVU
SF9HU1RSSU5HX0xFTiAtIDFdID0gMDsKCglyZXR1cm4gc3RyaW5nczsKfQoKc3RhdGljIHN0cnVj
dCBmZWF0dXJlX2RlZnMgKmdldF9mZWF0dXJlX2RlZnMoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgp
CnsKCXN0cnVjdCBldGh0b29sX2dzdHJpbmdzICpuYW1lczsKCXN0cnVjdCBmZWF0dXJlX2RlZnMg
KmRlZnM7Cgl1bnNpZ25lZCBpbnQgaSwgajsKCXUzMiBuX2ZlYXR1cmVzOwoKCW5hbWVzID0gZ2V0
X3N0cmluZ3NldChjdHgsIEVUSF9TU19GRUFUVVJFUywgMCwgMSk7CglpZiAobmFtZXMpIHsKCQlu
X2ZlYXR1cmVzID0gbmFtZXMtPmxlbjsKCX0gZWxzZSBpZiAoZXJybm8gPT0gRU9QTk9UU1VQUCB8
fCBlcnJubyA9PSBFSU5WQUwpIHsKCQkvKiBLZXJuZWwgZG9lc24ndCBzdXBwb3J0IG5hbWVkIGZl
YXR1cmVzOyBub3QgYW4gZXJyb3IgKi8KCQluX2ZlYXR1cmVzID0gMDsKCX0gZWxzZSBpZiAoZXJy
bm8gPT0gRVBFUk0pIHsKCQkvKiBLZXJuZWwgYnVnOiBFVEhUT09MX0dTU0VUX0lORk8gd2FzIHBy
aXZpbGVnZWQuCgkJICogV29yayBhcm91bmQgaXQuICovCgkJbl9mZWF0dXJlcyA9IDA7Cgl9IGVs
c2UgewoJCXJldHVybiBOVUxMOwoJfQoKCWRlZnMgPSBtYWxsb2Moc2l6ZW9mKCpkZWZzKSArIHNp
emVvZihkZWZzLT5kZWZbMF0pICogbl9mZWF0dXJlcyk7CglpZiAoIWRlZnMpIHsKCQlmcmVlKG5h
bWVzKTsKCQlyZXR1cm4gTlVMTDsKCX0KCglkZWZzLT5uX2ZlYXR1cmVzID0gbl9mZWF0dXJlczsK
CW1lbXNldChkZWZzLT5vZmZfZmxhZ19tYXRjaGVkLCAwLCBzaXplb2YoZGVmcy0+b2ZmX2ZsYWdf
bWF0Y2hlZCkpOwoKCS8qIENvcHkgb3V0IGZlYXR1cmUgbmFtZXMgYW5kIGZpbmQgdGhvc2UgYXNz
b2NpYXRlZCB3aXRoIGxlZ2FjeSBmbGFncyAqLwoJZm9yIChpID0gMDsgaSA8IGRlZnMtPm5fZmVh
dHVyZXM7IGkrKykgewoJCW1lbWNweShkZWZzLT5kZWZbaV0ubmFtZSwgbmFtZXMtPmRhdGEgKyBp
ICogRVRIX0dTVFJJTkdfTEVOLAoJCSAgICAgICBFVEhfR1NUUklOR19MRU4pOwoJCWRlZnMtPmRl
ZltpXS5vZmZfZmxhZ19pbmRleCA9IC0xOwoKCQlmb3IgKGogPSAwOwoJCSAgICAgaiA8IE9GRl9G
TEFHX0RFRl9TSVpFICYmCgkJCSAgICAgZGVmcy0+ZGVmW2ldLm9mZl9mbGFnX2luZGV4IDwgMDsK
CQkgICAgIGorKykgewoJCQljb25zdCBjaGFyICpwYXR0ZXJuID0KCQkJCW9mZl9mbGFnX2RlZltq
XS5rZXJuZWxfbmFtZTsKCQkJY29uc3QgY2hhciAqbmFtZSA9IGRlZnMtPmRlZltpXS5uYW1lOwoJ
CQlmb3IgKDs7KSB7CgkJCQlpZiAoKnBhdHRlcm4gPT0gJyonKSB7CgkJCQkJLyogVGhlcmUgaXMg
b25seSBvbmUgd2lsZGNhcmQ7IHNvCgkJCQkJICogc3dpdGNoIHRvIGEgc3VmZml4IGNvbXBhcmlz
b24gKi8KCQkJCQlzaXplX3QgcGF0dGVybl9sZW4gPQoJCQkJCQlzdHJsZW4ocGF0dGVybiArIDEp
OwoJCQkJCXNpemVfdCBuYW1lX2xlbiA9IHN0cmxlbihuYW1lKTsKCQkJCQlpZiAobmFtZV9sZW4g
PCBwYXR0ZXJuX2xlbikKCQkJCQkJYnJlYWs7IC8qIG5hbWUgaXMgdG9vIHNob3J0ICovCgkJCQkJ
bmFtZSArPSBuYW1lX2xlbiAtIHBhdHRlcm5fbGVuOwoJCQkJCSsrcGF0dGVybjsKCQkJCX0gZWxz
ZSBpZiAoKnBhdHRlcm4gIT0gKm5hbWUpIHsKCQkJCQlicmVhazsgLyogbWlzbWF0Y2ggKi8KCQkJ
CX0gZWxzZSBpZiAoKnBhdHRlcm4gPT0gMCkgewoJCQkJCWRlZnMtPmRlZltpXS5vZmZfZmxhZ19p
bmRleCA9IGo7CgkJCQkJZGVmcy0+b2ZmX2ZsYWdfbWF0Y2hlZFtqXSsrOwoJCQkJCWJyZWFrOwoJ
CQkJfSBlbHNlIHsKCQkJCQkrK25hbWU7CgkJCQkJKytwYXR0ZXJuOwoJCQkJfQoJCQl9CgkJfQoJ
fQoKCWZyZWUobmFtZXMpOwoJcmV0dXJuIGRlZnM7Cn0KCnN0YXRpYyBpbnQgZG9fZ2RydihzdHJ1
Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJaW50IGVycjsKCXN0cnVjdCBldGh0b29sX2RydmluZm8g
ZHJ2aW5mbzsKCglpZiAoY3R4LT5hcmdjICE9IDApCgkJZXhpdF9iYWRfYXJncygpOwoKCWRydmlu
Zm8uY21kID0gRVRIVE9PTF9HRFJWSU5GTzsKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmZHJ2aW5m
byk7CglpZiAoZXJyIDwgMCkgewoJCXBlcnJvcigiQ2Fubm90IGdldCBkcml2ZXIgaW5mb3JtYXRp
b24iKTsKCQlyZXR1cm4gNzE7Cgl9CglyZXR1cm4gZHVtcF9kcnZpbmZvKCZkcnZpbmZvKTsKfQoK
c3RhdGljIGludCBkb19ncGF1c2Uoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgpCnsKCXN0cnVjdCBl
dGh0b29sX3BhdXNlcGFyYW0gZXBhdXNlOwoJc3RydWN0IGV0aHRvb2xfY21kIGVjbWQ7CglpbnQg
ZXJyOwoKCWlmIChjdHgtPmFyZ2MgIT0gMCkKCQlleGl0X2JhZF9hcmdzKCk7CgoJZnByaW50Zihz
dGRvdXQsICJQYXVzZSBwYXJhbWV0ZXJzIGZvciAlczpcbiIsIGN0eC0+ZGV2bmFtZSk7CgoJZXBh
dXNlLmNtZCA9IEVUSFRPT0xfR1BBVVNFUEFSQU07CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJmVw
YXVzZSk7CglpZiAoZXJyKSB7CgkJcGVycm9yKCJDYW5ub3QgZ2V0IGRldmljZSBwYXVzZSBzZXR0
aW5ncyIpOwoJCXJldHVybiA3NjsKCX0KCglpZiAoZXBhdXNlLmF1dG9uZWcpIHsKCQllY21kLmNt
ZCA9IEVUSFRPT0xfR1NFVDsKCQllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJmVjbWQpOwoJCWlmIChl
cnIpIHsKCQkJcGVycm9yKCJDYW5ub3QgZ2V0IGRldmljZSBzZXR0aW5ncyIpOwoJCQlyZXR1cm4g
MTsKCQl9CgkJZHVtcF9wYXVzZSgmZXBhdXNlLCBlY21kLmFkdmVydGlzaW5nLCBlY21kLmxwX2Fk
dmVydGlzaW5nKTsKCX0gZWxzZSB7CgkJZHVtcF9wYXVzZSgmZXBhdXNlLCAwLCAwKTsKCX0KCgly
ZXR1cm4gMDsKfQoKc3RhdGljIHZvaWQgZG9fZ2VuZXJpY19zZXQxKHN0cnVjdCBjbWRsaW5lX2lu
Zm8gKmluZm8sIGludCAqY2hhbmdlZF9vdXQpCnsKCWludCB3YW50ZWQsICp2MSwgKnYyOwoKCXYx
ID0gaW5mby0+d2FudGVkX3ZhbDsKCXdhbnRlZCA9ICp2MTsKCglpZiAod2FudGVkIDwgMCkKCQly
ZXR1cm47CgoJdjIgPSBpbmZvLT5pb2N0bF92YWw7CglpZiAod2FudGVkID09ICp2MikgewoJCWZw
cmludGYoc3RkZXJyLCAiJXMgdW5tb2RpZmllZCwgaWdub3JpbmdcbiIsIGluZm8tPm5hbWUpOwoJ
fSBlbHNlIHsKCQkqdjIgPSB3YW50ZWQ7CgkJKmNoYW5nZWRfb3V0ID0gMTsKCX0KfQoKc3RhdGlj
IHZvaWQgZG9fZ2VuZXJpY19zZXQoc3RydWN0IGNtZGxpbmVfaW5mbyAqaW5mbywKCQkJICAgdW5z
aWduZWQgaW50IG5faW5mbywKCQkJICAgaW50ICpjaGFuZ2VkX291dCkKewoJdW5zaWduZWQgaW50
IGk7CgoJZm9yIChpID0gMDsgaSA8IG5faW5mbzsgaSsrKQoJCWRvX2dlbmVyaWNfc2V0MSgmaW5m
b1tpXSwgY2hhbmdlZF9vdXQpOwp9CgpzdGF0aWMgaW50IGRvX3NwYXVzZShzdHJ1Y3QgY21kX2Nv
bnRleHQgKmN0eCkKewoJc3RydWN0IGV0aHRvb2xfcGF1c2VwYXJhbSBlcGF1c2U7CglpbnQgZ3Bh
dXNlX2NoYW5nZWQgPSAwOwoJaW50IHBhdXNlX2F1dG9uZWdfd2FudGVkID0gLTE7CglpbnQgcGF1
c2Vfcnhfd2FudGVkID0gLTE7CglpbnQgcGF1c2VfdHhfd2FudGVkID0gLTE7CglzdHJ1Y3QgY21k
bGluZV9pbmZvIGNtZGxpbmVfcGF1c2VbXSA9IHsKCQl7CgkJCS5uYW1lCQk9ICJhdXRvbmVnIiwK
CQkJLnR5cGUJCT0gQ01ETF9CT09MLAoJCQkud2FudGVkX3ZhbAk9ICZwYXVzZV9hdXRvbmVnX3dh
bnRlZCwKCQkJLmlvY3RsX3ZhbAk9ICZlcGF1c2UuYXV0b25lZywKCQl9LAoJCXsKCQkJLm5hbWUJ
CT0gInJ4IiwKCQkJLnR5cGUJCT0gQ01ETF9CT09MLAoJCQkud2FudGVkX3ZhbAk9ICZwYXVzZV9y
eF93YW50ZWQsCgkJCS5pb2N0bF92YWwJPSAmZXBhdXNlLnJ4X3BhdXNlLAoJCX0sCgkJewoJCQku
bmFtZQkJPSAidHgiLAoJCQkudHlwZQkJPSBDTURMX0JPT0wsCgkJCS53YW50ZWRfdmFsCT0gJnBh
dXNlX3R4X3dhbnRlZCwKCQkJLmlvY3RsX3ZhbAk9ICZlcGF1c2UudHhfcGF1c2UsCgkJfSwKCX07
CglpbnQgZXJyLCBjaGFuZ2VkID0gMDsKCglwYXJzZV9nZW5lcmljX2NtZGxpbmUoY3R4LCAmZ3Bh
dXNlX2NoYW5nZWQsCgkJCSAgICAgIGNtZGxpbmVfcGF1c2UsIEFSUkFZX1NJWkUoY21kbGluZV9w
YXVzZSkpOwoKCWVwYXVzZS5jbWQgPSBFVEhUT09MX0dQQVVTRVBBUkFNOwoJZXJyID0gc2VuZF9p
b2N0bChjdHgsICZlcGF1c2UpOwoJaWYgKGVycikgewoJCXBlcnJvcigiQ2Fubm90IGdldCBkZXZp
Y2UgcGF1c2Ugc2V0dGluZ3MiKTsKCQlyZXR1cm4gNzc7Cgl9CgoJZG9fZ2VuZXJpY19zZXQoY21k
bGluZV9wYXVzZSwgQVJSQVlfU0laRShjbWRsaW5lX3BhdXNlKSwgJmNoYW5nZWQpOwoKCWlmICgh
Y2hhbmdlZCkgewoJCWZwcmludGYoc3RkZXJyLCAibm8gcGF1c2UgcGFyYW1ldGVycyBjaGFuZ2Vk
LCBhYm9ydGluZ1xuIik7CgkJcmV0dXJuIDc4OwoJfQoKCWVwYXVzZS5jbWQgPSBFVEhUT09MX1NQ
QVVTRVBBUkFNOwoJZXJyID0gc2VuZF9pb2N0bChjdHgsICZlcGF1c2UpOwoJaWYgKGVycikgewoJ
CXBlcnJvcigiQ2Fubm90IHNldCBkZXZpY2UgcGF1c2UgcGFyYW1ldGVycyIpOwoJCXJldHVybiA3
OTsKCX0KCglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBkb19zcmluZyhzdHJ1Y3QgY21kX2NvbnRl
eHQgKmN0eCkKewoJc3RydWN0IGV0aHRvb2xfcmluZ3BhcmFtIGVyaW5nOwoJaW50IGdyaW5nX2No
YW5nZWQgPSAwOwoJczMyIHJpbmdfcnhfd2FudGVkID0gLTE7CglzMzIgcmluZ19yeF9taW5pX3dh
bnRlZCA9IC0xOwoJczMyIHJpbmdfcnhfanVtYm9fd2FudGVkID0gLTE7CglzMzIgcmluZ190eF93
YW50ZWQgPSAtMTsKCXN0cnVjdCBjbWRsaW5lX2luZm8gY21kbGluZV9yaW5nW10gPSB7CgkJewoJ
CQkubmFtZQkJPSAicngiLAoJCQkudHlwZQkJPSBDTURMX1MzMiwKCQkJLndhbnRlZF92YWwJPSAm
cmluZ19yeF93YW50ZWQsCgkJCS5pb2N0bF92YWwJPSAmZXJpbmcucnhfcGVuZGluZywKCQl9LAoJ
CXsKCQkJLm5hbWUJCT0gInJ4LW1pbmkiLAoJCQkudHlwZQkJPSBDTURMX1MzMiwKCQkJLndhbnRl
ZF92YWwJPSAmcmluZ19yeF9taW5pX3dhbnRlZCwKCQkJLmlvY3RsX3ZhbAk9ICZlcmluZy5yeF9t
aW5pX3BlbmRpbmcsCgkJfSwKCQl7CgkJCS5uYW1lCQk9ICJyeC1qdW1ibyIsCgkJCS50eXBlCQk9
IENNRExfUzMyLAoJCQkud2FudGVkX3ZhbAk9ICZyaW5nX3J4X2p1bWJvX3dhbnRlZCwKCQkJLmlv
Y3RsX3ZhbAk9ICZlcmluZy5yeF9qdW1ib19wZW5kaW5nLAoJCX0sCgkJewoJCQkubmFtZQkJPSAi
dHgiLAoJCQkudHlwZQkJPSBDTURMX1MzMiwKCQkJLndhbnRlZF92YWwJPSAmcmluZ190eF93YW50
ZWQsCgkJCS5pb2N0bF92YWwJPSAmZXJpbmcudHhfcGVuZGluZywKCQl9LAoJfTsKCWludCBlcnIs
IGNoYW5nZWQgPSAwOwoKCXBhcnNlX2dlbmVyaWNfY21kbGluZShjdHgsICZncmluZ19jaGFuZ2Vk
LAoJCQkgICAgICBjbWRsaW5lX3JpbmcsIEFSUkFZX1NJWkUoY21kbGluZV9yaW5nKSk7CgoJZXJp
bmcuY21kID0gRVRIVE9PTF9HUklOR1BBUkFNOwoJZXJyID0gc2VuZF9pb2N0bChjdHgsICZlcmlu
Zyk7CglpZiAoZXJyKSB7CgkJcGVycm9yKCJDYW5ub3QgZ2V0IGRldmljZSByaW5nIHNldHRpbmdz
Iik7CgkJcmV0dXJuIDc2OwoJfQoKCWRvX2dlbmVyaWNfc2V0KGNtZGxpbmVfcmluZywgQVJSQVlf
U0laRShjbWRsaW5lX3JpbmcpLCAmY2hhbmdlZCk7CgoJaWYgKCFjaGFuZ2VkKSB7CgkJZnByaW50
ZihzdGRlcnIsICJubyByaW5nIHBhcmFtZXRlcnMgY2hhbmdlZCwgYWJvcnRpbmdcbiIpOwoJCXJl
dHVybiA4MDsKCX0KCgllcmluZy5jbWQgPSBFVEhUT09MX1NSSU5HUEFSQU07CgllcnIgPSBzZW5k
X2lvY3RsKGN0eCwgJmVyaW5nKTsKCWlmIChlcnIpIHsKCQlwZXJyb3IoIkNhbm5vdCBzZXQgZGV2
aWNlIHJpbmcgcGFyYW1ldGVycyIpOwoJCXJldHVybiA4MTsKCX0KCglyZXR1cm4gMDsKfQoKc3Rh
dGljIGludCBkb19ncmluZyhzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJc3RydWN0IGV0aHRv
b2xfcmluZ3BhcmFtIGVyaW5nOwoJaW50IGVycjsKCglpZiAoY3R4LT5hcmdjICE9IDApCgkJZXhp
dF9iYWRfYXJncygpOwoKCWZwcmludGYoc3Rkb3V0LCAiUmluZyBwYXJhbWV0ZXJzIGZvciAlczpc
biIsIGN0eC0+ZGV2bmFtZSk7CgoJZXJpbmcuY21kID0gRVRIVE9PTF9HUklOR1BBUkFNOwoJZXJy
ID0gc2VuZF9pb2N0bChjdHgsICZlcmluZyk7CglpZiAoZXJyID09IDApIHsKCQllcnIgPSBkdW1w
X3JpbmcoJmVyaW5nKTsKCQlpZiAoZXJyKQoJCQlyZXR1cm4gZXJyOwoJfSBlbHNlIHsKCQlwZXJy
b3IoIkNhbm5vdCBnZXQgZGV2aWNlIHJpbmcgc2V0dGluZ3MiKTsKCQlyZXR1cm4gNzY7Cgl9CgoJ
cmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgZG9fc2NoYW5uZWxzKHN0cnVjdCBjbWRfY29udGV4dCAq
Y3R4KQp7CglzdHJ1Y3QgZXRodG9vbF9jaGFubmVscyBlY2hhbm5lbHM7CglpbnQgZ2NoYW5uZWxz
X2NoYW5nZWQ7CglzMzIgY2hhbm5lbHNfcnhfd2FudGVkID0gLTE7CglzMzIgY2hhbm5lbHNfdHhf
d2FudGVkID0gLTE7CglzMzIgY2hhbm5lbHNfb3RoZXJfd2FudGVkID0gLTE7CglzMzIgY2hhbm5l
bHNfY29tYmluZWRfd2FudGVkID0gLTE7CglzdHJ1Y3QgY21kbGluZV9pbmZvIGNtZGxpbmVfY2hh
bm5lbHNbXSA9IHsKCQl7CgkJCS5uYW1lCQk9ICJyeCIsCgkJCS50eXBlCQk9IENNRExfUzMyLAoJ
CQkud2FudGVkX3ZhbAk9ICZjaGFubmVsc19yeF93YW50ZWQsCgkJCS5pb2N0bF92YWwJPSAmZWNo
YW5uZWxzLnJ4X2NvdW50LAoJCX0sCgkJewoJCQkubmFtZQkJPSAidHgiLAoJCQkudHlwZQkJPSBD
TURMX1MzMiwKCQkJLndhbnRlZF92YWwJPSAmY2hhbm5lbHNfdHhfd2FudGVkLAoJCQkuaW9jdGxf
dmFsCT0gJmVjaGFubmVscy50eF9jb3VudCwKCQl9LAoJCXsKCQkJLm5hbWUJCT0gIm90aGVyIiwK
CQkJLnR5cGUJCT0gQ01ETF9TMzIsCgkJCS53YW50ZWRfdmFsCT0gJmNoYW5uZWxzX290aGVyX3dh
bnRlZCwKCQkJLmlvY3RsX3ZhbAk9ICZlY2hhbm5lbHMub3RoZXJfY291bnQsCgkJfSwKCQl7CgkJ
CS5uYW1lCQk9ICJjb21iaW5lZCIsCgkJCS50eXBlCQk9IENNRExfUzMyLAoJCQkud2FudGVkX3Zh
bAk9ICZjaGFubmVsc19jb21iaW5lZF93YW50ZWQsCgkJCS5pb2N0bF92YWwJPSAmZWNoYW5uZWxz
LmNvbWJpbmVkX2NvdW50LAoJCX0sCgl9OwoJaW50IGVyciwgY2hhbmdlZCA9IDA7CgoJcGFyc2Vf
Z2VuZXJpY19jbWRsaW5lKGN0eCwgJmdjaGFubmVsc19jaGFuZ2VkLAoJCQkgICAgICBjbWRsaW5l
X2NoYW5uZWxzLCBBUlJBWV9TSVpFKGNtZGxpbmVfY2hhbm5lbHMpKTsKCgllY2hhbm5lbHMuY21k
ID0gRVRIVE9PTF9HQ0hBTk5FTFM7CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJmVjaGFubmVscyk7
CglpZiAoZXJyKSB7CgkJcGVycm9yKCJDYW5ub3QgZ2V0IGRldmljZSBjaGFubmVsIHBhcmFtZXRl
cnMiKTsKCQlyZXR1cm4gMTsKCX0KCglkb19nZW5lcmljX3NldChjbWRsaW5lX2NoYW5uZWxzLCBB
UlJBWV9TSVpFKGNtZGxpbmVfY2hhbm5lbHMpLAoJCQkmY2hhbmdlZCk7CgoJaWYgKCFjaGFuZ2Vk
KSB7CgkJZnByaW50ZihzdGRlcnIsICJubyBjaGFubmVsIHBhcmFtZXRlcnMgY2hhbmdlZC5cbiIp
OwoJCWZwcmludGYoc3RkZXJyLCAiY3VycmVudCB2YWx1ZXM6IHJ4ICV1IHR4ICV1IG90aGVyICV1
IgoJCQkiIGNvbWJpbmVkICV1XG4iLCBlY2hhbm5lbHMucnhfY291bnQsCgkJCWVjaGFubmVscy50
eF9jb3VudCwgZWNoYW5uZWxzLm90aGVyX2NvdW50LAoJCQllY2hhbm5lbHMuY29tYmluZWRfY291
bnQpOwoJCXJldHVybiAwOwoJfQoKCWVjaGFubmVscy5jbWQgPSBFVEhUT09MX1NDSEFOTkVMUzsK
CWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmZWNoYW5uZWxzKTsKCWlmIChlcnIpIHsKCQlwZXJyb3Io
IkNhbm5vdCBzZXQgZGV2aWNlIGNoYW5uZWwgcGFyYW1ldGVycyIpOwoJCXJldHVybiAxOwoJfQoK
CXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRvX2djaGFubmVscyhzdHJ1Y3QgY21kX2NvbnRleHQg
KmN0eCkKewoJc3RydWN0IGV0aHRvb2xfY2hhbm5lbHMgZWNoYW5uZWxzOwoJaW50IGVycjsKCglp
ZiAoY3R4LT5hcmdjICE9IDApCgkJZXhpdF9iYWRfYXJncygpOwoKCWZwcmludGYoc3Rkb3V0LCAi
Q2hhbm5lbCBwYXJhbWV0ZXJzIGZvciAlczpcbiIsIGN0eC0+ZGV2bmFtZSk7CgoJZWNoYW5uZWxz
LmNtZCA9IEVUSFRPT0xfR0NIQU5ORUxTOwoJZXJyID0gc2VuZF9pb2N0bChjdHgsICZlY2hhbm5l
bHMpOwoJaWYgKGVyciA9PSAwKSB7CgkJZXJyID0gZHVtcF9jaGFubmVscygmZWNoYW5uZWxzKTsK
CQlpZiAoZXJyKQoJCQlyZXR1cm4gZXJyOwoJfSBlbHNlIHsKCQlwZXJyb3IoIkNhbm5vdCBnZXQg
ZGV2aWNlIGNoYW5uZWwgcGFyYW1ldGVycyIpOwoJCXJldHVybiAxOwoJfQoJcmV0dXJuIDA7Cgp9
CgpzdGF0aWMgaW50IGRvX2djb2FsZXNjZShzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJc3Ry
dWN0IGV0aHRvb2xfY29hbGVzY2UgZWNvYWwgPSB7fTsKCWludCBlcnI7CgoJaWYgKGN0eC0+YXJn
YyAhPSAwKQoJCWV4aXRfYmFkX2FyZ3MoKTsKCglmcHJpbnRmKHN0ZG91dCwgIkNvYWxlc2NlIHBh
cmFtZXRlcnMgZm9yICVzOlxuIiwgY3R4LT5kZXZuYW1lKTsKCgllY29hbC5jbWQgPSBFVEhUT09M
X0dDT0FMRVNDRTsKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmZWNvYWwpOwoJaWYgKGVyciA9PSAw
KSB7CgkJZXJyID0gZHVtcF9jb2FsZXNjZSgmZWNvYWwpOwoJCWlmIChlcnIpCgkJCXJldHVybiBl
cnI7Cgl9IGVsc2UgewoJCXBlcnJvcigiQ2Fubm90IGdldCBkZXZpY2UgY29hbGVzY2Ugc2V0dGlu
Z3MiKTsKCQlyZXR1cm4gODI7Cgl9CgoJcmV0dXJuIDA7Cn0KCiNkZWZpbmUgREVDTEFSRV9DT0FM
RVNDRV9PUFRJT05fVkFSUygpCQlcCglzMzIgY29hbF9zdGF0c193YW50ZWQgPSAtMTsJCVwKCWlu
dCBjb2FsX2FkYXB0aXZlX3J4X3dhbnRlZCA9IC0xOwlcCglpbnQgY29hbF9hZGFwdGl2ZV90eF93
YW50ZWQgPSAtMTsJXAoJczMyIGNvYWxfc2FtcGxlX3JhdGVfd2FudGVkID0gLTE7CVwKCXMzMiBj
b2FsX3BrdF9yYXRlX2xvd193YW50ZWQgPSAtMTsJXAoJczMyIGNvYWxfcGt0X3JhdGVfaGlnaF93
YW50ZWQgPSAtMTsJXAoJczMyIGNvYWxfcnhfdXNlY193YW50ZWQgPSAtMTsJCVwKCXMzMiBjb2Fs
X3J4X2ZyYW1lc193YW50ZWQgPSAtMTsJCVwKCXMzMiBjb2FsX3J4X3VzZWNfaXJxX3dhbnRlZCA9
IC0xOwlcCglzMzIgY29hbF9yeF9mcmFtZXNfaXJxX3dhbnRlZCA9IC0xOwlcCglzMzIgY29hbF90
eF91c2VjX3dhbnRlZCA9IC0xOwkJXAoJczMyIGNvYWxfdHhfZnJhbWVzX3dhbnRlZCA9IC0xOwkJ
XAoJczMyIGNvYWxfdHhfdXNlY19pcnFfd2FudGVkID0gLTE7CVwKCXMzMiBjb2FsX3R4X2ZyYW1l
c19pcnFfd2FudGVkID0gLTE7CVwKCXMzMiBjb2FsX3J4X3VzZWNfbG93X3dhbnRlZCA9IC0xOwlc
CglzMzIgY29hbF9yeF9mcmFtZXNfbG93X3dhbnRlZCA9IC0xOwlcCglzMzIgY29hbF90eF91c2Vj
X2xvd193YW50ZWQgPSAtMTsJXAoJczMyIGNvYWxfdHhfZnJhbWVzX2xvd193YW50ZWQgPSAtMTsJ
XAoJczMyIGNvYWxfcnhfdXNlY19oaWdoX3dhbnRlZCA9IC0xOwlcCglzMzIgY29hbF9yeF9mcmFt
ZXNfaGlnaF93YW50ZWQgPSAtMTsJXAoJczMyIGNvYWxfdHhfdXNlY19oaWdoX3dhbnRlZCA9IC0x
OwlcCglzMzIgY29hbF90eF9mcmFtZXNfaGlnaF93YW50ZWQgPSAtMQoKI2RlZmluZSBDT0FMRVND
RV9DTURMSU5FX0lORk8oX19lY29hbCkJCQkJCVwKewkJCQkJCQkJCVwKCXsJCQkJCQkJCVwKCQku
bmFtZQkJPSAiYWRhcHRpdmUtcngiLAkJCVwKCQkudHlwZQkJPSBDTURMX0JPT0wsCQkJCVwKCQku
d2FudGVkX3ZhbAk9ICZjb2FsX2FkYXB0aXZlX3J4X3dhbnRlZCwJCVwKCQkuaW9jdGxfdmFsCT0g
Jl9fZWNvYWwudXNlX2FkYXB0aXZlX3J4X2NvYWxlc2NlLAlcCgl9LAkJCQkJCQkJXAoJewkJCQkJ
CQkJXAoJCS5uYW1lCQk9ICJhZGFwdGl2ZS10eCIsCQkJXAoJCS50eXBlCQk9IENNRExfQk9PTCwJ
CQkJXAoJCS53YW50ZWRfdmFsCT0gJmNvYWxfYWRhcHRpdmVfdHhfd2FudGVkLAkJXAoJCS5pb2N0
bF92YWwJPSAmX19lY29hbC51c2VfYWRhcHRpdmVfdHhfY29hbGVzY2UsCVwKCX0sCQkJCQkJCQlc
Cgl7CQkJCQkJCQlcCgkJLm5hbWUJCT0gInNhbXBsZS1pbnRlcnZhbCIsCQkJXAoJCS50eXBlCQk9
IENNRExfUzMyLAkJCQlcCgkJLndhbnRlZF92YWwJPSAmY29hbF9zYW1wbGVfcmF0ZV93YW50ZWQs
CQlcCgkJLmlvY3RsX3ZhbAk9ICZfX2Vjb2FsLnJhdGVfc2FtcGxlX2ludGVydmFsLAlcCgl9LAkJ
CQkJCQkJXAoJewkJCQkJCQkJXAoJCS5uYW1lCQk9ICJzdGF0cy1ibG9jay11c2VjcyIsCQkJXAoJ
CS50eXBlCQk9IENNRExfUzMyLAkJCQlcCgkJLndhbnRlZF92YWwJPSAmY29hbF9zdGF0c193YW50
ZWQsCQkJXAoJCS5pb2N0bF92YWwJPSAmX19lY29hbC5zdGF0c19ibG9ja19jb2FsZXNjZV91c2Vj
cywJXAoJfSwJCQkJCQkJCVwKCXsJCQkJCQkJCVwKCQkubmFtZQkJPSAicGt0LXJhdGUtbG93IiwJ
CQlcCgkJLnR5cGUJCT0gQ01ETF9TMzIsCQkJCVwKCQkud2FudGVkX3ZhbAk9ICZjb2FsX3BrdF9y
YXRlX2xvd193YW50ZWQsCQlcCgkJLmlvY3RsX3ZhbAk9ICZfX2Vjb2FsLnBrdF9yYXRlX2xvdywJ
CVwKCX0sCQkJCQkJCQlcCgl7CQkJCQkJCQlcCgkJLm5hbWUJCT0gInBrdC1yYXRlLWhpZ2giLAkJ
CVwKCQkudHlwZQkJPSBDTURMX1MzMiwJCQkJXAoJCS53YW50ZWRfdmFsCT0gJmNvYWxfcGt0X3Jh
dGVfaGlnaF93YW50ZWQsCQlcCgkJLmlvY3RsX3ZhbAk9ICZfX2Vjb2FsLnBrdF9yYXRlX2hpZ2gs
CQlcCgl9LAkJCQkJCQkJXAoJewkJCQkJCQkJXAoJCS5uYW1lCQk9ICJyeC11c2VjcyIsCQkJCVwK
CQkudHlwZQkJPSBDTURMX1MzMiwJCQkJXAoJCS53YW50ZWRfdmFsCT0gJmNvYWxfcnhfdXNlY193
YW50ZWQsCQkJXAoJCS5pb2N0bF92YWwJPSAmX19lY29hbC5yeF9jb2FsZXNjZV91c2VjcywJCVwK
CX0sCQkJCQkJCQlcCgl7CQkJCQkJCQlcCgkJLm5hbWUJCT0gInJ4LWZyYW1lcyIsCQkJCVwKCQku
dHlwZQkJPSBDTURMX1MzMiwJCQkJXAoJCS53YW50ZWRfdmFsCT0gJmNvYWxfcnhfZnJhbWVzX3dh
bnRlZCwJCVwKCQkuaW9jdGxfdmFsCT0gJl9fZWNvYWwucnhfbWF4X2NvYWxlc2NlZF9mcmFtZXMs
CVwKCX0sCQkJCQkJCQlcCgl7CQkJCQkJCQlcCgkJLm5hbWUJCT0gInJ4LXVzZWNzLWlycSIsCQkJ
XAoJCS50eXBlCQk9IENNRExfUzMyLAkJCQlcCgkJLndhbnRlZF92YWwJPSAmY29hbF9yeF91c2Vj
X2lycV93YW50ZWQsCQlcCgkJLmlvY3RsX3ZhbAk9ICZfX2Vjb2FsLnJ4X2NvYWxlc2NlX3VzZWNz
X2lycSwJXAoJfSwJCQkJCQkJCVwKCXsJCQkJCQkJCVwKCQkubmFtZQkJPSAicngtZnJhbWVzLWly
cSIsCQkJXAoJCS50eXBlCQk9IENNRExfUzMyLAkJCQlcCgkJLndhbnRlZF92YWwJPSAmY29hbF9y
eF9mcmFtZXNfaXJxX3dhbnRlZCwJCVwKCQkuaW9jdGxfdmFsCT0gJl9fZWNvYWwucnhfbWF4X2Nv
YWxlc2NlZF9mcmFtZXNfaXJxLAlcCgl9LAkJCQkJCQkJXAoJewkJCQkJCQkJXAoJCS5uYW1lCQk9
ICJ0eC11c2VjcyIsCQkJCVwKCQkudHlwZQkJPSBDTURMX1MzMiwJCQkJXAoJCS53YW50ZWRfdmFs
CT0gJmNvYWxfdHhfdXNlY193YW50ZWQsCQkJXAoJCS5pb2N0bF92YWwJPSAmX19lY29hbC50eF9j
b2FsZXNjZV91c2VjcywJCVwKCX0sCQkJCQkJCQlcCgl7CQkJCQkJCQlcCgkJLm5hbWUJCT0gInR4
LWZyYW1lcyIsCQkJCVwKCQkudHlwZQkJPSBDTURMX1MzMiwJCQkJXAoJCS53YW50ZWRfdmFsCT0g
JmNvYWxfdHhfZnJhbWVzX3dhbnRlZCwJCVwKCQkuaW9jdGxfdmFsCT0gJl9fZWNvYWwudHhfbWF4
X2NvYWxlc2NlZF9mcmFtZXMsCVwKCX0sCQkJCQkJCQlcCgl7CQkJCQkJCQlcCgkJLm5hbWUJCT0g
InR4LXVzZWNzLWlycSIsCQkJXAoJCS50eXBlCQk9IENNRExfUzMyLAkJCQlcCgkJLndhbnRlZF92
YWwJPSAmY29hbF90eF91c2VjX2lycV93YW50ZWQsCQlcCgkJLmlvY3RsX3ZhbAk9ICZfX2Vjb2Fs
LnR4X2NvYWxlc2NlX3VzZWNzX2lycSwJXAoJfSwJCQkJCQkJCVwKCXsJCQkJCQkJCVwKCQkubmFt
ZQkJPSAidHgtZnJhbWVzLWlycSIsCQkJXAoJCS50eXBlCQk9IENNRExfUzMyLAkJCQlcCgkJLndh
bnRlZF92YWwJPSAmY29hbF90eF9mcmFtZXNfaXJxX3dhbnRlZCwJCVwKCQkuaW9jdGxfdmFsCT0g
Jl9fZWNvYWwudHhfbWF4X2NvYWxlc2NlZF9mcmFtZXNfaXJxLAlcCgl9LAkJCQkJCQkJXAoJewkJ
CQkJCQkJXAoJCS5uYW1lCQk9ICJyeC11c2Vjcy1sb3ciLAkJCVwKCQkudHlwZQkJPSBDTURMX1Mz
MiwJCQkJXAoJCS53YW50ZWRfdmFsCT0gJmNvYWxfcnhfdXNlY19sb3dfd2FudGVkLAkJXAoJCS5p
b2N0bF92YWwJPSAmX19lY29hbC5yeF9jb2FsZXNjZV91c2Vjc19sb3csCVwKCX0sCQkJCQkJCQlc
Cgl7CQkJCQkJCQlcCgkJLm5hbWUJCT0gInJ4LWZyYW1lcy1sb3ciLAkJCVwKCQkudHlwZQkJPSBD
TURMX1MzMiwJCQkJXAoJCS53YW50ZWRfdmFsCT0gJmNvYWxfcnhfZnJhbWVzX2xvd193YW50ZWQs
CQlcCgkJLmlvY3RsX3ZhbAk9ICZfX2Vjb2FsLnJ4X21heF9jb2FsZXNjZWRfZnJhbWVzX2xvdywJ
XAoJfSwJCQkJCQkJCVwKCXsJCQkJCQkJCVwKCQkubmFtZQkJPSAidHgtdXNlY3MtbG93IiwJCQlc
CgkJLnR5cGUJCT0gQ01ETF9TMzIsCQkJCVwKCQkud2FudGVkX3ZhbAk9ICZjb2FsX3R4X3VzZWNf
bG93X3dhbnRlZCwJCVwKCQkuaW9jdGxfdmFsCT0gJl9fZWNvYWwudHhfY29hbGVzY2VfdXNlY3Nf
bG93LAlcCgl9LAkJCQkJCQkJXAoJewkJCQkJCQkJXAoJCS5uYW1lCQk9ICJ0eC1mcmFtZXMtbG93
IiwJCQlcCgkJLnR5cGUJCT0gQ01ETF9TMzIsCQkJCVwKCQkud2FudGVkX3ZhbAk9ICZjb2FsX3R4
X2ZyYW1lc19sb3dfd2FudGVkLAkJXAoJCS5pb2N0bF92YWwJPSAmX19lY29hbC50eF9tYXhfY29h
bGVzY2VkX2ZyYW1lc19sb3csCVwKCX0sCQkJCQkJCQlcCgl7CQkJCQkJCQlcCgkJLm5hbWUJCT0g
InJ4LXVzZWNzLWhpZ2giLAkJCVwKCQkudHlwZQkJPSBDTURMX1MzMiwJCQkJXAoJCS53YW50ZWRf
dmFsCT0gJmNvYWxfcnhfdXNlY19oaWdoX3dhbnRlZCwJCVwKCQkuaW9jdGxfdmFsCT0gJl9fZWNv
YWwucnhfY29hbGVzY2VfdXNlY3NfaGlnaCwJXAoJfSwJCQkJCQkJCVwKCXsJCQkJCQkJCVwKCQku
bmFtZQkJPSAicngtZnJhbWVzLWhpZ2giLAkJCVwKCQkudHlwZQkJPSBDTURMX1MzMiwJCQkJXAoJ
CS53YW50ZWRfdmFsCT0gJmNvYWxfcnhfZnJhbWVzX2hpZ2hfd2FudGVkLAkJXAoJCS5pb2N0bF92
YWwJPSAmX19lY29hbC5yeF9tYXhfY29hbGVzY2VkX2ZyYW1lc19oaWdoLFwKCX0sCQkJCQkJCQlc
Cgl7CQkJCQkJCQlcCgkJLm5hbWUJCT0gInR4LXVzZWNzLWhpZ2giLAkJCVwKCQkudHlwZQkJPSBD
TURMX1MzMiwJCQkJXAoJCS53YW50ZWRfdmFsCT0gJmNvYWxfdHhfdXNlY19oaWdoX3dhbnRlZCwJ
CVwKCQkuaW9jdGxfdmFsCT0gJl9fZWNvYWwudHhfY29hbGVzY2VfdXNlY3NfaGlnaCwJXAoJfSwJ
CQkJCQkJCVwKCXsJCQkJCQkJCVwKCQkubmFtZQkJPSAidHgtZnJhbWVzLWhpZ2giLAkJCVwKCQku
dHlwZQkJPSBDTURMX1MzMiwJCQkJXAoJCS53YW50ZWRfdmFsCT0gJmNvYWxfdHhfZnJhbWVzX2hp
Z2hfd2FudGVkLAkJXAoJCS5pb2N0bF92YWwJPSAmX19lY29hbC50eF9tYXhfY29hbGVzY2VkX2Zy
YW1lc19oaWdoLFwKCX0sCQkJCQkJCQlcCn0KCnN0YXRpYyBpbnQgZG9fc2NvYWxlc2NlKHN0cnVj
dCBjbWRfY29udGV4dCAqY3R4KQp7CglzdHJ1Y3QgZXRodG9vbF9jb2FsZXNjZSBlY29hbDsKCWlu
dCBnY29hbGVzY2VfY2hhbmdlZCA9IDA7CglERUNMQVJFX0NPQUxFU0NFX09QVElPTl9WQVJTKCk7
CglzdHJ1Y3QgY21kbGluZV9pbmZvIGNtZGxpbmVfY29hbGVzY2VbXSA9IENPQUxFU0NFX0NNRExJ
TkVfSU5GTyhlY29hbCk7CglpbnQgZXJyLCBjaGFuZ2VkID0gMDsKCglwYXJzZV9nZW5lcmljX2Nt
ZGxpbmUoY3R4LCAmZ2NvYWxlc2NlX2NoYW5nZWQsCgkJCSAgICAgIGNtZGxpbmVfY29hbGVzY2Us
IEFSUkFZX1NJWkUoY21kbGluZV9jb2FsZXNjZSkpOwoKCWVjb2FsLmNtZCA9IEVUSFRPT0xfR0NP
QUxFU0NFOwoJZXJyID0gc2VuZF9pb2N0bChjdHgsICZlY29hbCk7CglpZiAoZXJyKSB7CgkJcGVy
cm9yKCJDYW5ub3QgZ2V0IGRldmljZSBjb2FsZXNjZSBzZXR0aW5ncyIpOwoJCXJldHVybiA3NjsK
CX0KCglkb19nZW5lcmljX3NldChjbWRsaW5lX2NvYWxlc2NlLCBBUlJBWV9TSVpFKGNtZGxpbmVf
Y29hbGVzY2UpLAoJCSAgICAgICAmY2hhbmdlZCk7CgoJaWYgKCFjaGFuZ2VkKSB7CgkJZnByaW50
ZihzdGRlcnIsICJubyBjb2FsZXNjZSBwYXJhbWV0ZXJzIGNoYW5nZWQsIGFib3J0aW5nXG4iKTsK
CQlyZXR1cm4gODA7Cgl9CgoJZWNvYWwuY21kID0gRVRIVE9PTF9TQ09BTEVTQ0U7CgllcnIgPSBz
ZW5kX2lvY3RsKGN0eCwgJmVjb2FsKTsKCWlmIChlcnIpIHsKCQlwZXJyb3IoIkNhbm5vdCBzZXQg
ZGV2aWNlIGNvYWxlc2NlIHBhcmFtZXRlcnMiKTsKCQlyZXR1cm4gODE7Cgl9CgoJcmV0dXJuIDA7
Cn0KCnN0YXRpYyBzdHJ1Y3QgZmVhdHVyZV9zdGF0ZSAqCmdldF9mZWF0dXJlcyhzdHJ1Y3QgY21k
X2NvbnRleHQgKmN0eCwgY29uc3Qgc3RydWN0IGZlYXR1cmVfZGVmcyAqZGVmcykKewoJc3RydWN0
IGZlYXR1cmVfc3RhdGUgKnN0YXRlOwoJc3RydWN0IGV0aHRvb2xfdmFsdWUgZXZhbDsKCWludCBl
cnIsIGFsbGZhaWwgPSAxOwoJdTMyIHZhbHVlOwoJaW50IGk7CgoJc3RhdGUgPSBtYWxsb2Moc2l6
ZW9mKCpzdGF0ZSkgKwoJCSAgICAgICBGRUFUVVJFX0JJVFNfVE9fQkxPQ0tTKGRlZnMtPm5fZmVh
dHVyZXMpICoKCQkgICAgICAgc2l6ZW9mKHN0YXRlLT5mZWF0dXJlcy5mZWF0dXJlc1swXSkpOwoJ
aWYgKCFzdGF0ZSkKCQlyZXR1cm4gTlVMTDsKCglzdGF0ZS0+b2ZmX2ZsYWdzID0gMDsKCglmb3Ig
KGkgPSAwOyBpIDwgT0ZGX0ZMQUdfREVGX1NJWkU7IGkrKykgewoJCXZhbHVlID0gb2ZmX2ZsYWdf
ZGVmW2ldLnZhbHVlOwoJCWlmICghb2ZmX2ZsYWdfZGVmW2ldLmdldF9jbWQpCgkJCWNvbnRpbnVl
OwoJCWV2YWwuY21kID0gb2ZmX2ZsYWdfZGVmW2ldLmdldF9jbWQ7CgkJZXJyID0gc2VuZF9pb2N0
bChjdHgsICZldmFsKTsKCQlpZiAoZXJyKSB7CgkJCWlmIChlcnJubyA9PSBFT1BOT1RTVVBQICYm
CgkJCSAgICBvZmZfZmxhZ19kZWZbaV0uZ2V0X2NtZCA9PSBFVEhUT09MX0dVRk8pCgkJCQljb250
aW51ZTsKCgkJCWZwcmludGYoc3RkZXJyLAoJCQkJIkNhbm5vdCBnZXQgZGV2aWNlICVzIHNldHRp
bmdzOiAlbVxuIiwKCQkJCW9mZl9mbGFnX2RlZltpXS5sb25nX25hbWUpOwoJCX0gZWxzZSB7CgkJ
CWlmIChldmFsLmRhdGEpCgkJCQlzdGF0ZS0+b2ZmX2ZsYWdzIHw9IHZhbHVlOwoJCQlhbGxmYWls
ID0gMDsKCQl9Cgl9CgoJZXZhbC5jbWQgPSBFVEhUT09MX0dGTEFHUzsKCWVyciA9IHNlbmRfaW9j
dGwoY3R4LCAmZXZhbCk7CglpZiAoZXJyKSB7CgkJcGVycm9yKCJDYW5ub3QgZ2V0IGRldmljZSBm
bGFncyIpOwoJfSBlbHNlIHsKCQlzdGF0ZS0+b2ZmX2ZsYWdzIHw9IGV2YWwuZGF0YSAmIEVUSF9G
TEFHX0VYVF9NQVNLOwoJCWFsbGZhaWwgPSAwOwoJfQoKCWlmIChkZWZzLT5uX2ZlYXR1cmVzKSB7
CgkJc3RhdGUtPmZlYXR1cmVzLmNtZCA9IEVUSFRPT0xfR0ZFQVRVUkVTOwoJCXN0YXRlLT5mZWF0
dXJlcy5zaXplID0gRkVBVFVSRV9CSVRTX1RPX0JMT0NLUyhkZWZzLT5uX2ZlYXR1cmVzKTsKCQll
cnIgPSBzZW5kX2lvY3RsKGN0eCwgJnN0YXRlLT5mZWF0dXJlcyk7CgkJaWYgKGVycikKCQkJcGVy
cm9yKCJDYW5ub3QgZ2V0IGRldmljZSBnZW5lcmljIGZlYXR1cmVzIik7CgkJZWxzZQoJCQlhbGxm
YWlsID0gMDsKCX0KCglpZiAoYWxsZmFpbCkgewoJCWZyZWUoc3RhdGUpOwoJCXJldHVybiBOVUxM
OwoJfQoKCXJldHVybiBzdGF0ZTsKfQoKc3RhdGljIGludCBkb19nZmVhdHVyZXMoc3RydWN0IGNt
ZF9jb250ZXh0ICpjdHgpCnsKCXN0cnVjdCBmZWF0dXJlX2RlZnMgKmRlZnM7CglzdHJ1Y3QgZmVh
dHVyZV9zdGF0ZSAqZmVhdHVyZXM7CgoJaWYgKGN0eC0+YXJnYyAhPSAwKQoJCWV4aXRfYmFkX2Fy
Z3MoKTsKCglkZWZzID0gZ2V0X2ZlYXR1cmVfZGVmcyhjdHgpOwoJaWYgKCFkZWZzKSB7CgkJcGVy
cm9yKCJDYW5ub3QgZ2V0IGRldmljZSBmZWF0dXJlIG5hbWVzIik7CgkJcmV0dXJuIDE7Cgl9CgoJ
ZnByaW50ZihzdGRvdXQsICJGZWF0dXJlcyBmb3IgJXM6XG4iLCBjdHgtPmRldm5hbWUpOwoKCWZl
YXR1cmVzID0gZ2V0X2ZlYXR1cmVzKGN0eCwgZGVmcyk7CglpZiAoIWZlYXR1cmVzKSB7CgkJZnBy
aW50ZihzdGRvdXQsICJubyBmZWF0dXJlIGluZm8gYXZhaWxhYmxlXG4iKTsKCQlmcmVlKGRlZnMp
OwoJCXJldHVybiAxOwoJfQoKCWR1bXBfZmVhdHVyZXMoZGVmcywgZmVhdHVyZXMsIE5VTEwpOwoJ
ZnJlZShmZWF0dXJlcyk7CglmcmVlKGRlZnMpOwoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgZG9f
c2ZlYXR1cmVzKHN0cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7CglzdHJ1Y3QgZmVhdHVyZV9kZWZz
ICpkZWZzOwoJaW50IGFueV9jaGFuZ2VkID0gMCwgYW55X21pc21hdGNoID0gMDsKCXUzMiBvZmZf
ZmxhZ3Nfd2FudGVkID0gMDsKCXUzMiBvZmZfZmxhZ3NfbWFzayA9IDA7CglzdHJ1Y3QgZXRodG9v
bF9zZmVhdHVyZXMgKmVmZWF0dXJlcyA9IE5VTEw7CglzdHJ1Y3QgZmVhdHVyZV9zdGF0ZSAqb2xk
X3N0YXRlID0gTlVMTDsKCXN0cnVjdCBmZWF0dXJlX3N0YXRlICpuZXdfc3RhdGUgPSBOVUxMOwoJ
c3RydWN0IGNtZGxpbmVfaW5mbyAqY21kbGluZV9mZWF0dXJlczsKCXN0cnVjdCBldGh0b29sX3Zh
bHVlIGV2YWw7Cgl1bnNpZ25lZCBpbnQgaSwgajsKCWludCBlcnIsIHJjOwoKCWRlZnMgPSBnZXRf
ZmVhdHVyZV9kZWZzKGN0eCk7CglpZiAoIWRlZnMpIHsKCQlwZXJyb3IoIkNhbm5vdCBnZXQgZGV2
aWNlIGZlYXR1cmUgbmFtZXMiKTsKCQlyZXR1cm4gMTsKCX0KCWlmIChkZWZzLT5uX2ZlYXR1cmVz
KSB7CgkJZWZlYXR1cmVzID0gbWFsbG9jKHNpemVvZigqZWZlYXR1cmVzKSArCgkJCQkgICBGRUFU
VVJFX0JJVFNfVE9fQkxPQ0tTKGRlZnMtPm5fZmVhdHVyZXMpICoKCQkJCSAgIHNpemVvZihlZmVh
dHVyZXMtPmZlYXR1cmVzWzBdKSk7CgkJaWYgKCFlZmVhdHVyZXMpIHsKCQkJcGVycm9yKCJDYW5u
b3QgcGFyc2UgYXJndW1lbnRzIik7CgkJCXJjID0gMTsKCQkJZ290byBlcnI7CgkJfQoJCWVmZWF0
dXJlcy0+Y21kID0gRVRIVE9PTF9TRkVBVFVSRVM7CgkJZWZlYXR1cmVzLT5zaXplID0gRkVBVFVS
RV9CSVRTX1RPX0JMT0NLUyhkZWZzLT5uX2ZlYXR1cmVzKTsKCQltZW1zZXQoZWZlYXR1cmVzLT5m
ZWF0dXJlcywgMCwKCQkgICAgICAgRkVBVFVSRV9CSVRTX1RPX0JMT0NLUyhkZWZzLT5uX2ZlYXR1
cmVzKSAqCgkJICAgICAgIHNpemVvZihlZmVhdHVyZXMtPmZlYXR1cmVzWzBdKSk7Cgl9CgoJLyog
R2VuZXJhdGUgY21kbGluZV9pbmZvIGZvciBsZWdhY3kgZmxhZ3MgYW5kIGtlcm5lbC1uYW1lZAoJ
ICogZmVhdHVyZXMsIGFuZCBwYXJzZSBvdXIgYXJndW1lbnRzLgoJICovCgljbWRsaW5lX2ZlYXR1
cmVzID0gY2FsbG9jKDIgKiBPRkZfRkxBR19ERUZfU0laRSArIGRlZnMtPm5fZmVhdHVyZXMsCgkJ
CQkgIHNpemVvZihjbWRsaW5lX2ZlYXR1cmVzWzBdKSk7CglpZiAoIWNtZGxpbmVfZmVhdHVyZXMp
IHsKCQlwZXJyb3IoIkNhbm5vdCBwYXJzZSBhcmd1bWVudHMiKTsKCQlyYyA9IDE7CgkJZ290byBl
cnI7Cgl9CglqID0gMDsKCWZvciAoaSA9IDA7IGkgPCBPRkZfRkxBR19ERUZfU0laRTsgaSsrKSB7
CgkJZmxhZ190b19jbWRsaW5lX2luZm8ob2ZmX2ZsYWdfZGVmW2ldLnNob3J0X25hbWUsCgkJCQkg
ICAgIG9mZl9mbGFnX2RlZltpXS52YWx1ZSwKCQkJCSAgICAgJm9mZl9mbGFnc193YW50ZWQsICZv
ZmZfZmxhZ3NfbWFzaywKCQkJCSAgICAgJmNtZGxpbmVfZmVhdHVyZXNbaisrXSk7CgkJZmxhZ190
b19jbWRsaW5lX2luZm8ob2ZmX2ZsYWdfZGVmW2ldLmxvbmdfbmFtZSwKCQkJCSAgICAgb2ZmX2Zs
YWdfZGVmW2ldLnZhbHVlLAoJCQkJICAgICAmb2ZmX2ZsYWdzX3dhbnRlZCwgJm9mZl9mbGFnc19t
YXNrLAoJCQkJICAgICAmY21kbGluZV9mZWF0dXJlc1tqKytdKTsKCX0KCWZvciAoaSA9IDA7IGkg
PCBkZWZzLT5uX2ZlYXR1cmVzOyBpKyspCgkJZmxhZ190b19jbWRsaW5lX2luZm8oCgkJCWRlZnMt
PmRlZltpXS5uYW1lLCBGRUFUVVJFX0ZJRUxEX0ZMQUcoaSksCgkJCSZGRUFUVVJFX1dPUkQoZWZl
YXR1cmVzLT5mZWF0dXJlcywgaSwgcmVxdWVzdGVkKSwKCQkJJkZFQVRVUkVfV09SRChlZmVhdHVy
ZXMtPmZlYXR1cmVzLCBpLCB2YWxpZCksCgkJCSZjbWRsaW5lX2ZlYXR1cmVzW2orK10pOwoJcGFy
c2VfZ2VuZXJpY19jbWRsaW5lKGN0eCwgJmFueV9jaGFuZ2VkLCBjbWRsaW5lX2ZlYXR1cmVzLAoJ
CQkgICAgICAyICogT0ZGX0ZMQUdfREVGX1NJWkUgKyBkZWZzLT5uX2ZlYXR1cmVzKTsKCWZyZWUo
Y21kbGluZV9mZWF0dXJlcyk7CgoJaWYgKCFhbnlfY2hhbmdlZCkgewoJCWZwcmludGYoc3Rkb3V0
LCAibm8gZmVhdHVyZXMgY2hhbmdlZFxuIik7CgkJcmMgPSAwOwoJCWdvdG8gZXJyOwoJfQoKCW9s
ZF9zdGF0ZSA9IGdldF9mZWF0dXJlcyhjdHgsIGRlZnMpOwoJaWYgKCFvbGRfc3RhdGUpIHsKCQly
YyA9IDE7CgkJZ290byBlcnI7Cgl9CgoJaWYgKGVmZWF0dXJlcykgewoJCS8qIEZvciBlYWNoIG9m
ZmxvYWQgdGhhdCB0aGUgdXNlciBzcGVjaWZpZWQsIHVwZGF0ZSBhbnkKCQkgKiByZWxhdGVkIGZl
YXR1cmVzIHRoYXQgdGhlIHVzZXIgZGlkIG5vdCBzcGVjaWZ5IGFuZCB0aGF0CgkJICogYXJlIG5v
dCBmaXhlZC4gIFdhcm4gaWYgYWxsIHJlbGF0ZWQgZmVhdHVyZXMgYXJlIGZpeGVkLgoJCSAqLwoJ
CWZvciAoaSA9IDA7IGkgPCBPRkZfRkxBR19ERUZfU0laRTsgaSsrKSB7CgkJCWludCBmaXhlZCA9
IDE7CgoJCQlpZiAoIShvZmZfZmxhZ3NfbWFzayAmIG9mZl9mbGFnX2RlZltpXS52YWx1ZSkpCgkJ
CQljb250aW51ZTsKCgkJCWZvciAoaiA9IDA7IGogPCBkZWZzLT5uX2ZlYXR1cmVzOyBqKyspIHsK
CQkJCWlmIChkZWZzLT5kZWZbal0ub2ZmX2ZsYWdfaW5kZXggIT0gKGludClpIHx8CgkJCQkgICAg
IUZFQVRVUkVfQklUX0lTX1NFVCgKCQkJCQkgICAgb2xkX3N0YXRlLT5mZWF0dXJlcy5mZWF0dXJl
cywKCQkJCQkgICAgaiwgYXZhaWxhYmxlKSB8fAoJCQkJICAgIEZFQVRVUkVfQklUX0lTX1NFVCgK
CQkJCQkgICAgb2xkX3N0YXRlLT5mZWF0dXJlcy5mZWF0dXJlcywKCQkJCQkgICAgaiwgbmV2ZXJf
Y2hhbmdlZCkpCgkJCQkJY29udGludWU7CgoJCQkJZml4ZWQgPSAwOwoJCQkJaWYgKCFGRUFUVVJF
X0JJVF9JU19TRVQoZWZlYXR1cmVzLT5mZWF0dXJlcywKCQkJCQkJCWosIHZhbGlkKSkgewoJCQkJ
CUZFQVRVUkVfQklUX1NFVChlZmVhdHVyZXMtPmZlYXR1cmVzLAoJCQkJCQkJaiwgdmFsaWQpOwoJ
CQkJCWlmIChvZmZfZmxhZ3Nfd2FudGVkICYKCQkJCQkgICAgb2ZmX2ZsYWdfZGVmW2ldLnZhbHVl
KQoJCQkJCQlGRUFUVVJFX0JJVF9TRVQoCgkJCQkJCQllZmVhdHVyZXMtPmZlYXR1cmVzLAoJCQkJ
CQkJaiwgcmVxdWVzdGVkKTsKCQkJCX0KCQkJfQoKCQkJaWYgKGZpeGVkKQoJCQkJZnByaW50Zihz
dGRlcnIsICJDYW5ub3QgY2hhbmdlICVzXG4iLAoJCQkJCW9mZl9mbGFnX2RlZltpXS5sb25nX25h
bWUpOwoJCX0KCgkJZXJyID0gc2VuZF9pb2N0bChjdHgsIGVmZWF0dXJlcyk7CgkJaWYgKGVyciA8
IDApIHsKCQkJcGVycm9yKCJDYW5ub3Qgc2V0IGRldmljZSBmZWF0dXJlIHNldHRpbmdzIik7CgkJ
CXJjID0gMTsKCQkJZ290byBlcnI7CgkJfQoJfSBlbHNlIHsKCQlmb3IgKGkgPSAwOyBpIDwgT0ZG
X0ZMQUdfREVGX1NJWkU7IGkrKykgewoJCQlpZiAoIW9mZl9mbGFnX2RlZltpXS5zZXRfY21kKQoJ
CQkJY29udGludWU7CgkJCWlmIChvZmZfZmxhZ3NfbWFzayAmIG9mZl9mbGFnX2RlZltpXS52YWx1
ZSkgewoJCQkJZXZhbC5jbWQgPSBvZmZfZmxhZ19kZWZbaV0uc2V0X2NtZDsKCQkJCWV2YWwuZGF0
YSA9ICEhKG9mZl9mbGFnc193YW50ZWQgJgoJCQkJCSAgICAgICBvZmZfZmxhZ19kZWZbaV0udmFs
dWUpOwoJCQkJZXJyID0gc2VuZF9pb2N0bChjdHgsICZldmFsKTsKCQkJCWlmIChlcnIpIHsKCQkJ
CQlmcHJpbnRmKHN0ZGVyciwKCQkJCQkJIkNhbm5vdCBzZXQgZGV2aWNlICVzIHNldHRpbmdzOiAl
bVxuIiwKCQkJCQkJb2ZmX2ZsYWdfZGVmW2ldLmxvbmdfbmFtZSk7CgkJCQkJcmMgPSAxOwoJCQkJ
CWdvdG8gZXJyOwoJCQkJfQoJCQl9CgkJfQoKCQlpZiAob2ZmX2ZsYWdzX21hc2sgJiBFVEhfRkxB
R19FWFRfTUFTSykgewoJCQlldmFsLmNtZCA9IEVUSFRPT0xfU0ZMQUdTOwoJCQlldmFsLmRhdGEg
PSAob2xkX3N0YXRlLT5vZmZfZmxhZ3MgJiB+b2ZmX2ZsYWdzX21hc2sgJgoJCQkJICAgICBFVEhf
RkxBR19FWFRfTUFTSyk7CgkJCWV2YWwuZGF0YSB8PSBvZmZfZmxhZ3Nfd2FudGVkICYgRVRIX0ZM
QUdfRVhUX01BU0s7CgoJCQllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJmV2YWwpOwoJCQlpZiAoZXJy
KSB7CgkJCQlwZXJyb3IoIkNhbm5vdCBzZXQgZGV2aWNlIGZsYWcgc2V0dGluZ3MiKTsKCQkJCXJj
ID0gOTI7CgkJCQlnb3RvIGVycjsKCQkJfQoJCX0KCX0KCgkvKiBDb21wYXJlIG5ldyBzdGF0ZSB3
aXRoIHJlcXVlc3RlZCBzdGF0ZSAqLwoJbmV3X3N0YXRlID0gZ2V0X2ZlYXR1cmVzKGN0eCwgZGVm
cyk7CglpZiAoIW5ld19zdGF0ZSkgewoJCXJjID0gMTsKCQlnb3RvIGVycjsKCX0KCWFueV9jaGFu
Z2VkID0gbmV3X3N0YXRlLT5vZmZfZmxhZ3MgIT0gb2xkX3N0YXRlLT5vZmZfZmxhZ3M7Cglhbnlf
bWlzbWF0Y2ggPSAobmV3X3N0YXRlLT5vZmZfZmxhZ3MgIT0KCQkJKChvbGRfc3RhdGUtPm9mZl9m
bGFncyAmIH5vZmZfZmxhZ3NfbWFzaykgfAoJCQkgb2ZmX2ZsYWdzX3dhbnRlZCkpOwoJZm9yIChp
ID0gMDsgaSA8IEZFQVRVUkVfQklUU19UT19CTE9DS1MoZGVmcy0+bl9mZWF0dXJlcyk7IGkrKykg
ewoJCWlmIChuZXdfc3RhdGUtPmZlYXR1cmVzLmZlYXR1cmVzW2ldLmFjdGl2ZSAhPQoJCSAgICBv
bGRfc3RhdGUtPmZlYXR1cmVzLmZlYXR1cmVzW2ldLmFjdGl2ZSkKCQkJYW55X2NoYW5nZWQgPSAx
OwoJCWlmIChuZXdfc3RhdGUtPmZlYXR1cmVzLmZlYXR1cmVzW2ldLmFjdGl2ZSAhPQoJCSAgICAo
KG9sZF9zdGF0ZS0+ZmVhdHVyZXMuZmVhdHVyZXNbaV0uYWN0aXZlICYKCQkgICAgICB+ZWZlYXR1
cmVzLT5mZWF0dXJlc1tpXS52YWxpZCkgfAoJCSAgICAgZWZlYXR1cmVzLT5mZWF0dXJlc1tpXS5y
ZXF1ZXN0ZWQpKQoJCQlhbnlfbWlzbWF0Y2ggPSAxOwoJfQoJaWYgKGFueV9taXNtYXRjaCkgewoJ
CWlmICghYW55X2NoYW5nZWQpIHsKCQkJZnByaW50ZihzdGRlcnIsCgkJCQkiQ291bGQgbm90IGNo
YW5nZSBhbnkgZGV2aWNlIGZlYXR1cmVzXG4iKTsKCQkJcmMgPSAxOwoJCQlnb3RvIGVycjsKCQl9
CgkJcHJpbnRmKCJBY3R1YWwgY2hhbmdlczpcbiIpOwoJCWR1bXBfZmVhdHVyZXMoZGVmcywgbmV3
X3N0YXRlLCBvbGRfc3RhdGUpOwoJfQoKCXJjID0gMDsKCmVycjoKCWZyZWUobmV3X3N0YXRlKTsK
CWZyZWUob2xkX3N0YXRlKTsKCWZyZWUoZGVmcyk7CglmcmVlKGVmZWF0dXJlcyk7CgoJcmV0dXJu
IHJjOwp9CgpzdGF0aWMgc3RydWN0IGV0aHRvb2xfbGlua191c2V0dGluZ3MgKgpkb19pb2N0bF9n
bGlua3NldHRpbmdzKHN0cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7CglpbnQgZXJyOwoJc3RydWN0
IHsKCQlzdHJ1Y3QgZXRodG9vbF9saW5rX3NldHRpbmdzIHJlcTsKCQlfX3UzMiBsaW5rX21vZGVf
ZGF0YVszICogRVRIVE9PTF9MSU5LX01PREVfTUFTS19NQVhfS0VSTkVMX05VMzJdOwoJfSBlY21k
OwoJc3RydWN0IGV0aHRvb2xfbGlua191c2V0dGluZ3MgKmxpbmtfdXNldHRpbmdzOwoJdW5zaWdu
ZWQgaW50IHUzMl9vZmZzOwoKCS8qIEhhbmRzaGFrZSB3aXRoIGtlcm5lbCB0byBkZXRlcm1pbmUg
bnVtYmVyIG9mIHdvcmRzIGZvciBsaW5rCgkgKiBtb2RlIGJpdG1hcHMuIFdoZW4gcmVxdWVzdGVk
IG51bWJlciBvZiBiaXRtYXAgd29yZHMgaXMgbm90CgkgKiB0aGUgb25lIGV4cGVjdGVkIGJ5IGtl
cm5lbCwgdGhlIGxhdHRlciByZXR1cm5zIHRoZSBpbnRlZ2VyCgkgKiBvcHBvc2l0ZSBvZiB3aGF0
IGl0IGlzIGV4cGVjdGluZy4gV2UgcmVxdWVzdCBsZW5ndGggMCBiZWxvdwoJICogKGFrYS4gaW52
YWxpZCBiaXRtYXAgbGVuZ3RoKSB0byBnZXQgdGhpcyBpbmZvLgoJICovCgltZW1zZXQoJmVjbWQs
IDAsIHNpemVvZihlY21kKSk7CgllY21kLnJlcS5jbWQgPSBFVEhUT09MX0dMSU5LU0VUVElOR1M7
CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJmVjbWQpOwoJaWYgKGVyciA8IDApCgkJcmV0dXJuIE5V
TEw7CgoJLyogc2VlIGFib3ZlOiB3ZSBleHBlY3QgYSBzdHJpY3RseSBuZWdhdGl2ZSB2YWx1ZSBm
cm9tIGtlcm5lbC4KCSAqLwoJaWYgKGVjbWQucmVxLmxpbmtfbW9kZV9tYXNrc19ud29yZHMgPj0g
MAoJICAgIHx8IGVjbWQucmVxLmNtZCAhPSBFVEhUT09MX0dMSU5LU0VUVElOR1MpCgkJcmV0dXJu
IE5VTEw7CgoJLyogZ290IHRoZSByZWFsIGVjbWQucmVxLmxpbmtfbW9kZV9tYXNrc19ud29yZHMs
CgkgKiBub3cgc2VuZCB0aGUgcmVhbCByZXF1ZXN0CgkgKi8KCWVjbWQucmVxLmNtZCA9IEVUSFRP
T0xfR0xJTktTRVRUSU5HUzsKCWVjbWQucmVxLmxpbmtfbW9kZV9tYXNrc19ud29yZHMgPSAtZWNt
ZC5yZXEubGlua19tb2RlX21hc2tzX253b3JkczsKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmZWNt
ZCk7CglpZiAoZXJyIDwgMCkKCQlyZXR1cm4gTlVMTDsKCglpZiAoZWNtZC5yZXEubGlua19tb2Rl
X21hc2tzX253b3JkcyA8PSAwCgkgICAgfHwgZWNtZC5yZXEuY21kICE9IEVUSFRPT0xfR0xJTktT
RVRUSU5HUykKCQlyZXR1cm4gTlVMTDsKCgkvKiBDb252ZXJ0IHRvIHVzZXR0aW5ncyBzdHJ1Y3Qg
Ki8KCWxpbmtfdXNldHRpbmdzID0gY2FsbG9jKDEsIHNpemVvZigqbGlua191c2V0dGluZ3MpKTsK
CWlmIChsaW5rX3VzZXR0aW5ncyA9PSBOVUxMKQoJCXJldHVybiBOVUxMOwoKCW1lbWNweSgmbGlu
a191c2V0dGluZ3MtPmJhc2UsICZlY21kLnJlcSwgc2l6ZW9mKGxpbmtfdXNldHRpbmdzLT5iYXNl
KSk7CglsaW5rX3VzZXR0aW5ncy0+ZGVwcmVjYXRlZC50cmFuc2NlaXZlciA9IGVjbWQucmVxLnRy
YW5zY2VpdmVyOwoKCS8qIGNvcHkgbGluayBtb2RlIGJpdG1hcHMgKi8KCXUzMl9vZmZzID0gMDsK
CW1lbWNweShsaW5rX3VzZXR0aW5ncy0+bGlua19tb2Rlcy5zdXBwb3J0ZWQsCgkgICAgICAgJmVj
bWQubGlua19tb2RlX2RhdGFbdTMyX29mZnNdLAoJICAgICAgIDQgKiBlY21kLnJlcS5saW5rX21v
ZGVfbWFza3NfbndvcmRzKTsKCgl1MzJfb2ZmcyArPSBlY21kLnJlcS5saW5rX21vZGVfbWFza3Nf
bndvcmRzOwoJbWVtY3B5KGxpbmtfdXNldHRpbmdzLT5saW5rX21vZGVzLmFkdmVydGlzaW5nLAoJ
ICAgICAgICZlY21kLmxpbmtfbW9kZV9kYXRhW3UzMl9vZmZzXSwKCSAgICAgICA0ICogZWNtZC5y
ZXEubGlua19tb2RlX21hc2tzX253b3Jkcyk7CgoJdTMyX29mZnMgKz0gZWNtZC5yZXEubGlua19t
b2RlX21hc2tzX253b3JkczsKCW1lbWNweShsaW5rX3VzZXR0aW5ncy0+bGlua19tb2Rlcy5scF9h
ZHZlcnRpc2luZywKCSAgICAgICAmZWNtZC5saW5rX21vZGVfZGF0YVt1MzJfb2Zmc10sCgkgICAg
ICAgNCAqIGVjbWQucmVxLmxpbmtfbW9kZV9tYXNrc19ud29yZHMpOwoKCXJldHVybiBsaW5rX3Vz
ZXR0aW5nczsKfQoKc3RhdGljIGludApkb19pb2N0bF9zbGlua3NldHRpbmdzKHN0cnVjdCBjbWRf
Y29udGV4dCAqY3R4LAoJCSAgICAgICBjb25zdCBzdHJ1Y3QgZXRodG9vbF9saW5rX3VzZXR0aW5n
cyAqbGlua191c2V0dGluZ3MpCnsKCXN0cnVjdCB7CgkJc3RydWN0IGV0aHRvb2xfbGlua19zZXR0
aW5ncyByZXE7CgkJX191MzIgbGlua19tb2RlX2RhdGFbMyAqIEVUSFRPT0xfTElOS19NT0RFX01B
U0tfTUFYX0tFUk5FTF9OVTMyXTsKCX0gZWNtZDsKCXVuc2lnbmVkIGludCB1MzJfb2ZmczsKCgkv
KiByZWZ1c2UgdG8gc2VuZCBFVEhUT09MX1NMSU5LU0VUVElOR1MgaW9jdGwgaWYKCSAqIGxpbmtf
dXNldHRpbmdzIHdhcyByZXRyaWV2ZWQgd2l0aCBFVEhUT09MX0dTRVQKCSAqLwoJaWYgKGxpbmtf
dXNldHRpbmdzLT5iYXNlLmNtZCAhPSBFVEhUT09MX0dMSU5LU0VUVElOR1MpCgkJcmV0dXJuIC0x
OwoKCS8qIHJlZnVzZSB0byBzZW5kIEVUSFRPT0xfU0xJTktTRVRUSU5HUyBpb2N0bCBpZiBkZXBy
ZWNhdGVkIGZpZWxkcwoJICogd2VyZSBzZXQKCSAqLwoJaWYgKGxpbmtfdXNldHRpbmdzLT5kZXBy
ZWNhdGVkLnRyYW5zY2VpdmVyKQoJCXJldHVybiAtMTsKCglpZiAobGlua191c2V0dGluZ3MtPmJh
c2UubGlua19tb2RlX21hc2tzX253b3JkcyA8PSAwKQoJCXJldHVybiAtMTsKCgltZW1jcHkoJmVj
bWQucmVxLCAmbGlua191c2V0dGluZ3MtPmJhc2UsIHNpemVvZihlY21kLnJlcSkpOwoJZWNtZC5y
ZXEuY21kID0gRVRIVE9PTF9TTElOS1NFVFRJTkdTOwoKCS8qIGNvcHkgbGluayBtb2RlIGJpdG1h
cHMgKi8KCXUzMl9vZmZzID0gMDsKCW1lbWNweSgmZWNtZC5saW5rX21vZGVfZGF0YVt1MzJfb2Zm
c10sCgkgICAgICAgbGlua191c2V0dGluZ3MtPmxpbmtfbW9kZXMuc3VwcG9ydGVkLAoJICAgICAg
IDQgKiBlY21kLnJlcS5saW5rX21vZGVfbWFza3NfbndvcmRzKTsKCgl1MzJfb2ZmcyArPSBlY21k
LnJlcS5saW5rX21vZGVfbWFza3NfbndvcmRzOwoJbWVtY3B5KCZlY21kLmxpbmtfbW9kZV9kYXRh
W3UzMl9vZmZzXSwKCSAgICAgICBsaW5rX3VzZXR0aW5ncy0+bGlua19tb2Rlcy5hZHZlcnRpc2lu
ZywKCSAgICAgICA0ICogZWNtZC5yZXEubGlua19tb2RlX21hc2tzX253b3Jkcyk7CgoJdTMyX29m
ZnMgKz0gZWNtZC5yZXEubGlua19tb2RlX21hc2tzX253b3JkczsKCW1lbWNweSgmZWNtZC5saW5r
X21vZGVfZGF0YVt1MzJfb2Zmc10sCgkgICAgICAgbGlua191c2V0dGluZ3MtPmxpbmtfbW9kZXMu
bHBfYWR2ZXJ0aXNpbmcsCgkgICAgICAgNCAqIGVjbWQucmVxLmxpbmtfbW9kZV9tYXNrc19ud29y
ZHMpOwoKCXJldHVybiBzZW5kX2lvY3RsKGN0eCwgJmVjbWQpOwp9CgpzdGF0aWMgc3RydWN0IGV0
aHRvb2xfbGlua191c2V0dGluZ3MgKgpkb19pb2N0bF9nc2V0KHN0cnVjdCBjbWRfY29udGV4dCAq
Y3R4KQp7CglpbnQgZXJyOwoJc3RydWN0IGV0aHRvb2xfY21kIGVjbWQ7CglzdHJ1Y3QgZXRodG9v
bF9saW5rX3VzZXR0aW5ncyAqbGlua191c2V0dGluZ3M7CgoJbWVtc2V0KCZlY21kLCAwLCBzaXpl
b2YoZWNtZCkpOwoJZWNtZC5jbWQgPSBFVEhUT09MX0dTRVQ7CgllcnIgPSBzZW5kX2lvY3RsKGN0
eCwgJmVjbWQpOwoJaWYgKGVyciA8IDApCgkJcmV0dXJuIE5VTEw7CgoJbGlua191c2V0dGluZ3Mg
PSBjYWxsb2MoMSwgc2l6ZW9mKCpsaW5rX3VzZXR0aW5ncykpOwoJaWYgKGxpbmtfdXNldHRpbmdz
ID09IE5VTEwpCgkJcmV0dXJuIE5VTEw7CgoJLyogcmVtZW1iZXIgdGhhdCBFVEhUT09MX0dTRVQg
d2FzIHVzZWQgKi8KCWxpbmtfdXNldHRpbmdzLT5iYXNlLmNtZCA9IEVUSFRPT0xfR1NFVDsKCgls
aW5rX3VzZXR0aW5ncy0+YmFzZS5saW5rX21vZGVfbWFza3NfbndvcmRzID0gMTsKCWxpbmtfdXNl
dHRpbmdzLT5saW5rX21vZGVzLnN1cHBvcnRlZFswXSA9IGVjbWQuc3VwcG9ydGVkOwoJbGlua191
c2V0dGluZ3MtPmxpbmtfbW9kZXMuYWR2ZXJ0aXNpbmdbMF0gPSBlY21kLmFkdmVydGlzaW5nOwoJ
bGlua191c2V0dGluZ3MtPmxpbmtfbW9kZXMubHBfYWR2ZXJ0aXNpbmdbMF0gPSBlY21kLmxwX2Fk
dmVydGlzaW5nOwoJbGlua191c2V0dGluZ3MtPmJhc2Uuc3BlZWQgPSBldGh0b29sX2NtZF9zcGVl
ZCgmZWNtZCk7CglsaW5rX3VzZXR0aW5ncy0+YmFzZS5kdXBsZXggPSBlY21kLmR1cGxleDsKCWxp
bmtfdXNldHRpbmdzLT5iYXNlLnBvcnQgPSBlY21kLnBvcnQ7CglsaW5rX3VzZXR0aW5ncy0+YmFz
ZS5waHlfYWRkcmVzcyA9IGVjbWQucGh5X2FkZHJlc3M7CglsaW5rX3VzZXR0aW5ncy0+ZGVwcmVj
YXRlZC50cmFuc2NlaXZlciA9IGVjbWQudHJhbnNjZWl2ZXI7CglsaW5rX3VzZXR0aW5ncy0+YmFz
ZS5hdXRvbmVnID0gZWNtZC5hdXRvbmVnOwoJbGlua191c2V0dGluZ3MtPmJhc2UubWRpb19zdXBw
b3J0ID0gZWNtZC5tZGlvX3N1cHBvcnQ7CgkvKiBpZ25vcmVkIChmdWxseSBkZXByZWNhdGVkKTog
bWF4cnhwa3QsIG1heHR4cGt0ICovCglsaW5rX3VzZXR0aW5ncy0+YmFzZS5ldGhfdHBfbWRpeCA9
IGVjbWQuZXRoX3RwX21kaXg7CglsaW5rX3VzZXR0aW5ncy0+YmFzZS5ldGhfdHBfbWRpeF9jdHJs
ID0gZWNtZC5ldGhfdHBfbWRpeF9jdHJsOwoKCXJldHVybiBsaW5rX3VzZXR0aW5nczsKfQoKc3Rh
dGljIGJvb2wgZXRodG9vbF9saW5rX21vZGVfaXNfYmFja3dhcmRfY29tcGF0aWJsZShjb25zdCB1
MzIgKm1hc2spCnsKCXVuc2lnbmVkIGludCBpOwoKCWZvciAoaSA9IDE7IGkgPCBFVEhUT09MX0xJ
TktfTU9ERV9NQVNLX01BWF9LRVJORUxfTlUzMjsgKytpKQoJCWlmIChtYXNrW2ldKQoJCQlyZXR1
cm4gZmFsc2U7CgoJcmV0dXJuIHRydWU7Cn0KCnN0YXRpYyBpbnQKZG9faW9jdGxfc3NldChzdHJ1
Y3QgY21kX2NvbnRleHQgKmN0eCwKCSAgICAgIGNvbnN0IHN0cnVjdCBldGh0b29sX2xpbmtfdXNl
dHRpbmdzICpsaW5rX3VzZXR0aW5ncykKewoJc3RydWN0IGV0aHRvb2xfY21kIGVjbWQ7CgoJLyog
cmVmdXNlIHRvIHNlbmQgRVRIVE9PTF9TU0VUIGlvY3RsIGlmIGxpbmtfdXNldHRpbmdzIHdhcwoJ
ICogcmV0cmlldmVkIHdpdGggRVRIVE9PTF9HTElOS1NFVFRJTkdTCgkgKi8KCWlmIChsaW5rX3Vz
ZXR0aW5ncy0+YmFzZS5jbWQgIT0gRVRIVE9PTF9HU0VUKQoJCXJldHVybiAtMTsKCglpZiAobGlu
a191c2V0dGluZ3MtPmJhc2UubGlua19tb2RlX21hc2tzX253b3JkcyA8PSAwKQoJCXJldHVybiAt
MTsKCgkvKiByZWZ1c2UgdG8gc3NldCBpZiBhbnkgYml0ID4gMzEgaXMgc2V0ICovCglpZiAoIWV0
aHRvb2xfbGlua19tb2RlX2lzX2JhY2t3YXJkX2NvbXBhdGlibGUoCgkJICAgIGxpbmtfdXNldHRp
bmdzLT5saW5rX21vZGVzLnN1cHBvcnRlZCkpCgkJcmV0dXJuIC0xOwoJaWYgKCFldGh0b29sX2xp
bmtfbW9kZV9pc19iYWNrd2FyZF9jb21wYXRpYmxlKAoJCSAgICBsaW5rX3VzZXR0aW5ncy0+bGlu
a19tb2Rlcy5hZHZlcnRpc2luZykpCgkJcmV0dXJuIC0xOwoJaWYgKCFldGh0b29sX2xpbmtfbW9k
ZV9pc19iYWNrd2FyZF9jb21wYXRpYmxlKAoJCSAgICBsaW5rX3VzZXR0aW5ncy0+bGlua19tb2Rl
cy5scF9hZHZlcnRpc2luZykpCgkJcmV0dXJuIC0xOwoKCW1lbXNldCgmZWNtZCwgMCwgc2l6ZW9m
KGVjbWQpKTsKCWVjbWQuY21kID0gRVRIVE9PTF9TU0VUOwoKCWVjbWQuc3VwcG9ydGVkID0gbGlu
a191c2V0dGluZ3MtPmxpbmtfbW9kZXMuc3VwcG9ydGVkWzBdOwoJZWNtZC5hZHZlcnRpc2luZyA9
IGxpbmtfdXNldHRpbmdzLT5saW5rX21vZGVzLmFkdmVydGlzaW5nWzBdOwoJZWNtZC5scF9hZHZl
cnRpc2luZyA9IGxpbmtfdXNldHRpbmdzLT5saW5rX21vZGVzLmxwX2FkdmVydGlzaW5nWzBdOwoJ
ZXRodG9vbF9jbWRfc3BlZWRfc2V0KCZlY21kLCBsaW5rX3VzZXR0aW5ncy0+YmFzZS5zcGVlZCk7
CgllY21kLmR1cGxleCA9IGxpbmtfdXNldHRpbmdzLT5iYXNlLmR1cGxleDsKCWVjbWQucG9ydCA9
IGxpbmtfdXNldHRpbmdzLT5iYXNlLnBvcnQ7CgllY21kLnBoeV9hZGRyZXNzID0gbGlua191c2V0
dGluZ3MtPmJhc2UucGh5X2FkZHJlc3M7CgllY21kLnRyYW5zY2VpdmVyID0gbGlua191c2V0dGlu
Z3MtPmRlcHJlY2F0ZWQudHJhbnNjZWl2ZXI7CgllY21kLmF1dG9uZWcgPSBsaW5rX3VzZXR0aW5n
cy0+YmFzZS5hdXRvbmVnOwoJZWNtZC5tZGlvX3N1cHBvcnQgPSBsaW5rX3VzZXR0aW5ncy0+YmFz
ZS5tZGlvX3N1cHBvcnQ7CgkvKiBpZ25vcmVkIChmdWxseSBkZXByZWNhdGVkKTogbWF4cnhwa3Qs
IG1heHR4cGt0ICovCgllY21kLmV0aF90cF9tZGl4ID0gbGlua191c2V0dGluZ3MtPmJhc2UuZXRo
X3RwX21kaXg7CgllY21kLmV0aF90cF9tZGl4X2N0cmwgPSBsaW5rX3VzZXR0aW5ncy0+YmFzZS5l
dGhfdHBfbWRpeF9jdHJsOwoJcmV0dXJuIHNlbmRfaW9jdGwoY3R4LCAmZWNtZCk7Cn0KCnN0YXRp
YyBpbnQgZG9fZ3NldChzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJaW50IGVycjsKCXN0cnVj
dCBldGh0b29sX2xpbmtfdXNldHRpbmdzICpsaW5rX3VzZXR0aW5nczsKCXN0cnVjdCBldGh0b29s
X3dvbGluZm8gd29saW5mbzsKCXN0cnVjdCBldGh0b29sX3ZhbHVlIGVkYXRhOwoJaW50IGFsbGZh
aWwgPSAxOwoKCWlmIChjdHgtPmFyZ2MgIT0gMCkKCQlleGl0X2JhZF9hcmdzKCk7CgoJZnByaW50
ZihzdGRvdXQsICJTZXR0aW5ncyBmb3IgJXM6XG4iLCBjdHgtPmRldm5hbWUpOwoKCWxpbmtfdXNl
dHRpbmdzID0gZG9faW9jdGxfZ2xpbmtzZXR0aW5ncyhjdHgpOwoJaWYgKGxpbmtfdXNldHRpbmdz
ID09IE5VTEwpCgkJbGlua191c2V0dGluZ3MgPSBkb19pb2N0bF9nc2V0KGN0eCk7CglpZiAobGlu
a191c2V0dGluZ3MgIT0gTlVMTCkgewoJCWVyciA9IGR1bXBfbGlua191c2V0dGluZ3MobGlua191
c2V0dGluZ3MpOwoJCWZyZWUobGlua191c2V0dGluZ3MpOwoJCWlmIChlcnIpCgkJCXJldHVybiBl
cnI7CgkJYWxsZmFpbCA9IDA7Cgl9IGVsc2UgaWYgKGVycm5vICE9IEVPUE5PVFNVUFApIHsKCQlw
ZXJyb3IoIkNhbm5vdCBnZXQgZGV2aWNlIHNldHRpbmdzIik7Cgl9CgoJd29saW5mby5jbWQgPSBF
VEhUT09MX0dXT0w7CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJndvbGluZm8pOwoJaWYgKGVyciA9
PSAwKSB7CgkJZXJyID0gZHVtcF93b2woJndvbGluZm8pOwoJCWlmIChlcnIpCgkJCXJldHVybiBl
cnI7CgkJYWxsZmFpbCA9IDA7Cgl9IGVsc2UgaWYgKGVycm5vICE9IEVPUE5PVFNVUFApIHsKCQlw
ZXJyb3IoIkNhbm5vdCBnZXQgd2FrZS1vbi1sYW4gc2V0dGluZ3MiKTsKCX0KCgllZGF0YS5jbWQg
PSBFVEhUT09MX0dNU0dMVkw7CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJmVkYXRhKTsKCWlmIChl
cnIgPT0gMCkgewoJCWZwcmludGYoc3Rkb3V0LCAiCUN1cnJlbnQgbWVzc2FnZSBsZXZlbDogMHgl
MDh4ICglZClcbiIKCQkJIgkJCSAgICAgICAiLAoJCQllZGF0YS5kYXRhLCBlZGF0YS5kYXRhKTsK
CQlwcmludF9mbGFncyhmbGFnc19tc2dsdmwsIG5fZmxhZ3NfbXNnbHZsLCBlZGF0YS5kYXRhKTsK
CQlmcHJpbnRmKHN0ZG91dCwgIlxuIik7CgkJYWxsZmFpbCA9IDA7Cgl9IGVsc2UgaWYgKGVycm5v
ICE9IEVPUE5PVFNVUFApIHsKCQlwZXJyb3IoIkNhbm5vdCBnZXQgbWVzc2FnZSBsZXZlbCIpOwoJ
fQoKCWVkYXRhLmNtZCA9IEVUSFRPT0xfR0xJTks7CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJmVk
YXRhKTsKCWlmIChlcnIgPT0gMCkgewoJCWZwcmludGYoc3Rkb3V0LCAiCUxpbmsgZGV0ZWN0ZWQ6
ICVzXG4iLAoJCQllZGF0YS5kYXRhID8gInllcyI6Im5vIik7CgkJYWxsZmFpbCA9IDA7Cgl9IGVs
c2UgaWYgKGVycm5vICE9IEVPUE5PVFNVUFApIHsKCQlwZXJyb3IoIkNhbm5vdCBnZXQgbGluayBz
dGF0dXMiKTsKCX0KCglpZiAoYWxsZmFpbCkgewoJCWZwcmludGYoc3Rkb3V0LCAiTm8gZGF0YSBh
dmFpbGFibGVcbiIpOwoJCXJldHVybiA3NTsKCX0KCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRv
X3NzZXQoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgpCnsKCWludCBzcGVlZF93YW50ZWQgPSAtMTsK
CWludCBkdXBsZXhfd2FudGVkID0gLTE7CglpbnQgcG9ydF93YW50ZWQgPSAtMTsKCWludCBtZGl4
X3dhbnRlZCA9IC0xOwoJaW50IGF1dG9uZWdfd2FudGVkID0gLTE7CglpbnQgcGh5YWRfd2FudGVk
ID0gLTE7CglpbnQgeGN2cl93YW50ZWQgPSAtMTsKCXUzMiAqZnVsbF9hZHZlcnRpc2luZ193YW50
ZWQgPSBOVUxMOwoJdTMyICphZHZlcnRpc2luZ193YW50ZWQgPSBOVUxMOwoJRVRIVE9PTF9ERUNM
QVJFX0xJTktfTU9ERV9NQVNLKG1hc2tfZnVsbF9hZHZlcnRpc2luZ193YW50ZWQpOwoJRVRIVE9P
TF9ERUNMQVJFX0xJTktfTU9ERV9NQVNLKG1hc2tfYWR2ZXJ0aXNpbmdfd2FudGVkKTsKCWludCBn
c2V0X2NoYW5nZWQgPSAwOyAvKiBkaWQgYW55dGhpbmcgaW4gR1NFVCBjaGFuZ2U/ICovCgl1MzIg
d29sX3dhbnRlZCA9IDA7CglpbnQgd29sX2NoYW5nZSA9IDA7Cgl1OCBzb3Bhc3Nfd2FudGVkW1NP
UEFTU19NQVhdOwoJaW50IHNvcGFzc19jaGFuZ2UgPSAwOwoJaW50IGd3b2xfY2hhbmdlZCA9IDA7
IC8qIGRpZCBhbnl0aGluZyBpbiBHV09MIGNoYW5nZT8gKi8KCWludCBtc2dsdmxfY2hhbmdlZCA9
IDA7Cgl1MzIgbXNnbHZsX3dhbnRlZCA9IDA7Cgl1MzIgbXNnbHZsX21hc2sgPSAwOwoJc3RydWN0
IGNtZGxpbmVfaW5mbyBjbWRsaW5lX21zZ2x2bFtuX2ZsYWdzX21zZ2x2bF07Cgl1bnNpZ25lZCBp
bnQgYXJnYyA9IGN0eC0+YXJnYzsKCWNoYXIgKiphcmdwID0gY3R4LT5hcmdwOwoJdW5zaWduZWQg
aW50IGk7CglpbnQgZXJyID0gMDsKCglmb3IgKGkgPSAwOyBpIDwgbl9mbGFnc19tc2dsdmw7IGkr
KykKCQlmbGFnX3RvX2NtZGxpbmVfaW5mbyhmbGFnc19tc2dsdmxbaV0ubmFtZSwKCQkJCSAgICAg
ZmxhZ3NfbXNnbHZsW2ldLnZhbHVlLAoJCQkJICAgICAmbXNnbHZsX3dhbnRlZCwgJm1zZ2x2bF9t
YXNrLAoJCQkJICAgICAmY21kbGluZV9tc2dsdmxbaV0pOwoKCWZvciAoaSA9IDA7IGkgPCBhcmdj
OyBpKyspIHsKCQlpZiAoIXN0cmNtcChhcmdwW2ldLCAic3BlZWQiKSkgewoJCQlnc2V0X2NoYW5n
ZWQgPSAxOwoJCQlpICs9IDE7CgkJCWlmIChpID49IGFyZ2MpCgkJCQlleGl0X2JhZF9hcmdzKCk7
CgkJCXNwZWVkX3dhbnRlZCA9IGdldF9pbnQoYXJncFtpXSwgMTApOwoJCX0gZWxzZSBpZiAoIXN0
cmNtcChhcmdwW2ldLCAiZHVwbGV4IikpIHsKCQkJZ3NldF9jaGFuZ2VkID0gMTsKCQkJaSArPSAx
OwoJCQlpZiAoaSA+PSBhcmdjKQoJCQkJZXhpdF9iYWRfYXJncygpOwoJCQlpZiAoIXN0cmNtcChh
cmdwW2ldLCAiaGFsZiIpKQoJCQkJZHVwbGV4X3dhbnRlZCA9IERVUExFWF9IQUxGOwoJCQllbHNl
IGlmICghc3RyY21wKGFyZ3BbaV0sICJmdWxsIikpCgkJCQlkdXBsZXhfd2FudGVkID0gRFVQTEVY
X0ZVTEw7CgkJCWVsc2UKCQkJCWV4aXRfYmFkX2FyZ3MoKTsKCQl9IGVsc2UgaWYgKCFzdHJjbXAo
YXJncFtpXSwgInBvcnQiKSkgewoJCQlnc2V0X2NoYW5nZWQgPSAxOwoJCQlpICs9IDE7CgkJCWlm
IChpID49IGFyZ2MpCgkJCQlleGl0X2JhZF9hcmdzKCk7CgkJCWlmICghc3RyY21wKGFyZ3BbaV0s
ICJ0cCIpKQoJCQkJcG9ydF93YW50ZWQgPSBQT1JUX1RQOwoJCQllbHNlIGlmICghc3RyY21wKGFy
Z3BbaV0sICJhdWkiKSkKCQkJCXBvcnRfd2FudGVkID0gUE9SVF9BVUk7CgkJCWVsc2UgaWYgKCFz
dHJjbXAoYXJncFtpXSwgImJuYyIpKQoJCQkJcG9ydF93YW50ZWQgPSBQT1JUX0JOQzsKCQkJZWxz
ZSBpZiAoIXN0cmNtcChhcmdwW2ldLCAibWlpIikpCgkJCQlwb3J0X3dhbnRlZCA9IFBPUlRfTUlJ
OwoJCQllbHNlIGlmICghc3RyY21wKGFyZ3BbaV0sICJmaWJyZSIpKQoJCQkJcG9ydF93YW50ZWQg
PSBQT1JUX0ZJQlJFOwoJCQllbHNlCgkJCQlleGl0X2JhZF9hcmdzKCk7CgkJfSBlbHNlIGlmICgh
c3RyY21wKGFyZ3BbaV0sICJtZGl4IikpIHsKCQkJZ3NldF9jaGFuZ2VkID0gMTsKCQkJaSArPSAx
OwoJCQlpZiAoaSA+PSBhcmdjKQoJCQkJZXhpdF9iYWRfYXJncygpOwoJCQlpZiAoIXN0cmNtcChh
cmdwW2ldLCAiYXV0byIpKQoJCQkJbWRpeF93YW50ZWQgPSBFVEhfVFBfTURJX0FVVE87CgkJCWVs
c2UgaWYgKCFzdHJjbXAoYXJncFtpXSwgIm9uIikpCgkJCQltZGl4X3dhbnRlZCA9IEVUSF9UUF9N
RElfWDsKCQkJZWxzZSBpZiAoIXN0cmNtcChhcmdwW2ldLCAib2ZmIikpCgkJCQltZGl4X3dhbnRl
ZCA9IEVUSF9UUF9NREk7CgkJCWVsc2UKCQkJCWV4aXRfYmFkX2FyZ3MoKTsKCQl9IGVsc2UgaWYg
KCFzdHJjbXAoYXJncFtpXSwgImF1dG9uZWciKSkgewoJCQlpICs9IDE7CgkJCWlmIChpID49IGFy
Z2MpCgkJCQlleGl0X2JhZF9hcmdzKCk7CgkJCWlmICghc3RyY21wKGFyZ3BbaV0sICJvbiIpKSB7
CgkJCQlnc2V0X2NoYW5nZWQgPSAxOwoJCQkJYXV0b25lZ193YW50ZWQgPSBBVVRPTkVHX0VOQUJM
RTsKCQkJfSBlbHNlIGlmICghc3RyY21wKGFyZ3BbaV0sICJvZmYiKSkgewoJCQkJZ3NldF9jaGFu
Z2VkID0gMTsKCQkJCWF1dG9uZWdfd2FudGVkID0gQVVUT05FR19ESVNBQkxFOwoJCQl9IGVsc2Ug
ewoJCQkJZXhpdF9iYWRfYXJncygpOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY21wKGFyZ3BbaV0s
ICJhZHZlcnRpc2UiKSkgewoJCQlnc2V0X2NoYW5nZWQgPSAxOwoJCQlpICs9IDE7CgkJCWlmIChp
ID49IGFyZ2MpCgkJCQlleGl0X2JhZF9hcmdzKCk7CgkJCWlmIChwYXJzZV9oZXhfdTMyX2JpdG1h
cCgKCQkJCSAgICBhcmdwW2ldLAoJCQkJICAgIEVUSFRPT0xfTElOS19NT0RFX01BU0tfTUFYX0tF
Uk5FTF9OQklUUywKCQkJCSAgICBtYXNrX2Z1bGxfYWR2ZXJ0aXNpbmdfd2FudGVkKSkKCQkJCWV4
aXRfYmFkX2FyZ3MoKTsKCQkJZnVsbF9hZHZlcnRpc2luZ193YW50ZWQgPSBtYXNrX2Z1bGxfYWR2
ZXJ0aXNpbmdfd2FudGVkOwoJCX0gZWxzZSBpZiAoIXN0cmNtcChhcmdwW2ldLCAicGh5YWQiKSkg
ewoJCQlnc2V0X2NoYW5nZWQgPSAxOwoJCQlpICs9IDE7CgkJCWlmIChpID49IGFyZ2MpCgkJCQll
eGl0X2JhZF9hcmdzKCk7CgkJCXBoeWFkX3dhbnRlZCA9IGdldF9pbnQoYXJncFtpXSwgMCk7CgkJ
fSBlbHNlIGlmICghc3RyY21wKGFyZ3BbaV0sICJ4Y3ZyIikpIHsKCQkJZ3NldF9jaGFuZ2VkID0g
MTsKCQkJaSArPSAxOwoJCQlpZiAoaSA+PSBhcmdjKQoJCQkJZXhpdF9iYWRfYXJncygpOwoJCQlp
ZiAoIXN0cmNtcChhcmdwW2ldLCAiaW50ZXJuYWwiKSkKCQkJCXhjdnJfd2FudGVkID0gWENWUl9J
TlRFUk5BTDsKCQkJZWxzZSBpZiAoIXN0cmNtcChhcmdwW2ldLCAiZXh0ZXJuYWwiKSkKCQkJCXhj
dnJfd2FudGVkID0gWENWUl9FWFRFUk5BTDsKCQkJZWxzZQoJCQkJZXhpdF9iYWRfYXJncygpOwoJ
CX0gZWxzZSBpZiAoIXN0cmNtcChhcmdwW2ldLCAid29sIikpIHsKCQkJZ3dvbF9jaGFuZ2VkID0g
MTsKCQkJaSsrOwoJCQlpZiAoaSA+PSBhcmdjKQoJCQkJZXhpdF9iYWRfYXJncygpOwoJCQlpZiAo
cGFyc2Vfd29sb3B0cyhhcmdwW2ldLCAmd29sX3dhbnRlZCkgPCAwKQoJCQkJZXhpdF9iYWRfYXJn
cygpOwoJCQl3b2xfY2hhbmdlID0gMTsKCQl9IGVsc2UgaWYgKCFzdHJjbXAoYXJncFtpXSwgInNv
cGFzcyIpKSB7CgkJCWd3b2xfY2hhbmdlZCA9IDE7CgkJCWkrKzsKCQkJaWYgKGkgPj0gYXJnYykK
CQkJCWV4aXRfYmFkX2FyZ3MoKTsKCQkJZ2V0X21hY19hZGRyKGFyZ3BbaV0sIHNvcGFzc193YW50
ZWQpOwoJCQlzb3Bhc3NfY2hhbmdlID0gMTsKCQl9IGVsc2UgaWYgKCFzdHJjbXAoYXJncFtpXSwg
Im1zZ2x2bCIpKSB7CgkJCWkrKzsKCQkJaWYgKGkgPj0gYXJnYykKCQkJCWV4aXRfYmFkX2FyZ3Mo
KTsKCQkJaWYgKGlzZGlnaXQoKHVuc2lnbmVkIGNoYXIpYXJncFtpXVswXSkpIHsKCQkJCW1zZ2x2
bF9jaGFuZ2VkID0gMTsKCQkJCW1zZ2x2bF9tYXNrID0gfjA7CgkJCQltc2dsdmxfd2FudGVkID0K
CQkJCQlnZXRfdWludF9yYW5nZShhcmdwW2ldLCAwLAoJCQkJCQkgICAgICAgMHhmZmZmZmZmZik7
CgkJCX0gZWxzZSB7CgkJCQljdHgtPmFyZ2MgLT0gaTsKCQkJCWN0eC0+YXJncCArPSBpOwoJCQkJ
cGFyc2VfZ2VuZXJpY19jbWRsaW5lKAoJCQkJCWN0eCwgJm1zZ2x2bF9jaGFuZ2VkLAoJCQkJCWNt
ZGxpbmVfbXNnbHZsLAoJCQkJCUFSUkFZX1NJWkUoY21kbGluZV9tc2dsdmwpKTsKCQkJCWJyZWFr
OwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY21wKGFyZ3BbaV0sICJtYXN0ZXItc2xhdmUiKSkgewoJ
CQlleGl0X25sb25seV9wYXJhbShhcmdwW2ldKTsKCQl9IGVsc2UgewoJCQlleGl0X2JhZF9hcmdz
KCk7CgkJfQoJfQoKCWlmIChmdWxsX2FkdmVydGlzaW5nX3dhbnRlZCA9PSBOVUxMKSB7CgkJLyog
VXNlciBkaWRuJ3Qgc3VwcGx5IGEgZnVsbCBhZHZlcnRpc2VtZW50IGJpdGZpZWxkOgoJCSAqIGNv
bnN0cnVjdCBvbmUgZnJvbSB0aGUgc3BlY2lmaWVkIHNwZWVkIGFuZCBkdXBsZXguCgkJICovCgkJ
aW50IGFkdl9iaXQgPSAtMTsKCgkJaWYgKHNwZWVkX3dhbnRlZCA9PSBTUEVFRF8xMCAmJiBkdXBs
ZXhfd2FudGVkID09IERVUExFWF9IQUxGKQoJCQlhZHZfYml0ID0gRVRIVE9PTF9MSU5LX01PREVf
MTBiYXNlVF9IYWxmX0JJVDsKCQllbHNlIGlmIChzcGVlZF93YW50ZWQgPT0gU1BFRURfMTAgJiYK
CQkJIGR1cGxleF93YW50ZWQgPT0gRFVQTEVYX0ZVTEwpCgkJCWFkdl9iaXQgPSBFVEhUT09MX0xJ
TktfTU9ERV8xMGJhc2VUX0Z1bGxfQklUOwoJCWVsc2UgaWYgKHNwZWVkX3dhbnRlZCA9PSBTUEVF
RF8xMDAgJiYKCQkJIGR1cGxleF93YW50ZWQgPT0gRFVQTEVYX0hBTEYpCgkJCWFkdl9iaXQgPSBF
VEhUT09MX0xJTktfTU9ERV8xMDBiYXNlVF9IYWxmX0JJVDsKCQllbHNlIGlmIChzcGVlZF93YW50
ZWQgPT0gU1BFRURfMTAwICYmCgkJCSBkdXBsZXhfd2FudGVkID09IERVUExFWF9GVUxMKQoJCQlh
ZHZfYml0ID0gRVRIVE9PTF9MSU5LX01PREVfMTAwYmFzZVRfRnVsbF9CSVQ7CgkJZWxzZSBpZiAo
c3BlZWRfd2FudGVkID09IFNQRUVEXzEwMDAgJiYKCQkJIGR1cGxleF93YW50ZWQgPT0gRFVQTEVY
X0hBTEYpCgkJCWFkdl9iaXQgPSBFVEhUT09MX0xJTktfTU9ERV8xMDAwYmFzZVRfSGFsZl9CSVQ7
CgkJZWxzZSBpZiAoc3BlZWRfd2FudGVkID09IFNQRUVEXzEwMDAgJiYKCQkJIGR1cGxleF93YW50
ZWQgPT0gRFVQTEVYX0ZVTEwpCgkJCWFkdl9iaXQgPSBFVEhUT09MX0xJTktfTU9ERV8xMDAwYmFz
ZVRfRnVsbF9CSVQ7CgkJZWxzZSBpZiAoc3BlZWRfd2FudGVkID09IFNQRUVEXzI1MDAgJiYKCQkJ
IGR1cGxleF93YW50ZWQgPT0gRFVQTEVYX0ZVTEwpCgkJCWFkdl9iaXQgPSBFVEhUT09MX0xJTktf
TU9ERV8yNTAwYmFzZVhfRnVsbF9CSVQ7CgkJZWxzZSBpZiAoc3BlZWRfd2FudGVkID09IFNQRUVE
XzEwMDAwICYmCgkJCSBkdXBsZXhfd2FudGVkID09IERVUExFWF9GVUxMKQoJCQlhZHZfYml0ID0g
RVRIVE9PTF9MSU5LX01PREVfMTAwMDBiYXNlVF9GdWxsX0JJVDsKCgkJaWYgKGFkdl9iaXQgPj0g
MCkgewoJCQlhZHZlcnRpc2luZ193YW50ZWQgPSBtYXNrX2FkdmVydGlzaW5nX3dhbnRlZDsKCQkJ
ZXRodG9vbF9saW5rX21vZGVfemVybyhhZHZlcnRpc2luZ193YW50ZWQpOwoJCQlldGh0b29sX2xp
bmtfbW9kZV9zZXRfYml0KAoJCQkJYWR2X2JpdCwgYWR2ZXJ0aXNpbmdfd2FudGVkKTsKCQl9CgkJ
Lyogb3RoZXJ3aXNlOiBhdXRvIG5lZ290aWF0ZSB3aXRob3V0IGZvcmNpbmcsCgkJICogYWxsIHN1
cHBvcnRlZCBzcGVlZCB3aWxsIGJlIGFzc2lnbmVkIGJlbG93CgkJICovCgl9CgoJaWYgKGdzZXRf
Y2hhbmdlZCkgewoJCXN0cnVjdCBldGh0b29sX2xpbmtfdXNldHRpbmdzICpsaW5rX3VzZXR0aW5n
czsKCgkJbGlua191c2V0dGluZ3MgPSBkb19pb2N0bF9nbGlua3NldHRpbmdzKGN0eCk7CgkJaWYg
KGxpbmtfdXNldHRpbmdzID09IE5VTEwpCgkJCWxpbmtfdXNldHRpbmdzID0gZG9faW9jdGxfZ3Nl
dChjdHgpOwoJCWVsc2UKCQkJbWVtc2V0KCZsaW5rX3VzZXR0aW5ncy0+ZGVwcmVjYXRlZCwgMCwK
CQkJICAgICAgIHNpemVvZihsaW5rX3VzZXR0aW5ncy0+ZGVwcmVjYXRlZCkpOwoJCWlmIChsaW5r
X3VzZXR0aW5ncyA9PSBOVUxMKSB7CgkJCXBlcnJvcigiQ2Fubm90IGdldCBjdXJyZW50IGRldmlj
ZSBzZXR0aW5ncyIpOwoJCQllcnIgPSAtMTsKCQl9IGVsc2UgewoJCQkvKiBDaGFuZ2UgZXZlcnl0
aGluZyB0aGUgdXNlciBzcGVjaWZpZWQuICovCgkJCWlmIChzcGVlZF93YW50ZWQgIT0gLTEpCgkJ
CQlsaW5rX3VzZXR0aW5ncy0+YmFzZS5zcGVlZCA9IHNwZWVkX3dhbnRlZDsKCQkJaWYgKGR1cGxl
eF93YW50ZWQgIT0gLTEpCgkJCQlsaW5rX3VzZXR0aW5ncy0+YmFzZS5kdXBsZXggPSBkdXBsZXhf
d2FudGVkOwoJCQlpZiAocG9ydF93YW50ZWQgIT0gLTEpCgkJCQlsaW5rX3VzZXR0aW5ncy0+YmFz
ZS5wb3J0ID0gcG9ydF93YW50ZWQ7CgkJCWlmIChtZGl4X3dhbnRlZCAhPSAtMSkgewoJCQkJLyog
Y2hlY2sgZHJpdmVyIHN1cHBvcnRzIE1ESS1YICovCgkJCQlpZiAobGlua191c2V0dGluZ3MtPmJh
c2UuZXRoX3RwX21kaXhfY3RybAoJCQkJICAgICE9IEVUSF9UUF9NRElfSU5WQUxJRCkKCQkJCQls
aW5rX3VzZXR0aW5ncy0+YmFzZS5ldGhfdHBfbWRpeF9jdHJsCgkJCQkJCT0gbWRpeF93YW50ZWQ7
CgkJCQllbHNlCgkJCQkJZnByaW50ZihzdGRlcnIsCgkJCQkJCSJzZXR0aW5nIE1ESSBub3Qgc3Vw
cG9ydGVkXG4iKTsKCQkJfQoJCQlpZiAoYXV0b25lZ193YW50ZWQgIT0gLTEpCgkJCQlsaW5rX3Vz
ZXR0aW5ncy0+YmFzZS5hdXRvbmVnID0gYXV0b25lZ193YW50ZWQ7CgkJCWlmIChwaHlhZF93YW50
ZWQgIT0gLTEpCgkJCQlsaW5rX3VzZXR0aW5ncy0+YmFzZS5waHlfYWRkcmVzcyA9IHBoeWFkX3dh
bnRlZDsKCQkJaWYgKHhjdnJfd2FudGVkICE9IC0xKQoJCQkJbGlua191c2V0dGluZ3MtPmRlcHJl
Y2F0ZWQudHJhbnNjZWl2ZXIKCQkJCQk9IHhjdnJfd2FudGVkOwoJCQkvKiBYWFggSWYgdGhlIHVz
ZXIgc3BlY2lmaWVkIHNwZWVkIG9yIGR1cGxleAoJCQkgKiB0aGVuIHdlIHNob3VsZCBtYXNrIHRo
ZSBhZHZlcnRpc2VkIG1vZGVzCgkJCSAqIGFjY29yZGluZ2x5LiAgRm9yIG5vdywgd2FybiB0aGF0
IHdlIGFyZW4ndAoJCQkgKiBkb2luZyB0aGF0LgoJCQkgKi8KCQkJaWYgKChzcGVlZF93YW50ZWQg
IT0gLTEgfHwgZHVwbGV4X3dhbnRlZCAhPSAtMSkgJiYKCQkJICAgIGxpbmtfdXNldHRpbmdzLT5i
YXNlLmF1dG9uZWcgJiYKCQkJICAgIGFkdmVydGlzaW5nX3dhbnRlZCA9PSBOVUxMKSB7CgkJCQlm
cHJpbnRmKHN0ZGVyciwgIkNhbm5vdCBhZHZlcnRpc2UiKTsKCQkJCWlmIChzcGVlZF93YW50ZWQg
Pj0gMCkKCQkJCQlmcHJpbnRmKHN0ZGVyciwgIiBzcGVlZCAlZCIsCgkJCQkJCXNwZWVkX3dhbnRl
ZCk7CgkJCQlpZiAoZHVwbGV4X3dhbnRlZCA+PSAwKQoJCQkJCWZwcmludGYoc3RkZXJyLCAiIGR1
cGxleCAlcyIsCgkJCQkJCWR1cGxleF93YW50ZWQgPwoJCQkJCQkiZnVsbCIgOiAiaGFsZiIpOwoJ
CQkJZnByaW50ZihzdGRlcnIsCSJcbiIpOwoJCQl9CgkJCWlmIChhdXRvbmVnX3dhbnRlZCA9PSBB
VVRPTkVHX0VOQUJMRSAmJgoJCQkgICAgYWR2ZXJ0aXNpbmdfd2FudGVkID09IE5VTEwgJiYKCQkJ
ICAgIGZ1bGxfYWR2ZXJ0aXNpbmdfd2FudGVkID09IE5VTEwpIHsKCQkJCXVuc2lnbmVkIGludCBp
OwoKCQkJCS8qIEF1dG8gbmVnb3RpYXRpb24gZW5hYmxlZCwgYnV0IHdpdGgKCQkJCSAqIHVuc3Bl
Y2lmaWVkIHNwZWVkIGFuZCBkdXBsZXg6IGVuYWJsZSBhbGwKCQkJCSAqIHN1cHBvcnRlZCBzcGVl
ZHMgYW5kIGR1cGxleGVzLgoJCQkJICovCgkJCQlldGh0b29sX2xpbmtfbW9kZV9mb3JfZWFjaF91
MzIoaSkgewoJCQkJCXUzMiBzdXAgPSBsaW5rX3VzZXR0aW5ncy0+bGlua19tb2Rlcy5zdXBwb3J0
ZWRbaV07CgkJCQkJdTMyICphZHYgPSBsaW5rX3VzZXR0aW5ncy0+bGlua19tb2Rlcy5hZHZlcnRp
c2luZyArIGk7CgoJCQkJCSphZHYgPSAoKCphZHYgJiB+YWxsX2FkdmVydGlzZWRfbW9kZXNbaV0p
CgkJCQkJCXwgKHN1cCAmIGFsbF9hZHZlcnRpc2VkX21vZGVzW2ldKSk7CgkJCQl9CgoJCQkJLyog
SWYgZHJpdmVyIHN1cHBvcnRzIHVua25vd24gZmxhZ3MsIHdlIGNhbm5vdAoJCQkJICogYmUgc3Vy
ZSB0aGF0IHdlIGVuYWJsZSBhbGwgbGluayBtb2Rlcy4KCQkJCSAqLwoJCQkJZXRodG9vbF9saW5r
X21vZGVfZm9yX2VhY2hfdTMyKGkpIHsKCQkJCQl1MzIgc3VwID0gbGlua191c2V0dGluZ3MtPmxp
bmtfbW9kZXMuc3VwcG9ydGVkW2ldOwoKCQkJCQlpZiAoKHN1cCAmIGFsbF9hZHZlcnRpc2VkX2Zs
YWdzW2ldKSAhPSBzdXApIHsKCQkJCQkJZnByaW50ZihzdGRlcnIsICJEcml2ZXIgc3VwcG9ydHMg
b25lIG9yIG1vcmUgdW5rbm93biBmbGFnc1xuIik7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0K
CQkJfSBlbHNlIGlmIChhZHZlcnRpc2luZ193YW50ZWQgIT0gTlVMTCkgewoJCQkJdW5zaWduZWQg
aW50IGk7CgoJCQkJLyogRW5hYmxlIGFsbCByZXF1ZXN0ZWQgbW9kZXMgKi8KCQkJCWV0aHRvb2xf
bGlua19tb2RlX2Zvcl9lYWNoX3UzMihpKSB7CgkJCQkJdTMyICphZHYgPSBsaW5rX3VzZXR0aW5n
cy0+bGlua19tb2Rlcy5hZHZlcnRpc2luZyArIGk7CgoJCQkJCSphZHYgPSAoKCphZHYgJiB+YWxs
X2FkdmVydGlzZWRfbW9kZXNbaV0pCgkJCQkJCXwgYWR2ZXJ0aXNpbmdfd2FudGVkW2ldKTsKCQkJ
CX0KCQkJfSBlbHNlIGlmIChmdWxsX2FkdmVydGlzaW5nX3dhbnRlZCAhPSBOVUxMKSB7CgkJCQll
dGh0b29sX2xpbmtfbW9kZV9jb3B5KAoJCQkJCWxpbmtfdXNldHRpbmdzLT5saW5rX21vZGVzLmFk
dmVydGlzaW5nLAoJCQkJCWZ1bGxfYWR2ZXJ0aXNpbmdfd2FudGVkKTsKCQkJfQoKCQkJLyogVHJ5
IHRvIHBlcmZvcm0gdGhlIHVwZGF0ZS4gKi8KCQkJaWYgKGxpbmtfdXNldHRpbmdzLT5iYXNlLmNt
ZCA9PSBFVEhUT09MX0dMSU5LU0VUVElOR1MpCgkJCQllcnIgPSBkb19pb2N0bF9zbGlua3NldHRp
bmdzKGN0eCwKCQkJCQkJCSAgICAgbGlua191c2V0dGluZ3MpOwoJCQllbHNlCgkJCQllcnIgPSBk
b19pb2N0bF9zc2V0KGN0eCwgbGlua191c2V0dGluZ3MpOwoJCQlmcmVlKGxpbmtfdXNldHRpbmdz
KTsKCQkJaWYgKGVyciA8IDApCgkJCQlwZXJyb3IoIkNhbm5vdCBzZXQgbmV3IHNldHRpbmdzIik7
CgkJfQoJCWlmIChlcnIgPCAwKSB7CgkJCWlmIChzcGVlZF93YW50ZWQgIT0gLTEpCgkJCQlmcHJp
bnRmKHN0ZGVyciwgIiAgbm90IHNldHRpbmcgc3BlZWRcbiIpOwoJCQlpZiAoZHVwbGV4X3dhbnRl
ZCAhPSAtMSkKCQkJCWZwcmludGYoc3RkZXJyLCAiICBub3Qgc2V0dGluZyBkdXBsZXhcbiIpOwoJ
CQlpZiAocG9ydF93YW50ZWQgIT0gLTEpCgkJCQlmcHJpbnRmKHN0ZGVyciwgIiAgbm90IHNldHRp
bmcgcG9ydFxuIik7CgkJCWlmIChhdXRvbmVnX3dhbnRlZCAhPSAtMSkKCQkJCWZwcmludGYoc3Rk
ZXJyLCAiICBub3Qgc2V0dGluZyBhdXRvbmVnXG4iKTsKCQkJaWYgKHBoeWFkX3dhbnRlZCAhPSAt
MSkKCQkJCWZwcmludGYoc3RkZXJyLCAiICBub3Qgc2V0dGluZyBwaHlfYWRkcmVzc1xuIik7CgkJ
CWlmICh4Y3ZyX3dhbnRlZCAhPSAtMSkKCQkJCWZwcmludGYoc3RkZXJyLCAiICBub3Qgc2V0dGlu
ZyB0cmFuc2NlaXZlclxuIik7CgkJCWlmIChtZGl4X3dhbnRlZCAhPSAtMSkKCQkJCWZwcmludGYo
c3RkZXJyLCAiICBub3Qgc2V0dGluZyBtZGl4XG4iKTsKCQl9Cgl9CgoJaWYgKGd3b2xfY2hhbmdl
ZCkgewoJCXN0cnVjdCBldGh0b29sX3dvbGluZm8gd29sOwoKCQl3b2wuY21kID0gRVRIVE9PTF9H
V09MOwoJCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmd29sKTsKCQlpZiAoZXJyIDwgMCkgewoJCQlw
ZXJyb3IoIkNhbm5vdCBnZXQgY3VycmVudCB3YWtlLW9uLWxhbiBzZXR0aW5ncyIpOwoJCX0gZWxz
ZSB7CgkJCS8qIENoYW5nZSBldmVyeXRoaW5nIHRoZSB1c2VyIHNwZWNpZmllZC4gKi8KCQkJaWYg
KHdvbF9jaGFuZ2UpCgkJCQl3b2wud29sb3B0cyA9IHdvbF93YW50ZWQ7CgkJCWlmIChzb3Bhc3Nf
Y2hhbmdlKSB7CgkJCQlpbnQgaTsKCQkJCWZvciAoaSA9IDA7IGkgPCBTT1BBU1NfTUFYOyBpKysp
CgkJCQkJd29sLnNvcGFzc1tpXSA9IHNvcGFzc193YW50ZWRbaV07CgkJCX0KCgkJCS8qIFRyeSB0
byBwZXJmb3JtIHRoZSB1cGRhdGUuICovCgkJCXdvbC5jbWQgPSBFVEhUT09MX1NXT0w7CgkJCWVy
ciA9IHNlbmRfaW9jdGwoY3R4LCAmd29sKTsKCQkJaWYgKGVyciA8IDApCgkJCQlwZXJyb3IoIkNh
bm5vdCBzZXQgbmV3IHdha2Utb24tbGFuIHNldHRpbmdzIik7CgkJfQoJCWlmIChlcnIgPCAwKSB7
CgkJCWlmICh3b2xfY2hhbmdlKQoJCQkJZnByaW50ZihzdGRlcnIsICIgIG5vdCBzZXR0aW5nIHdv
bFxuIik7CgkJCWlmIChzb3Bhc3NfY2hhbmdlKQoJCQkJZnByaW50ZihzdGRlcnIsICIgIG5vdCBz
ZXR0aW5nIHNvcGFzc1xuIik7CgkJfQoJfQoKCWlmIChtc2dsdmxfY2hhbmdlZCkgewoJCXN0cnVj
dCBldGh0b29sX3ZhbHVlIGVkYXRhOwoKCQllZGF0YS5jbWQgPSBFVEhUT09MX0dNU0dMVkw7CgkJ
ZXJyID0gc2VuZF9pb2N0bChjdHgsICZlZGF0YSk7CgkJaWYgKGVyciA8IDApIHsKCQkJcGVycm9y
KCJDYW5ub3QgZ2V0IG1zZ2x2bCIpOwoJCX0gZWxzZSB7CgkJCWVkYXRhLmNtZCA9IEVUSFRPT0xf
U01TR0xWTDsKCQkJZWRhdGEuZGF0YSA9ICgoZWRhdGEuZGF0YSAmIH5tc2dsdmxfbWFzaykgfAoJ
CQkJICAgICAgbXNnbHZsX3dhbnRlZCk7CgkJCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmZWRhdGEp
OwoJCQlpZiAoZXJyIDwgMCkKCQkJCXBlcnJvcigiQ2Fubm90IHNldCBuZXcgbXNnbHZsIik7CgkJ
fQoJfQoKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRvX2dyZWdzKHN0cnVjdCBjbWRfY29udGV4
dCAqY3R4KQp7CglpbnQgZ3JlZ3NfY2hhbmdlZCA9IDA7CglpbnQgZ3JlZ3NfZHVtcF9yYXcgPSAw
OwoJaW50IGdyZWdzX2R1bXBfaGV4ID0gMDsKCWNoYXIgKmdyZWdzX2R1bXBfZmlsZSA9IE5VTEw7
CglzdHJ1Y3QgY21kbGluZV9pbmZvIGNtZGxpbmVfZ3JlZ3NbXSA9IHsKCQl7CgkJCS5uYW1lCQk9
ICJyYXciLAoJCQkudHlwZQkJPSBDTURMX0JPT0wsCgkJCS53YW50ZWRfdmFsCT0gJmdyZWdzX2R1
bXBfcmF3LAoJCX0sCgkJewoJCQkubmFtZQkJPSAiaGV4IiwKCQkJLnR5cGUJCT0gQ01ETF9CT09M
LAoJCQkud2FudGVkX3ZhbAk9ICZncmVnc19kdW1wX2hleCwKCQl9LAoJCXsKCQkJLm5hbWUJCT0g
ImZpbGUiLAoJCQkudHlwZQkJPSBDTURMX1NUUiwKCQkJLndhbnRlZF92YWwJPSAmZ3JlZ3NfZHVt
cF9maWxlLAoJCX0sCgl9OwoJaW50IGVycjsKCXN0cnVjdCBldGh0b29sX2RydmluZm8gZHJ2aW5m
bzsKCXN0cnVjdCBldGh0b29sX3JlZ3MgKnJlZ3M7CgoJcGFyc2VfZ2VuZXJpY19jbWRsaW5lKGN0
eCwgJmdyZWdzX2NoYW5nZWQsCgkJCSAgICAgIGNtZGxpbmVfZ3JlZ3MsIEFSUkFZX1NJWkUoY21k
bGluZV9ncmVncykpOwoKCWRydmluZm8uY21kID0gRVRIVE9PTF9HRFJWSU5GTzsKCWVyciA9IHNl
bmRfaW9jdGwoY3R4LCAmZHJ2aW5mbyk7CglpZiAoZXJyIDwgMCkgewoJCXBlcnJvcigiQ2Fubm90
IGdldCBkcml2ZXIgaW5mb3JtYXRpb24iKTsKCQlyZXR1cm4gNzI7Cgl9CgoJcmVncyA9IGNhbGxv
YygxLCBzaXplb2YoKnJlZ3MpK2RydmluZm8ucmVnZHVtcF9sZW4pOwoJaWYgKCFyZWdzKSB7CgkJ
cGVycm9yKCJDYW5ub3QgYWxsb2NhdGUgbWVtb3J5IGZvciByZWdpc3RlciBkdW1wIik7CgkJcmV0
dXJuIDczOwoJfQoJcmVncy0+Y21kID0gRVRIVE9PTF9HUkVHUzsKCXJlZ3MtPmxlbiA9IGRydmlu
Zm8ucmVnZHVtcF9sZW47CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgcmVncyk7CglpZiAoZXJyIDwg
MCkgewoJCXBlcnJvcigiQ2Fubm90IGdldCByZWdpc3RlciBkdW1wIik7CgkJZnJlZShyZWdzKTsK
CQlyZXR1cm4gNzQ7Cgl9CgoJaWYgKCFncmVnc19kdW1wX3JhdyAmJiBncmVnc19kdW1wX2ZpbGUg
IT0gTlVMTCkgewoJCS8qIG92ZXJ3cml0ZSByZWcgdmFsdWVzIGZyb20gZmlsZSBkdW1wICovCgkJ
RklMRSAqZiA9IGZvcGVuKGdyZWdzX2R1bXBfZmlsZSwgInIiKTsKCQlzdHJ1Y3QgZXRodG9vbF9y
ZWdzICpucmVnczsKCQlzdHJ1Y3Qgc3RhdCBzdDsKCQlzaXplX3QgbnJlYWQ7CgoJCWlmICghZiB8
fCBmc3RhdChmaWxlbm8oZiksICZzdCkgPCAwKSB7CgkJCWZwcmludGYoc3RkZXJyLCAiQ2FuJ3Qg
b3BlbiAnJXMnOiAlc1xuIiwKCQkJCWdyZWdzX2R1bXBfZmlsZSwgc3RyZXJyb3IoZXJybm8pKTsK
CQkJaWYgKGYpCgkJCQlmY2xvc2UoZik7CgkJCWZyZWUocmVncyk7CgkJCXJldHVybiA3NTsKCQl9
CgoJCW5yZWdzID0gcmVhbGxvYyhyZWdzLCBzaXplb2YoKnJlZ3MpICsgc3Quc3Rfc2l6ZSk7CgkJ
aWYgKCFucmVncykgewoJCQlwZXJyb3IoIkNhbm5vdCBhbGxvY2F0ZSBtZW1vcnkgZm9yIHJlZ2lz
dGVyIGR1bXAiKTsKCQkJZnJlZShyZWdzKTsgLyogd2FzIG5vdCBmcmVlZCBieSByZWFsbG9jICov
CgkJCXJldHVybiA3MzsKCQl9CgkJcmVncyA9IG5yZWdzOwoJCXJlZ3MtPmxlbiA9IHN0LnN0X3Np
emU7CgkJbnJlYWQgPSBmcmVhZChyZWdzLT5kYXRhLCByZWdzLT5sZW4sIDEsIGYpOwoJCWZjbG9z
ZShmKTsKCQlpZiAobnJlYWQgIT0gMSkgewoJCQlmcmVlKHJlZ3MpOwoJCQlyZXR1cm4gNzU7CgkJ
fQoJfQoKCWlmIChkdW1wX3JlZ3MoZ3JlZ3NfZHVtcF9yYXcsIGdyZWdzX2R1bXBfaGV4LAoJCSAg
ICAgICZkcnZpbmZvLCByZWdzKSA8IDApIHsKCQlmcHJpbnRmKHN0ZGVyciwgIkNhbm5vdCBkdW1w
IHJlZ2lzdGVyc1xuIik7CgkJZnJlZShyZWdzKTsKCQlyZXR1cm4gNzU7Cgl9CglmcmVlKHJlZ3Mp
OwoKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRvX253YXlfcnN0KHN0cnVjdCBjbWRfY29udGV4
dCAqY3R4KQp7CglzdHJ1Y3QgZXRodG9vbF92YWx1ZSBlZGF0YTsKCWludCBlcnI7CgoJaWYgKGN0
eC0+YXJnYyAhPSAwKQoJCWV4aXRfYmFkX2FyZ3MoKTsKCgllZGF0YS5jbWQgPSBFVEhUT09MX05X
QVlfUlNUOwoJZXJyID0gc2VuZF9pb2N0bChjdHgsICZlZGF0YSk7CglpZiAoZXJyIDwgMCkKCQlw
ZXJyb3IoIkNhbm5vdCByZXN0YXJ0IGF1dG9uZWdvdGlhdGlvbiIpOwoKCXJldHVybiBlcnI7Cn0K
CnN0YXRpYyBpbnQgZG9fZ2VlcHJvbShzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJaW50IGdl
ZXByb21fY2hhbmdlZCA9IDA7CglpbnQgZ2VlcHJvbV9kdW1wX3JhdyA9IDA7Cgl1MzIgZ2VlcHJv
bV9vZmZzZXQgPSAwOwoJdTMyIGdlZXByb21fbGVuZ3RoID0gMDsKCWludCBnZWVwcm9tX2xlbmd0
aF9zZWVuID0gMDsKCXN0cnVjdCBjbWRsaW5lX2luZm8gY21kbGluZV9nZWVwcm9tW10gPSB7CgkJ
ewoJCQkubmFtZQkJPSAib2Zmc2V0IiwKCQkJLnR5cGUJCT0gQ01ETF9VMzIsCgkJCS53YW50ZWRf
dmFsCT0gJmdlZXByb21fb2Zmc2V0LAoJCX0sCgkJewoJCQkubmFtZQkJPSAibGVuZ3RoIiwKCQkJ
LnR5cGUJCT0gQ01ETF9VMzIsCgkJCS53YW50ZWRfdmFsCT0gJmdlZXByb21fbGVuZ3RoLAoJCQku
c2Vlbl92YWwJPSAmZ2VlcHJvbV9sZW5ndGhfc2VlbiwKCQl9LAoJCXsKCQkJLm5hbWUJCT0gInJh
dyIsCgkJCS50eXBlCQk9IENNRExfQk9PTCwKCQkJLndhbnRlZF92YWwJPSAmZ2VlcHJvbV9kdW1w
X3JhdywKCQl9LAoJfTsKCWludCBlcnI7CglzdHJ1Y3QgZXRodG9vbF9kcnZpbmZvIGRydmluZm87
CglzdHJ1Y3QgZXRodG9vbF9lZXByb20gKmVlcHJvbTsKCglwYXJzZV9nZW5lcmljX2NtZGxpbmUo
Y3R4LCAmZ2VlcHJvbV9jaGFuZ2VkLAoJCQkgICAgICBjbWRsaW5lX2dlZXByb20sIEFSUkFZX1NJ
WkUoY21kbGluZV9nZWVwcm9tKSk7CgoJZHJ2aW5mby5jbWQgPSBFVEhUT09MX0dEUlZJTkZPOwoJ
ZXJyID0gc2VuZF9pb2N0bChjdHgsICZkcnZpbmZvKTsKCWlmIChlcnIgPCAwKSB7CgkJcGVycm9y
KCJDYW5ub3QgZ2V0IGRyaXZlciBpbmZvcm1hdGlvbiIpOwoJCXJldHVybiA3NDsKCX0KCglpZiAo
IWdlZXByb21fbGVuZ3RoX3NlZW4pCgkJZ2VlcHJvbV9sZW5ndGggPSBkcnZpbmZvLmVlZHVtcF9s
ZW47CgoJaWYgKGRydmluZm8uZWVkdW1wX2xlbiA8IGdlZXByb21fb2Zmc2V0ICsgZ2VlcHJvbV9s
ZW5ndGgpCgkJZ2VlcHJvbV9sZW5ndGggPSBkcnZpbmZvLmVlZHVtcF9sZW4gLSBnZWVwcm9tX29m
ZnNldDsKCgllZXByb20gPSBjYWxsb2MoMSwgc2l6ZW9mKCplZXByb20pK2dlZXByb21fbGVuZ3Ro
KTsKCWlmICghZWVwcm9tKSB7CgkJcGVycm9yKCJDYW5ub3QgYWxsb2NhdGUgbWVtb3J5IGZvciBF
RVBST00gZGF0YSIpOwoJCXJldHVybiA3NTsKCX0KCWVlcHJvbS0+Y21kID0gRVRIVE9PTF9HRUVQ
Uk9NOwoJZWVwcm9tLT5sZW4gPSBnZWVwcm9tX2xlbmd0aDsKCWVlcHJvbS0+b2Zmc2V0ID0gZ2Vl
cHJvbV9vZmZzZXQ7CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgZWVwcm9tKTsKCWlmIChlcnIgPCAw
KSB7CgkJcGVycm9yKCJDYW5ub3QgZ2V0IEVFUFJPTSBkYXRhIik7CgkJZnJlZShlZXByb20pOwoJ
CXJldHVybiA3NDsKCX0KCWVyciA9IGR1bXBfZWVwcm9tKGdlZXByb21fZHVtcF9yYXcsICZkcnZp
bmZvLCBlZXByb20pOwoJZnJlZShlZXByb20pOwoKCXJldHVybiBlcnI7Cn0KCnN0YXRpYyBpbnQg
ZG9fc2VlcHJvbShzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJaW50IHNlZXByb21fY2hhbmdl
ZCA9IDA7Cgl1MzIgc2VlcHJvbV9tYWdpYyA9IDA7Cgl1MzIgc2VlcHJvbV9sZW5ndGggPSAwOwoJ
dTMyIHNlZXByb21fb2Zmc2V0ID0gMDsKCXU4IHNlZXByb21fdmFsdWUgPSAwOwoJaW50IHNlZXBy
b21fbGVuZ3RoX3NlZW4gPSAwOwoJaW50IHNlZXByb21fdmFsdWVfc2VlbiA9IDA7CglzdHJ1Y3Qg
Y21kbGluZV9pbmZvIGNtZGxpbmVfc2VlcHJvbVtdID0gewoJCXsKCQkJLm5hbWUJCT0gIm1hZ2lj
IiwKCQkJLnR5cGUJCT0gQ01ETF9VMzIsCgkJCS53YW50ZWRfdmFsCT0gJnNlZXByb21fbWFnaWMs
CgkJfSwKCQl7CgkJCS5uYW1lCQk9ICJvZmZzZXQiLAoJCQkudHlwZQkJPSBDTURMX1UzMiwKCQkJ
LndhbnRlZF92YWwJPSAmc2VlcHJvbV9vZmZzZXQsCgkJfSwKCQl7CgkJCS5uYW1lCQk9ICJsZW5n
dGgiLAoJCQkudHlwZQkJPSBDTURMX1UzMiwKCQkJLndhbnRlZF92YWwJPSAmc2VlcHJvbV9sZW5n
dGgsCgkJCS5zZWVuX3ZhbAk9ICZzZWVwcm9tX2xlbmd0aF9zZWVuLAoJCX0sCgkJewoJCQkubmFt
ZQkJPSAidmFsdWUiLAoJCQkudHlwZQkJPSBDTURMX1U4LAoJCQkud2FudGVkX3ZhbAk9ICZzZWVw
cm9tX3ZhbHVlLAoJCQkuc2Vlbl92YWwJPSAmc2VlcHJvbV92YWx1ZV9zZWVuLAoJCX0sCgl9OwoJ
aW50IGVycjsKCXN0cnVjdCBldGh0b29sX2RydmluZm8gZHJ2aW5mbzsKCXN0cnVjdCBldGh0b29s
X2VlcHJvbSAqZWVwcm9tOwoKCXBhcnNlX2dlbmVyaWNfY21kbGluZShjdHgsICZzZWVwcm9tX2No
YW5nZWQsCgkJCSAgICAgIGNtZGxpbmVfc2VlcHJvbSwgQVJSQVlfU0laRShjbWRsaW5lX3NlZXBy
b20pKTsKCglkcnZpbmZvLmNtZCA9IEVUSFRPT0xfR0RSVklORk87CgllcnIgPSBzZW5kX2lvY3Rs
KGN0eCwgJmRydmluZm8pOwoJaWYgKGVyciA8IDApIHsKCQlwZXJyb3IoIkNhbm5vdCBnZXQgZHJp
dmVyIGluZm9ybWF0aW9uIik7CgkJcmV0dXJuIDc0OwoJfQoKCWlmIChzZWVwcm9tX3ZhbHVlX3Nl
ZW4gJiYgIXNlZXByb21fbGVuZ3RoX3NlZW4pCgkJc2VlcHJvbV9sZW5ndGggPSAxOwoJZWxzZSBp
ZiAoIXNlZXByb21fbGVuZ3RoX3NlZW4pCgkJc2VlcHJvbV9sZW5ndGggPSBkcnZpbmZvLmVlZHVt
cF9sZW47CgoJaWYgKHNlZXByb21fdmFsdWVfc2VlbiAmJiAoc2VlcHJvbV9sZW5ndGggIT0gMSkp
IHsKCQlmcHJpbnRmKHN0ZGVyciwgInZhbHVlIHJlcXVpcmVzIGxlbmd0aCAxXG4iKTsKCQlyZXR1
cm4gMTsKCX0KCglpZiAoZHJ2aW5mby5lZWR1bXBfbGVuIDwgc2VlcHJvbV9vZmZzZXQgKyBzZWVw
cm9tX2xlbmd0aCkgewoJCWZwcmludGYoc3RkZXJyLCAib2Zmc2V0ICYgbGVuZ3RoIG91dCBvZiBi
b3VuZHNcbiIpOwoJCXJldHVybiAxOwoJfQoKCWVlcHJvbSA9IGNhbGxvYygxLCBzaXplb2YoKmVl
cHJvbSkrc2VlcHJvbV9sZW5ndGgpOwoJaWYgKCFlZXByb20pIHsKCQlwZXJyb3IoIkNhbm5vdCBh
bGxvY2F0ZSBtZW1vcnkgZm9yIEVFUFJPTSBkYXRhIik7CgkJcmV0dXJuIDc1OwoJfQoKCWVlcHJv
bS0+Y21kID0gRVRIVE9PTF9TRUVQUk9NOwoJZWVwcm9tLT5sZW4gPSBzZWVwcm9tX2xlbmd0aDsK
CWVlcHJvbS0+b2Zmc2V0ID0gc2VlcHJvbV9vZmZzZXQ7CgllZXByb20tPm1hZ2ljID0gc2VlcHJv
bV9tYWdpYzsKCWVlcHJvbS0+ZGF0YVswXSA9IHNlZXByb21fdmFsdWU7CgoJLyogTXVsdGktYnl0
ZSB3cml0ZTogcmVhZCBpbnB1dCBmcm9tIHN0ZGluICovCglpZiAoIXNlZXByb21fdmFsdWVfc2Vl
bikgewoJCWlmIChmcmVhZChlZXByb20tPmRhdGEsIGVlcHJvbS0+bGVuLCAxLCBzdGRpbikgIT0g
MSkgewoJCQlmcHJpbnRmKHN0ZGVyciwgIm5vdCBlbm91Z2ggZGF0YSBmcm9tIHN0ZGluXG4iKTsK
CQkJZnJlZShlZXByb20pOwoJCQlyZXR1cm4gNzU7CgkJfQoJCWlmICgoZmdldGMoc3RkaW4pICE9
IEVPRikgfHwgIWZlb2Yoc3RkaW4pKSB7CgkJCWZwcmludGYoc3RkZXJyLCAidG9vIG11Y2ggZGF0
YSBmcm9tIHN0ZGluXG4iKTsKCQkJZnJlZShlZXByb20pOwoJCQlyZXR1cm4gNzU7CgkJfQoJfQoK
CWVyciA9IHNlbmRfaW9jdGwoY3R4LCBlZXByb20pOwoJaWYgKGVyciA8IDApIHsKCQlwZXJyb3Io
IkNhbm5vdCBzZXQgRUVQUk9NIGRhdGEiKTsKCQllcnIgPSA4NzsKCX0KCWZyZWUoZWVwcm9tKTsK
CglyZXR1cm4gZXJyOwp9CgpzdGF0aWMgaW50IGRvX3Rlc3Qoc3RydWN0IGNtZF9jb250ZXh0ICpj
dHgpCnsKCWVudW0gewoJCU9OTElORSA9IDAsCgkJT0ZGTElORSwKCQlFWFRFUk5BTF9MQiwKCX0g
dGVzdF90eXBlOwoJaW50IGVycjsKCXN0cnVjdCBldGh0b29sX3Rlc3QgKnRlc3Q7CglzdHJ1Y3Qg
ZXRodG9vbF9nc3RyaW5ncyAqc3RyaW5nczsKCglpZiAoY3R4LT5hcmdjID4gMSkKCQlleGl0X2Jh
ZF9hcmdzKCk7CglpZiAoY3R4LT5hcmdjID09IDEpIHsKCQlpZiAoIXN0cmNtcChjdHgtPmFyZ3Bb
MF0sICJvbmxpbmUiKSkKCQkJdGVzdF90eXBlID0gT05MSU5FOwoJCWVsc2UgaWYgKCFzdHJjbXAo
KmN0eC0+YXJncCwgIm9mZmxpbmUiKSkKCQkJdGVzdF90eXBlID0gT0ZGTElORTsKCQllbHNlIGlm
ICghc3RyY21wKCpjdHgtPmFyZ3AsICJleHRlcm5hbF9sYiIpKQoJCQl0ZXN0X3R5cGUgPSBFWFRF
Uk5BTF9MQjsKCQllbHNlCgkJCWV4aXRfYmFkX2FyZ3MoKTsKCX0gZWxzZSB7CgkJdGVzdF90eXBl
ID0gT0ZGTElORTsKCX0KCglzdHJpbmdzID0gZ2V0X3N0cmluZ3NldChjdHgsIEVUSF9TU19URVNU
LAoJCQkJb2Zmc2V0b2Yoc3RydWN0IGV0aHRvb2xfZHJ2aW5mbywgdGVzdGluZm9fbGVuKSwKCQkJ
CTEpOwoJaWYgKCFzdHJpbmdzKSB7CgkJcGVycm9yKCJDYW5ub3QgZ2V0IHN0cmluZ3MiKTsKCQly
ZXR1cm4gNzQ7Cgl9CgoJdGVzdCA9IGNhbGxvYygxLCBzaXplb2YoKnRlc3QpICsgc3RyaW5ncy0+
bGVuICogc2l6ZW9mKHU2NCkpOwoJaWYgKCF0ZXN0KSB7CgkJcGVycm9yKCJDYW5ub3QgYWxsb2Nh
dGUgbWVtb3J5IGZvciB0ZXN0IGluZm8iKTsKCQlmcmVlKHN0cmluZ3MpOwoJCXJldHVybiA3MzsK
CX0KCW1lbXNldCh0ZXN0LT5kYXRhLCAwLCBzdHJpbmdzLT5sZW4gKiBzaXplb2YodTY0KSk7Cgl0
ZXN0LT5jbWQgPSBFVEhUT09MX1RFU1Q7Cgl0ZXN0LT5sZW4gPSBzdHJpbmdzLT5sZW47CglpZiAo
dGVzdF90eXBlID09IEVYVEVSTkFMX0xCKQoJCXRlc3QtPmZsYWdzID0gKEVUSF9URVNUX0ZMX09G
RkxJTkUgfCBFVEhfVEVTVF9GTF9FWFRFUk5BTF9MQik7CgllbHNlIGlmICh0ZXN0X3R5cGUgPT0g
T0ZGTElORSkKCQl0ZXN0LT5mbGFncyA9IEVUSF9URVNUX0ZMX09GRkxJTkU7CgllbHNlCgkJdGVz
dC0+ZmxhZ3MgPSAwOwoJZXJyID0gc2VuZF9pb2N0bChjdHgsIHRlc3QpOwoJaWYgKGVyciA8IDAp
IHsKCQlwZXJyb3IoIkNhbm5vdCB0ZXN0Iik7CgkJZnJlZSh0ZXN0KTsKCQlmcmVlKHN0cmluZ3Mp
OwoJCXJldHVybiA3NDsKCX0KCgllcnIgPSBkdW1wX3Rlc3QodGVzdCwgc3RyaW5ncyk7CglmcmVl
KHRlc3QpOwoJZnJlZShzdHJpbmdzKTsKCglyZXR1cm4gZXJyOwp9CgpzdGF0aWMgaW50IGRvX3Bo
eXNfaWQoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgpCnsKCWludCBlcnI7CglzdHJ1Y3QgZXRodG9v
bF92YWx1ZSBlZGF0YTsKCWludCBwaHlzX2lkX3RpbWU7CgoJaWYgKGN0eC0+YXJnYyA+IDEpCgkJ
ZXhpdF9iYWRfYXJncygpOwoJaWYgKGN0eC0+YXJnYyA9PSAxKQoJCXBoeXNfaWRfdGltZSA9IGdl
dF9pbnQoKmN0eC0+YXJncCwgMCk7CgllbHNlCgkJcGh5c19pZF90aW1lID0gMDsKCgllZGF0YS5j
bWQgPSBFVEhUT09MX1BIWVNfSUQ7CgllZGF0YS5kYXRhID0gcGh5c19pZF90aW1lOwoJZXJyID0g
c2VuZF9pb2N0bChjdHgsICZlZGF0YSk7CglpZiAoZXJyIDwgMCkKCQlwZXJyb3IoIkNhbm5vdCBp
ZGVudGlmeSBOSUMiKTsKCglyZXR1cm4gZXJyOwp9CgpzdGF0aWMgaW50IGRvX2dzdGF0cyhzdHJ1
Y3QgY21kX2NvbnRleHQgKmN0eCwgaW50IGNtZCwgaW50IHN0cmluZ3NldCwKCQkgICAgY29uc3Qg
Y2hhciAqbmFtZSkKewoJc3RydWN0IGV0aHRvb2xfZ3N0cmluZ3MgKnN0cmluZ3M7CglzdHJ1Y3Qg
ZXRodG9vbF9zdGF0cyAqc3RhdHM7Cgl1bnNpZ25lZCBpbnQgbl9zdGF0cywgc3pfc3RhdHMsIGk7
CglpbnQgZXJyOwoKCWlmIChjdHgtPmFyZ2MgIT0gMCkKCQlleGl0X2JhZF9hcmdzKCk7CgoJc3Ry
aW5ncyA9IGdldF9zdHJpbmdzZXQoY3R4LCBzdHJpbmdzZXQsCgkJCQlvZmZzZXRvZihzdHJ1Y3Qg
ZXRodG9vbF9kcnZpbmZvLCBuX3N0YXRzKSwKCQkJCTApOwoJaWYgKCFzdHJpbmdzKSB7CgkJcGVy
cm9yKCJDYW5ub3QgZ2V0IHN0YXRzIHN0cmluZ3MgaW5mb3JtYXRpb24iKTsKCQlyZXR1cm4gOTY7
Cgl9CgoJbl9zdGF0cyA9IHN0cmluZ3MtPmxlbjsKCWlmIChuX3N0YXRzIDwgMSkgewoJCWZwcmlu
dGYoc3RkZXJyLCAibm8gc3RhdHMgYXZhaWxhYmxlXG4iKTsKCQlmcmVlKHN0cmluZ3MpOwoJCXJl
dHVybiA5NDsKCX0KCglzel9zdGF0cyA9IG5fc3RhdHMgKiBzaXplb2YodTY0KTsKCglzdGF0cyA9
IGNhbGxvYygxLCBzel9zdGF0cyArIHNpemVvZihzdHJ1Y3QgZXRodG9vbF9zdGF0cykpOwoJaWYg
KCFzdGF0cykgewoJCWZwcmludGYoc3RkZXJyLCAibm8gbWVtb3J5IGF2YWlsYWJsZVxuIik7CgkJ
ZnJlZShzdHJpbmdzKTsKCQlyZXR1cm4gOTU7Cgl9CgoJc3RhdHMtPmNtZCA9IGNtZDsKCXN0YXRz
LT5uX3N0YXRzID0gbl9zdGF0czsKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCBzdGF0cyk7CglpZiAo
ZXJyIDwgMCkgewoJCXBlcnJvcigiQ2Fubm90IGdldCBzdGF0cyBpbmZvcm1hdGlvbiIpOwoJCWZy
ZWUoc3RyaW5ncyk7CgkJZnJlZShzdGF0cyk7CgkJcmV0dXJuIDk3OwoJfQoKCS8qIHRvZG8gLSBw
cmV0dHktcHJpbnQgdGhlIHN0cmluZ3MgcGVyLWRyaXZlciAqLwoJZnByaW50ZihzdGRvdXQsICIl
cyBzdGF0aXN0aWNzOlxuIiwgbmFtZSk7Cglmb3IgKGkgPSAwOyBpIDwgbl9zdGF0czsgaSsrKSB7
CgkJZnByaW50ZihzdGRvdXQsICIgICAgICUuKnM6ICVsbHVcbiIsCgkJCUVUSF9HU1RSSU5HX0xF
TiwKCQkJJnN0cmluZ3MtPmRhdGFbaSAqIEVUSF9HU1RSSU5HX0xFTl0sCgkJCXN0YXRzLT5kYXRh
W2ldKTsKCX0KCWZyZWUoc3RyaW5ncyk7CglmcmVlKHN0YXRzKTsKCglyZXR1cm4gMDsKfQoKc3Rh
dGljIGludCBkb19nbmljc3RhdHMoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgpCnsKCXJldHVybiBk
b19nc3RhdHMoY3R4LCBFVEhUT09MX0dTVEFUUywgRVRIX1NTX1NUQVRTLCAiTklDIik7Cn0KCnN0
YXRpYyBpbnQgZG9fZ3BoeXN0YXRzKHN0cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7CglyZXR1cm4g
ZG9fZ3N0YXRzKGN0eCwgRVRIVE9PTF9HUEhZU1RBVFMsIEVUSF9TU19QSFlfU1RBVFMsICJQSFki
KTsKfQoKc3RhdGljIGludCBkb19zcnhudHVwbGUoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgsCgkJ
CXN0cnVjdCBldGh0b29sX3J4X2Zsb3dfc3BlYyAqcnhfcnVsZV9mcyk7CgpzdGF0aWMgaW50IGRv
X3NyeGNsYXNzKHN0cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7CglpbnQgZXJyOwoKCWlmIChjdHgt
PmFyZ2MgPCAyKQoJCWV4aXRfYmFkX2FyZ3MoKTsKCglpZiAoIXN0cmNtcChjdHgtPmFyZ3BbMF0s
ICJyeC1mbG93LWhhc2giKSkgewoJCWludCByeF9maGFzaF9zZXQ7CgkJdTMyIHJ4X2ZoYXNoX3Zh
bDsKCQlzdHJ1Y3QgZXRodG9vbF9yeG5mYyBuZmNjbWQ7CgkJYm9vbCBmbG93X3JzcyA9IGZhbHNl
OwoKCQlpZiAoY3R4LT5hcmdjID09IDUpIHsKCQkJaWYgKHN0cmNtcChjdHgtPmFyZ3BbM10sICJj
b250ZXh0IikpCgkJCQlleGl0X2JhZF9hcmdzKCk7CgkJCWZsb3dfcnNzID0gdHJ1ZTsKCQkJbmZj
Y21kLnJzc19jb250ZXh0ID0gZ2V0X3UzMihjdHgtPmFyZ3BbNF0sIDApOwoJCX0gZWxzZSBpZiAo
Y3R4LT5hcmdjICE9IDMpIHsKCQkJZXhpdF9iYWRfYXJncygpOwoJCX0KCQlyeF9maGFzaF9zZXQg
PSByeGZsb3dfc3RyX3RvX3R5cGUoY3R4LT5hcmdwWzFdKTsKCQlpZiAoIXJ4X2ZoYXNoX3NldCkK
CQkJZXhpdF9iYWRfYXJncygpOwoJCWlmIChwYXJzZV9yeGZoYXNob3B0cyhjdHgtPmFyZ3BbMl0s
ICZyeF9maGFzaF92YWwpIDwgMCkKCQkJZXhpdF9iYWRfYXJncygpOwoKCQluZmNjbWQuY21kID0g
RVRIVE9PTF9TUlhGSDsKCQluZmNjbWQuZmxvd190eXBlID0gcnhfZmhhc2hfc2V0OwoJCW5mY2Nt
ZC5kYXRhID0gcnhfZmhhc2hfdmFsOwoJCWlmIChmbG93X3JzcykKCQkJbmZjY21kLmZsb3dfdHlw
ZSB8PSBGTE9XX1JTUzsKCgkJZXJyID0gc2VuZF9pb2N0bChjdHgsICZuZmNjbWQpOwoJCWlmIChl
cnIgPCAwKQoJCQlwZXJyb3IoIkNhbm5vdCBjaGFuZ2UgUlggbmV0d29yayBmbG93IGhhc2hpbmcg
b3B0aW9ucyIpOwoJfSBlbHNlIGlmICghc3RyY21wKGN0eC0+YXJncFswXSwgImZsb3ctdHlwZSIp
KSB7CgkJc3RydWN0IGV0aHRvb2xfcnhfZmxvd19zcGVjIHJ4X3J1bGVfZnM7CgkJX191MzIgcnNz
X2NvbnRleHQgPSAwOwoKCQljdHgtPmFyZ2MtLTsKCQljdHgtPmFyZ3ArKzsKCQlpZiAocnhjbGFz
c19wYXJzZV9ydWxlb3B0cyhjdHgsICZyeF9ydWxlX2ZzLCAmcnNzX2NvbnRleHQpIDwgMCkKCQkJ
ZXhpdF9iYWRfYXJncygpOwoKCQkvKiBhdHRlbXB0IHRvIGFkZCBydWxlIHZpYSBOLXR1cGxlIHNw
ZWNpZmllciAqLwoJCWVyciA9IGRvX3NyeG50dXBsZShjdHgsICZyeF9ydWxlX2ZzKTsKCQlpZiAo
IWVycikKCQkJcmV0dXJuIDA7CgoJCS8qIGF0dGVtcHQgdG8gYWRkIHJ1bGUgdmlhIG5ldHdvcmsg
ZmxvdyBjbGFzc2lmaWVyICovCgkJZXJyID0gcnhjbGFzc19ydWxlX2lucyhjdHgsICZyeF9ydWxl
X2ZzLCByc3NfY29udGV4dCk7CgkJaWYgKGVyciA8IDApIHsKCQkJZnByaW50ZihzdGRlcnIsICJD
YW5ub3QgaW5zZXJ0IgoJCQkJIiBjbGFzc2lmaWNhdGlvbiBydWxlXG4iKTsKCQkJcmV0dXJuIDE7
CgkJfQoJfSBlbHNlIGlmICghc3RyY21wKGN0eC0+YXJncFswXSwgImRlbGV0ZSIpKSB7CgkJaW50
IHJ4X2NsYXNzX3J1bGVfZGVsID0KCQkJZ2V0X3VpbnRfcmFuZ2UoY3R4LT5hcmdwWzFdLCAwLCBJ
TlRfTUFYKTsKCgkJZXJyID0gcnhjbGFzc19ydWxlX2RlbChjdHgsIHJ4X2NsYXNzX3J1bGVfZGVs
KTsKCgkJaWYgKGVyciA8IDApIHsKCQkJZnByaW50ZihzdGRlcnIsICJDYW5ub3QgZGVsZXRlIgoJ
CQkJIiBjbGFzc2lmaWNhdGlvbiBydWxlXG4iKTsKCQkJcmV0dXJuIDE7CgkJfQoJfSBlbHNlIHsK
CQlleGl0X2JhZF9hcmdzKCk7Cgl9CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgZG9fZ3J4Y2xh
c3Moc3RydWN0IGNtZF9jb250ZXh0ICpjdHgpCnsKCXN0cnVjdCBldGh0b29sX3J4bmZjIG5mY2Nt
ZDsKCWludCBlcnI7CgoJaWYgKGN0eC0+YXJnYyA+IDAgJiYgIXN0cmNtcChjdHgtPmFyZ3BbMF0s
ICJyeC1mbG93LWhhc2giKSkgewoJCWludCByeF9maGFzaF9nZXQ7CgkJYm9vbCBmbG93X3JzcyA9
IGZhbHNlOwoKCQlpZiAoY3R4LT5hcmdjID09IDQpIHsKCQkJaWYgKHN0cmNtcChjdHgtPmFyZ3Bb
Ml0sICJjb250ZXh0IikpCgkJCQlleGl0X2JhZF9hcmdzKCk7CgkJCWZsb3dfcnNzID0gdHJ1ZTsK
CQkJbmZjY21kLnJzc19jb250ZXh0ID0gZ2V0X3UzMihjdHgtPmFyZ3BbM10sIDApOwoJCX0gZWxz
ZSBpZiAoY3R4LT5hcmdjICE9IDIpIHsKCQkJZXhpdF9iYWRfYXJncygpOwoJCX0KCgkJcnhfZmhh
c2hfZ2V0ID0gcnhmbG93X3N0cl90b190eXBlKGN0eC0+YXJncFsxXSk7CgkJaWYgKCFyeF9maGFz
aF9nZXQpCgkJCWV4aXRfYmFkX2FyZ3MoKTsKCgkJbmZjY21kLmNtZCA9IEVUSFRPT0xfR1JYRkg7
CgkJbmZjY21kLmZsb3dfdHlwZSA9IHJ4X2ZoYXNoX2dldDsKCQlpZiAoZmxvd19yc3MpCgkJCW5m
Y2NtZC5mbG93X3R5cGUgfD0gRkxPV19SU1M7CgkJZXJyID0gc2VuZF9pb2N0bChjdHgsICZuZmNj
bWQpOwoJCWlmIChlcnIgPCAwKSB7CgkJCXBlcnJvcigiQ2Fubm90IGdldCBSWCBuZXR3b3JrIGZs
b3cgaGFzaGluZyBvcHRpb25zIik7CgkJfSBlbHNlIHsKCQkJaWYgKGZsb3dfcnNzKQoJCQkJZnBy
aW50ZihzdGRvdXQsICJGb3IgUlNTIGNvbnRleHQgJXU6XG4iLAoJCQkJCW5mY2NtZC5yc3NfY29u
dGV4dCk7CgkJCWR1bXBfcnhmaGFzaChyeF9maGFzaF9nZXQsIG5mY2NtZC5kYXRhKTsKCQl9Cgl9
IGVsc2UgaWYgKGN0eC0+YXJnYyA9PSAyICYmICFzdHJjbXAoY3R4LT5hcmdwWzBdLCAicnVsZSIp
KSB7CgkJaW50IHJ4X2NsYXNzX3J1bGVfZ2V0ID0KCQkJZ2V0X3VpbnRfcmFuZ2UoY3R4LT5hcmdw
WzFdLCAwLCBJTlRfTUFYKTsKCgkJZXJyID0gcnhjbGFzc19ydWxlX2dldChjdHgsIHJ4X2NsYXNz
X3J1bGVfZ2V0KTsKCQlpZiAoZXJyIDwgMCkKCQkJZnByaW50ZihzdGRlcnIsICJDYW5ub3QgZ2V0
IFJYIGNsYXNzaWZpY2F0aW9uIHJ1bGVcbiIpOwoJfSBlbHNlIGlmIChjdHgtPmFyZ2MgPT0gMCkg
ewoJCW5mY2NtZC5jbWQgPSBFVEhUT09MX0dSWFJJTkdTOwoJCWVyciA9IHNlbmRfaW9jdGwoY3R4
LCAmbmZjY21kKTsKCQlpZiAoZXJyIDwgMCkKCQkJcGVycm9yKCJDYW5ub3QgZ2V0IFJYIHJpbmdz
Iik7CgkJZWxzZQoJCQlmcHJpbnRmKHN0ZG91dCwgIiVkIFJYIHJpbmdzIGF2YWlsYWJsZVxuIiwK
CQkJCShpbnQpbmZjY21kLmRhdGEpOwoKCQllcnIgPSByeGNsYXNzX3J1bGVfZ2V0YWxsKGN0eCk7
CgkJaWYgKGVyciA8IDApCgkJCWZwcmludGYoc3RkZXJyLCAiUlggY2xhc3NpZmljYXRpb24gcnVs
ZSByZXRyaWV2YWwgZmFpbGVkXG4iKTsKCgl9IGVsc2UgewoJCWV4aXRfYmFkX2FyZ3MoKTsKCX0K
CglyZXR1cm4gZXJyID8gMSA6IDA7Cn0KCnN0YXRpYyBpbnQgZG9fZ3J4ZmhpbmRpcihzdHJ1Y3Qg
Y21kX2NvbnRleHQgKmN0eCwKCQkJIHN0cnVjdCBldGh0b29sX3J4bmZjICpyaW5nX2NvdW50KQp7
CglzdHJ1Y3QgZXRodG9vbF9yeGZoX2luZGlyIGluZGlyX2hlYWQ7CglzdHJ1Y3QgZXRodG9vbF9y
eGZoX2luZGlyICppbmRpcjsKCWludCBlcnI7CgoJaW5kaXJfaGVhZC5jbWQgPSBFVEhUT09MX0dS
WEZISU5ESVI7CglpbmRpcl9oZWFkLnNpemUgPSAwOwoJZXJyID0gc2VuZF9pb2N0bChjdHgsICZp
bmRpcl9oZWFkKTsKCWlmIChlcnIgPCAwKSB7CgkJcGVycm9yKCJDYW5ub3QgZ2V0IFJYIGZsb3cg
aGFzaCBpbmRpcmVjdGlvbiB0YWJsZSBzaXplIik7CgkJcmV0dXJuIDE7Cgl9CgoJaW5kaXIgPSBt
YWxsb2Moc2l6ZW9mKCppbmRpcikgKwoJCSAgICAgICBpbmRpcl9oZWFkLnNpemUgKiBzaXplb2Yo
KmluZGlyLT5yaW5nX2luZGV4KSk7CglpZiAoIWluZGlyKSB7CgkJcGVycm9yKCJDYW5ub3QgYWxs
b2NhdGUgbWVtb3J5IGZvciBpbmRpcmVjdGlvbiB0YWJsZSIpOwoJCXJldHVybiAxOwoJfQoKCWlu
ZGlyLT5jbWQgPSBFVEhUT09MX0dSWEZISU5ESVI7CglpbmRpci0+c2l6ZSA9IGluZGlyX2hlYWQu
c2l6ZTsKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCBpbmRpcik7CglpZiAoZXJyIDwgMCkgewoJCXBl
cnJvcigiQ2Fubm90IGdldCBSWCBmbG93IGhhc2ggaW5kaXJlY3Rpb24gdGFibGUiKTsKCQlmcmVl
KGluZGlyKTsKCQlyZXR1cm4gMTsKCX0KCglwcmludF9pbmRpcl90YWJsZShjdHgsIHJpbmdfY291
bnQtPmRhdGEsIGluZGlyLT5zaXplLAoJCQkgIGluZGlyLT5yaW5nX2luZGV4KTsKCglmcmVlKGlu
ZGlyKTsKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRvX2dyeGZoKHN0cnVjdCBjbWRfY29udGV4
dCAqY3R4KQp7CglzdHJ1Y3QgZXRodG9vbF9nc3RyaW5ncyAqaGZ1bmNzID0gTlVMTDsKCXN0cnVj
dCBldGh0b29sX3J4ZmggcnNzX2hlYWQgPSB7MH07CglzdHJ1Y3QgZXRodG9vbF9yeG5mYyByaW5n
X2NvdW50OwoJc3RydWN0IGV0aHRvb2xfcnhmaCAqcnNzOwoJdTMyIHJzc19jb250ZXh0ID0gMDsK
CXUzMiBpLCBpbmRpcl9ieXRlczsKCXVuc2lnbmVkIGludCBhcmdfbnVtID0gMDsKCXU4ICpoa2V5
OwoJaW50IGVycjsKCgl3aGlsZSAoYXJnX251bSA8IGN0eC0+YXJnYykgewoJCWlmICghc3RyY21w
KGN0eC0+YXJncFthcmdfbnVtXSwgImNvbnRleHQiKSkgewoJCQkrK2FyZ19udW07CgkJCXJzc19j
b250ZXh0ID0gZ2V0X2ludF9yYW5nZShjdHgtPmFyZ3BbYXJnX251bV0sIDAsIDEsCgkJCQkJCSAg
ICBFVEhfUlhGSF9DT05URVhUX0FMTE9DIC0gMSk7CgkJCSsrYXJnX251bTsKCQl9IGVsc2UgewoJ
CQlleGl0X2JhZF9hcmdzKCk7CgkJfQoJfQoKCXJpbmdfY291bnQuY21kID0gRVRIVE9PTF9HUlhS
SU5HUzsKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmcmluZ19jb3VudCk7CglpZiAoZXJyIDwgMCkg
ewoJCXBlcnJvcigiQ2Fubm90IGdldCBSWCByaW5nIGNvdW50Iik7CgkJcmV0dXJuIDE7Cgl9CgoJ
cnNzX2hlYWQuY21kID0gRVRIVE9PTF9HUlNTSDsKCXJzc19oZWFkLnJzc19jb250ZXh0ID0gcnNz
X2NvbnRleHQ7CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJnJzc19oZWFkKTsKCWlmIChlcnIgPCAw
ICYmIGVycm5vID09IEVPUE5PVFNVUFAgJiYgIXJzc19jb250ZXh0KSB7CgkJcmV0dXJuIGRvX2dy
eGZoaW5kaXIoY3R4LCAmcmluZ19jb3VudCk7Cgl9IGVsc2UgaWYgKGVyciA8IDApIHsKCQlwZXJy
b3IoIkNhbm5vdCBnZXQgUlggZmxvdyBoYXNoIGluZGlyIHNpemUgYW5kL29yIGtleSBzaXplIik7
CgkJcmV0dXJuIDE7Cgl9CgoJcnNzID0gY2FsbG9jKDEsIHNpemVvZigqcnNzKSArCgkJCXJzc19o
ZWFkLmluZGlyX3NpemUgKiBzaXplb2YocnNzX2hlYWQucnNzX2NvbmZpZ1swXSkgKwoJCQlyc3Nf
aGVhZC5rZXlfc2l6ZSk7CglpZiAoIXJzcykgewoJCXBlcnJvcigiQ2Fubm90IGFsbG9jYXRlIG1l
bW9yeSBmb3IgUlggZmxvdyBoYXNoIGNvbmZpZyIpOwoJCXJldHVybiAxOwoJfQoKCXJzcy0+Y21k
ID0gRVRIVE9PTF9HUlNTSDsKCXJzcy0+cnNzX2NvbnRleHQgPSByc3NfY29udGV4dDsKCXJzcy0+
aW5kaXJfc2l6ZSA9IHJzc19oZWFkLmluZGlyX3NpemU7Cglyc3MtPmtleV9zaXplID0gcnNzX2hl
YWQua2V5X3NpemU7CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgcnNzKTsKCWlmIChlcnIgPCAwKSB7
CgkJcGVycm9yKCJDYW5ub3QgZ2V0IFJYIGZsb3cgaGFzaCBjb25maWd1cmF0aW9uIik7CgkJZnJl
ZShyc3MpOwoJCXJldHVybiAxOwoJfQoKCXByaW50X2luZGlyX3RhYmxlKGN0eCwgcmluZ19jb3Vu
dC5kYXRhLCByc3MtPmluZGlyX3NpemUsCgkJCSAgcnNzLT5yc3NfY29uZmlnKTsKCglpbmRpcl9i
eXRlcyA9IHJzcy0+aW5kaXJfc2l6ZSAqIHNpemVvZihyc3MtPnJzc19jb25maWdbMF0pOwoJaGtl
eSA9ICgodTggKilyc3MtPnJzc19jb25maWcgKyBpbmRpcl9ieXRlcyk7CgoJcHJpbnRfcnNzX2hr
ZXkoaGtleSwgcnNzLT5rZXlfc2l6ZSk7CgoJcHJpbnRmKCJSU1MgaGFzaCBmdW5jdGlvbjpcbiIp
OwoJaWYgKCFyc3MtPmhmdW5jKSB7CgkJcHJpbnRmKCIgICAgT3BlcmF0aW9uIG5vdCBzdXBwb3J0
ZWRcbiIpOwoJCWdvdG8gb3V0OwoJfQoKCWhmdW5jcyA9IGdldF9zdHJpbmdzZXQoY3R4LCBFVEhf
U1NfUlNTX0hBU0hfRlVOQ1MsIDAsIDEpOwoJaWYgKCFoZnVuY3MpIHsKCQlwZXJyb3IoIkNhbm5v
dCBnZXQgaGFzaCBmdW5jdGlvbnMgbmFtZXMiKTsKCQlmcmVlKHJzcyk7CgkJcmV0dXJuIDE7Cgl9
CgoJZm9yIChpID0gMDsgaSA8IGhmdW5jcy0+bGVuOyBpKyspCgkJcHJpbnRmKCIgICAgJXM6ICVz
XG4iLAoJCSAgICAgICAoY29uc3QgY2hhciAqKWhmdW5jcy0+ZGF0YSArIGkgKiBFVEhfR1NUUklO
R19MRU4sCgkJICAgICAgIChyc3MtPmhmdW5jICYgKDEgPDwgaSkpID8gIm9uIiA6ICJvZmYiKTsK
Cm91dDoKCWZyZWUoaGZ1bmNzKTsKCWZyZWUocnNzKTsKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50
IGZpbGxfaW5kaXJfdGFibGUodTMyICppbmRpcl9zaXplLCB1MzIgKmluZGlyLCBpbnQgcnhmaGlu
ZGlyX2RlZmF1bHQsCgkJCSAgICBpbnQgcnhmaGluZGlyX3N0YXJ0LCBpbnQgcnhmaGluZGlyX2Vx
dWFsLAoJCQkgICAgY2hhciAqKnJ4ZmhpbmRpcl93ZWlnaHQsIHUzMiBudW1fd2VpZ2h0cykKewoJ
dTMyIGk7CgoJaWYgKHJ4ZmhpbmRpcl9lcXVhbCkgewoJCWZvciAoaSA9IDA7IGkgPCAqaW5kaXJf
c2l6ZTsgaSsrKQoJCQlpbmRpcltpXSA9IHJ4ZmhpbmRpcl9zdGFydCArIChpICUgcnhmaGluZGly
X2VxdWFsKTsKCX0gZWxzZSBpZiAocnhmaGluZGlyX3dlaWdodCkgewoJCXUzMiBqLCB3ZWlnaHQs
IHN1bSA9IDAsIHBhcnRpYWwgPSAwOwoKCQlmb3IgKGogPSAwOyBqIDwgbnVtX3dlaWdodHM7IGor
KykgewoJCQl3ZWlnaHQgPSBnZXRfdTMyKHJ4ZmhpbmRpcl93ZWlnaHRbal0sIDApOwoJCQlzdW0g
Kz0gd2VpZ2h0OwoJCX0KCgkJaWYgKHN1bSA9PSAwKSB7CgkJCWZwcmludGYoc3RkZXJyLAoJCQkJ
IkF0IGxlYXN0IG9uZSB3ZWlnaHQgbXVzdCBiZSBub24temVyb1xuIik7CgkJCXJldHVybiAyOwoJ
CX0KCgkJaWYgKHN1bSA+ICppbmRpcl9zaXplKSB7CgkJCWZwcmludGYoc3RkZXJyLAoJCQkJIlRv
dGFsIHdlaWdodCBleGNlZWRzIHRoZSBzaXplIG9mIHRoZSAiCgkJCQkiaW5kaXJlY3Rpb24gdGFi
bGVcbiIpOwoJCQlyZXR1cm4gMjsKCQl9CgoJCWogPSAtMTsKCQlmb3IgKGkgPSAwOyBpIDwgKmlu
ZGlyX3NpemU7IGkrKykgewoJCQl3aGlsZSAoaSA+PSAoKmluZGlyX3NpemUpICogcGFydGlhbCAv
IHN1bSkgewoJCQkJaiArPSAxOwoJCQkJd2VpZ2h0ID0gZ2V0X3UzMihyeGZoaW5kaXJfd2VpZ2h0
W2pdLCAwKTsKCQkJCXBhcnRpYWwgKz0gd2VpZ2h0OwoJCQl9CgkJCWluZGlyW2ldID0gcnhmaGlu
ZGlyX3N0YXJ0ICsgajsKCQl9Cgl9IGVsc2UgaWYgKHJ4ZmhpbmRpcl9kZWZhdWx0KSB7CgkJLyog
IippbmRpcl9zaXplID09IDAiID09PiByZXNldCBpbmRpciB0byBkZWZhdWx0ICovCgkJKmluZGly
X3NpemUgPSAwOwoJfSBlbHNlIHsKCQkqaW5kaXJfc2l6ZSA9IEVUSF9SWEZIX0lORElSX05PX0NI
QU5HRTsKCX0KCglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBkb19zcnhmaGluZGlyKHN0cnVjdCBj
bWRfY29udGV4dCAqY3R4LCBpbnQgcnhmaGluZGlyX2RlZmF1bHQsCgkJCSBpbnQgcnhmaGluZGly
X3N0YXJ0LCBpbnQgcnhmaGluZGlyX2VxdWFsLAoJCQkgY2hhciAqKnJ4ZmhpbmRpcl93ZWlnaHQs
IHUzMiBudW1fd2VpZ2h0cykKewoJc3RydWN0IGV0aHRvb2xfcnhmaF9pbmRpciBpbmRpcl9oZWFk
OwoJc3RydWN0IGV0aHRvb2xfcnhmaF9pbmRpciAqaW5kaXI7CglpbnQgZXJyOwoKCWluZGlyX2hl
YWQuY21kID0gRVRIVE9PTF9HUlhGSElORElSOwoJaW5kaXJfaGVhZC5zaXplID0gMDsKCWVyciA9
IHNlbmRfaW9jdGwoY3R4LCAmaW5kaXJfaGVhZCk7CglpZiAoZXJyIDwgMCkgewoJCXBlcnJvcigi
Q2Fubm90IGdldCBSWCBmbG93IGhhc2ggaW5kaXJlY3Rpb24gdGFibGUgc2l6ZSIpOwoJCXJldHVy
biAxOwoJfQoKCWluZGlyID0gbWFsbG9jKHNpemVvZigqaW5kaXIpICsKCQkgICAgICAgaW5kaXJf
aGVhZC5zaXplICogc2l6ZW9mKCppbmRpci0+cmluZ19pbmRleCkpOwoKCWlmICghaW5kaXIpIHsK
CQlwZXJyb3IoIkNhbm5vdCBhbGxvY2F0ZSBtZW1vcnkgZm9yIGluZGlyZWN0aW9uIHRhYmxlIik7
CgkJcmV0dXJuIDE7Cgl9CgoJaW5kaXItPmNtZCA9IEVUSFRPT0xfU1JYRkhJTkRJUjsKCWluZGly
LT5zaXplID0gaW5kaXJfaGVhZC5zaXplOwoKCWlmIChmaWxsX2luZGlyX3RhYmxlKCZpbmRpci0+
c2l6ZSwgaW5kaXItPnJpbmdfaW5kZXgsCgkJCSAgICAgcnhmaGluZGlyX2RlZmF1bHQsIHJ4Zmhp
bmRpcl9zdGFydCwKCQkJICAgICByeGZoaW5kaXJfZXF1YWwsIHJ4ZmhpbmRpcl93ZWlnaHQsIG51
bV93ZWlnaHRzKSkgewoJCWZyZWUoaW5kaXIpOwoJCXJldHVybiAxOwoJfQoKCWVyciA9IHNlbmRf
aW9jdGwoY3R4LCBpbmRpcik7CglpZiAoZXJyIDwgMCkgewoJCXBlcnJvcigiQ2Fubm90IHNldCBS
WCBmbG93IGhhc2ggaW5kaXJlY3Rpb24gdGFibGUiKTsKCQlmcmVlKGluZGlyKTsKCQlyZXR1cm4g
MTsKCX0KCglmcmVlKGluZGlyKTsKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRvX3NyeGZoKHN0
cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7CglzdHJ1Y3QgZXRodG9vbF9yeGZoIHJzc19oZWFkID0g
ezB9OwoJc3RydWN0IGV0aHRvb2xfcnhmaCAqcnNzID0gTlVMTDsKCXN0cnVjdCBldGh0b29sX3J4
bmZjIHJpbmdfY291bnQ7CglpbnQgcnhmaGluZGlyX2VxdWFsID0gMCwgcnhmaGluZGlyX2RlZmF1
bHQgPSAwLCByeGZoaW5kaXJfc3RhcnQgPSAwOwoJc3RydWN0IGV0aHRvb2xfZ3N0cmluZ3MgKmhm
dW5jcyA9IE5VTEw7CgljaGFyICoqcnhmaGluZGlyX3dlaWdodCA9IE5VTEw7CgljaGFyICpyeGZo
aW5kaXJfa2V5ID0gTlVMTDsKCWNoYXIgKnJlcV9oZnVuY19uYW1lID0gTlVMTDsKCWNoYXIgKmhm
dW5jX25hbWUgPSBOVUxMOwoJY2hhciAqaGtleSA9IE5VTEw7CglpbnQgZXJyID0gMDsKCXVuc2ln
bmVkIGludCBpOwoJdTMyIGFyZ19udW0gPSAwLCBpbmRpcl9ieXRlcyA9IDA7Cgl1MzIgcmVxX2hm
dW5jID0gMDsKCXUzMiBlbnRyeV9zaXplID0gc2l6ZW9mKHJzc19oZWFkLnJzc19jb25maWdbMF0p
OwoJdTMyIG51bV93ZWlnaHRzID0gMDsKCXUzMiByc3NfY29udGV4dCA9IDA7CglpbnQgZGVsZXRl
ID0gMDsKCglpZiAoY3R4LT5hcmdjIDwgMSkKCQlleGl0X2JhZF9hcmdzKCk7CgoJd2hpbGUgKGFy
Z19udW0gPCBjdHgtPmFyZ2MpIHsKCQlpZiAoIXN0cmNtcChjdHgtPmFyZ3BbYXJnX251bV0sICJl
cXVhbCIpKSB7CgkJCSsrYXJnX251bTsKCQkJcnhmaGluZGlyX2VxdWFsID0gZ2V0X2ludF9yYW5n
ZShjdHgtPmFyZ3BbYXJnX251bV0sCgkJCQkJCQkwLCAxLCBJTlRfTUFYKTsKCQkJKythcmdfbnVt
OwoJCX0gZWxzZSBpZiAoIXN0cmNtcChjdHgtPmFyZ3BbYXJnX251bV0sICJzdGFydCIpKSB7CgkJ
CSsrYXJnX251bTsKCQkJcnhmaGluZGlyX3N0YXJ0ID0gZ2V0X2ludF9yYW5nZShjdHgtPmFyZ3Bb
YXJnX251bV0sCgkJCQkJCQkwLCAwLCBJTlRfTUFYKTsKCQkJKythcmdfbnVtOwoJCX0gZWxzZSBp
ZiAoIXN0cmNtcChjdHgtPmFyZ3BbYXJnX251bV0sICJ3ZWlnaHQiKSkgewoJCQkrK2FyZ19udW07
CgkJCXJ4ZmhpbmRpcl93ZWlnaHQgPSBjdHgtPmFyZ3AgKyBhcmdfbnVtOwoJCQl3aGlsZSAoYXJn
X251bSA8IGN0eC0+YXJnYyAmJgoJCQkgICAgICAgaXNkaWdpdCgodW5zaWduZWQgY2hhciljdHgt
PmFyZ3BbYXJnX251bV1bMF0pKSB7CgkJCQkrK2FyZ19udW07CgkJCQkrK251bV93ZWlnaHRzOwoJ
CQl9CgkJCWlmICghbnVtX3dlaWdodHMpCgkJCQlleGl0X2JhZF9hcmdzKCk7CgkJfSBlbHNlIGlm
ICghc3RyY21wKGN0eC0+YXJncFthcmdfbnVtXSwgImhrZXkiKSkgewoJCQkrK2FyZ19udW07CgkJ
CXJ4ZmhpbmRpcl9rZXkgPSBjdHgtPmFyZ3BbYXJnX251bV07CgkJCWlmICghcnhmaGluZGlyX2tl
eSkKCQkJCWV4aXRfYmFkX2FyZ3MoKTsKCQkJKythcmdfbnVtOwoJCX0gZWxzZSBpZiAoIXN0cmNt
cChjdHgtPmFyZ3BbYXJnX251bV0sICJkZWZhdWx0IikpIHsKCQkJKythcmdfbnVtOwoJCQlyeGZo
aW5kaXJfZGVmYXVsdCA9IDE7CgkJfSBlbHNlIGlmICghc3RyY21wKGN0eC0+YXJncFthcmdfbnVt
XSwgImhmdW5jIikpIHsKCQkJKythcmdfbnVtOwoJCQlyZXFfaGZ1bmNfbmFtZSA9IGN0eC0+YXJn
cFthcmdfbnVtXTsKCQkJaWYgKCFyZXFfaGZ1bmNfbmFtZSkKCQkJCWV4aXRfYmFkX2FyZ3MoKTsK
CQkJKythcmdfbnVtOwoJCX0gZWxzZSBpZiAoIXN0cmNtcChjdHgtPmFyZ3BbYXJnX251bV0sICJj
b250ZXh0IikpIHsKCQkJKythcmdfbnVtOwoJCQlpZighc3RyY21wKGN0eC0+YXJncFthcmdfbnVt
XSwgIm5ldyIpKQoJCQkJcnNzX2NvbnRleHQgPSBFVEhfUlhGSF9DT05URVhUX0FMTE9DOwoJCQll
bHNlCgkJCQlyc3NfY29udGV4dCA9IGdldF9pbnRfcmFuZ2UoCgkJCQkJCWN0eC0+YXJncFthcmdf
bnVtXSwgMCwgMSwKCQkJCQkJRVRIX1JYRkhfQ09OVEVYVF9BTExPQyAtIDEpOwoJCQkrK2FyZ19u
dW07CgkJfSBlbHNlIGlmICghc3RyY21wKGN0eC0+YXJncFthcmdfbnVtXSwgImRlbGV0ZSIpKSB7
CgkJCSsrYXJnX251bTsKCQkJZGVsZXRlID0gMTsKCQl9IGVsc2UgewoJCQlleGl0X2JhZF9hcmdz
KCk7CgkJfQoJfQoKCWlmIChyeGZoaW5kaXJfZXF1YWwgJiYgcnhmaGluZGlyX3dlaWdodCkgewoJ
CWZwcmludGYoc3RkZXJyLAoJCQkiRXF1YWwgYW5kIHdlaWdodCBvcHRpb25zIGFyZSBtdXR1YWxs
eSBleGNsdXNpdmVcbiIpOwoJCXJldHVybiAxOwoJfQoKCWlmIChyeGZoaW5kaXJfZXF1YWwgJiYg
cnhmaGluZGlyX2RlZmF1bHQpIHsKCQlmcHJpbnRmKHN0ZGVyciwKCQkJIkVxdWFsIGFuZCBkZWZh
dWx0IG9wdGlvbnMgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZVxuIik7CgkJcmV0dXJuIDE7Cgl9CgoJ
aWYgKHJ4ZmhpbmRpcl93ZWlnaHQgJiYgcnhmaGluZGlyX2RlZmF1bHQpIHsKCQlmcHJpbnRmKHN0
ZGVyciwKCQkJIldlaWdodCBhbmQgZGVmYXVsdCBvcHRpb25zIGFyZSBtdXR1YWxseSBleGNsdXNp
dmVcbiIpOwoJCXJldHVybiAxOwoJfQoKCWlmIChyeGZoaW5kaXJfc3RhcnQgJiYgcnhmaGluZGly
X2RlZmF1bHQpIHsKCQlmcHJpbnRmKHN0ZGVyciwKCQkJIlN0YXJ0IGFuZCBkZWZhdWx0IG9wdGlv
bnMgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZVxuIik7CgkJcmV0dXJuIDE7Cgl9CgoJaWYgKHJ4Zmhp
bmRpcl9zdGFydCAmJiAhKHJ4ZmhpbmRpcl9lcXVhbCB8fCByeGZoaW5kaXJfd2VpZ2h0KSkgewoJ
CWZwcmludGYoc3RkZXJyLAoJCQkiU3RhcnQgbXVzdCBiZSB1c2VkIHdpdGggZXF1YWwgb3Igd2Vp
Z2h0IG9wdGlvbnNcbiIpOwoJCXJldHVybiAxOwoJfQoKCWlmIChyeGZoaW5kaXJfZGVmYXVsdCAm
JiByc3NfY29udGV4dCkgewoJCWZwcmludGYoc3RkZXJyLAoJCQkiRGVmYXVsdCBhbmQgY29udGV4
dCBvcHRpb25zIGFyZSBtdXR1YWxseSBleGNsdXNpdmVcbiIpOwoJCXJldHVybiAxOwoJfQoKCWlm
IChkZWxldGUgJiYgIXJzc19jb250ZXh0KSB7CgkJZnByaW50ZihzdGRlcnIsICJEZWxldGUgb3B0
aW9uIHJlcXVpcmVzIGNvbnRleHQgb3B0aW9uXG4iKTsKCQlyZXR1cm4gMTsKCX0KCglpZiAoZGVs
ZXRlICYmIHJ4ZmhpbmRpcl93ZWlnaHQpIHsKCQlmcHJpbnRmKHN0ZGVyciwKCQkJIkRlbGV0ZSBh
bmQgd2VpZ2h0IG9wdGlvbnMgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZVxuIik7CgkJcmV0dXJuIDE7
Cgl9CgoJaWYgKGRlbGV0ZSAmJiByeGZoaW5kaXJfZXF1YWwpIHsKCQlmcHJpbnRmKHN0ZGVyciwK
CQkJIkRlbGV0ZSBhbmQgZXF1YWwgb3B0aW9ucyBhcmUgbXV0dWFsbHkgZXhjbHVzaXZlXG4iKTsK
CQlyZXR1cm4gMTsKCX0KCglpZiAoZGVsZXRlICYmIHJ4ZmhpbmRpcl9kZWZhdWx0KSB7CgkJZnBy
aW50ZihzdGRlcnIsCgkJCSJEZWxldGUgYW5kIGRlZmF1bHQgb3B0aW9ucyBhcmUgbXV0dWFsbHkg
ZXhjbHVzaXZlXG4iKTsKCQlyZXR1cm4gMTsKCX0KCglpZiAoZGVsZXRlICYmIHJ4ZmhpbmRpcl9r
ZXkpIHsKCQlmcHJpbnRmKHN0ZGVyciwKCQkJIkRlbGV0ZSBhbmQgaGtleSBvcHRpb25zIGFyZSBt
dXR1YWxseSBleGNsdXNpdmVcbiIpOwoJCXJldHVybiAxOwoJfQoKCXJpbmdfY291bnQuY21kID0g
RVRIVE9PTF9HUlhSSU5HUzsKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmcmluZ19jb3VudCk7Cglp
ZiAoZXJyIDwgMCkgewoJCXBlcnJvcigiQ2Fubm90IGdldCBSWCByaW5nIGNvdW50Iik7CgkJcmV0
dXJuIDE7Cgl9CgoJcnNzX2hlYWQuY21kID0gRVRIVE9PTF9HUlNTSDsKCWVyciA9IHNlbmRfaW9j
dGwoY3R4LCAmcnNzX2hlYWQpOwoJaWYgKGVyciA8IDAgJiYgZXJybm8gPT0gRU9QTk9UU1VQUCAm
JiAhcnhmaGluZGlyX2tleSAmJgoJICAgICFyZXFfaGZ1bmNfbmFtZSAmJiAhcnNzX2NvbnRleHQp
IHsKCQlyZXR1cm4gZG9fc3J4ZmhpbmRpcihjdHgsIHJ4ZmhpbmRpcl9kZWZhdWx0LCByeGZoaW5k
aXJfc3RhcnQsCgkJCQkgICAgIHJ4ZmhpbmRpcl9lcXVhbCwgcnhmaGluZGlyX3dlaWdodCwKCQkJ
CSAgICAgbnVtX3dlaWdodHMpOwoJfSBlbHNlIGlmIChlcnIgPCAwKSB7CgkJcGVycm9yKCJDYW5u
b3QgZ2V0IFJYIGZsb3cgaGFzaCBpbmRpciBzaXplIGFuZCBrZXkgc2l6ZSIpOwoJCXJldHVybiAx
OwoJfQoKCWlmIChyeGZoaW5kaXJfa2V5KSB7CgkJZXJyID0gcGFyc2VfaGtleSgmaGtleSwgcnNz
X2hlYWQua2V5X3NpemUsCgkJCQkgcnhmaGluZGlyX2tleSk7CgkJaWYgKGVycikKCQkJcmV0dXJu
IGVycjsKCX0KCglpZiAocnhmaGluZGlyX2VxdWFsIHx8IHJ4ZmhpbmRpcl93ZWlnaHQpCgkJaW5k
aXJfYnl0ZXMgPSByc3NfaGVhZC5pbmRpcl9zaXplICogZW50cnlfc2l6ZTsKCglpZiAocnNzX2hl
YWQuaGZ1bmMgJiYgcmVxX2hmdW5jX25hbWUpIHsKCQloZnVuY3MgPSBnZXRfc3RyaW5nc2V0KGN0
eCwgRVRIX1NTX1JTU19IQVNIX0ZVTkNTLCAwLCAxKTsKCQlpZiAoIWhmdW5jcykgewoJCQlwZXJy
b3IoIkNhbm5vdCBnZXQgaGFzaCBmdW5jdGlvbnMgbmFtZXMiKTsKCQkJZXJyID0gMTsKCQkJZ290
byBmcmVlOwoJCX0KCgkJZm9yIChpID0gMDsgaSA8IGhmdW5jcy0+bGVuICYmICFyZXFfaGZ1bmMg
OyBpKyspIHsKCQkJaGZ1bmNfbmFtZSA9IChjaGFyICopKGhmdW5jcy0+ZGF0YSArCgkJCQkJICAg
ICAgaSAqIEVUSF9HU1RSSU5HX0xFTik7CgkJCWlmICghc3RybmNtcChoZnVuY19uYW1lLCByZXFf
aGZ1bmNfbmFtZSwKCQkJCSAgICAgRVRIX0dTVFJJTkdfTEVOKSkKCQkJCXJlcV9oZnVuYyA9ICh1
MzIpMSA8PCBpOwoJCX0KCgkJaWYgKCFyZXFfaGZ1bmMpIHsKCQkJZnByaW50ZihzdGRlcnIsCgkJ
CQkiVW5rbm93biBoYXNoIGZ1bmN0aW9uOiAlc1xuIiwgcmVxX2hmdW5jX25hbWUpOwoJCQllcnIg
PSAxOwoJCQlnb3RvIGZyZWU7CgkJfQoJfQoKCXJzcyA9IGNhbGxvYygxLCBzaXplb2YoKnJzcykg
KyBpbmRpcl9ieXRlcyArIHJzc19oZWFkLmtleV9zaXplKTsKCWlmICghcnNzKSB7CgkJcGVycm9y
KCJDYW5ub3QgYWxsb2NhdGUgbWVtb3J5IGZvciBSWCBmbG93IGhhc2ggY29uZmlnIik7CgkJZXJy
ID0gMTsKCQlnb3RvIGZyZWU7Cgl9Cglyc3MtPmNtZCA9IEVUSFRPT0xfU1JTU0g7Cglyc3MtPnJz
c19jb250ZXh0ID0gcnNzX2NvbnRleHQ7Cglyc3MtPmhmdW5jID0gcmVxX2hmdW5jOwoJaWYgKGRl
bGV0ZSkgewoJCXJzcy0+aW5kaXJfc2l6ZSA9IHJzcy0+a2V5X3NpemUgPSAwOwoJfSBlbHNlIHsK
CQlyc3MtPmluZGlyX3NpemUgPSByc3NfaGVhZC5pbmRpcl9zaXplOwoJCXJzcy0+a2V5X3NpemUg
PSByc3NfaGVhZC5rZXlfc2l6ZTsKCQlpZiAoZmlsbF9pbmRpcl90YWJsZSgmcnNzLT5pbmRpcl9z
aXplLCByc3MtPnJzc19jb25maWcsCgkJCQkgICAgIHJ4ZmhpbmRpcl9kZWZhdWx0LCByeGZoaW5k
aXJfc3RhcnQsCgkJCQkgICAgIHJ4ZmhpbmRpcl9lcXVhbCwgcnhmaGluZGlyX3dlaWdodCwKCQkJ
CSAgICAgbnVtX3dlaWdodHMpKSB7CgkJCWVyciA9IDE7CgkJCWdvdG8gZnJlZTsKCQl9Cgl9CgoJ
aWYgKGhrZXkpCgkJbWVtY3B5KChjaGFyICopcnNzLT5yc3NfY29uZmlnICsgaW5kaXJfYnl0ZXMs
CgkJICAgICAgIGhrZXksIHJzcy0+a2V5X3NpemUpOwoJZWxzZQoJCXJzcy0+a2V5X3NpemUgPSAw
OwoKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCByc3MpOwoJaWYgKGVyciA8IDApIHsKCQlwZXJyb3Io
IkNhbm5vdCBzZXQgUlggZmxvdyBoYXNoIGNvbmZpZ3VyYXRpb24iKTsKCQllcnIgPSAxOwoJfSBl
bHNlIGlmIChyc3NfY29udGV4dCA9PSBFVEhfUlhGSF9DT05URVhUX0FMTE9DKSB7CgkJcHJpbnRm
KCJOZXcgUlNTIGNvbnRleHQgaXMgJWRcbiIsIHJzcy0+cnNzX2NvbnRleHQpOwoJfQoKZnJlZToK
CWZyZWUoaGtleSk7CglmcmVlKHJzcyk7CglmcmVlKGhmdW5jcyk7CglyZXR1cm4gZXJyOwp9Cgpz
dGF0aWMgaW50IGRvX2ZsYXNoKHN0cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7CgljaGFyICpmbGFz
aF9maWxlOwoJaW50IGZsYXNoX3JlZ2lvbjsKCXN0cnVjdCBldGh0b29sX2ZsYXNoIGVmbDsKCWlu
dCBlcnI7CgoJaWYgKGN0eC0+YXJnYyA8IDEgfHwgY3R4LT5hcmdjID4gMikKCQlleGl0X2JhZF9h
cmdzKCk7CglmbGFzaF9maWxlID0gY3R4LT5hcmdwWzBdOwoJaWYgKGN0eC0+YXJnYyA9PSAyKSB7
CgkJZmxhc2hfcmVnaW9uID0gc3RydG9sKGN0eC0+YXJncFsxXSwgTlVMTCwgMCk7CgkJaWYgKGZs
YXNoX3JlZ2lvbiA8IDApCgkJCWV4aXRfYmFkX2FyZ3MoKTsKCX0gZWxzZSB7CgkJZmxhc2hfcmVn
aW9uID0gLTE7Cgl9CgoJaWYgKHN0cmxlbihmbGFzaF9maWxlKSA+IEVUSFRPT0xfRkxBU0hfTUFY
X0ZJTEVOQU1FIC0gMSkgewoJCWZwcmludGYoc3Rkb3V0LCAiRmlsZW5hbWUgdG9vIGxvbmdcbiIp
OwoJCXJldHVybiA5OTsKCX0KCgllZmwuY21kID0gRVRIVE9PTF9GTEFTSERFVjsKCXN0cmNweShl
ZmwuZGF0YSwgZmxhc2hfZmlsZSk7CgoJaWYgKGZsYXNoX3JlZ2lvbiA8IDApCgkJZWZsLnJlZ2lv
biA9IEVUSFRPT0xfRkxBU0hfQUxMX1JFR0lPTlM7CgllbHNlCgkJZWZsLnJlZ2lvbiA9IGZsYXNo
X3JlZ2lvbjsKCgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJmVmbCk7CglpZiAoZXJyIDwgMCkKCQlw
ZXJyb3IoIkZsYXNoaW5nIGZhaWxlZCIpOwoKCXJldHVybiBlcnI7Cn0KCnN0YXRpYyBpbnQgZG9f
cGVybWFkZHIoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgpCnsKCXVuc2lnbmVkIGludCBpOwoJaW50
IGVycjsKCXN0cnVjdCBldGh0b29sX3Blcm1fYWRkciAqZXBhZGRyOwoKCWVwYWRkciA9IG1hbGxv
YyhzaXplb2Yoc3RydWN0IGV0aHRvb2xfcGVybV9hZGRyKSArIE1BWF9BRERSX0xFTik7CglpZiAo
IWVwYWRkcikgewoJCXBlcnJvcigiQ2Fubm90IGFsbG9jYXRlIG1lbW9yeSBmb3Igb3BlcmF0aW9u
Iik7CgkJcmV0dXJuIDE7Cgl9CgoJZXBhZGRyLT5jbWQgPSBFVEhUT09MX0dQRVJNQUREUjsKCWVw
YWRkci0+c2l6ZSA9IE1BWF9BRERSX0xFTjsKCgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgZXBhZGRy
KTsKCWlmIChlcnIgPCAwKQoJCXBlcnJvcigiQ2Fubm90IHJlYWQgcGVybWFuZW50IGFkZHJlc3Mi
KTsKCWVsc2UgewoJCXByaW50ZigiUGVybWFuZW50IGFkZHJlc3M6Iik7CgkJZm9yIChpID0gMDsg
aSA8IGVwYWRkci0+c2l6ZTsgaSsrKQoJCQlwcmludGYoIiVjJTAyeCIsIChpID09IDApID8gJyAn
IDogJzonLAoJCQkgICAgICAgZXBhZGRyLT5kYXRhW2ldKTsKCQlwcmludGYoIlxuIik7Cgl9Cglm
cmVlKGVwYWRkcik7CgoJcmV0dXJuIGVycjsKfQoKc3RhdGljIGJvb2wgZmxvd190eXBlX2lzX250
dXBsZV9zdXBwb3J0ZWQoX191MzIgZmxvd190eXBlKQp7Cglzd2l0Y2ggKGZsb3dfdHlwZSkgewoJ
Y2FzZSBUQ1BfVjRfRkxPVzoKCWNhc2UgVURQX1Y0X0ZMT1c6CgljYXNlIFNDVFBfVjRfRkxPVzoK
CWNhc2UgQUhfVjRfRkxPVzoKCWNhc2UgRVNQX1Y0X0ZMT1c6CgljYXNlIElQVjRfVVNFUl9GTE9X
OgoJY2FzZSBFVEhFUl9GTE9XOgoJCXJldHVybiB0cnVlOwoJZGVmYXVsdDoKCQlyZXR1cm4gZmFs
c2U7Cgl9Cn0KCnN0YXRpYyBpbnQgZmxvd19zcGVjX3RvX250dXBsZShzdHJ1Y3QgZXRodG9vbF9y
eF9mbG93X3NwZWMgKmZzcCwKCQkJICAgICAgIHN0cnVjdCBldGh0b29sX3J4X250dXBsZV9mbG93
X3NwZWMgKm50dXBsZSkKewoJc2l6ZV90IGk7CgoJLyogdmVyaWZ5IGxvY2F0aW9uIGlzIG5vdCBz
cGVjaWZpZWQgKi8KCWlmIChmc3AtPmxvY2F0aW9uICE9IFJYX0NMU19MT0NfQU5ZKQoJCXJldHVy
biAtMTsKCgkvKiBkZXN0aW5hdGlvbiBNQUMgYWRkcmVzcyBpbiBMMy9MNCBydWxlcyBpcyBub3Qg
c3VwcG9ydGVkIGJ5IG50dXBsZSAqLwoJaWYgKGZzcC0+Zmxvd190eXBlICYgRkxPV19NQUNfRVhU
KQoJCXJldHVybiAtMTsKCgkvKiB2ZXJpZnkgcmluZyBjb29raWUgY2FuIHRyYW5zZmVyIHRvIGFj
dGlvbiAqLwoJaWYgKGZzcC0+cmluZ19jb29raWUgPiBJTlRfTUFYICYmIGZzcC0+cmluZ19jb29r
aWUgPCAodTY0KSgtMikpCgkJcmV0dXJuIC0xOwoKCS8qIHZlcmlmeSBvbmx5IG9uZSBmaWVsZCBp
cyBzZXR0aW5nIGRhdGEgZmllbGQgKi8KCWlmICgoZnNwLT5mbG93X3R5cGUgJiBGTE9XX0VYVCkg
JiYKCSAgICAoZnNwLT5tX2V4dC5kYXRhWzBdIHx8IGZzcC0+bV9leHQuZGF0YVsxXSkgJiYKCSAg
ICBmc3AtPm1fZXh0LnZsYW5fZXR5cGUpCgkJcmV0dXJuIC0xOwoKCS8qIElQdjYgZmxvdyB0eXBl
cyBhcmUgbm90IHN1cHBvcnRlZCBieSBudHVwbGUgKi8KCWlmICghZmxvd190eXBlX2lzX250dXBs
ZV9zdXBwb3J0ZWQoZnNwLT5mbG93X3R5cGUgJiB+RkxPV19FWFQpKQoJCXJldHVybiAtMTsKCgkv
KiBTZXQgZW50aXJlIG50dXBsZSB0byB+MCB0byBndWFyYW50ZWUgYWxsIG1hc2tzIGFyZSBzZXQg
Ki8KCW1lbXNldChudHVwbGUsIH4wLCBzaXplb2YoKm50dXBsZSkpOwoKCS8qIHNldCBub24tZmls
dGVyIHZhbHVlcyAqLwoJbnR1cGxlLT5mbG93X3R5cGUgPSBmc3AtPmZsb3dfdHlwZTsKCW50dXBs
ZS0+YWN0aW9uID0gZnNwLT5yaW5nX2Nvb2tpZTsKCgkvKgoJICogQ29weSBvdmVyIGhlYWRlciB1
bmlvbiwgdGhleSBhcmUgaWRlbnRpY2FsIGluIGxheW91dCBob3dldmVyCgkgKiB0aGUgbnR1cGxl
IHVuaW9uIGNvbnRhaW5zIGFkZGl0aW9uYWwgcGFkZGluZyBvbiB0aGUgZW5kCgkgKi8KCW1lbWNw
eSgmbnR1cGxlLT5oX3UsICZmc3AtPmhfdSwgc2l6ZW9mKGZzcC0+aF91KSk7CgoJLyoKCSAqIFRo
ZSBzYW1lIHJ1bGUgbWVudGlvbmVkIGFib3ZlIGFwcGxpZXMgdG8gdGhlIG1hc2sgdW5pb24uICBI
b3dldmVyLAoJICogaW4gYWRkaXRpb24gd2UgbmVlZCB0byBpbnZlcnQgdGhlIG1hc2sgYml0cyB0
byBtYXRjaCB0aGUgbnR1cGxlCgkgKiBtYXNrIHdoaWNoIGlzIDEgZm9yIG1hc2tlZCwgdmVyc3Vz
IDAgZm9yIG1hc2tlZCBhcyBzZWVuIGluIG5mYy4KCSAqLwoJbWVtY3B5KCZudHVwbGUtPm1fdSwg
JmZzcC0+bV91LCBzaXplb2YoZnNwLT5tX3UpKTsKCWZvciAoaSA9IDA7IGkgPCBzaXplb2YoZnNw
LT5tX3UpOyBpKyspCgkJbnR1cGxlLT5tX3UuaGRhdGFbaV0gXj0gMHhGRjsKCgkvKiBjb3B5IGV4
dGVuZGVkIGZpZWxkcyAqLwoJaWYgKGZzcC0+Zmxvd190eXBlICYgRkxPV19FWFQpIHsKCQludHVw
bGUtPnZsYW5fdGFnID0KCQkJbnRvaHMoZnNwLT5oX2V4dC52bGFuX3RjaSk7CgkJbnR1cGxlLT52
bGFuX3RhZ19tYXNrID0KCQkJfm50b2hzKGZzcC0+bV9leHQudmxhbl90Y2kpOwoJCWlmIChmc3At
Pm1fZXh0LnZsYW5fZXR5cGUpIHsKCQkJLyoKCQkJICogdmxhbl9ldHlwZSBhbmQgdXNlciBkYXRh
IGFyZSBtdXR1YWxseSBleGNsdXNpdmUKCQkJICogaW4gbnR1cGxlIGNvbmZpZ3VyYXRpb24gYXMg
dGhleSBvY2N1cHkgdGhlIHNhbWUKCQkJICogc3BhY2UuCgkJCSAqLwoJCQlpZiAoZnNwLT5tX2V4
dC5kYXRhWzBdIHx8IGZzcC0+bV9leHQuZGF0YVsxXSkKCQkJCXJldHVybiAtMTsKCQkJbnR1cGxl
LT5kYXRhID0KCQkJCW50b2hsKGZzcC0+aF9leHQudmxhbl9ldHlwZSk7CgkJCW50dXBsZS0+ZGF0
YV9tYXNrID0KCQkJCX4odTY0KW50b2hsKGZzcC0+bV9leHQudmxhbl9ldHlwZSk7CgkJfSBlbHNl
IHsKCQkJbnR1cGxlLT5kYXRhID0KCQkJCSh1NjQpbnRvaGwoZnNwLT5oX2V4dC5kYXRhWzBdKSA8
PCAzMjsKCQkJbnR1cGxlLT5kYXRhIHw9CgkJCQkodTY0KW50b2hsKGZzcC0+aF9leHQuZGF0YVsx
XSk7CgkJCW50dXBsZS0+ZGF0YV9tYXNrID0KCQkJCSh1NjQpbnRvaGwofmZzcC0+bV9leHQuZGF0
YVswXSkgPDwgMzI7CgkJCW50dXBsZS0+ZGF0YV9tYXNrIHw9CgkJCQkodTY0KW50b2hsKH5mc3At
Pm1fZXh0LmRhdGFbMV0pOwoJCX0KCX0KCgkvKiBNYXNrIG91dCB0aGUgZXh0ZW5kZWQgYml0LCBi
ZWNhdXNlIG50dXBsZSBkb2VzIG5vdCBrbm93IGl0ISAqLwoJbnR1cGxlLT5mbG93X3R5cGUgJj0g
fkZMT1dfRVhUOwoKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRvX3NyeG50dXBsZShzdHJ1Y3Qg
Y21kX2NvbnRleHQgKmN0eCwKCQkJc3RydWN0IGV0aHRvb2xfcnhfZmxvd19zcGVjICpyeF9ydWxl
X2ZzKQp7CglzdHJ1Y3QgZXRodG9vbF9yeF9udHVwbGUgbnR1cGxlY21kOwoJc3RydWN0IGV0aHRv
b2xfdmFsdWUgZXZhbDsKCWludCBlcnI7CgoJLyogYXR0ZW1wdCB0byBjb252ZXJ0IHRoZSBmbG93
IGNsYXNzaWZpZXIgdG8gYW4gbnR1cGxlIGNsYXNzaWZpZXIgKi8KCWVyciA9IGZsb3dfc3BlY190
b19udHVwbGUocnhfcnVsZV9mcywgJm50dXBsZWNtZC5mcyk7CglpZiAoZXJyKQoJCXJldHVybiAt
MTsKCgkvKgoJICogQ2hlY2sgdG8gc2VlIGlmIHRoZSBmbGFnIGlzIHNldCBmb3IgTi10dXBsZSwg
dGhpcyBhbGxvd3MKCSAqIHVzIHRvIGF2b2lkIHRoZSBwb3NzaWJsZSBFSU5WQUwgcmVzcG9uc2Ug
Zm9yIHRoZSBOLXR1cGxlCgkgKiBmbGFnIG5vdCBiZWluZyBzZXQgb24gdGhlIGRldmljZQoJICov
CglldmFsLmNtZCA9IEVUSFRPT0xfR0ZMQUdTOwoJZXJyID0gc2VuZF9pb2N0bChjdHgsICZldmFs
KTsKCWlmIChlcnIgfHwgIShldmFsLmRhdGEgJiBFVEhfRkxBR19OVFVQTEUpKQoJCXJldHVybiAt
MTsKCgkvKiBzZW5kIHJ1bGUgdmlhIE4tdHVwbGUgKi8KCW50dXBsZWNtZC5jbWQgPSBFVEhUT09M
X1NSWE5UVVBMRTsKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmbnR1cGxlY21kKTsKCgkvKgoJICog
RGlzcGxheSBlcnJvciBvbmx5IGlmIHJlc3BvbnNlIGlzIHNvbWV0aGluZyBvdGhlciB0aGFuIG9w
IG5vdAoJICogc3VwcG9ydGVkLiAgSXQgaXMgcG9zc2libGUgdGhhdCB0aGUgaW50ZXJmYWNlIHVz
ZXMgdGhlIG5ldHdvcmsKCSAqIGZsb3cgY2xhc3NpZmllciBpbnRlcmZhY2UgaW5zdGVhZCBvZiBO
LXR1cGxlLgoJICovCglpZiAoZXJyIDwgMCkgewoJCWlmIChlcnJubyAhPSBFT1BOT1RTVVBQKQoJ
CQlwZXJyb3IoIkNhbm5vdCBhZGQgbmV3IHJ1bGUgdmlhIE4tdHVwbGUiKTsKCQlyZXR1cm4gLTE7
Cgl9CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgZG9fd3JpdGVmd2R1bXAoc3RydWN0IGV0aHRv
b2xfZHVtcCAqZHVtcCwgY29uc3QgY2hhciAqZHVtcF9maWxlKQp7CglpbnQgZXJyID0gMDsKCUZJ
TEUgKmY7CglzaXplX3QgYnl0ZXM7CgoJZiA9IGZvcGVuKGR1bXBfZmlsZSwgIndiKyIpOwoKCWlm
ICghZikgewoJCWZwcmludGYoc3RkZXJyLCAiQ2FuJ3Qgb3BlbiBmaWxlICVzOiAlc1xuIiwKCQkJ
ZHVtcF9maWxlLCBzdHJlcnJvcihlcnJubykpOwoJCXJldHVybiAxOwoJfQoJYnl0ZXMgPSBmd3Jp
dGUoZHVtcC0+ZGF0YSwgMSwgZHVtcC0+bGVuLCBmKTsKCWlmIChieXRlcyAhPSBkdW1wLT5sZW4p
IHsKCQlmcHJpbnRmKHN0ZGVyciwgIkNhbiBub3Qgd3JpdGUgYWxsIG9mIGR1bXAgZGF0YVxuIik7
CgkJZXJyID0gMTsKCX0KCWlmIChmY2xvc2UoZikpIHsKCQlmcHJpbnRmKHN0ZGVyciwgIkNhbid0
IGNsb3NlIGZpbGUgJXM6ICVzXG4iLAoJCQlkdW1wX2ZpbGUsIHN0cmVycm9yKGVycm5vKSk7CgkJ
ZXJyID0gMTsKCX0KCXJldHVybiBlcnI7Cn0KCnN0YXRpYyBpbnQgZG9fZ2V0ZndkdW1wKHN0cnVj
dCBjbWRfY29udGV4dCAqY3R4KQp7Cgl1MzIgZHVtcF9mbGFnOwoJY2hhciAqZHVtcF9maWxlOwoJ
aW50IGVycjsKCXN0cnVjdCBldGh0b29sX2R1bXAgZWRhdGE7CglzdHJ1Y3QgZXRodG9vbF9kdW1w
ICpkYXRhOwoKCWlmIChjdHgtPmFyZ2MgPT0gMiAmJiAhc3RyY21wKGN0eC0+YXJncFswXSwgImRh
dGEiKSkgewoJCWR1bXBfZmxhZyA9IEVUSFRPT0xfR0VUX0RVTVBfREFUQTsKCQlkdW1wX2ZpbGUg
PSBjdHgtPmFyZ3BbMV07Cgl9IGVsc2UgaWYgKGN0eC0+YXJnYyA9PSAwKSB7CgkJZHVtcF9mbGFn
ID0gMDsKCQlkdW1wX2ZpbGUgPSBOVUxMOwoJfSBlbHNlIHsKCQlleGl0X2JhZF9hcmdzKCk7Cgl9
CgoJZWRhdGEuY21kID0gRVRIVE9PTF9HRVRfRFVNUF9GTEFHOwoKCWVyciA9IHNlbmRfaW9jdGwo
Y3R4LCAmZWRhdGEpOwoJaWYgKGVyciA8IDApIHsKCQlwZXJyb3IoIkNhbiBub3QgZ2V0IGR1bXAg
bGV2ZWwiKTsKCQlyZXR1cm4gMTsKCX0KCWlmIChkdW1wX2ZsYWcgIT0gRVRIVE9PTF9HRVRfRFVN
UF9EQVRBKSB7CgkJZnByaW50ZihzdGRvdXQsICJmbGFnOiAldSwgdmVyc2lvbjogJXUsIGxlbmd0
aDogJXVcbiIsCgkJCWVkYXRhLmZsYWcsIGVkYXRhLnZlcnNpb24sIGVkYXRhLmxlbik7CgkJcmV0
dXJuIDA7Cgl9CglkYXRhID0gY2FsbG9jKDEsIG9mZnNldG9mKHN0cnVjdCBldGh0b29sX2R1bXAs
IGRhdGEpICsgZWRhdGEubGVuKTsKCWlmICghZGF0YSkgewoJCXBlcnJvcigiQ2FuIG5vdCBhbGxv
Y2F0ZSBlbm91Z2ggbWVtb3J5Iik7CgkJcmV0dXJuIDE7Cgl9CglkYXRhLT5jbWQgPSBFVEhUT09M
X0dFVF9EVU1QX0RBVEE7CglkYXRhLT5sZW4gPSBlZGF0YS5sZW47CgllcnIgPSBzZW5kX2lvY3Rs
KGN0eCwgZGF0YSk7CglpZiAoZXJyIDwgMCkgewoJCXBlcnJvcigiQ2FuIG5vdCBnZXQgZHVtcCBk
YXRhIik7CgkJZXJyID0gMTsKCQlnb3RvIGZyZWU7Cgl9CgllcnIgPSBkb193cml0ZWZ3ZHVtcChk
YXRhLCBkdW1wX2ZpbGUpOwpmcmVlOgoJZnJlZShkYXRhKTsKCXJldHVybiBlcnI7Cn0KCnN0YXRp
YyBpbnQgZG9fc2V0ZndkdW1wKHN0cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7Cgl1MzIgZHVtcF9m
bGFnOwoJaW50IGVycjsKCXN0cnVjdCBldGh0b29sX2R1bXAgZHVtcDsKCglpZiAoY3R4LT5hcmdj
ICE9IDEpCgkJZXhpdF9iYWRfYXJncygpOwoJZHVtcF9mbGFnID0gZ2V0X3UzMihjdHgtPmFyZ3Bb
MF0sIDApOwoKCWR1bXAuY21kID0gRVRIVE9PTF9TRVRfRFVNUDsKCWR1bXAuZmxhZyA9IGR1bXBf
ZmxhZzsKCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmZHVtcCk7CglpZiAoZXJyIDwgMCkgewoJCXBl
cnJvcigiQ2FuIG5vdCBzZXQgZHVtcCBsZXZlbCIpOwoJCXJldHVybiAxOwoJfQoJcmV0dXJuIDA7
Cn0KCnN0YXRpYyBpbnQgZG9fZ3ByaXZmbGFncyhzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJ
c3RydWN0IGV0aHRvb2xfZ3N0cmluZ3MgKnN0cmluZ3M7CglzdHJ1Y3QgZXRodG9vbF92YWx1ZSBm
bGFnczsKCXVuc2lnbmVkIGludCBpOwoJaW50IG1heF9sZW4gPSAwLCBjdXJfbGVuLCByYzsKCglp
ZiAoY3R4LT5hcmdjICE9IDApCgkJZXhpdF9iYWRfYXJncygpOwoKCXN0cmluZ3MgPSBnZXRfc3Ry
aW5nc2V0KGN0eCwgRVRIX1NTX1BSSVZfRkxBR1MsCgkJCQlvZmZzZXRvZihzdHJ1Y3QgZXRodG9v
bF9kcnZpbmZvLCBuX3ByaXZfZmxhZ3MpLAoJCQkJMSk7CglpZiAoIXN0cmluZ3MpIHsKCQlwZXJy
b3IoIkNhbm5vdCBnZXQgcHJpdmF0ZSBmbGFnIG5hbWVzIik7CgkJcmV0dXJuIDE7Cgl9CglpZiAo
c3RyaW5ncy0+bGVuID09IDApIHsKCQlmcHJpbnRmKHN0ZGVyciwgIk5vIHByaXZhdGUgZmxhZ3Mg
ZGVmaW5lZFxuIik7CgkJcmMgPSAxOwoJCWdvdG8gZXJyOwoJfQoJaWYgKHN0cmluZ3MtPmxlbiA+
IDMyKSB7CgkJLyogRVRIVE9PTF9HUEZMQUdTIGNhbiBvbmx5IGNvdmVyIDMyIGZsYWdzICovCgkJ
ZnByaW50ZihzdGRlcnIsICJPbmx5IHNob3dpbmcgZmlyc3QgMzIgcHJpdmF0ZSBmbGFnc1xuIik7
CgkJc3RyaW5ncy0+bGVuID0gMzI7Cgl9CgoJZmxhZ3MuY21kID0gRVRIVE9PTF9HUEZMQUdTOwoJ
aWYgKHNlbmRfaW9jdGwoY3R4LCAmZmxhZ3MpKSB7CgkJcGVycm9yKCJDYW5ub3QgZ2V0IHByaXZh
dGUgZmxhZ3MiKTsKCQlyYyA9IDE7CgkJZ290byBlcnI7Cgl9CgoJLyogRmluZCBsb25nZXN0IHN0
cmluZyBhbmQgYWxpZ24gYWxsIHN0cmluZ3MgYWNjb3JkaW5nbHkgKi8KCWZvciAoaSA9IDA7IGkg
PCBzdHJpbmdzLT5sZW47IGkrKykgewoJCWN1cl9sZW4gPSBzdHJsZW4oKGNvbnN0IGNoYXIgKilz
dHJpbmdzLT5kYXRhICsKCQkJCSBpICogRVRIX0dTVFJJTkdfTEVOKTsKCQlpZiAoY3VyX2xlbiA+
IG1heF9sZW4pCgkJCW1heF9sZW4gPSBjdXJfbGVuOwoJfQoKCXByaW50ZigiUHJpdmF0ZSBmbGFn
cyBmb3IgJXM6XG4iLCBjdHgtPmRldm5hbWUpOwoJZm9yIChpID0gMDsgaSA8IHN0cmluZ3MtPmxl
bjsgaSsrKQoJCXByaW50ZigiJS0qczogJXNcbiIsCgkJICAgICAgIG1heF9sZW4sCgkJICAgICAg
IChjb25zdCBjaGFyICopc3RyaW5ncy0+ZGF0YSArIGkgKiBFVEhfR1NUUklOR19MRU4sCgkJICAg
ICAgIChmbGFncy5kYXRhICYgKDFVIDw8IGkpKSA/ICJvbiIgOiAib2ZmIik7CgoJcmMgPSAwOwoK
ZXJyOgoJZnJlZShzdHJpbmdzKTsKCXJldHVybiByYzsKfQoKc3RhdGljIGludCBkb19zcHJpdmZs
YWdzKHN0cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7CglzdHJ1Y3QgZXRodG9vbF9nc3RyaW5ncyAq
c3RyaW5nczsKCXN0cnVjdCBjbWRsaW5lX2luZm8gKmNtZGxpbmU7CglzdHJ1Y3QgZXRodG9vbF92
YWx1ZSBmbGFnczsKCXUzMiB3YW50ZWRfZmxhZ3MgPSAwLCBzZWVuX2ZsYWdzID0gMDsKCWludCBh
bnlfY2hhbmdlZCwgcmM7Cgl1bnNpZ25lZCBpbnQgaTsKCglzdHJpbmdzID0gZ2V0X3N0cmluZ3Nl
dChjdHgsIEVUSF9TU19QUklWX0ZMQUdTLAoJCQkJb2Zmc2V0b2Yoc3RydWN0IGV0aHRvb2xfZHJ2
aW5mbywgbl9wcml2X2ZsYWdzKSwKCQkJCTEpOwoJaWYgKCFzdHJpbmdzKSB7CgkJcGVycm9yKCJD
YW5ub3QgZ2V0IHByaXZhdGUgZmxhZyBuYW1lcyIpOwoJCXJldHVybiAxOwoJfQoJaWYgKHN0cmlu
Z3MtPmxlbiA9PSAwKSB7CgkJZnByaW50ZihzdGRlcnIsICJObyBwcml2YXRlIGZsYWdzIGRlZmlu
ZWRcbiIpOwoJCXJjID0gMTsKCQlnb3RvIGVycjsKCX0KCWlmIChzdHJpbmdzLT5sZW4gPiAzMikg
ewoJCS8qIEVUSFRPT0xfe0csU31QRkxBR1MgY2FuIG9ubHkgY292ZXIgMzIgZmxhZ3MgKi8KCQlm
cHJpbnRmKHN0ZGVyciwgIk9ubHkgc2V0dGluZyBmaXJzdCAzMiBwcml2YXRlIGZsYWdzXG4iKTsK
CQlzdHJpbmdzLT5sZW4gPSAzMjsKCX0KCgljbWRsaW5lID0gY2FsbG9jKHN0cmluZ3MtPmxlbiwg
c2l6ZW9mKCpjbWRsaW5lKSk7CglpZiAoIWNtZGxpbmUpIHsKCQlwZXJyb3IoIkNhbm5vdCBwYXJz
ZSBhcmd1bWVudHMiKTsKCQlyYyA9IDE7CgkJZ290byBlcnI7Cgl9Cglmb3IgKGkgPSAwOyBpIDwg
c3RyaW5ncy0+bGVuOyBpKyspIHsKCQljbWRsaW5lW2ldLm5hbWUgPSAoKGNvbnN0IGNoYXIgKilz
dHJpbmdzLT5kYXRhICsKCQkJCSAgIGkgKiBFVEhfR1NUUklOR19MRU4pOwoJCWNtZGxpbmVbaV0u
dHlwZSA9IENNRExfRkxBRzsKCQljbWRsaW5lW2ldLndhbnRlZF92YWwgPSAmd2FudGVkX2ZsYWdz
OwoJCWNtZGxpbmVbaV0uZmxhZ192YWwgPSAxVSA8PCBpOwoJCWNtZGxpbmVbaV0uc2Vlbl92YWwg
PSAmc2Vlbl9mbGFnczsKCX0KCXBhcnNlX2dlbmVyaWNfY21kbGluZShjdHgsICZhbnlfY2hhbmdl
ZCwgY21kbGluZSwgc3RyaW5ncy0+bGVuKTsKCWZyZWUoY21kbGluZSk7CgoJZmxhZ3MuY21kID0g
RVRIVE9PTF9HUEZMQUdTOwoJaWYgKHNlbmRfaW9jdGwoY3R4LCAmZmxhZ3MpKSB7CgkJcGVycm9y
KCJDYW5ub3QgZ2V0IHByaXZhdGUgZmxhZ3MiKTsKCQlyYyA9IDE7CgkJZ290byBlcnI7Cgl9CgoJ
ZmxhZ3MuY21kID0gRVRIVE9PTF9TUEZMQUdTOwoJZmxhZ3MuZGF0YSA9IChmbGFncy5kYXRhICYg
fnNlZW5fZmxhZ3MpIHwgd2FudGVkX2ZsYWdzOwoJaWYgKHNlbmRfaW9jdGwoY3R4LCAmZmxhZ3Mp
KSB7CgkJcGVycm9yKCJDYW5ub3Qgc2V0IHByaXZhdGUgZmxhZ3MiKTsKCQlyYyA9IDE7CgkJZ290
byBlcnI7Cgl9CgoJcmMgPSAwOwplcnI6CglmcmVlKHN0cmluZ3MpOwoJcmV0dXJuIHJjOwp9Cgpz
dGF0aWMgaW50IGRvX3RzaW5mbyhzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJc3RydWN0IGV0
aHRvb2xfdHNfaW5mbyBpbmZvOwoKCWlmIChjdHgtPmFyZ2MgIT0gMCkKCQlleGl0X2JhZF9hcmdz
KCk7CgoJZnByaW50ZihzdGRvdXQsICJUaW1lIHN0YW1waW5nIHBhcmFtZXRlcnMgZm9yICVzOlxu
IiwgY3R4LT5kZXZuYW1lKTsKCWluZm8uY21kID0gRVRIVE9PTF9HRVRfVFNfSU5GTzsKCWlmIChz
ZW5kX2lvY3RsKGN0eCwgJmluZm8pKSB7CgkJcGVycm9yKCJDYW5ub3QgZ2V0IGRldmljZSB0aW1l
IHN0YW1waW5nIHNldHRpbmdzIik7CgkJcmV0dXJuIC0xOwoJfQoJZHVtcF90c2luZm8oJmluZm8p
OwoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgZG9fZ2V0bW9kdWxlKHN0cnVjdCBjbWRfY29udGV4
dCAqY3R4KQp7CglzdHJ1Y3QgZXRodG9vbF9tb2RpbmZvIG1vZGluZm87CglzdHJ1Y3QgZXRodG9v
bF9lZXByb20gKmVlcHJvbTsKCXUzMiBnZWVwcm9tX29mZnNldCA9IDA7Cgl1MzIgZ2VlcHJvbV9s
ZW5ndGggPSAwOwoJaW50IGdlZXByb21fY2hhbmdlZCA9IDA7CglpbnQgZ2VlcHJvbV9kdW1wX3Jh
dyA9IDA7CglpbnQgZ2VlcHJvbV9kdW1wX2hleCA9IDA7CglpbnQgZ2VlcHJvbV9sZW5ndGhfc2Vl
biA9IDA7CglpbnQgZXJyOwoKCXN0cnVjdCBjbWRsaW5lX2luZm8gY21kbGluZV9nZWVwcm9tW10g
PSB7CgkJewoJCQkubmFtZQkJPSAib2Zmc2V0IiwKCQkJLnR5cGUJCT0gQ01ETF9VMzIsCgkJCS53
YW50ZWRfdmFsCT0gJmdlZXByb21fb2Zmc2V0LAoJCX0sCgkJewoJCQkubmFtZQkJPSAibGVuZ3Ro
IiwKCQkJLnR5cGUJCT0gQ01ETF9VMzIsCgkJCS53YW50ZWRfdmFsCT0gJmdlZXByb21fbGVuZ3Ro
LAoJCQkuc2Vlbl92YWwJPSAmZ2VlcHJvbV9sZW5ndGhfc2VlbiwKCQl9LAoJCXsKCQkJLm5hbWUJ
CT0gInJhdyIsCgkJCS50eXBlCQk9IENNRExfQk9PTCwKCQkJLndhbnRlZF92YWwJPSAmZ2VlcHJv
bV9kdW1wX3JhdywKCQl9LAoJCXsKCQkJLm5hbWUJCT0gImhleCIsCgkJCS50eXBlCQk9IENNRExf
Qk9PTCwKCQkJLndhbnRlZF92YWwJPSAmZ2VlcHJvbV9kdW1wX2hleCwKCQl9LAoJfTsKCglwYXJz
ZV9nZW5lcmljX2NtZGxpbmUoY3R4LCAmZ2VlcHJvbV9jaGFuZ2VkLAoJCQkgICAgICBjbWRsaW5l
X2dlZXByb20sIEFSUkFZX1NJWkUoY21kbGluZV9nZWVwcm9tKSk7CgoJaWYgKGdlZXByb21fZHVt
cF9yYXcgJiYgZ2VlcHJvbV9kdW1wX2hleCkgewoJCXByaW50ZigiSGV4IGFuZCByYXcgZHVtcCBj
YW5ub3QgYmUgc3BlY2lmaWVkIHRvZ2V0aGVyXG4iKTsKCQlyZXR1cm4gMTsKCX0KCgltb2RpbmZv
LmNtZCA9IEVUSFRPT0xfR01PRFVMRUlORk87CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgJm1vZGlu
Zm8pOwoJaWYgKGVyciA8IDApIHsKCQlwZXJyb3IoIkNhbm5vdCBnZXQgbW9kdWxlIEVFUFJPTSBp
bmZvcm1hdGlvbiIpOwoJCXJldHVybiAxOwoJfQoKCWlmICghZ2VlcHJvbV9sZW5ndGhfc2VlbikK
CQlnZWVwcm9tX2xlbmd0aCA9IG1vZGluZm8uZWVwcm9tX2xlbjsKCglpZiAobW9kaW5mby5lZXBy
b21fbGVuIDwgZ2VlcHJvbV9vZmZzZXQgKyBnZWVwcm9tX2xlbmd0aCkKCQlnZWVwcm9tX2xlbmd0
aCA9IG1vZGluZm8uZWVwcm9tX2xlbiAtIGdlZXByb21fb2Zmc2V0OwoKCWVlcHJvbSA9IGNhbGxv
YygxLCBzaXplb2YoKmVlcHJvbSkrZ2VlcHJvbV9sZW5ndGgpOwoJaWYgKCFlZXByb20pIHsKCQlw
ZXJyb3IoIkNhbm5vdCBhbGxvY2F0ZSBtZW1vcnkgZm9yIE1vZHVsZSBFRVBST00gZGF0YSIpOwoJ
CXJldHVybiAxOwoJfQoKCWVlcHJvbS0+Y21kID0gRVRIVE9PTF9HTU9EVUxFRUVQUk9NOwoJZWVw
cm9tLT5sZW4gPSBnZWVwcm9tX2xlbmd0aDsKCWVlcHJvbS0+b2Zmc2V0ID0gZ2VlcHJvbV9vZmZz
ZXQ7CgllcnIgPSBzZW5kX2lvY3RsKGN0eCwgZWVwcm9tKTsKCWlmIChlcnIgPCAwKSB7CgkJaW50
IHNhdmVkX2Vycm5vID0gZXJybm87CgoJCXBlcnJvcigiQ2Fubm90IGdldCBNb2R1bGUgRUVQUk9N
IGRhdGEiKTsKCQlpZiAoc2F2ZWRfZXJybm8gPT0gRU5PREVWIHx8IHNhdmVkX2Vycm5vID09IEVJ
TyB8fAoJCSAgICBzYXZlZF9lcnJubyA9PSBFTlhJTykKCQkJZnByaW50ZihzdGRlcnIsICJTRlAg
bW9kdWxlIG5vdCBpbiBjYWdlP1xuIik7CgkJZnJlZShlZXByb20pOwoJCXJldHVybiAxOwoJfQoK
CS8qCgkgKiBTRkYtODA3OSBFRVBST00gbGF5b3V0IGNvbnRhaW5zIHRoZSBtZW1vcnkgYXZhaWxh
YmxlIGF0IEEwIGFkZHJlc3Mgb24KCSAqIHRoZSBQSFkgRUVQUk9NLgoJICogU0ZGLTg0NzIgZGVm
aW5lcyBhIHZpcnR1YWwgZXh0ZW5zaW9uIG9mIHRoZSBFRVBST00sIHdoZXJlIHRoZQoJICogbWlj
cm9jb250cm9sbGVyIG9uIHRoZSBTRlAvU0ZQKyBnZW5lcmF0ZXMgYSBwYWdlIGF0IHRoZSBBMiBh
ZGRyZXNzLAoJICogd2hpY2ggY29udGFpbnMgZGF0YSByZWxhdGl2ZSB0byBvcHRpY2FsIGRpYWdu
b3N0aWNzLgoJICogVGhlIGN1cnJlbnQga2VybmVsIGltcGxlbWVudGF0aW9uIHJldHVybnMgYSBi
bG9iLCB3aGljaCBjb250YWluczoKCSAqICAtIEVUSF9NT0RVTEVfU0ZGXzgwNzkgPT4gVGhlIEEw
IHBhZ2Ugb25seS4KCSAqICAtIEVUSF9NT0RVTEVfU0ZGXzg0NzIgPT4gVGhlIEEwIGFuZCBBMiBw
YWdlIGNvbmNhdGVuYXRlZC4KCSAqLwoJaWYgKGdlZXByb21fZHVtcF9yYXcpIHsKCQlmd3JpdGUo
ZWVwcm9tLT5kYXRhLCAxLCBlZXByb20tPmxlbiwgc3Rkb3V0KTsKCX0gZWxzZSB7CgkJaWYgKGVl
cHJvbS0+b2Zmc2V0ICE9IDAgIHx8CgkJICAgIChlZXByb20tPmxlbiAhPSBtb2RpbmZvLmVlcHJv
bV9sZW4pKSB7CgkJCWdlZXByb21fZHVtcF9oZXggPSAxOwoJCX0gZWxzZSBpZiAoIWdlZXByb21f
ZHVtcF9oZXgpIHsKCQkJc3dpdGNoIChtb2RpbmZvLnR5cGUpIHsKI2lmZGVmIEVUSFRPT0xfRU5B
QkxFX1BSRVRUWV9EVU1QCgkJCWNhc2UgRVRIX01PRFVMRV9TRkZfODA3OToKCQkJCXNmZjgwNzlf
c2hvd19hbGxfaW9jdGwoZWVwcm9tLT5kYXRhKTsKCQkJCWJyZWFrOwoJCQljYXNlIEVUSF9NT0RV
TEVfU0ZGXzg0NzI6CgkJCQlzZmY4MDc5X3Nob3dfYWxsX2lvY3RsKGVlcHJvbS0+ZGF0YSk7CgkJ
CQlzZmY4NDcyX3Nob3dfYWxsKGVlcHJvbS0+ZGF0YSk7CgkJCQlicmVhazsKCQkJY2FzZSBFVEhf
TU9EVUxFX1NGRl84NDM2OgoJCQljYXNlIEVUSF9NT0RVTEVfU0ZGXzg2MzY6CgkJCQlzZmY4NjM2
X3Nob3dfYWxsX2lvY3RsKGVlcHJvbS0+ZGF0YSwKCQkJCQkJICAgICAgIG1vZGluZm8uZWVwcm9t
X2xlbik7CgkJCQlicmVhazsKI2VuZGlmCgkJCWRlZmF1bHQ6CgkJCQlnZWVwcm9tX2R1bXBfaGV4
ID0gMTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJCWlmIChnZWVwcm9tX2R1bXBfaGV4KQoJCQlkdW1w
X2hleChzdGRvdXQsIGVlcHJvbS0+ZGF0YSwKCQkJCSBlZXByb20tPmxlbiwgZWVwcm9tLT5vZmZz
ZXQpOwoJfQoKCWZyZWUoZWVwcm9tKTsKCglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBkb19nZWVl
KHN0cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7CglzdHJ1Y3QgZXRodG9vbF9lZWUgZWVlY21kOwoK
CWlmIChjdHgtPmFyZ2MgIT0gMCkKCQlleGl0X2JhZF9hcmdzKCk7CgoJZWVlY21kLmNtZCA9IEVU
SFRPT0xfR0VFRTsKCWlmIChzZW5kX2lvY3RsKGN0eCwgJmVlZWNtZCkpIHsKCQlwZXJyb3IoIkNh
bm5vdCBnZXQgRUVFIHNldHRpbmdzIik7CgkJcmV0dXJuIDE7Cgl9CgoJZnByaW50ZihzdGRvdXQs
ICJFRUUgU2V0dGluZ3MgZm9yICVzOlxuIiwgY3R4LT5kZXZuYW1lKTsKCWR1bXBfZWVlY21kKCZl
ZWVjbWQpOwoKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRvX3NlZWUoc3RydWN0IGNtZF9jb250
ZXh0ICpjdHgpCnsKCWludCBhZHZfYyA9IC0xLCBscGlfYyA9IC0xLCBscGlfdGltZV9jID0gLTEs
IGVlZV9jID0gLTE7CglpbnQgY2hhbmdlID0gLTEsIGNoYW5nZTIgPSAwOwoJc3RydWN0IGV0aHRv
b2xfZWVlIGVlZWNtZDsKCXN0cnVjdCBjbWRsaW5lX2luZm8gY21kbGluZV9lZWVbXSA9IHsKCQl7
CgkJCS5uYW1lCQk9ICJhZHZlcnRpc2UiLAoJCQkudHlwZQkJPSBDTURMX1UzMiwKCQkJLndhbnRl
ZF92YWwJPSAmYWR2X2MsCgkJCS5pb2N0bF92YWwJPSAmZWVlY21kLmFkdmVydGlzZWQsCgkJfSwK
CQl7CgkJCS5uYW1lCQk9ICJ0eC1scGkiLAoJCQkudHlwZQkJPSBDTURMX0JPT0wsCgkJCS53YW50
ZWRfdmFsCT0gJmxwaV9jLAoJCQkuaW9jdGxfdmFsCT0gJmVlZWNtZC50eF9scGlfZW5hYmxlZCwK
CQl9LAoJCXsKCQkJLm5hbWUJCT0gInR4LXRpbWVyIiwKCQkJLnR5cGUJCT0gQ01ETF9VMzIsCgkJ
CS53YW50ZWRfdmFsCT0gJmxwaV90aW1lX2MsCgkJCS5pb2N0bF92YWwJPSAmZWVlY21kLnR4X2xw
aV90aW1lciwKCQl9LAoJCXsKCQkJLm5hbWUJCT0gImVlZSIsCgkJCS50eXBlCQk9IENNRExfQk9P
TCwKCQkJLndhbnRlZF92YWwJPSAmZWVlX2MsCgkJCS5pb2N0bF92YWwJPSAmZWVlY21kLmVlZV9l
bmFibGVkLAoJCX0sCgl9OwoKCWlmIChjdHgtPmFyZ2MgPT0gMCkKCQlleGl0X2JhZF9hcmdzKCk7
CgoJcGFyc2VfZ2VuZXJpY19jbWRsaW5lKGN0eCwgJmNoYW5nZSwgY21kbGluZV9lZWUsCgkJCSAg
ICAgIEFSUkFZX1NJWkUoY21kbGluZV9lZWUpKTsKCgllZWVjbWQuY21kID0gRVRIVE9PTF9HRUVF
OwoJaWYgKHNlbmRfaW9jdGwoY3R4LCAmZWVlY21kKSkgewoJCXBlcnJvcigiQ2Fubm90IGdldCBF
RUUgc2V0dGluZ3MiKTsKCQlyZXR1cm4gMTsKCX0KCglkb19nZW5lcmljX3NldChjbWRsaW5lX2Vl
ZSwgQVJSQVlfU0laRShjbWRsaW5lX2VlZSksICZjaGFuZ2UyKTsKCglpZiAoY2hhbmdlMikgewoJ
CWVlZWNtZC5jbWQgPSBFVEhUT09MX1NFRUU7CgkJaWYgKHNlbmRfaW9jdGwoY3R4LCAmZWVlY21k
KSkgewoJCQlwZXJyb3IoIkNhbm5vdCBzZXQgRUVFIHNldHRpbmdzIik7CgkJCXJldHVybiAxOwoJ
CX0KCX0KCglyZXR1cm4gMDsKfQoKLyogY29weSBvZiBuZXQvZXRodG9vbC9jb21tb24uYyAqLwpj
aGFyCnR1bmFibGVfc3RyaW5nc1tfX0VUSFRPT0xfVFVOQUJMRV9DT1VOVF1bRVRIX0dTVFJJTkdf
TEVOXSA9IHsKCVtFVEhUT09MX0lEX1VOU1BFQ10JCT0gIlVuc3BlYyIsCglbRVRIVE9PTF9SWF9D
T1BZQlJFQUtdCQk9ICJyeC1jb3B5YnJlYWsiLAoJW0VUSFRPT0xfVFhfQ09QWUJSRUFLXQkJPSAi
dHgtY29weWJyZWFrIiwKCVtFVEhUT09MX1RYX0NPUFlCUkVBS19CVUZfU0laRV0gPSAidHgtYnVm
LXNpemUiLAoJW0VUSFRPT0xfUEZDX1BSRVZFTlRJT05fVE9VVF0JPSAicGZjLXByZXZlbnRpb24t
dG91dCIsCn07Cgp1bmlvbiBldGh0b29sX3R1bmFibGVfaW5mb192YWwgewoJdWludDhfdCB1ODsK
CXVpbnQxNl90IHUxNjsKCXVpbnQzMl90IHUzMjsKCXVpbnQ2NF90IHU2NDsKCWludDhfdCBzODsK
CWludDE2X3QgczE2OwoJaW50MzJfdCBzMzI7CglpbnQ2NF90IHM2NDsKfTsKCnN0cnVjdCBldGh0
b29sX3R1bmFibGVfaW5mbyB7CgllbnVtIHR1bmFibGVfaWQgdF9pZDsKCWVudW0gdHVuYWJsZV90
eXBlX2lkIHRfdHlwZV9pZDsKCXNpemVfdCBzaXplOwoJY21kbGluZV90eXBlX3QgdHlwZTsKCXVu
aW9uIGV0aHRvb2xfdHVuYWJsZV9pbmZvX3ZhbCB3YW50ZWQ7CglpbnQgc2VlbjsKfTsKCnN0YXRp
YyBzdHJ1Y3QgZXRodG9vbF90dW5hYmxlX2luZm8gdHVuYWJsZXNfaW5mb1tdID0gewoJeyAudF9p
ZAkJPSBFVEhUT09MX1JYX0NPUFlCUkVBSywKCSAgLnRfdHlwZV9pZAk9IEVUSFRPT0xfVFVOQUJM
RV9VMzIsCgkgIC5zaXplCQk9IHNpemVvZih1MzIpLAoJICAudHlwZQkJPSBDTURMX1UzMiwKCX0s
Cgl7IC50X2lkCQk9IEVUSFRPT0xfVFhfQ09QWUJSRUFLLAoJICAudF90eXBlX2lkCT0gRVRIVE9P
TF9UVU5BQkxFX1UzMiwKCSAgLnNpemUJCT0gc2l6ZW9mKHUzMiksCgkgIC50eXBlCQk9IENNRExf
VTMyLAoJfSwKCXsgLnRfaWQJCT0gRVRIVE9PTF9QRkNfUFJFVkVOVElPTl9UT1VULAoJICAudF90
eXBlX2lkCT0gRVRIVE9PTF9UVU5BQkxFX1UxNiwKCSAgLnNpemUJCT0gc2l6ZW9mKHUxNiksCgkg
IC50eXBlCQk9IENNRExfVTE2LAoJfSwKCXsgLnRfaWQgICAgICAgICA9IEVUSFRPT0xfVFhfQ09Q
WUJSRUFLX0JVRl9TSVpFLAoJICAudF90eXBlX2lkICAgID0gRVRIVE9PTF9UVU5BQkxFX1UzMiwK
CSAgLnNpemUgICAgICAgICA9IHNpemVvZih1MzIpLAoJICAudHlwZSAgICAgICAgID0gQ01ETF9V
MzIsCgl9LAp9OwojZGVmaW5lIFRVTkFCTEVTX0lORk9fU0laRQlBUlJBWV9TSVpFKHR1bmFibGVz
X2luZm8pCgpzdGF0aWMgaW50IGRvX3N0dW5hYmxlKHN0cnVjdCBjbWRfY29udGV4dCAqY3R4KQp7
CglzdHJ1Y3QgY21kbGluZV9pbmZvIGNtZGxpbmVfdHVuYWJsZVtUVU5BQkxFU19JTkZPX1NJWkVd
OwoJc3RydWN0IGV0aHRvb2xfdHVuYWJsZV9pbmZvICp0aW5mbyA9IHR1bmFibGVzX2luZm87Cglp
bnQgY2hhbmdlZCA9IDA7Cgl1bnNpZ25lZCBpbnQgaTsKCglmb3IgKGkgPSAwOyBpIDwgVFVOQUJM
RVNfSU5GT19TSVpFOyBpKyspIHsKCQljbWRsaW5lX3R1bmFibGVbaV0ubmFtZSA9IHR1bmFibGVf
c3RyaW5nc1t0aW5mb1tpXS50X2lkXTsKCQljbWRsaW5lX3R1bmFibGVbaV0udHlwZSA9IHRpbmZv
W2ldLnR5cGU7CgkJY21kbGluZV90dW5hYmxlW2ldLndhbnRlZF92YWwgPSAmdGluZm9baV0ud2Fu
dGVkOwoJCWNtZGxpbmVfdHVuYWJsZVtpXS5zZWVuX3ZhbCA9ICZ0aW5mb1tpXS5zZWVuOwoJfQoK
CXBhcnNlX2dlbmVyaWNfY21kbGluZShjdHgsICZjaGFuZ2VkLCBjbWRsaW5lX3R1bmFibGUsIFRV
TkFCTEVTX0lORk9fU0laRSk7CglpZiAoIWNoYW5nZWQpCgkJZXhpdF9iYWRfYXJncygpOwoKCWZv
ciAoaSA9IDA7IGkgPCBUVU5BQkxFU19JTkZPX1NJWkU7IGkrKykgewoJCXN0cnVjdCBldGh0b29s
X3R1bmFibGUgKnR1bmE7CgkJc2l6ZV90IHNpemU7CgkJaW50IHJldDsKCgkJaWYgKCF0aW5mb1tp
XS5zZWVuKQoJCQljb250aW51ZTsKCgkJc2l6ZSA9IHNpemVvZigqdHVuYSkgKyB0aW5mb1tpXS5z
aXplOwoJCXR1bmEgPSBjYWxsb2MoMSwgc2l6ZSk7CgkJaWYgKCF0dW5hKSB7CgkJCXBlcnJvcih0
dW5hYmxlX3N0cmluZ3NbdGluZm9baV0udF9pZF0pOwoJCQlyZXR1cm4gMTsKCQl9CgkJdHVuYS0+
Y21kID0gRVRIVE9PTF9TVFVOQUJMRTsKCQl0dW5hLT5pZCA9IHRpbmZvW2ldLnRfaWQ7CgkJdHVu
YS0+dHlwZV9pZCA9IHRpbmZvW2ldLnRfdHlwZV9pZDsKCQl0dW5hLT5sZW4gPSB0aW5mb1tpXS5z
aXplOwoJCW1lbWNweSh0dW5hLT5kYXRhLCAmdGluZm9baV0ud2FudGVkLCB0dW5hLT5sZW4pOwoJ
CXJldCA9IHNlbmRfaW9jdGwoY3R4LCB0dW5hKTsKCQlpZiAocmV0KSB7CgkJCXBlcnJvcih0dW5h
YmxlX3N0cmluZ3NbdHVuYS0+aWRdKTsKCQkJZnJlZSh0dW5hKTsKCQkJcmV0dXJuIHJldDsKCQl9
CgkJZnJlZSh0dW5hKTsKCX0KCXJldHVybiAwOwp9CgpzdGF0aWMgdm9pZCBwcmludF90dW5hYmxl
KHN0cnVjdCBldGh0b29sX3R1bmFibGUgKnR1bmEpCnsKCWNoYXIgKm5hbWUgPSB0dW5hYmxlX3N0
cmluZ3NbdHVuYS0+aWRdOwoJdW5pb24gZXRodG9vbF90dW5hYmxlX2luZm9fdmFsICp2YWw7CgoJ
dmFsID0gKHVuaW9uIGV0aHRvb2xfdHVuYWJsZV9pbmZvX3ZhbCAqKXR1bmEtPmRhdGE7Cglzd2l0
Y2ggKHR1bmEtPnR5cGVfaWQpIHsKCWNhc2UgRVRIVE9PTF9UVU5BQkxFX1U4OgoJCWZwcmludGYo
c3Rkb3V0LCAiJXM6ICUiIFBSSXU4ICJcbiIsIG5hbWUsIHZhbC0+dTgpOwoJCWJyZWFrOwoJY2Fz
ZSBFVEhUT09MX1RVTkFCTEVfVTE2OgoJCWZwcmludGYoc3Rkb3V0LCAiJXM6ICUiIFBSSXUxNiAi
XG4iLCBuYW1lLCB2YWwtPnUxNik7CgkJYnJlYWs7CgljYXNlIEVUSFRPT0xfVFVOQUJMRV9VMzI6
CgkJZnByaW50ZihzdGRvdXQsICIlczogJSIgUFJJdTMyICJcbiIsIG5hbWUsIHZhbC0+dTMyKTsK
CQlicmVhazsKCWNhc2UgRVRIVE9PTF9UVU5BQkxFX1U2NDoKCQlmcHJpbnRmKHN0ZG91dCwgIiVz
OiAlIiBQUkl1NjQgIlxuIiwgbmFtZSwgdmFsLT51NjQpOwoJCWJyZWFrOwoJY2FzZSBFVEhUT09M
X1RVTkFCTEVfUzg6CgkJZnByaW50ZihzdGRvdXQsICIlczogJSIgUFJJZDggIlxuIiwgbmFtZSwg
dmFsLT5zOCk7CgkJYnJlYWs7CgljYXNlIEVUSFRPT0xfVFVOQUJMRV9TMTY6CgkJZnByaW50Zihz
dGRvdXQsICIlczogJSIgUFJJZDE2ICJcbiIsIG5hbWUsIHZhbC0+czE2KTsKCQlicmVhazsKCWNh
c2UgRVRIVE9PTF9UVU5BQkxFX1MzMjoKCQlmcHJpbnRmKHN0ZG91dCwgIiVzOiAlIiBQUklkMzIg
IlxuIiwgbmFtZSwgdmFsLT5zMzIpOwoJCWJyZWFrOwoJY2FzZSBFVEhUT09MX1RVTkFCTEVfUzY0
OgoJCWZwcmludGYoc3Rkb3V0LCAiJXM6ICUiIFBSSWQ2NCAiXG4iLCBuYW1lLCB2YWwtPnM2NCk7
CgkJYnJlYWs7CglkZWZhdWx0OgoJCWZwcmludGYoc3Rkb3V0LCAiJXM6IFVua25vd24gZm9ybWF0
XG4iLCBuYW1lKTsKCX0KfQoKc3RhdGljIGludCBkb19ndHVuYWJsZShzdHJ1Y3QgY21kX2NvbnRl
eHQgKmN0eCkKewoJc3RydWN0IGV0aHRvb2xfdHVuYWJsZV9pbmZvICp0aW5mbyA9IHR1bmFibGVz
X2luZm87CgljaGFyICoqYXJncCA9IGN0eC0+YXJncDsKCXVuc2lnbmVkIGludCBhcmdjID0gY3R4
LT5hcmdjOwoJdW5zaWduZWQgaW50IGksIGo7CgoJaWYgKGFyZ2MgPCAxKQoJCWV4aXRfYmFkX2Fy
Z3MoKTsKCglmb3IgKGkgPSAwOyBpIDwgYXJnYzsgaSsrKSB7CgkJaW50IHZhbGlkID0gMDsKCgkJ
Zm9yIChqID0gMDsgaiA8IFRVTkFCTEVTX0lORk9fU0laRTsgaisrKSB7CgkJCWNoYXIgKnRzID0g
dHVuYWJsZV9zdHJpbmdzW3RpbmZvW2pdLnRfaWRdOwoJCQlzdHJ1Y3QgZXRodG9vbF90dW5hYmxl
ICp0dW5hOwoJCQlpbnQgcmV0OwoKCQkJaWYgKHN0cmNtcChhcmdwW2ldLCB0cykpCgkJCQljb250
aW51ZTsKCQkJdmFsaWQgPSAxOwoKCQkJdHVuYSA9IGNhbGxvYygxLCBzaXplb2YoKnR1bmEpICsg
dGluZm9bal0uc2l6ZSk7CgkJCWlmICghdHVuYSkgewoJCQkJcGVycm9yKHRzKTsKCQkJCXJldHVy
biAxOwoJCQl9CgkJCXR1bmEtPmNtZCA9IEVUSFRPT0xfR1RVTkFCTEU7CgkJCXR1bmEtPmlkID0g
dGluZm9bal0udF9pZDsKCQkJdHVuYS0+dHlwZV9pZCA9IHRpbmZvW2pdLnRfdHlwZV9pZDsKCQkJ
dHVuYS0+bGVuID0gdGluZm9bal0uc2l6ZTsKCQkJcmV0ID0gc2VuZF9pb2N0bChjdHgsIHR1bmEp
OwoJCQlpZiAocmV0KSB7CgkJCQlmcHJpbnRmKHN0ZGVyciwgIiVzOiBDYW5ub3QgZ2V0IHR1bmFi
bGVcbiIsIHRzKTsKCQkJCWZyZWUodHVuYSk7CgkJCQlyZXR1cm4gcmV0OwoJCQl9CgkJCXByaW50
X3R1bmFibGUodHVuYSk7CgkJCWZyZWUodHVuYSk7CgkJfQoJCWlmICghdmFsaWQpCgkJCWV4aXRf
YmFkX2FyZ3MoKTsKCX0KCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRvX2dldF9waHlfdHVuYWJs
ZShzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJdW5zaWduZWQgaW50IGFyZ2MgPSBjdHgtPmFy
Z2M7CgljaGFyICoqYXJncCA9IGN0eC0+YXJncDsKCglpZiAoYXJnYyA8IDEpCgkJZXhpdF9iYWRf
YXJncygpOwoKCWlmICghc3RyY21wKGFyZ3BbMF0sICJkb3duc2hpZnQiKSkgewoJCXN0cnVjdCB7
CgkJCXN0cnVjdCBldGh0b29sX3R1bmFibGUgZHM7CgkJCXU4IGNvdW50OwoJCX0gY29udDsKCgkJ
Y29udC5kcy5jbWQgPSBFVEhUT09MX1BIWV9HVFVOQUJMRTsKCQljb250LmRzLmlkID0gRVRIVE9P
TF9QSFlfRE9XTlNISUZUOwoJCWNvbnQuZHMudHlwZV9pZCA9IEVUSFRPT0xfVFVOQUJMRV9VODsK
CQljb250LmRzLmxlbiA9IDE7CgkJaWYgKHNlbmRfaW9jdGwoY3R4LCAmY29udC5kcykgPCAwKSB7
CgkJCXBlcnJvcigiQ2Fubm90IEdldCBQSFkgZG93bnNoaWZ0IGNvdW50Iik7CgkJCXJldHVybiA4
NzsKCQl9CgkJaWYgKGNvbnQuY291bnQpCgkJCWZwcmludGYoc3Rkb3V0LCAiRG93bnNoaWZ0IGNv
dW50OiAlZFxuIiwgY29udC5jb3VudCk7CgkJZWxzZQoJCQlmcHJpbnRmKHN0ZG91dCwgIkRvd25z
aGlmdCBkaXNhYmxlZFxuIik7Cgl9IGVsc2UgaWYgKCFzdHJjbXAoYXJncFswXSwgImZhc3QtbGlu
ay1kb3duIikpIHsKCQlzdHJ1Y3QgewoJCQlzdHJ1Y3QgZXRodG9vbF90dW5hYmxlIGZsZDsKCQkJ
dTggbXNlY3M7CgkJfSBjb250OwoKCQljb250LmZsZC5jbWQgPSBFVEhUT09MX1BIWV9HVFVOQUJM
RTsKCQljb250LmZsZC5pZCA9IEVUSFRPT0xfUEhZX0ZBU1RfTElOS19ET1dOOwoJCWNvbnQuZmxk
LnR5cGVfaWQgPSBFVEhUT09MX1RVTkFCTEVfVTg7CgkJY29udC5mbGQubGVuID0gMTsKCQlpZiAo
c2VuZF9pb2N0bChjdHgsICZjb250LmZsZCkgPCAwKSB7CgkJCXBlcnJvcigiQ2Fubm90IEdldCBQ
SFkgRmFzdCBMaW5rIERvd24gdmFsdWUiKTsKCQkJcmV0dXJuIDg3OwoJCX0KCgkJaWYgKGNvbnQu
bXNlY3MgPT0gRVRIVE9PTF9QSFlfRkFTVF9MSU5LX0RPV05fT04pCgkJCWZwcmludGYoc3Rkb3V0
LCAiRmFzdCBMaW5rIERvd24gZW5hYmxlZFxuIik7CgkJZWxzZSBpZiAoY29udC5tc2VjcyA9PSBF
VEhUT09MX1BIWV9GQVNUX0xJTktfRE9XTl9PRkYpCgkJCWZwcmludGYoc3Rkb3V0LCAiRmFzdCBM
aW5rIERvd24gZGlzYWJsZWRcbiIpOwoJCWVsc2UKCQkJZnByaW50ZihzdGRvdXQsICJGYXN0IExp
bmsgRG93biBlbmFibGVkLCAlZCBtc2Vjc1xuIiwKCQkJCWNvbnQubXNlY3MpOwoJfSBlbHNlIGlm
ICghc3RyY21wKGFyZ3BbMF0sICJlbmVyZ3ktZGV0ZWN0LXBvd2VyLWRvd24iKSkgewoJCXN0cnVj
dCB7CgkJCXN0cnVjdCBldGh0b29sX3R1bmFibGUgZHM7CgkJCXUxNiBtc2VjczsKCQl9IGNvbnQ7
CgoJCWNvbnQuZHMuY21kID0gRVRIVE9PTF9QSFlfR1RVTkFCTEU7CgkJY29udC5kcy5pZCA9IEVU
SFRPT0xfUEhZX0VEUEQ7CgkJY29udC5kcy50eXBlX2lkID0gRVRIVE9PTF9UVU5BQkxFX1UxNjsK
CQljb250LmRzLmxlbiA9IDI7CgkJaWYgKHNlbmRfaW9jdGwoY3R4LCAmY29udC5kcykgPCAwKSB7
CgkJCXBlcnJvcigiQ2Fubm90IEdldCBQSFkgRW5lcmd5IERldGVjdCBQb3dlciBEb3duIHZhbHVl
Iik7CgkJCXJldHVybiA4NzsKCQl9CgoJCWlmIChjb250Lm1zZWNzID09IEVUSFRPT0xfUEhZX0VE
UERfRElTQUJMRSkKCQkJZnByaW50ZihzdGRvdXQsICJFbmVyZ3kgRGV0ZWN0IFBvd2VyIERvd246
IGRpc2FibGVkXG4iKTsKCQllbHNlIGlmIChjb250Lm1zZWNzID09IEVUSFRPT0xfUEhZX0VEUERf
Tk9fVFgpCgkJCWZwcmludGYoc3Rkb3V0LAoJCQkJIkVuZXJneSBEZXRlY3QgUG93ZXIgRG93bjog
ZW5hYmxlZCwgVFggZGlzYWJsZWRcbiIpOwoJCWVsc2UKCQkJZnByaW50ZihzdGRvdXQsCgkJCQki
RW5lcmd5IERldGVjdCBQb3dlciBEb3duOiBlbmFibGVkLCBUWCAldSBtc2Vjc1xuIiwKCQkJCWNv
bnQubXNlY3MpOwoJfSBlbHNlIHsKCQlleGl0X2JhZF9hcmdzKCk7Cgl9CgoJcmV0dXJuIDA7Cn0K
CnN0YXRpYyBfX3UzMiBwYXJzZV9yZXNldChjaGFyICp2YWwsIF9fdTMyIGJpdHNldCwgY2hhciAq
YXJnLCBfX3UzMiAqZGF0YSkKewoJX191MzIgYml0dmFsID0gMDsKCWludCBpOwoKCS8qIENoZWNr
IGZvciBjb21wb25lbnQgbWF0Y2ggKi8KCWZvciAoaSA9IDA7IHZhbFtpXSAhPSAnXDAnOyBpKysp
CgkJaWYgKGFyZ1tpXSAhPSB2YWxbaV0pCgkJCXJldHVybiAwOwoKCS8qIENoZWNrIGlmIGNvbXBv
bmVudCBoYXMgLXNoYXJlZCBzcGVjaWZpZWQgb3Igbm90ICovCglpZiAoYXJnW2ldID09ICdcMCcp
CgkJYml0dmFsID0gYml0c2V0OwoJZWxzZSBpZiAoIXN0cmNtcChhcmcraSwgIi1zaGFyZWQiKSkK
CQliaXR2YWwgPSBiaXRzZXQgPDwgRVRIX1JFU0VUX1NIQVJFRF9TSElGVDsKCglpZiAoYml0dmFs
KSB7CgkJKmRhdGEgfD0gYml0dmFsOwoJCXJldHVybiAxOwoJfQoJcmV0dXJuIDA7Cn0KCnN0YXRp
YyBpbnQgZG9fcmVzZXQoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgpCnsKCXN0cnVjdCBldGh0b29s
X3ZhbHVlIHJlc2V0aW5mbzsKCV9fdTMyIGRhdGE7Cgl1bnNpZ25lZCBpbnQgYXJnYyA9IGN0eC0+
YXJnYzsKCWNoYXIgKiphcmdwID0gY3R4LT5hcmdwOwoJdW5zaWduZWQgaW50IGk7CgoJaWYgKGFy
Z2MgPT0gMCkKCQlleGl0X2JhZF9hcmdzKCk7CgoJZGF0YSA9IDA7CgoJZm9yIChpID0gMDsgaSA8
IGFyZ2M7IGkrKykgewoJCWlmICghc3RyY21wKGFyZ3BbaV0sICJmbGFncyIpKSB7CgkJCV9fdTMy
IGZsYWdzOwoKCQkJaSsrOwoJCQlpZiAoaSA+PSBhcmdjKQoJCQkJZXhpdF9iYWRfYXJncygpOwoJ
CQlmbGFncyA9IHN0cnRvdWwoYXJncFtpXSwgTlVMTCwgMCk7CgkJCWlmIChmbGFncyA9PSAwKQoJ
CQkJZXhpdF9iYWRfYXJncygpOwoJCQllbHNlCgkJCQlkYXRhIHw9IGZsYWdzOwoJCX0gZWxzZSBp
ZiAocGFyc2VfcmVzZXQoIm1nbXQiLCBFVEhfUkVTRVRfTUdNVCwKCQkJCSAgICAgIGFyZ3BbaV0s
ICZkYXRhKSkgewoJCX0gZWxzZSBpZiAocGFyc2VfcmVzZXQoImlycSIsICBFVEhfUkVTRVRfSVJR
LAoJCQkJICAgIGFyZ3BbaV0sICZkYXRhKSkgewoJCX0gZWxzZSBpZiAocGFyc2VfcmVzZXQoImRt
YSIsIEVUSF9SRVNFVF9ETUEsCgkJCQkgICAgYXJncFtpXSwgJmRhdGEpKSB7CgkJfSBlbHNlIGlm
IChwYXJzZV9yZXNldCgiZmlsdGVyIiwgRVRIX1JFU0VUX0ZJTFRFUiwKCQkJCSAgICBhcmdwW2ld
LCAmZGF0YSkpIHsKCQl9IGVsc2UgaWYgKHBhcnNlX3Jlc2V0KCJvZmZsb2FkIiwgRVRIX1JFU0VU
X09GRkxPQUQsCgkJCQkgICAgYXJncFtpXSwgJmRhdGEpKSB7CgkJfSBlbHNlIGlmIChwYXJzZV9y
ZXNldCgibWFjIiwgRVRIX1JFU0VUX01BQywKCQkJCSAgICBhcmdwW2ldLCAmZGF0YSkpIHsKCQl9
IGVsc2UgaWYgKHBhcnNlX3Jlc2V0KCJwaHkiLCBFVEhfUkVTRVRfUEhZLAoJCQkJICAgIGFyZ3Bb
aV0sICZkYXRhKSkgewoJCX0gZWxzZSBpZiAocGFyc2VfcmVzZXQoInJhbSIsIEVUSF9SRVNFVF9S
QU0sCgkJCQkgICAgYXJncFtpXSwgJmRhdGEpKSB7CgkJfSBlbHNlIGlmIChwYXJzZV9yZXNldCgi
YXAiLCBFVEhfUkVTRVRfQVAsCgkJCQkgICAgYXJncFtpXSwgJmRhdGEpKSB7CgkJfSBlbHNlIGlm
ICghc3RyY21wKGFyZ3BbaV0sICJkZWRpY2F0ZWQiKSkgewoJCQlkYXRhIHw9IEVUSF9SRVNFVF9E
RURJQ0FURUQ7CgkJfSBlbHNlIGlmICghc3RyY21wKGFyZ3BbaV0sICJhbGwiKSkgewoJCQlkYXRh
IHw9IEVUSF9SRVNFVF9BTEw7CgkJfSBlbHNlIHsKCQkJZXhpdF9iYWRfYXJncygpOwoJCX0KCX0K
CglyZXNldGluZm8uY21kID0gRVRIVE9PTF9SRVNFVDsKCXJlc2V0aW5mby5kYXRhID0gZGF0YTsK
CWZwcmludGYoc3Rkb3V0LCAiRVRIVE9PTF9SRVNFVCAweCV4XG4iLCByZXNldGluZm8uZGF0YSk7
CgoJaWYgKHNlbmRfaW9jdGwoY3R4LCAmcmVzZXRpbmZvKSkgewoJCXBlcnJvcigiQ2Fubm90IGlz
c3VlIEVUSFRPT0xfUkVTRVQiKTsKCQlyZXR1cm4gMTsKCX0KCglmcHJpbnRmKHN0ZG91dCwgIkNv
bXBvbmVudHMgcmVzZXQ6ICAgICAweCV4XG4iLCBkYXRhICYgfnJlc2V0aW5mby5kYXRhKTsKCWlm
IChyZXNldGluZm8uZGF0YSkKCQlmcHJpbnRmKHN0ZG91dCwgIkNvbXBvbmVudHMgbm90IHJlc2V0
OiAweCV4XG4iLCByZXNldGluZm8uZGF0YSk7CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgcGFy
c2VfbmFtZWRfYm9vbChzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCwgY29uc3QgY2hhciAqbmFtZSwg
dTggKm9uKQp7CglpZiAoY3R4LT5hcmdjIDwgMikKCQlyZXR1cm4gMDsKCglpZiAoc3RyY21wKCpj
dHgtPmFyZ3AsIG5hbWUpKQoJCXJldHVybiAwOwoKCWlmICghc3RyY21wKCooY3R4LT5hcmdwICsg
MSksICJvbiIpKSB7CgkJKm9uID0gMTsKCX0gZWxzZSBpZiAoIXN0cmNtcCgqKGN0eC0+YXJncCAr
IDEpLCAib2ZmIikpIHsKCQkqb24gPSAwOwoJfSBlbHNlIHsKCQlmcHJpbnRmKHN0ZGVyciwgIklu
dmFsaWQgYm9vbGVhblxuIik7CgkJZXhpdF9iYWRfYXJncygpOwoJfQoKCWN0eC0+YXJnYyAtPSAy
OwoJY3R4LT5hcmdwICs9IDI7CgoJcmV0dXJuIDE7Cn0KCnN0YXRpYyBpbnQgcGFyc2VfbmFtZWRf
dWludChzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCwKCQkJICAgIGNvbnN0IGNoYXIgKm5hbWUsCgkJ
CSAgICB1bnNpZ25lZCBsb25nIGxvbmcgKnZhbCwKCQkJICAgIHVuc2lnbmVkIGxvbmcgbG9uZyBt
YXgpCnsKCWlmIChjdHgtPmFyZ2MgPCAyKQoJCXJldHVybiAwOwoKCWlmIChzdHJjbXAoKmN0eC0+
YXJncCwgbmFtZSkpCgkJcmV0dXJuIDA7CgoJKnZhbCA9IGdldF91aW50X3JhbmdlKCooY3R4LT5h
cmdwICsgMSksIDAsIG1heCk7CgoJY3R4LT5hcmdjIC09IDI7CgljdHgtPmFyZ3AgKz0gMjsKCgly
ZXR1cm4gMTsKfQoKc3RhdGljIGludCBwYXJzZV9uYW1lZF91OChzdHJ1Y3QgY21kX2NvbnRleHQg
KmN0eCwgY29uc3QgY2hhciAqbmFtZSwgdTggKnZhbCkKewoJdW5zaWduZWQgbG9uZyBsb25nIHZh
bDE7CglpbnQgcmV0OwoKCXJldCA9IHBhcnNlX25hbWVkX3VpbnQoY3R4LCBuYW1lLCAmdmFsMSwg
MHhmZik7CglpZiAocmV0KQoJCSp2YWwgPSB2YWwxOwoKCXJldHVybiByZXQ7Cn0KCnN0YXRpYyBp
bnQgcGFyc2VfbmFtZWRfdTE2KHN0cnVjdCBjbWRfY29udGV4dCAqY3R4LCBjb25zdCBjaGFyICpu
YW1lLCB1MTYgKnZhbCkKewoJdW5zaWduZWQgbG9uZyBsb25nIHZhbDE7CglpbnQgcmV0OwoKCXJl
dCA9IHBhcnNlX25hbWVkX3VpbnQoY3R4LCBuYW1lLCAmdmFsMSwgMHhmZmZmKTsKCWlmIChyZXQp
CgkJKnZhbCA9IHZhbDE7CgoJcmV0dXJuIHJldDsKfQoKc3RhdGljIGludCBkb19zZXRfcGh5X3R1
bmFibGUoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgpCnsKCWludCBlcnIgPSAwOwoJdTggZHNfY250
ID0gRE9XTlNISUZUX0RFVl9ERUZBVUxUX0NPVU5UOwoJdTggZHNfY2hhbmdlZCA9IDAsIGRzX2hh
c19jbnQgPSAwLCBkc19lbmFibGUgPSAwOwoJdTggZmxkX2NoYW5nZWQgPSAwLCBmbGRfZW5hYmxl
ID0gMDsKCXU4IGZsZF9tc2VjcyA9IEVUSFRPT0xfUEhZX0ZBU1RfTElOS19ET1dOX09OOwoJdTgg
ZWRwZF9jaGFuZ2VkID0gMCwgZWRwZF9lbmFibGUgPSAwOwoJdTE2IGVkcGRfdHhfaW50ZXJ2YWwg
PSBFVEhUT09MX1BIWV9FRFBEX0RGTFRfVFhfTVNFQ1M7CgoJLyogUGFyc2UgYXJndW1lbnRzICov
CglpZiAocGFyc2VfbmFtZWRfYm9vbChjdHgsICJkb3duc2hpZnQiLCAmZHNfZW5hYmxlKSkgewoJ
CWRzX2NoYW5nZWQgPSAxOwoJCWRzX2hhc19jbnQgPSBwYXJzZV9uYW1lZF91OChjdHgsICJjb3Vu
dCIsICZkc19jbnQpOwoJfSBlbHNlIGlmIChwYXJzZV9uYW1lZF9ib29sKGN0eCwgImZhc3QtbGlu
ay1kb3duIiwgJmZsZF9lbmFibGUpKSB7CgkJZmxkX2NoYW5nZWQgPSAxOwoJCWlmIChmbGRfZW5h
YmxlKQoJCQlwYXJzZV9uYW1lZF91OChjdHgsICJtc2VjcyIsICZmbGRfbXNlY3MpOwoJfSBlbHNl
IGlmIChwYXJzZV9uYW1lZF9ib29sKGN0eCwgImVuZXJneS1kZXRlY3QtcG93ZXItZG93biIsCgkJ
CQkgICAgJmVkcGRfZW5hYmxlKSkgewoJCWVkcGRfY2hhbmdlZCA9IDE7CgkJaWYgKGVkcGRfZW5h
YmxlKQoJCQlwYXJzZV9uYW1lZF91MTYoY3R4LCAibXNlY3MiLCAmZWRwZF90eF9pbnRlcnZhbCk7
Cgl9IGVsc2UgewoJCWV4aXRfYmFkX2FyZ3MoKTsKCX0KCgkvKiBWYWxpZGF0ZSBwYXJhbWV0ZXJz
ICovCglpZiAoZHNfY2hhbmdlZCkgewoJCWlmICghZHNfZW5hYmxlICYmIGRzX2hhc19jbnQpIHsK
CQkJZnByaW50ZihzdGRlcnIsICInY291bnQnIG1heSBub3QgYmUgc2V0IHdoZW4gZG93bnNoaWZ0
ICIKCQkJCSAgICAgICAgImlzIG9mZi5cbiIpOwoJCQlleGl0X2JhZF9hcmdzKCk7CgkJfQoKCQlp
ZiAoZHNfZW5hYmxlICYmIGRzX2hhc19jbnQgJiYgZHNfY250ID09IDApIHsKCQkJZnByaW50Zihz
dGRlcnIsICInY291bnQnIG1heSBub3QgYmUgemVyby5cbiIpOwoJCQlleGl0X2JhZF9hcmdzKCk7
CgkJfQoKCQlpZiAoIWRzX2VuYWJsZSkKCQkJZHNfY250ID0gRE9XTlNISUZUX0RFVl9ESVNBQkxF
OwoJfSBlbHNlIGlmIChmbGRfY2hhbmdlZCkgewoJCWlmICghZmxkX2VuYWJsZSkKCQkJZmxkX21z
ZWNzID0gRVRIVE9PTF9QSFlfRkFTVF9MSU5LX0RPV05fT0ZGOwoJCWVsc2UgaWYgKGZsZF9tc2Vj
cyA9PSBFVEhUT09MX1BIWV9GQVNUX0xJTktfRE9XTl9PRkYpCgkJCWV4aXRfYmFkX2FyZ3MoKTsK
CX0gZWxzZSBpZiAoZWRwZF9jaGFuZ2VkKSB7CgkJaWYgKCFlZHBkX2VuYWJsZSkKCQkJZWRwZF90
eF9pbnRlcnZhbCA9IEVUSFRPT0xfUEhZX0VEUERfRElTQUJMRTsKCQllbHNlIGlmIChlZHBkX3R4
X2ludGVydmFsID09IDApCgkJCWVkcGRfdHhfaW50ZXJ2YWwgPSBFVEhUT09MX1BIWV9FRFBEX05P
X1RYOwoJCWVsc2UgaWYgKGVkcGRfdHhfaW50ZXJ2YWwgPiBFVEhUT09MX1BIWV9FRFBEX05PX1RY
KSB7CgkJCWZwcmludGYoc3RkZXJyLCAiJ21zZWNzJyBtYXggdmFsdWUgaXMgJWQuXG4iLAoJCQkJ
KEVUSFRPT0xfUEhZX0VEUERfTk9fVFggLSAxKSk7CgkJCWV4aXRfYmFkX2FyZ3MoKTsKCQl9Cgl9
CgoJLyogRG8gaXQgKi8KCWlmIChkc19jaGFuZ2VkKSB7CgkJc3RydWN0IHsKCQkJc3RydWN0IGV0
aHRvb2xfdHVuYWJsZSBkczsKCQkJdTggY291bnQ7CgkJfSBjb250OwoKCQljb250LmRzLmNtZCA9
IEVUSFRPT0xfUEhZX1NUVU5BQkxFOwoJCWNvbnQuZHMuaWQgPSBFVEhUT09MX1BIWV9ET1dOU0hJ
RlQ7CgkJY29udC5kcy50eXBlX2lkID0gRVRIVE9PTF9UVU5BQkxFX1U4OwoJCWNvbnQuZHMubGVu
ID0gMTsKCQljb250LmNvdW50ID0gZHNfY250OwoJCWVyciA9IHNlbmRfaW9jdGwoY3R4LCAmY29u
dC5kcyk7CgkJaWYgKGVyciA8IDApIHsKCQkJcGVycm9yKCJDYW5ub3QgU2V0IFBIWSBkb3duc2hp
ZnQgY291bnQiKTsKCQkJZXJyID0gODc7CgkJfQoJfSBlbHNlIGlmIChmbGRfY2hhbmdlZCkgewoJ
CXN0cnVjdCB7CgkJCXN0cnVjdCBldGh0b29sX3R1bmFibGUgZmxkOwoJCQl1OCBtc2VjczsKCQl9
IGNvbnQ7CgoJCWNvbnQuZmxkLmNtZCA9IEVUSFRPT0xfUEhZX1NUVU5BQkxFOwoJCWNvbnQuZmxk
LmlkID0gRVRIVE9PTF9QSFlfRkFTVF9MSU5LX0RPV047CgkJY29udC5mbGQudHlwZV9pZCA9IEVU
SFRPT0xfVFVOQUJMRV9VODsKCQljb250LmZsZC5sZW4gPSAxOwoJCWNvbnQubXNlY3MgPSBmbGRf
bXNlY3M7CgkJZXJyID0gc2VuZF9pb2N0bChjdHgsICZjb250LmZsZCk7CgkJaWYgKGVyciA8IDAp
IHsKCQkJcGVycm9yKCJDYW5ub3QgU2V0IFBIWSBGYXN0IExpbmsgRG93biB2YWx1ZSIpOwoJCQll
cnIgPSA4NzsKCQl9Cgl9IGVsc2UgaWYgKGVkcGRfY2hhbmdlZCkgewoJCXN0cnVjdCB7CgkJCXN0
cnVjdCBldGh0b29sX3R1bmFibGUgZmxkOwoJCQl1MTYgbXNlY3M7CgkJfSBjb250OwoKCQljb250
LmZsZC5jbWQgPSBFVEhUT09MX1BIWV9TVFVOQUJMRTsKCQljb250LmZsZC5pZCA9IEVUSFRPT0xf
UEhZX0VEUEQ7CgkJY29udC5mbGQudHlwZV9pZCA9IEVUSFRPT0xfVFVOQUJMRV9VMTY7CgkJY29u
dC5mbGQubGVuID0gMjsKCQljb250Lm1zZWNzID0gZWRwZF90eF9pbnRlcnZhbDsKCQllcnIgPSBz
ZW5kX2lvY3RsKGN0eCwgJmNvbnQuZmxkKTsKCQlpZiAoZXJyIDwgMCkgewoJCQlwZXJyb3IoIkNh
bm5vdCBTZXQgUEhZIEVuZXJneSBEZXRlY3QgUG93ZXIgRG93biIpOwoJCQllcnIgPSA4NzsKCQl9
Cgl9CgoJcmV0dXJuIGVycjsKfQoKc3RhdGljIGludCBmZWNtb2RlX3N0cl90b190eXBlKGNvbnN0
IGNoYXIgKnN0cikKewoJaWYgKCFzdHJjYXNlY21wKHN0ciwgImF1dG8iKSkKCQlyZXR1cm4gRVRI
VE9PTF9GRUNfQVVUTzsKCWlmICghc3RyY2FzZWNtcChzdHIsICJvZmYiKSkKCQlyZXR1cm4gRVRI
VE9PTF9GRUNfT0ZGOwoJaWYgKCFzdHJjYXNlY21wKHN0ciwgInJzIikpCgkJcmV0dXJuIEVUSFRP
T0xfRkVDX1JTOwoJaWYgKCFzdHJjYXNlY21wKHN0ciwgImJhc2VyIikpCgkJcmV0dXJuIEVUSFRP
T0xfRkVDX0JBU0VSOwoJaWYgKCFzdHJjYXNlY21wKHN0ciwgImxscnMiKSkKCQlyZXR1cm4gRVRI
VE9PTF9GRUNfTExSUzsKCXJldHVybiAwOwp9CgpzdGF0aWMgaW50IGRvX2dmZWMoc3RydWN0IGNt
ZF9jb250ZXh0ICpjdHgpCnsKCXN0cnVjdCBldGh0b29sX2ZlY3BhcmFtIGZlY2NtZCA9IHsgMCB9
OwoJaW50IHJ2OwoKCWlmIChjdHgtPmFyZ2MgIT0gMCkKCQlleGl0X2JhZF9hcmdzKCk7CgoJZmVj
Y21kLmNtZCA9IEVUSFRPT0xfR0ZFQ1BBUkFNOwoJcnYgPSBzZW5kX2lvY3RsKGN0eCwgJmZlY2Nt
ZCk7CglpZiAocnYgIT0gMCkgewoJCXBlcnJvcigiQ2Fubm90IGdldCBGRUMgc2V0dGluZ3MiKTsK
CQlyZXR1cm4gcnY7Cgl9CgoJZnByaW50ZihzdGRvdXQsICJGRUMgcGFyYW1ldGVycyBmb3IgJXM6
XG4iLCBjdHgtPmRldm5hbWUpOwoJZnByaW50ZihzdGRvdXQsICJTdXBwb3J0ZWQvQ29uZmlndXJl
ZCBGRUMgZW5jb2RpbmdzOiIpOwoJZHVtcF9mZWMoZmVjY21kLmZlYyk7CglmcHJpbnRmKHN0ZG91
dCwgIlxuIik7CgoJZnByaW50ZihzdGRvdXQsICJBY3RpdmUgRkVDIGVuY29kaW5nOiIpOwoJZHVt
cF9mZWMoZmVjY21kLmFjdGl2ZV9mZWMpOwoJZnByaW50ZihzdGRvdXQsICJcbiIpOwoKCXJldHVy
biAwOwp9CgpzdGF0aWMgaW50IGRvX3NmZWMoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgpCnsKCWVu
dW0geyBBUkdfTk9ORSwgQVJHX0VOQ09ESU5HIH0gc3RhdGUgPSBBUkdfTk9ORTsKCXN0cnVjdCBl
dGh0b29sX2ZlY3BhcmFtIGZlY2NtZDsKCWludCBmZWNtb2RlID0gMCwgbmV3bW9kZTsKCXVuc2ln
bmVkIGludCBpOwoJaW50IHJ2OwoKCWZvciAoaSA9IDA7IGkgPCBjdHgtPmFyZ2M7IGkrKykgewoJ
CWlmICghc3RyY21wKGN0eC0+YXJncFtpXSwgImVuY29kaW5nIikpIHsKCQkJc3RhdGUgPSBBUkdf
RU5DT0RJTkc7CgkJCWNvbnRpbnVlOwoJCX0KCQlpZiAoc3RhdGUgPT0gQVJHX0VOQ09ESU5HKSB7
CgkJCW5ld21vZGUgPSBmZWNtb2RlX3N0cl90b190eXBlKGN0eC0+YXJncFtpXSk7CgkJCWlmICgh
bmV3bW9kZSkKCQkJCWV4aXRfYmFkX2FyZ3MoKTsKCQkJZmVjbW9kZSB8PSBuZXdtb2RlOwoJCQlj
b250aW51ZTsKCQl9CgkJZXhpdF9iYWRfYXJncygpOwoJfQoKCWlmICghZmVjbW9kZSkKCQlleGl0
X2JhZF9hcmdzKCk7CgoJZmVjY21kLmNtZCA9IEVUSFRPT0xfU0ZFQ1BBUkFNOwoJZmVjY21kLmZl
YyA9IGZlY21vZGU7CglydiA9IHNlbmRfaW9jdGwoY3R4LCAmZmVjY21kKTsKCWlmIChydiAhPSAw
KSB7CgkJcGVycm9yKCJDYW5ub3Qgc2V0IEZFQyBzZXR0aW5ncyIpOwoJCXJldHVybiBydjsKCX0K
CglyZXR1cm4gMDsKfQoKc3RhdGljIGludCBkb19wZXJxdWV1ZShzdHJ1Y3QgY21kX2NvbnRleHQg
KmN0eCk7CgojaWZuZGVmIFRFU1RfRVRIVE9PTAppbnQgc2VuZF9pb2N0bChzdHJ1Y3QgY21kX2Nv
bnRleHQgKmN0eCwgdm9pZCAqY21kKQp7CgljdHgtPmlmci5pZnJfZGF0YSA9IGNtZDsKCXJldHVy
biBpb2N0bChjdHgtPmZkLCBTSU9DRVRIVE9PTCwgJmN0eC0+aWZyKTsKfQojZW5kaWYKCnN0YXRp
YyBpbnQgc2hvd191c2FnZShzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCk7CgpzdHJ1Y3Qgb3B0aW9u
IHsKCWNvbnN0IGNoYXIJKm9wdHM7Cglib29sCQlub19kZXY7Cglib29sCQlqc29uOwoJaW50CQko
KmZ1bmMpKHN0cnVjdCBjbWRfY29udGV4dCAqKTsKCW5sX2Noa190CW5sY2hrOwoJbmxfZnVuY190
CW5sZnVuYzsKCWNvbnN0IGNoYXIJKmhlbHA7Cgljb25zdCBjaGFyCSp4aGVscDsKfTsKCnN0YXRp
YyBjb25zdCBzdHJ1Y3Qgb3B0aW9uIGFyZ3NbXSA9IHsKCXsKCQkvKiAiZGVmYXVsdCIgZW50cnkg
d2hlbiBubyBzd2l0Y2ggaXMgdXNlZCAqLwoJCS5vcHRzCT0gIiIsCgkJLmZ1bmMJPSBkb19nc2V0
LAoJCS5ubGZ1bmMJPSBubF9nc2V0LAoJCS5oZWxwCT0gIkRpc3BsYXkgc3RhbmRhcmQgaW5mb3Jt
YXRpb24gYWJvdXQgZGV2aWNlIiwKCX0sCgl7CgkJLm9wdHMJPSAiLXN8LS1jaGFuZ2UiLAoJCS5m
dW5jCT0gZG9fc3NldCwKCQkubmxmdW5jCT0gbmxfc3NldCwKCQkuaGVscAk9ICJDaGFuZ2UgZ2Vu
ZXJpYyBvcHRpb25zIiwKCQkueGhlbHAJPSAiCQlbIHNwZWVkICVkIF1cbiIKCQkJICAiCQlbIGxh
bmVzICVkIF1cbiIKCQkJICAiCQlbIGR1cGxleCBoYWxmfGZ1bGwgXVxuIgoJCQkgICIJCVsgcG9y
dCB0cHxhdWl8Ym5jfG1paXxmaWJyZXxkYSBdXG4iCgkJCSAgIgkJWyBtZGl4IGF1dG98b258b2Zm
IF1cbiIKCQkJICAiCQlbIGF1dG9uZWcgb258b2ZmIF1cbiIKCQkJICAiCQlbIGFkdmVydGlzZSAl
eFsvJXhdIHwgbW9kZSBvbnxvZmYgLi4uIFstLV0gXVxuIgoJCQkgICIJCVsgcGh5YWQgJWQgXVxu
IgoJCQkgICIJCVsgeGN2ciBpbnRlcm5hbHxleHRlcm5hbCBdXG4iCgkJCSAgIgkJWyB3b2wgJWRb
LyVkXSB8IHB8dXxtfGJ8YXxnfHN8ZnxkLi4uIF1cbiIKCQkJICAiCQlbIHNvcGFzcyAleDoleDol
eDoleDoleDoleCBdXG4iCgkJCSAgIgkJWyBtc2dsdmwgJWRbLyVkXSB8IHR5cGUgb258b2ZmIC4u
LiBbLS1dIF1cbiIKCQkJICAiCQlbIG1hc3Rlci1zbGF2ZSBwcmVmZXJyZWQtbWFzdGVyfHByZWZl
cnJlZC1zbGF2ZXxmb3JjZWQtbWFzdGVyfGZvcmNlZC1zbGF2ZSBdXG4iCgl9LAoJewoJCS5vcHRz
CT0gIi1hfC0tc2hvdy1wYXVzZSIsCgkJLmpzb24JPSB0cnVlLAoJCS5mdW5jCT0gZG9fZ3BhdXNl
LAoJCS5ubGZ1bmMJPSBubF9ncGF1c2UsCgkJLmhlbHAJPSAiU2hvdyBwYXVzZSBvcHRpb25zIiwK
CQkueGhlbHAJPSAiCQlbIC0tc3JjIGFnZ3JlZ2F0ZSB8IGVtYWMgfCBwbWFjIF1cbiIKCX0sCgl7
CgkJLm9wdHMJPSAiLUF8LS1wYXVzZSIsCgkJLmZ1bmMJPSBkb19zcGF1c2UsCgkJLm5sZnVuYwk9
IG5sX3NwYXVzZSwKCQkuaGVscAk9ICJTZXQgcGF1c2Ugb3B0aW9ucyIsCgkJLnhoZWxwCT0gIgkJ
WyBhdXRvbmVnIG9ufG9mZiBdXG4iCgkJCSAgIgkJWyByeCBvbnxvZmYgXVxuIgoJCQkgICIJCVsg
dHggb258b2ZmIF1cbiIKCX0sCgl7CgkJLm9wdHMJPSAiLWN8LS1zaG93LWNvYWxlc2NlIiwKCQku
anNvbgk9IHRydWUsCgkJLmZ1bmMJPSBkb19nY29hbGVzY2UsCgkJLm5sZnVuYwk9IG5sX2djb2Fs
ZXNjZSwKCQkuaGVscAk9ICJTaG93IGNvYWxlc2NlIG9wdGlvbnMiCgl9LAoJewoJCS5vcHRzCT0g
Ii1DfC0tY29hbGVzY2UiLAoJCS5mdW5jCT0gZG9fc2NvYWxlc2NlLAoJCS5ubGZ1bmMJPSBubF9z
Y29hbGVzY2UsCgkJLmhlbHAJPSAiU2V0IGNvYWxlc2NlIG9wdGlvbnMiLAoJCS54aGVscAk9ICIJ
CVthZGFwdGl2ZS1yeCBvbnxvZmZdXG4iCgkJCSAgIgkJW2FkYXB0aXZlLXR4IG9ufG9mZl1cbiIK
CQkJICAiCQlbcngtdXNlY3MgTl1cbiIKCQkJICAiCQlbcngtZnJhbWVzIE5dXG4iCgkJCSAgIgkJ
W3J4LXVzZWNzLWlycSBOXVxuIgoJCQkgICIJCVtyeC1mcmFtZXMtaXJxIE5dXG4iCgkJCSAgIgkJ
W3R4LXVzZWNzIE5dXG4iCgkJCSAgIgkJW3R4LWZyYW1lcyBOXVxuIgoJCQkgICIJCVt0eC11c2Vj
cy1pcnEgTl1cbiIKCQkJICAiCQlbdHgtZnJhbWVzLWlycSBOXVxuIgoJCQkgICIJCVtzdGF0cy1i
bG9jay11c2VjcyBOXVxuIgoJCQkgICIJCVtwa3QtcmF0ZS1sb3cgTl1cbiIKCQkJICAiCQlbcngt
dXNlY3MtbG93IE5dXG4iCgkJCSAgIgkJW3J4LWZyYW1lcy1sb3cgTl1cbiIKCQkJICAiCQlbdHgt
dXNlY3MtbG93IE5dXG4iCgkJCSAgIgkJW3R4LWZyYW1lcy1sb3cgTl1cbiIKCQkJICAiCQlbcGt0
LXJhdGUtaGlnaCBOXVxuIgoJCQkgICIJCVtyeC11c2Vjcy1oaWdoIE5dXG4iCgkJCSAgIgkJW3J4
LWZyYW1lcy1oaWdoIE5dXG4iCgkJCSAgIgkJW3R4LXVzZWNzLWhpZ2ggTl1cbiIKCQkJICAiCQlb
dHgtZnJhbWVzLWhpZ2ggTl1cbiIKCQkJICAiCQlbc2FtcGxlLWludGVydmFsIE5dXG4iCgkJCSAg
IgkJW2NxZS1tb2RlLXJ4IG9ufG9mZl1cbiIKCQkJICAiCQlbY3FlLW1vZGUtdHggb258b2ZmXVxu
IgoJCQkgICIJCVt0eC1hZ2dyLW1heC1ieXRlcyBOXVxuIgoJCQkgICIJCVt0eC1hZ2dyLW1heC1m
cmFtZXMgTl1cbiIKCQkJICAiCQlbdHgtYWdnci10aW1lLXVzZWNzIE5dXG4iCgl9LAoJewoJCS5v
cHRzCT0gIi1nfC0tc2hvdy1yaW5nIiwKCQkuanNvbgk9IHRydWUsCgkJLmZ1bmMJPSBkb19ncmlu
ZywKCQkubmxmdW5jCT0gbmxfZ3JpbmcsCgkJLmhlbHAJPSAiUXVlcnkgUlgvVFggcmluZyBwYXJh
bWV0ZXJzIgoJfSwKCXsKCQkub3B0cwk9ICItR3wtLXNldC1yaW5nIiwKCQkuZnVuYwk9IGRvX3Ny
aW5nLAoJCS5ubGZ1bmMJPSBubF9zcmluZywKCQkuaGVscAk9ICJTZXQgUlgvVFggcmluZyBwYXJh
bWV0ZXJzIiwKCQkueGhlbHAJPSAiCQlbIHJ4IE4gXVxuIgoJCQkgICIJCVsgcngtbWluaSBOIF1c
biIKCQkJICAiCQlbIHJ4LWp1bWJvIE4gXVxuIgoJCQkgICIJCVsgdHggTiBdXG4iCgkJCSAgIgkJ
WyByeC1idWYtbGVuIE4gXVxuIgoJCQkgICIJCVsgdGNwLWRhdGEtc3BsaXQgYXV0b3xvbnxvZmYg
XVxuIgoJCQkgICIJCVsgY3FlLXNpemUgTiBdXG4iCgkJCSAgIgkJWyB0eC1wdXNoIG9ufG9mZiBd
XG4iCgkJCSAgIgkJWyByeC1wdXNoIG9ufG9mZiBdXG4iCgkJCSAgIgkJWyB0eC1wdXNoLWJ1Zi1s
ZW4gTl1cbiIKCX0sCgl7CgkJLm9wdHMJPSAiLWt8LS1zaG93LWZlYXR1cmVzfC0tc2hvdy1vZmZs
b2FkIiwKCQkuanNvbgk9IHRydWUsCgkJLmZ1bmMJPSBkb19nZmVhdHVyZXMsCgkJLm5sZnVuYwk9
IG5sX2dmZWF0dXJlcywKCQkuaGVscAk9ICJHZXQgc3RhdGUgb2YgcHJvdG9jb2wgb2ZmbG9hZCBh
bmQgb3RoZXIgZmVhdHVyZXMiCgl9LAoJewoJCS5vcHRzCT0gIi1LfC0tZmVhdHVyZXN8LS1vZmZs
b2FkIiwKCQkuZnVuYwk9IGRvX3NmZWF0dXJlcywKCQkubmxmdW5jCT0gbmxfc2ZlYXR1cmVzLAoJ
CS5oZWxwCT0gIlNldCBwcm90b2NvbCBvZmZsb2FkIGFuZCBvdGhlciBmZWF0dXJlcyIsCgkJLnho
ZWxwCT0gIgkJRkVBVFVSRSBvbnxvZmYgLi4uXG4iCgl9LAoJewoJCS5vcHRzCT0gIi1pfC0tZHJp
dmVyIiwKCQkuZnVuYwk9IGRvX2dkcnYsCgkJLmhlbHAJPSAiU2hvdyBkcml2ZXIgaW5mb3JtYXRp
b24iCgl9LAoJewoJCS5vcHRzCT0gIi1kfC0tcmVnaXN0ZXItZHVtcCIsCgkJLmZ1bmMJPSBkb19n
cmVncywKCQkuaGVscAk9ICJEbyBhIHJlZ2lzdGVyIGR1bXAiLAoJCS54aGVscAk9ICIJCVsgcmF3
IG9ufG9mZiBdXG4iCgkJCSAgIgkJWyBmaWxlIEZJTEVOQU1FIF1cbiIKCX0sCgl7CgkJLm9wdHMJ
PSAiLWV8LS1lZXByb20tZHVtcCIsCgkJLmZ1bmMJPSBkb19nZWVwcm9tLAoJCS5oZWxwCT0gIkRv
IGEgRUVQUk9NIGR1bXAiLAoJCS54aGVscAk9ICIJCVsgcmF3IG9ufG9mZiBdXG4iCgkJCSAgIgkJ
WyBvZmZzZXQgTiBdXG4iCgkJCSAgIgkJWyBsZW5ndGggTiBdXG4iCgl9LAoJewoJCS5vcHRzCT0g
Ii1FfC0tY2hhbmdlLWVlcHJvbSIsCgkJLmZ1bmMJPSBkb19zZWVwcm9tLAoJCS5oZWxwCT0gIkNo
YW5nZSBieXRlcyBpbiBkZXZpY2UgRUVQUk9NIiwKCQkueGhlbHAJPSAiCQlbIG1hZ2ljIE4gXVxu
IgoJCQkgICIJCVsgb2Zmc2V0IE4gXVxuIgoJCQkgICIJCVsgbGVuZ3RoIE4gXVxuIgoJCQkgICIJ
CVsgdmFsdWUgTiBdXG4iCgl9LAoJewoJCS5vcHRzCT0gIi1yfC0tbmVnb3RpYXRlIiwKCQkuZnVu
Ywk9IGRvX253YXlfcnN0LAoJCS5oZWxwCT0gIlJlc3RhcnQgTi1XQVkgbmVnb3RpYXRpb24iCgl9
LAoJewoJCS5vcHRzCT0gIi1wfC0taWRlbnRpZnkiLAoJCS5mdW5jCT0gZG9fcGh5c19pZCwKCQku
aGVscAk9ICJTaG93IHZpc2libGUgcG9ydCBpZGVudGlmaWNhdGlvbiAoZS5nLiBibGlua2luZyki
LAoJCS54aGVscAk9ICIJCVsgVElNRS1JTi1TRUNPTkRTIF1cbiIKCX0sCgl7CgkJLm9wdHMJPSAi
LXR8LS10ZXN0IiwKCQkuZnVuYwk9IGRvX3Rlc3QsCgkJLmhlbHAJPSAiRXhlY3V0ZSBhZGFwdGVy
IHNlbGYgdGVzdCIsCgkJLnhoZWxwCT0gIgkJWyBvbmxpbmUgfCBvZmZsaW5lIHwgZXh0ZXJuYWxf
bGIgXVxuIgoJfSwKCXsKCQkub3B0cwk9ICItU3wtLXN0YXRpc3RpY3MiLAoJCS5qc29uCT0gdHJ1
ZSwKCQkuZnVuYwk9IGRvX2duaWNzdGF0cywKCQkubmxjaGsJPSBubF9nc3RhdHNfY2hrLAoJCS5u
bGZ1bmMJPSBubF9nc3RhdHMsCgkJLmhlbHAJPSAiU2hvdyBhZGFwdGVyIHN0YXRpc3RpY3MiLAoJ
CS54aGVscAk9ICIJCVsgLS1hbGwtZ3JvdXBzIHwgLS1ncm91cHMgW2V0aC1waHldIFtldGgtbWFj
XSBbZXRoLWN0cmxdIFtybW9uXSBdXG4iCgkJCSAgIgkJWyAtLXNyYyBhZ2dyZWdhdGUgfCBlbWFj
IHwgcG1hYyBdXG4iCgl9LAoJewoJCS5vcHRzCT0gIi0tcGh5LXN0YXRpc3RpY3MiLAoJCS5mdW5j
CT0gZG9fZ3BoeXN0YXRzLAoJCS5oZWxwCT0gIlNob3cgcGh5IHN0YXRpc3RpY3MiCgl9LAoJewoJ
CS5vcHRzCT0gIi1ufC11fC0tc2hvdy1uZmN8LS1zaG93LW50dXBsZSIsCgkJLmZ1bmMJPSBkb19n
cnhjbGFzcywKCQkuaGVscAk9ICJTaG93IFJ4IG5ldHdvcmsgZmxvdyBjbGFzc2lmaWNhdGlvbiBv
cHRpb25zIG9yIHJ1bGVzIiwKCQkueGhlbHAJPSAiCQlbIHJ4LWZsb3ctaGFzaCB0Y3A0fHVkcDR8
YWg0fGVzcDR8c2N0cDR8IgoJCQkgICJ0Y3A2fHVkcDZ8YWg2fGVzcDZ8c2N0cDYgW2NvbnRleHQg
JWRdIHxcbiIKCQkJICAiCQkgIHJ1bGUgJWQgXVxuIgoJfSwKCXsKCQkub3B0cwk9ICItTnwtVXwt
LWNvbmZpZy1uZmN8LS1jb25maWctbnR1cGxlIiwKCQkuZnVuYwk9IGRvX3NyeGNsYXNzLAoJCS5o
ZWxwCT0gIkNvbmZpZ3VyZSBSeCBuZXR3b3JrIGZsb3cgY2xhc3NpZmljYXRpb24gb3B0aW9ucyBv
ciBydWxlcyIsCgkJLnhoZWxwCT0gIgkJcngtZmxvdy1oYXNoIHRjcDR8dWRwNHxhaDR8ZXNwNHxz
Y3RwNHwiCgkJCSAgInRjcDZ8dWRwNnxhaDZ8ZXNwNnxzY3RwNiBtfHZ8dHxzfGR8ZnxufHIuLi4g
W2NvbnRleHQgJWRdIHxcbiIKCQkJICAiCQlmbG93LXR5cGUgZXRoZXJ8aXA0fHRjcDR8dWRwNHxz
Y3RwNHxhaDR8ZXNwNHwiCgkJCSAgImlwNnx0Y3A2fHVkcDZ8YWg2fGVzcDZ8c2N0cDZcbiIKCQkJ
ICAiCQkJWyBzcmMgJXg6JXg6JXg6JXg6JXg6JXggW20gJXg6JXg6JXg6JXg6JXg6JXhdIF1cbiIK
CQkJICAiCQkJWyBkc3QgJXg6JXg6JXg6JXg6JXg6JXggW20gJXg6JXg6JXg6JXg6JXg6JXhdIF1c
biIKCQkJICAiCQkJWyBwcm90byAlZCBbbSAleF0gXVxuIgoJCQkgICIJCQlbIHNyYy1pcCBJUC1B
RERSRVNTIFttIElQLUFERFJFU1NdIF1cbiIKCQkJICAiCQkJWyBkc3QtaXAgSVAtQUREUkVTUyBb
bSBJUC1BRERSRVNTXSBdXG4iCgkJCSAgIgkJCVsgdG9zICVkIFttICV4XSBdXG4iCgkJCSAgIgkJ
CVsgdGNsYXNzICVkIFttICV4XSBdXG4iCgkJCSAgIgkJCVsgbDRwcm90byAlZCBbbSAleF0gXVxu
IgoJCQkgICIJCQlbIHNyYy1wb3J0ICVkIFttICV4XSBdXG4iCgkJCSAgIgkJCVsgZHN0LXBvcnQg
JWQgW20gJXhdIF1cbiIKCQkJICAiCQkJWyBzcGkgJWQgW20gJXhdIF1cbiIKCQkJICAiCQkJWyB2
bGFuLWV0eXBlICV4IFttICV4XSBdXG4iCgkJCSAgIgkJCVsgdmxhbiAleCBbbSAleF0gXVxuIgoJ
CQkgICIJCQlbIHVzZXItZGVmICV4IFttICV4XSBdXG4iCgkJCSAgIgkJCVsgZHN0LW1hYyAleDol
eDoleDoleDoleDoleCBbbSAleDoleDoleDoleDoleDoleF0gXVxuIgoJCQkgICIJCQlbIGFjdGlv
biAlZCBdIHwgWyB2ZiAlZCBxdWV1ZSAlZCBdXG4iCgkJCSAgIgkJCVsgY29udGV4dCAlZCBdXG4i
CgkJCSAgIgkJCVsgbG9jICVkIF0gfFxuIgoJCQkgICIJCWRlbGV0ZSAlZFxuIgoJfSwKCXsKCQku
b3B0cwk9ICItVHwtLXNob3ctdGltZS1zdGFtcGluZyIsCgkJLmZ1bmMJPSBkb190c2luZm8sCgkJ
Lm5sZnVuYwk9IG5sX3RzaW5mbywKCQkuaGVscAk9ICJTaG93IHRpbWUgc3RhbXBpbmcgY2FwYWJp
bGl0aWVzIgoJfSwKCXsKCQkub3B0cwk9ICIteHwtLXNob3ctcnhmaC1pbmRpcnwtLXNob3ctcnhm
aCIsCgkJLmpzb24JPSB0cnVlLAoJCS5mdW5jCT0gZG9fZ3J4ZmgsCgkJLm5sZnVuYwk9IG5sX2dy
c3MsCgkJLmhlbHAJPSAiU2hvdyBSeCBmbG93IGhhc2ggaW5kaXJlY3Rpb24gdGFibGUgYW5kL29y
IFJTUyBoYXNoIGtleSIsCgkJLnhoZWxwCT0gIgkJWyBjb250ZXh0ICVkIF1cbiIKCX0sCgl7CgkJ
Lm9wdHMJPSAiLVh8LS1zZXQtcnhmaC1pbmRpcnwtLXJ4ZmgiLAoJCS5mdW5jCT0gZG9fc3J4Zmgs
CgkJLmhlbHAJPSAiU2V0IFJ4IGZsb3cgaGFzaCBpbmRpcmVjdGlvbiB0YWJsZSBhbmQvb3IgUlNT
IGhhc2gga2V5IiwKCQkueGhlbHAJPSAiCQlbIGNvbnRleHQgJWR8bmV3IF1cbiIKCQkJICAiCQlb
IGVxdWFsIE4gfCB3ZWlnaHQgVzAgVzEgLi4uIHwgZGVmYXVsdCBdXG4iCgkJCSAgIgkJWyBoa2V5
ICV4OiV4OiV4OiV4OiV4Oi4uLi4gXVxuIgoJCQkgICIJCVsgaGZ1bmMgRlVOQyBdXG4iCgkJCSAg
IgkJWyBkZWxldGUgXVxuIgoJfSwKCXsKCQkub3B0cwk9ICItZnwtLWZsYXNoIiwKCQkuZnVuYwk9
IGRvX2ZsYXNoLAoJCS5oZWxwCT0gIkZsYXNoIGZpcm13YXJlIGltYWdlIGZyb20gdGhlIHNwZWNp
ZmllZCBmaWxlIHRvIGEgcmVnaW9uIG9uIHRoZSBkZXZpY2UiLAoJCS54aGVscAk9ICIJCUZJTEVO
QU1FIFsgUkVHSU9OLU5VTUJFUi1UTy1GTEFTSCBdXG4iCgl9LAoJewoJCS5vcHRzCT0gIi1QfC0t
c2hvdy1wZXJtYWRkciIsCgkJLmZ1bmMJPSBkb19wZXJtYWRkciwKCQkubmxmdW5jCT0gbmxfcGVy
bWFkZHIsCgkJLmhlbHAJPSAiU2hvdyBwZXJtYW5lbnQgaGFyZHdhcmUgYWRkcmVzcyIKCX0sCgl7
CgkJLm9wdHMJPSAiLXd8LS1nZXQtZHVtcCIsCgkJLmZ1bmMJPSBkb19nZXRmd2R1bXAsCgkJLmhl
bHAJPSAiR2V0IGR1bXAgZmxhZywgZGF0YSIsCgkJLnhoZWxwCT0gIgkJWyBkYXRhIEZJTEVOQU1F
IF1cbiIKCX0sCgl7CgkJLm9wdHMJPSAiLVd8LS1zZXQtZHVtcCIsCgkJLmZ1bmMJPSBkb19zZXRm
d2R1bXAsCgkJLmhlbHAJPSAiU2V0IGR1bXAgZmxhZyBvZiB0aGUgZGV2aWNlIiwKCQkueGhlbHAJ
PSAiCQlOXG4iCgl9LAoJewoJCS5vcHRzCT0gIi1sfC0tc2hvdy1jaGFubmVscyIsCgkJLmZ1bmMJ
PSBkb19nY2hhbm5lbHMsCgkJLm5sZnVuYwk9IG5sX2djaGFubmVscywKCQkuaGVscAk9ICJRdWVy
eSBDaGFubmVscyIKCX0sCgl7CgkJLm9wdHMJPSAiLUx8LS1zZXQtY2hhbm5lbHMiLAoJCS5mdW5j
CT0gZG9fc2NoYW5uZWxzLAoJCS5ubGZ1bmMJPSBubF9zY2hhbm5lbHMsCgkJLmhlbHAJPSAiU2V0
IENoYW5uZWxzIiwKCQkueGhlbHAJPSAiCQlbIHJ4IE4gXVxuIgoJCQkgICIJCVsgdHggTiBdXG4i
CgkJCSAgIgkJWyBvdGhlciBOIF1cbiIKCQkJICAiCQlbIGNvbWJpbmVkIE4gXVxuIgoJfSwKCXsK
CQkub3B0cwk9ICItLXNob3ctcHJpdi1mbGFncyIsCgkJLmZ1bmMJPSBkb19ncHJpdmZsYWdzLAoJ
CS5ubGZ1bmMJPSBubF9ncHJpdmZsYWdzLAoJCS5oZWxwCT0gIlF1ZXJ5IHByaXZhdGUgZmxhZ3Mi
Cgl9LAoJewoJCS5vcHRzCT0gIi0tc2V0LXByaXYtZmxhZ3MiLAoJCS5mdW5jCT0gZG9fc3ByaXZm
bGFncywKCQkubmxmdW5jCT0gbmxfc3ByaXZmbGFncywKCQkuaGVscAk9ICJTZXQgcHJpdmF0ZSBm
bGFncyIsCgkJLnhoZWxwCT0gIgkJRkxBRyBvbnxvZmYgLi4uXG4iCgl9LAoJewoJCS5vcHRzCT0g
Ii1tfC0tZHVtcC1tb2R1bGUtZWVwcm9tfC0tbW9kdWxlLWluZm8iLAoJCS5mdW5jCT0gZG9fZ2V0
bW9kdWxlLAoJCS5ubGZ1bmMgPSBubF9nZXRtb2R1bGUsCgkJLmhlbHAJPSAiUXVlcnkvRGVjb2Rl
IE1vZHVsZSBFRVBST00gaW5mb3JtYXRpb24gYW5kIG9wdGljYWwgZGlhZ25vc3RpY3MgaWYgYXZh
aWxhYmxlIiwKCQkueGhlbHAJPSAiCQlbIHJhdyBvbnxvZmYgXVxuIgoJCQkgICIJCVsgaGV4IG9u
fG9mZiBdXG4iCgkJCSAgIgkJWyBvZmZzZXQgTiBdXG4iCgkJCSAgIgkJWyBsZW5ndGggTiBdXG4i
CgkJCSAgIgkJWyBwYWdlIE4gXVxuIgoJCQkgICIJCVsgYmFuayBOIF1cbiIKCQkJICAiCQlbIGky
YyBOIF1cbiIKCX0sCgl7CgkJLm9wdHMJPSAiLS1zaG93LWVlZSIsCgkJLmZ1bmMJPSBkb19nZWVl
LAoJCS5ubGZ1bmMJPSBubF9nZWVlLAoJCS5oZWxwCT0gIlNob3cgRUVFIHNldHRpbmdzIiwKCX0s
Cgl7CgkJLm9wdHMJPSAiLS1zZXQtZWVlIiwKCQkuZnVuYwk9IGRvX3NlZWUsCgkJLm5sZnVuYwk9
IG5sX3NlZWUsCgkJLmhlbHAJPSAiU2V0IEVFRSBzZXR0aW5ncyIsCgkJLnhoZWxwCT0gIgkJWyBl
ZWUgb258b2ZmIF1cbiIKCQkJICAiCQlbIGFkdmVydGlzZSAleCBdXG4iCgkJCSAgIgkJWyB0eC1s
cGkgb258b2ZmIF1cbiIKCQkJICAiCQlbIHR4LXRpbWVyICVkIF1cbiIKCX0sCgl7CgkJLm9wdHMJ
PSAiLS1zZXQtcGh5LXR1bmFibGUiLAoJCS5mdW5jCT0gZG9fc2V0X3BoeV90dW5hYmxlLAoJCS5o
ZWxwCT0gIlNldCBQSFkgdHVuYWJsZSIsCgkJLnhoZWxwCT0gIgkJWyBkb3duc2hpZnQgb258b2Zm
IFtjb3VudCBOXSBdXG4iCgkJCSAgIgkJWyBmYXN0LWxpbmstZG93biBvbnxvZmYgW21zZWNzIE5d
IF1cbiIKCQkJICAiCQlbIGVuZXJneS1kZXRlY3QtcG93ZXItZG93biBvbnxvZmYgW21zZWNzIE5d
IF1cbiIKCX0sCgl7CgkJLm9wdHMJPSAiLS1nZXQtcGh5LXR1bmFibGUiLAoJCS5mdW5jCT0gZG9f
Z2V0X3BoeV90dW5hYmxlLAoJCS5oZWxwCT0gIkdldCBQSFkgdHVuYWJsZSIsCgkJLnhoZWxwCT0g
IgkJWyBkb3duc2hpZnQgXVxuIgoJCQkgICIJCVsgZmFzdC1saW5rLWRvd24gXVxuIgoJCQkgICIJ
CVsgZW5lcmd5LWRldGVjdC1wb3dlci1kb3duIF1cbiIKCX0sCgl7CgkJLm9wdHMJPSAiLS1nZXQt
dHVuYWJsZSIsCgkJLmZ1bmMJPSBkb19ndHVuYWJsZSwKCQkuaGVscAk9ICJHZXQgdHVuYWJsZSIs
CgkJLnhoZWxwCT0gIgkJWyByeC1jb3B5YnJlYWsgXVxuIgoJCQkgICIJCVsgdHgtY29weWJyZWFr
IF1cbiIKCQkJICAiCQlbIHR4LWJ1Zi1zaXplIF1cbiIKCQkJICAiCQlbIHBmYy1wcmV2ZW50aW9u
LXRvdXQgXVxuIgoJfSwKCXsKCQkub3B0cwk9ICItLXNldC10dW5hYmxlIiwKCQkuZnVuYwk9IGRv
X3N0dW5hYmxlLAoJCS5oZWxwCT0gIlNldCB0dW5hYmxlIiwKCQkueGhlbHAJPSAiCQlbIHJ4LWNv
cHlicmVhayBOIF1cbiIKCQkJICAiCQlbIHR4LWNvcHlicmVhayBOIF1cbiIKCQkJICAiCQlbIHR4
LWJ1Zi1zaXplIE4gXVxuIgoJCQkgICIJCVsgcGZjLXByZXZlbnRpb24tdG91dCBOIF1cbiIKCX0s
Cgl7CgkJLm9wdHMJPSAiLS1yZXNldCIsCgkJLmZ1bmMJPSBkb19yZXNldCwKCQkuaGVscAk9ICJS
ZXNldCBjb21wb25lbnRzIiwKCQkueGhlbHAJPSAiCQlbIGZsYWdzICV4IF1cbiIKCQkJICAiCQlb
IG1nbXQgXVxuIgoJCQkgICIJCVsgbWdtdC1zaGFyZWQgXVxuIgoJCQkgICIJCVsgaXJxIF1cbiIK
CQkJICAiCQlbIGlycS1zaGFyZWQgXVxuIgoJCQkgICIJCVsgZG1hIF1cbiIKCQkJICAiCQlbIGRt
YS1zaGFyZWQgXVxuIgoJCQkgICIJCVsgZmlsdGVyIF1cbiIKCQkJICAiCQlbIGZpbHRlci1zaGFy
ZWQgXVxuIgoJCQkgICIJCVsgb2ZmbG9hZCBdXG4iCgkJCSAgIgkJWyBvZmZsb2FkLXNoYXJlZCBd
XG4iCgkJCSAgIgkJWyBtYWMgXVxuIgoJCQkgICIJCVsgbWFjLXNoYXJlZCBdXG4iCgkJCSAgIgkJ
WyBwaHkgXVxuIgoJCQkgICIJCVsgcGh5LXNoYXJlZCBdXG4iCgkJCSAgIgkJWyByYW0gXVxuIgoJ
CQkgICIJCVsgcmFtLXNoYXJlZCBdXG4iCgkJCSAgIgkJWyBhcCBdXG4iCgkJCSAgIgkJWyBhcC1z
aGFyZWQgXVxuIgoJCQkgICIJCVsgZGVkaWNhdGVkIF1cbiIKCQkJICAiCQlbIGFsbCBdXG4iCgl9
LAoJewoJCS5vcHRzCT0gIi0tc2hvdy1mZWMiLAoJCS5qc29uCT0gdHJ1ZSwKCQkuZnVuYwk9IGRv
X2dmZWMsCgkJLm5sZnVuYwk9IG5sX2dmZWMsCgkJLmhlbHAJPSAiU2hvdyBGRUMgc2V0dGluZ3Mi
LAoJfSwKCXsKCQkub3B0cwk9ICItLXNldC1mZWMiLAoJCS5mdW5jCT0gZG9fc2ZlYywKCQkubmxm
dW5jCT0gbmxfc2ZlYywKCQkuaGVscAk9ICJTZXQgRkVDIHNldHRpbmdzIiwKCQkueGhlbHAJPSAi
CQlbIGVuY29kaW5nIGF1dG98b2ZmfHJzfGJhc2VyfGxscnMgWy4uLl0gXVxuIgoJfSwKCXsKCQku
b3B0cwk9ICItUXwtLXBlci1xdWV1ZSIsCgkJLmZ1bmMJPSBkb19wZXJxdWV1ZSwKCQkuaGVscAk9
ICJBcHBseSBwZXItcXVldWUgY29tbWFuZC4gIiwKCQkueGhlbHAJPSAiVGhlIHN1cHBvcnRlZCBz
dWIgY29tbWFuZHMgaW5jbHVkZSAtLXNob3ctY29hbGVzY2UsIC0tY29hbGVzY2UiCgkJCSAgIgkJ
W3F1ZXVlX21hc2sgJXhdIFNVQl9DT01NQU5EXG4iLAoJfSwKCXsKCQkub3B0cwk9ICItLWNhYmxl
LXRlc3QiLAoJCS5qc29uCT0gdHJ1ZSwKCQkubmxmdW5jCT0gbmxfY2FibGVfdGVzdCwKCQkuaGVs
cAk9ICJQZXJmb3JtIGEgY2FibGUgdGVzdCIsCgl9LAoJewoJCS5vcHRzCT0gIi0tY2FibGUtdGVz
dC10ZHIiLAoJCS5qc29uCT0gdHJ1ZSwKCQkubmxmdW5jCT0gbmxfY2FibGVfdGVzdF90ZHIsCgkJ
LmhlbHAJPSAiUHJpbnQgY2FibGUgdGVzdCB0aW1lIGRvbWFpbiByZWZsZWN0cm9tZXRlcnkgZGF0
YSIsCgkJLnhoZWxwCT0gIgkJWyBmaXJzdCBOIF1cbiIKCQkJICAiCQlbIGxhc3QgTiBdXG4iCgkJ
CSAgIgkJWyBzdGVwIE4gXVxuIgoJCQkgICIJCVsgcGFpciBOIF1cbiIKCX0sCgl7CgkJLm9wdHMJ
PSAiLS1zaG93LXR1bm5lbHMiLAoJCS5ubGZ1bmMJPSBubF9ndHVubmVscywKCQkuaGVscAk9ICJT
aG93IE5JQyB0dW5uZWwgb2ZmbG9hZCBpbmZvcm1hdGlvbiIsCgl9LAoJewoJCS5vcHRzCT0gIi0t
c2hvdy1tb2R1bGUiLAoJCS5qc29uCT0gdHJ1ZSwKCQkubmxmdW5jCT0gbmxfZ21vZHVsZSwKCQku
aGVscAk9ICJTaG93IHRyYW5zY2VpdmVyIG1vZHVsZSBzZXR0aW5ncyIsCgl9LAoJewoJCS5vcHRz
CT0gIi0tc2V0LW1vZHVsZSIsCgkJLm5sZnVuYwk9IG5sX3Ntb2R1bGUsCgkJLmhlbHAJPSAiU2V0
IHRyYW5zY2VpdmVyIG1vZHVsZSBzZXR0aW5ncyIsCgkJLnhoZWxwCT0gIgkJWyBwb3dlci1tb2Rl
LXBvbGljeSBoaWdofGF1dG8gXVxuIgoJfSwKCXsKCQkub3B0cwk9ICItLWdldC1wbGNhLWNmZyIs
CgkJLm5sZnVuYwk9IG5sX3BsY2FfZ2V0X2NmZywKCQkuaGVscAk9ICJHZXQgUExDQSBjb25maWd1
cmF0aW9uIiwKCX0sCgl7CgkJLm9wdHMJPSAiLS1zZXQtcGxjYS1jZmciLAoJCS5ubGZ1bmMJPSBu
bF9wbGNhX3NldF9jZmcsCgkJLmhlbHAJPSAiU2V0IFBMQ0EgY29uZmlndXJhdGlvbiIsCgkJLnho
ZWxwICA9ICIJCVsgZW5hYmxlIG9ufG9mZiBdXG4iCgkJCSAgIgkJWyBub2RlLWlkIE4gXVxuIgoJ
CQkgICIJCVsgbm9kZS1jbnQgTiBdXG4iCgkJCSAgIgkJWyB0by10bXIgTiBdXG4iCgkJCSAgIgkJ
WyBidXJzdC1jbnQgTiBdXG4iCgkJCSAgIgkJWyBidXJzdC10bXIgTiBdXG4iCgl9LAoJewoJCS5v
cHRzCT0gIi0tZ2V0LXBsY2Etc3RhdHVzIiwKCQkubmxmdW5jCT0gbmxfcGxjYV9nZXRfc3RhdHVz
LAoJCS5oZWxwCT0gIkdldCBQTENBIHN0YXR1cyBpbmZvcm1hdGlvbiIsCgl9LAoJewoJCS5vcHRz
CT0gIi0tc2hvdy1tbSIsCgkJLmpzb24JPSB0cnVlLAoJCS5ubGZ1bmMJPSBubF9nZXRfbW0sCgkJ
LmhlbHAJPSAiU2hvdyBNQUMgbWVyZ2UgbGF5ZXIgc3RhdGUiLAoJfSwKCXsKCQkub3B0cwk9ICIt
LXNldC1tbSIsCgkJLm5sZnVuYwk9IG5sX3NldF9tbSwKCQkuaGVscAk9ICJTZXQgTUFDIG1lcmdl
IGxheWVyIHBhcmFtZXRlcnMiLAoJCQkgICIJCVsgdmVyaWZ5LWVuYWJsZWQgb258b2ZmIF1cbiIK
CQkJICAiCQlbIHZlcmlmeS10aW1lIE4gXVxuIgoJCQkgICIJCVsgdHgtZW5hYmxlZCBvbnxvZmYg
XVxuIgoJCQkgICIJCVsgcG1hYy1lbmFibGVkIG9ufG9mZiBdXG4iCgkJCSAgIgkJWyB0eC1taW4t
ZnJhZy1zaXplIDYwLTI1MiBdXG4iCgl9LAoJewoJCS5vcHRzCT0gIi0tc2hvdy1wc2UiLAoJCS5q
c29uCT0gdHJ1ZSwKCQkubmxmdW5jCT0gbmxfZ3BzZSwKCQkuaGVscAk9ICJTaG93IHNldHRpbmdz
IGZvciBQb3dlciBTb3VyY2luZyBFcXVpcG1lbnQiLAoJfSwKCXsKCQkub3B0cwk9ICItLXNldC1w
c2UiLAoJCS5ubGZ1bmMJPSBubF9zcHNlLAoJCS5oZWxwCT0gIlNldCBQb3dlciBTb3VyY2luZyBF
cXVpcG1lbnQgc2V0dGluZ3MiLAoJCS54aGVscAk9ICIJCVsgcG9kbC1wc2UtYWRtaW4tY29udHJv
bCBlbmFibGV8ZGlzYWJsZSBdXG4iCgl9LAoJewoJCS5vcHRzCT0gIi1ofC0taGVscCIsCgkJLm5v
X2Rldgk9IHRydWUsCgkJLmZ1bmMJPSBzaG93X3VzYWdlLAoJCS5oZWxwCT0gIlNob3cgdGhpcyBo
ZWxwIgoJfSwKCXsKCQkub3B0cwk9ICItLXZlcnNpb24iLAoJCS5ub19kZXYJPSB0cnVlLAoJCS5m
dW5jCT0gZG9fdmVyc2lvbiwKCQkuaGVscAk9ICJTaG93IHZlcnNpb24gbnVtYmVyIgoJfSwKCXt9
Cn07CgpzdGF0aWMgaW50IHNob3dfdXNhZ2Uoc3RydWN0IGNtZF9jb250ZXh0ICpjdHggX19tYXli
ZV91bnVzZWQpCnsKCWludCBpOwoKCS8qIGV0aHRvb2wgLWggKi8KCWZwcmludGYoc3Rkb3V0LCBQ
QUNLQUdFICIgdmVyc2lvbiAiIFZFUlNJT04gIlxuIik7CglmcHJpbnRmKHN0ZG91dCwJIlVzYWdl
OlxuIik7Cglmb3IgKGkgPSAwOyBhcmdzW2ldLm9wdHM7IGkrKykgewoJCWZwdXRzKCIgICAgICAg
IGV0aHRvb2wgWyBGTEFHUyBdICIsIHN0ZG91dCk7CgkJZnByaW50ZihzdGRvdXQsICIlcyAlc1x0
JXNcbiIsCgkJCWFyZ3NbaV0ub3B0cywKCQkJYXJnc1tpXS5ub19kZXYgPyAiXHQiIDogIkRFVk5B
TUUiLAoJCQlhcmdzW2ldLmhlbHApOwoJCWlmIChhcmdzW2ldLnhoZWxwKQoJCQlmcHV0cyhhcmdz
W2ldLnhoZWxwLCBzdGRvdXQpOwoJfQoJbmxfbW9uaXRvcl91c2FnZSgpOwoJZnByaW50ZihzdGRv
dXQsICJcbiIpOwoJZnByaW50ZihzdGRvdXQsICJGTEFHUzpcbiIpOwoJZnByaW50ZihzdGRvdXQs
ICIJLS1kZWJ1ZyBNQVNLCXR1cm4gb24gZGVidWdnaW5nIG1lc3NhZ2VzXG4iKTsKCWZwcmludGYo
c3Rkb3V0LCAiCS0tanNvbgkJZW5hYmxlIEpTT04gb3V0cHV0IGZvcm1hdCAobm90IHN1cHBvcnRl
ZCBieSBhbGwgY29tbWFuZHMpXG4iKTsKCWZwcmludGYoc3Rkb3V0LCAiCS1JfC0taW5jbHVkZS1z
dGF0aXN0aWNzCQlyZXF1ZXN0IGRldmljZSBzdGF0aXN0aWNzIHJlbGF0ZWQgdG8gdGhlIGNvbW1h
bmQgKG5vdCBzdXBwb3J0ZWQgYnkgYWxsIGNvbW1hbmRzKVxuIik7CgoJcmV0dXJuIDA7Cn0KCnN0
YXRpYyBpbnQgZmluZF9vcHRpb24oY2hhciAqYXJnKQp7Cgljb25zdCBjaGFyICpvcHQ7CglzaXpl
X3QgbGVuOwoJaW50IGs7CgoJZm9yIChrID0gMTsgYXJnc1trXS5vcHRzOyBrKyspIHsKCQlvcHQg
PSBhcmdzW2tdLm9wdHM7CgkJZm9yICg7OykgewoJCQlsZW4gPSBzdHJjc3BuKG9wdCwgInwiKTsK
CQkJaWYgKHN0cm5jbXAoYXJnLCBvcHQsIGxlbikgPT0gMCAmJiBhcmdbbGVuXSA9PSAwKQoJCQkJ
cmV0dXJuIGs7CgoJCQlpZiAob3B0W2xlbl0gPT0gMCkKCQkJCWJyZWFrOwoJCQlvcHQgKz0gbGVu
ICsgMTsKCQl9Cgl9CgoJcmV0dXJuIC0xOwp9CgojZGVmaW5lIE1BWCh4LCB5KSAoeCA+IHkgPyB4
IDogeSkKCnN0YXRpYyBpbnQgZmluZF9tYXhfbnVtX3F1ZXVlcyhzdHJ1Y3QgY21kX2NvbnRleHQg
KmN0eCkKewoJc3RydWN0IGV0aHRvb2xfY2hhbm5lbHMgZWNoYW5uZWxzOwoKCWVjaGFubmVscy5j
bWQgPSBFVEhUT09MX0dDSEFOTkVMUzsKCWlmIChzZW5kX2lvY3RsKGN0eCwgJmVjaGFubmVscykp
CgkJcmV0dXJuIC0xOwoKCXJldHVybiBNQVgoZWNoYW5uZWxzLnJ4X2NvdW50LCBlY2hhbm5lbHMu
dHhfY291bnQpICsKCQllY2hhbm5lbHMuY29tYmluZWRfY291bnQ7Cn0KCnN0YXRpYyBzdHJ1Y3Qg
ZXRodG9vbF9wZXJfcXVldWVfb3AgKgpnZXRfcGVyX3F1ZXVlX2NvYWxlc2NlKHN0cnVjdCBjbWRf
Y29udGV4dCAqY3R4LCBfX3UzMiAqcXVldWVfbWFzaywgaW50IG5fcXVldWVzKQp7CglzdHJ1Y3Qg
ZXRodG9vbF9wZXJfcXVldWVfb3AgKnBlcl9xdWV1ZV9vcHQ7CgoJcGVyX3F1ZXVlX29wdCA9IG1h
bGxvYyhzaXplb2YoKnBlcl9xdWV1ZV9vcHQpICsgbl9xdWV1ZXMgKgoJCQlzaXplb2Yoc3RydWN0
IGV0aHRvb2xfY29hbGVzY2UpKTsKCWlmICghcGVyX3F1ZXVlX29wdCkKCQlyZXR1cm4gTlVMTDsK
CgltZW1jcHkocGVyX3F1ZXVlX29wdC0+cXVldWVfbWFzaywgcXVldWVfbWFzaywKCSAgICAgICBf
X0tFUk5FTF9ESVZfUk9VTkRfVVAoTUFYX05VTV9RVUVVRSwgMzIpICogc2l6ZW9mKF9fdTMyKSk7
CglwZXJfcXVldWVfb3B0LT5jbWQgPSBFVEhUT09MX1BFUlFVRVVFOwoJcGVyX3F1ZXVlX29wdC0+
c3ViX2NvbW1hbmQgPSBFVEhUT09MX0dDT0FMRVNDRTsKCWlmIChzZW5kX2lvY3RsKGN0eCwgcGVy
X3F1ZXVlX29wdCkpIHsKCQlmcmVlKHBlcl9xdWV1ZV9vcHQpOwoJCXBlcnJvcigiQ2Fubm90IGdl
dCBkZXZpY2UgcGVyIHF1ZXVlIHBhcmFtZXRlcnMiKTsKCQlyZXR1cm4gTlVMTDsKCX0KCglyZXR1
cm4gcGVyX3F1ZXVlX29wdDsKfQoKc3RhdGljIHZvaWQgc2V0X3Blcl9xdWV1ZV9jb2FsZXNjZShz
dHJ1Y3QgY21kX2NvbnRleHQgKmN0eCwKCQkJCSAgIHN0cnVjdCBldGh0b29sX3Blcl9xdWV1ZV9v
cCAqcGVyX3F1ZXVlX29wdCwKCQkJCSAgIGludCBuX3F1ZXVlcykKewoJc3RydWN0IGV0aHRvb2xf
Y29hbGVzY2UgZWNvYWw7CglERUNMQVJFX0NPQUxFU0NFX09QVElPTl9WQVJTKCk7CglzdHJ1Y3Qg
Y21kbGluZV9pbmZvIGNtZGxpbmVfY29hbGVzY2VbXSA9IENPQUxFU0NFX0NNRExJTkVfSU5GTyhl
Y29hbCk7CglfX3UzMiAqcXVldWVfbWFzayA9IHBlcl9xdWV1ZV9vcHQtPnF1ZXVlX21hc2s7Cglz
dHJ1Y3QgZXRodG9vbF9jb2FsZXNjZSAqZWNvYWxfcTsKCWludCBnY29hbGVzY2VfY2hhbmdlZCA9
IDA7CglpbnQgaSwgaWR4ID0gMDsKCglwYXJzZV9nZW5lcmljX2NtZGxpbmUoY3R4LCAmZ2NvYWxl
c2NlX2NoYW5nZWQsCgkJCSAgICAgIGNtZGxpbmVfY29hbGVzY2UsIEFSUkFZX1NJWkUoY21kbGlu
ZV9jb2FsZXNjZSkpOwoKCWVjb2FsX3EgPSAoc3RydWN0IGV0aHRvb2xfY29hbGVzY2UgKikocGVy
X3F1ZXVlX29wdCArIDEpOwoJZm9yIChpID0gMDsgaSA8IF9fS0VSTkVMX0RJVl9ST1VORF9VUChN
QVhfTlVNX1FVRVVFLCAzMik7IGkrKykgewoJCWludCBxdWV1ZSA9IGkgKiAzMjsKCQlfX3UzMiBt
YXNrID0gcXVldWVfbWFza1tpXTsKCgkJd2hpbGUgKG1hc2sgPiAwKSB7CgkJCWlmIChtYXNrICYg
MHgxKSB7CgkJCQlpbnQgY2hhbmdlZCA9IDA7CgoJCQkJbWVtY3B5KCZlY29hbCwgZWNvYWxfcSAr
IGlkeCwKCQkJCSAgICAgICBzaXplb2Yoc3RydWN0IGV0aHRvb2xfY29hbGVzY2UpKTsKCQkJCWRv
X2dlbmVyaWNfc2V0KGNtZGxpbmVfY29hbGVzY2UsCgkJCQkJICAgICAgIEFSUkFZX1NJWkUoY21k
bGluZV9jb2FsZXNjZSksCgkJCQkJICAgICAgICZjaGFuZ2VkKTsKCQkJCWlmICghY2hhbmdlZCkK
CQkJCQlmcHJpbnRmKHN0ZGVyciwKCQkJCQkJIlF1ZXVlICVkLCBubyBjb2FsZXNjZSBwYXJhbWV0
ZXJzIGNoYW5nZWRcbiIsCgkJCQkJCXF1ZXVlKTsKCQkJCW1lbWNweShlY29hbF9xICsgaWR4LCAm
ZWNvYWwsCgkJCQkgICAgICAgc2l6ZW9mKHN0cnVjdCBldGh0b29sX2NvYWxlc2NlKSk7CgkJCQlp
ZHgrKzsKCQkJfQoJCQltYXNrID0gbWFzayA+PiAxOwoJCQlxdWV1ZSsrOwoJCX0KCQlpZiAoaWR4
ID09IG5fcXVldWVzKQoJCQlicmVhazsKCX0KCglwZXJfcXVldWVfb3B0LT5jbWQgPSBFVEhUT09M
X1BFUlFVRVVFOwoJcGVyX3F1ZXVlX29wdC0+c3ViX2NvbW1hbmQgPSBFVEhUT09MX1NDT0FMRVND
RTsKCglpZiAoc2VuZF9pb2N0bChjdHgsIHBlcl9xdWV1ZV9vcHQpKQoJCXBlcnJvcigiQ2Fubm90
IHNldCBkZXZpY2UgcGVyIHF1ZXVlIHBhcmFtZXRlcnMiKTsKfQoKc3RhdGljIGludCBkb19wZXJx
dWV1ZShzdHJ1Y3QgY21kX2NvbnRleHQgKmN0eCkKewoJc3RydWN0IGV0aHRvb2xfcGVyX3F1ZXVl
X29wICpwZXJfcXVldWVfb3B0OwoJX191MzIgcXVldWVfbWFza1tfX0tFUk5FTF9ESVZfUk9VTkRf
VVAoTUFYX05VTV9RVUVVRSwgMzIpXSA9IHswfTsKCWludCBpLCBuX3F1ZXVlcyA9IDA7CgoJaWYg
KGN0eC0+YXJnYyA9PSAwKQoJCWV4aXRfYmFkX2FyZ3MoKTsKCgkvKgoJICogVGhlIHN1YiBjb21t
YW5kcyB3aWxsIGJlIGFwcGxpZWQgdG8KCSAqIGFsbCBxdWV1ZXMgaWYgbm8gcXVldWVfbWFzayBz
ZXQKCSAqLwoJaWYgKHN0cm5jbXAoKmN0eC0+YXJncCwgInF1ZXVlX21hc2siLCAxMSkpIHsKCQlu
X3F1ZXVlcyA9IGZpbmRfbWF4X251bV9xdWV1ZXMoY3R4KTsKCQlpZiAobl9xdWV1ZXMgPCAwKSB7
CgkJCXBlcnJvcigiQ2Fubm90IGdldCBudW1iZXIgb2YgcXVldWVzIik7CgkJCXJldHVybiAtRUZB
VUxUOwoJCX0gZWxzZSBpZiAobl9xdWV1ZXMgPiBNQVhfTlVNX1FVRVVFKSB7CgkJCW5fcXVldWVz
ID0gTUFYX05VTV9RVUVVRTsKCQl9CgkJZm9yIChpID0gMDsgaSA8IG5fcXVldWVzIC8gMzI7IGkr
KykKCQkJcXVldWVfbWFza1tpXSA9IH4wOwoJCWlmIChuX3F1ZXVlcyAlIDMyKQoJCQlxdWV1ZV9t
YXNrW2ldID0gKDEgPDwgKG5fcXVldWVzIC0gaSAqIDMyKSkgLSAxOwoJCWZwcmludGYoc3Rkb3V0
LAoJCQkiVGhlIHN1YiBjb21tYW5kcyB3aWxsIGJlIGFwcGxpZWQgdG8gYWxsICVkIHF1ZXVlc1xu
IiwKCQkJbl9xdWV1ZXMpOwoJfSBlbHNlIHsKCQlpZiAoY3R4LT5hcmdjIDw9IDIpCgkJCWV4aXRf
YmFkX2FyZ3MoKTsKCQljdHgtPmFyZ2MtLTsKCQljdHgtPmFyZ3ArKzsKCQlpZiAocGFyc2VfaGV4
X3UzMl9iaXRtYXAoKmN0eC0+YXJncCwgTUFYX05VTV9RVUVVRSwKCQkgICAgcXVldWVfbWFzaykp
IHsKCQkJZnByaW50ZihzdGRvdXQsICJJbnZhbGlkIHF1ZXVlIG1hc2tcbiIpOwoJCQlyZXR1cm4g
LTE7CgkJfQoJCWZvciAoaSA9IDA7IGkgPCBfX0tFUk5FTF9ESVZfUk9VTkRfVVAoTUFYX05VTV9R
VUVVRSwgMzIpOyBpKyspIHsKCQkJX191MzIgbWFzayA9IHF1ZXVlX21hc2tbaV07CgoJCQl3aGls
ZSAobWFzayA+IDApIHsKCQkJCWlmIChtYXNrICYgMHgxKQoJCQkJCW5fcXVldWVzKys7CgkJCQlt
YXNrID0gbWFzayA+PiAxOwoJCQl9CgkJfQoJCWN0eC0+YXJnYy0tOwoJCWN0eC0+YXJncCsrOwoJ
fQoKCWkgPSBmaW5kX29wdGlvbihjdHgtPmFyZ3BbMF0pOwoJaWYgKGkgPCAwKQoJCWV4aXRfYmFk
X2FyZ3MoKTsKCglpZiAoc3Ryc3RyKGFyZ3NbaV0ub3B0cywgIi0tc2hvdy1jb2FsZXNjZSIpICE9
IE5VTEwpIHsKCQlwZXJfcXVldWVfb3B0ID0gZ2V0X3Blcl9xdWV1ZV9jb2FsZXNjZShjdHgsIHF1
ZXVlX21hc2ssCgkJCQkJCSAgICAgICBuX3F1ZXVlcyk7CgkJaWYgKHBlcl9xdWV1ZV9vcHQgPT0g
TlVMTCkgewoJCQlwZXJyb3IoIkNhbm5vdCBnZXQgZGV2aWNlIHBlciBxdWV1ZSBwYXJhbWV0ZXJz
Iik7CgkJCXJldHVybiAtRUZBVUxUOwoJCX0KCQlkdW1wX3Blcl9xdWV1ZV9jb2FsZXNjZShwZXJf
cXVldWVfb3B0LCBxdWV1ZV9tYXNrLCBuX3F1ZXVlcyk7CgkJZnJlZShwZXJfcXVldWVfb3B0KTsK
CX0gZWxzZSBpZiAoc3Ryc3RyKGFyZ3NbaV0ub3B0cywgIi0tY29hbGVzY2UiKSAhPSBOVUxMKSB7
CgkJY3R4LT5hcmdjLS07CgkJY3R4LT5hcmdwKys7CgkJcGVyX3F1ZXVlX29wdCA9IGdldF9wZXJf
cXVldWVfY29hbGVzY2UoY3R4LCBxdWV1ZV9tYXNrLAoJCQkJCQkgICAgICAgbl9xdWV1ZXMpOwoJ
CWlmIChwZXJfcXVldWVfb3B0ID09IE5VTEwpIHsKCQkJcGVycm9yKCJDYW5ub3QgZ2V0IGRldmlj
ZSBwZXIgcXVldWUgcGFyYW1ldGVycyIpOwoJCQlyZXR1cm4gLUVGQVVMVDsKCQl9CgkJc2V0X3Bl
cl9xdWV1ZV9jb2FsZXNjZShjdHgsIHBlcl9xdWV1ZV9vcHQsIG5fcXVldWVzKTsKCQlmcmVlKHBl
cl9xdWV1ZV9vcHQpOwoJfSBlbHNlIHsKCQlwZXJyb3IoIlRoZSBzdWJjb21tYW5kIGlzIG5vdCBz
dXBwb3J0ZWQgeWV0Iik7CgkJcmV0dXJuIC1FT1BOT1RTVVBQOwoJfQoKCXJldHVybiAwOwp9Cgpz
dGF0aWMgaW50IGlvY3RsX2luaXQoc3RydWN0IGNtZF9jb250ZXh0ICpjdHgsIGJvb2wgbm9fZGV2
KQp7CglpZiAobm9fZGV2KSB7CgkJY3R4LT5mZCA9IC0xOwoJCXJldHVybiAwOwoJfQoJaWYgKHN0
cmxlbihjdHgtPmRldm5hbWUpID49IElGTkFNU0laKSB7CgkJZnByaW50ZihzdGRlcnIsICJEZXZp
Y2UgbmFtZSBsb25nZXIgdGhhbiAldSBjaGFyYWN0ZXJzXG4iLAoJCQlJRk5BTVNJWiAtIDEpOwoJ
CWV4aXRfYmFkX2FyZ3MoKTsKCX0KCgkvKiBTZXR1cCBvdXIgY29udHJvbCBzdHJ1Y3R1cmVzLiAq
LwoJbWVtc2V0KCZjdHgtPmlmciwgMCwgc2l6ZW9mKGN0eC0+aWZyKSk7CglzdHJjcHkoY3R4LT5p
ZnIuaWZyX25hbWUsIGN0eC0+ZGV2bmFtZSk7CgoJLyogT3BlbiBjb250cm9sIHNvY2tldC4gKi8K
CWN0eC0+ZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19ER1JBTSwgMCk7CglpZiAoY3R4LT5mZCA8
IDApCgkJY3R4LT5mZCA9IHNvY2tldChBRl9ORVRMSU5LLCBTT0NLX1JBVywgTkVUTElOS19HRU5F
UklDKTsKCWlmIChjdHgtPmZkIDwgMCkgewoJCXBlcnJvcigiQ2Fubm90IGdldCBjb250cm9sIHNv
Y2tldCIpOwoJCXJldHVybiA3MDsKCX0KCglyZXR1cm4gMDsKfQoKaW50IG1haW4oaW50IGFyZ2Ms
IGNoYXIgKiphcmdwKQp7CglzdHJ1Y3QgY21kX2NvbnRleHQgY3R4ID0ge307CglpbnQgcmV0OwoJ
aW50IGs7CgoJaW5pdF9nbG9iYWxfbGlua19tb2RlX21hc2tzKCk7CgoJaWYgKGFyZ2MgPCAyKQoJ
CWV4aXRfYmFkX2FyZ3MoKTsKCgkvKiBTa2lwIGNvbW1hbmQgbmFtZSAqLwoJYXJncCsrOwoJYXJn
Yy0tOwoKCXdoaWxlICh0cnVlKSB7CgkJaWYgKCphcmdwICYmICFzdHJjbXAoKmFyZ3AsICItLWRl
YnVnIikpIHsKCQkJY2hhciAqZXB0cjsKCgkJCWlmIChhcmdjIDwgMikKCQkJCWV4aXRfYmFkX2Fy
Z3MoKTsKCQkJY3R4LmRlYnVnID0gc3RydG91bChhcmdwWzFdLCAmZXB0ciwgMCk7CgkJCWlmICgh
YXJncFsxXVswXSB8fCAqZXB0cikKCQkJCWV4aXRfYmFkX2FyZ3MoKTsKCgkJCWFyZ3AgKz0gMjsK
CQkJYXJnYyAtPSAyOwoJCQljb250aW51ZTsKCQl9CgkJaWYgKCphcmdwICYmICFzdHJjbXAoKmFy
Z3AsICItLWpzb24iKSkgewoJCQljdHguanNvbiA9IHRydWU7CgkJCWFyZ3AgKz0gMTsKCQkJYXJn
YyAtPSAxOwoJCQljb250aW51ZTsKCQl9CgkJaWYgKCphcmdwICYmICghc3RyY21wKCphcmdwLCAi
LS1pbmNsdWRlLXN0YXRpc3RpY3MiKSB8fAoJCQkgICAgICAhc3RyY21wKCphcmdwLCAiLUkiKSkp
IHsKCQkJY3R4LnNob3dfc3RhdHMgPSB0cnVlOwoJCQlhcmdwICs9IDE7CgkJCWFyZ2MgLT0gMTsK
CQkJY29udGludWU7CgkJfQoJCWJyZWFrOwoJfQoJaWYgKCphcmdwICYmICFzdHJjbXAoKmFyZ3As
ICItLW1vbml0b3IiKSkgewoJCWN0eC5hcmdwID0gKythcmdwOwoJCWN0eC5hcmdjID0gLS1hcmdj
OwoJCXJldCA9IG5sX21vbml0b3IoJmN0eCk7CgkJcmV0dXJuIHJldCA/IDEgOiAwOwoJfQoKCS8q
IEZpcnN0IGFyZ3VtZW50IG11c3QgYmUgZWl0aGVyIGEgdmFsaWQgb3B0aW9uIG9yIGEgZGV2aWNl
CgkgKiBuYW1lIHRvIGdldCBzZXR0aW5ncyBmb3IgKHdoaWNoIHdlIGRvbid0IGV4cGVjdCB0byBi
ZWdpbgoJICogd2l0aCAnLScpLgoJICovCglpZiAoISphcmdwKQoJCWV4aXRfYmFkX2FyZ3MoKTsK
CglrID0gZmluZF9vcHRpb24oKmFyZ3ApOwoJaWYgKGsgPiAwKSB7CgkJYXJncCsrOwoJCWFyZ2Mt
LTsKCX0gZWxzZSB7CgkJaWYgKCgqYXJncClbMF0gPT0gJy0nKQoJCQlleGl0X2JhZF9hcmdzKCk7
CgkJayA9IDA7Cgl9CgoJaWYgKCFhcmdzW2tdLm5vX2RldikgewoJCWN0eC5kZXZuYW1lID0gKmFy
Z3ArKzsKCQlhcmdjLS07CgoJCWlmICghY3R4LmRldm5hbWUpCgkJCWV4aXRfYmFkX2FyZ3MoKTsK
CX0KCWlmIChjdHguanNvbiAmJiAhYXJnc1trXS5qc29uKQoJCWV4aXRfYmFkX2FyZ3MoKTsKCWN0
eC5hcmdjID0gYXJnYzsKCWN0eC5hcmdwID0gYXJncDsKCW5ldGxpbmtfcnVuX2hhbmRsZXIoJmN0
eCwgYXJnc1trXS5ubGNoaywgYXJnc1trXS5ubGZ1bmMsICFhcmdzW2tdLmZ1bmMpOwoKCWlmIChj
dHguanNvbikgLyogbm8gSU9DVEwgY29tbWFuZCBzdXBwb3J0cyBKU09OIG91dHB1dCAqLwoJCWV4
aXRfYmFkX2FyZ3MoKTsKCglyZXQgPSBpb2N0bF9pbml0KCZjdHgsIGFyZ3Nba10ubm9fZGV2KTsK
CWlmIChyZXQpCgkJcmV0dXJuIHJldDsKCglyZXR1cm4gYXJnc1trXS5mdW5jKCZjdHgpOwp9Cg==

--_002_LV8PR11MB8700FC048AB32D6E7168855E9F5E2LV8PR11MB8700namp_--

